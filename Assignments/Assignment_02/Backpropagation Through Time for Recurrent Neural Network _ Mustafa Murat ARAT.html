<!DOCTYPE html>
<!-- saved from url=(0051)https://mmuratarat.github.io/2019-02-07/bptt-of-rnn -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Backpropagation Through Time for Recurrent Neural Network | Mustafa Murat ARAT</title>
<meta name="generator" content="Jekyll v3.9.0">
<meta property="og:title" content="Backpropagation Through Time for Recurrent Neural Network">
<meta name="author" content="MMA">
<meta property="og:locale" content="en_US">
<meta name="description" content="Homepage">
<meta property="og:description" content="Homepage">
<link rel="canonical" href="https://mmuratarat.github.io//2019-02-07/bptt-of-rnn">
<meta property="og:url" content="https://mmuratarat.github.io//2019-02-07/bptt-of-rnn">
<meta property="og:site_name" content="Mustafa Murat ARAT">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2019-02-07T00:00:00+00:00">
<meta name="twitter:card" content="summary">
<meta property="twitter:title" content="Backpropagation Through Time for Recurrent Neural Network">
<script type="application/ld+json">
{"@type":"BlogPosting","headline":"Backpropagation Through Time for Recurrent Neural Network","dateModified":"2019-02-07T00:00:00+00:00","datePublished":"2019-02-07T00:00:00+00:00","author":{"@type":"Person","name":"MMA"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://mmuratarat.github.io//2019-02-07/bptt-of-rnn"},"url":"https://mmuratarat.github.io//2019-02-07/bptt-of-rnn","description":"Homepage","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  <!-- CSS -->
  <link rel="stylesheet" href="./Backpropagation Through Time for Recurrent Neural Network _ Mustafa Murat ARAT_files/main.css">
  <link rel="stylesheet" href="./Backpropagation Through Time for Recurrent Neural Network _ Mustafa Murat ARAT_files/font-awesome.min.css">
  <link rel="stylesheet" href="./Backpropagation Through Time for Recurrent Neural Network _ Mustafa Murat ARAT_files/css">
  
  <link rel="stylesheet" href="./Backpropagation Through Time for Recurrent Neural Network _ Mustafa Murat ARAT_files/all.css">
  <link rel="stylesheet" href="./Backpropagation Through Time for Recurrent Neural Network _ Mustafa Murat ARAT_files/v4-shims.css">

  <!-- Favicon -->
  <link rel="icon" type="image/png" sizes="32x32" href="https://mmuratarat.github.io/assets/favicon.png">
  <link rel="icon" type="image/png" sizes="16x16" href="https://mmuratarat.github.io/assets/favicon.png">
  <link rel="apple-touch-icon" sizes="180x180" href="https://mmuratarat.github.io/assets/favicon.png">
  
  <!-- LaTeX -->
  <script type="text/x-mathjax-config;executed=true">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
        inlineMath: [['$','$']]
      }
    });
  </script>
  <script src="./Backpropagation Through Time for Recurrent Neural Network _ Mustafa Murat ARAT_files/MathJax.js.download" id=""></script>
  
  <!-- RSS -->
  <link type="application/atom+xml" rel="alternate" href="https://mmuratarat.github.io//feed.xml" title="Mustafa Murat ARAT">

  <!-- Google Analytics-->
  
  <script>
  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
  ga('create', 'UA-105252522-2', 'auto');
  ga('send', 'pageview');
</script>
<script async="" src="./Backpropagation Through Time for Recurrent Neural Network _ Mustafa Murat ARAT_files/analytics.js.download"></script>

  


  <script src="./Backpropagation Through Time for Recurrent Neural Network _ Mustafa Murat ARAT_files/embed.js.download" data-timestamp="1616958895197"></script><link rel="prefetch" as="style" href="https://c.disquscdn.com/next/embed/styles/lounge.c82b267b396dfbc10ae5113342115da8.css"><link rel="prefetch" as="script" href="https://c.disquscdn.com/next/embed/common.bundle.f485ba8b89bf2153fdb9f493ec342aed.js"><link rel="prefetch" as="script" href="https://c.disquscdn.com/next/embed/lounge.bundle.5c8cd56736a07a84352a4d37a862a762.js"><link rel="prefetch" as="script" href="https://disqus.com/next/config.js"><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 2px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 2px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: 1em}
.MathJax_MenuRadioCheck.RTL {right: 1em; left: auto}
.MathJax_MenuLabel {padding: 2px 2em 4px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #CCCCCC; margin: 4px 1px 0px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: Highlight; color: HighlightText}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><script src="./Backpropagation Through Time for Recurrent Neural Network _ Mustafa Murat ARAT_files/alfie_v4.63f1ab6d6b9d5807dc0c94ef3fe0b851.js.download" async="" charset="UTF-8"></script><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax.MathJax_FullWidth {text-align: center; display: table-cell!important; width: 10000em!important}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax_LineBox {display: table!important}
.MathJax_LineBox span {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Main; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Main-bold; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Main-italic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Math-italic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Caligraphic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size1; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size2; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size3; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size4; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf?V=2.7.1') format('opentype')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">@font-face {font-family: MathJax_AMS; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_AMS-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_AMS-Regular.otf?V=2.7.1') format('opentype')}
</style></head><body data-new-gr-c-s-check-loaded="14.1001.0" data-gr-ext-installed=""><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div>

    <nav class="nav">
  <div class="nav-container">
    <a href="https://mmuratarat.github.io/">
      <h2 class="nav-title">Mustafa Murat ARAT</h2>
    </a>
    <ul>
      <li><a href="https://mmuratarat.github.io/about">About</a></li>
      <li><a href="https://mmuratarat.github.io/">Posts</a></li>
      <li><a href="https://mmuratarat.github.io/archive/">Archive</a></li>
      <li><a href="https://mmuratarat.github.io/presentations/" target="_blank">Presentations</a></li>
      <li><a href="https://mmuratarat.github.io/turkish/" target="_blank">Türkçe</a></li>
    </ul>
  </div>
</nav>


    <main>
      <div class="post">
  <div class="post-info">
    <span>Written by</span>
    
        MMA
    

    
      <br>
      <span>on&nbsp;</span><time datetime="2019-02-07 00:00:00 +0000">February 07, 2019</time>
        <br>
    <span class="reading-time" title="Estimated read time">
  
  
    16 mins to read.
  
</span>

    

  </div>

  <h1 class="post-title">Backpropagation Through Time for Recurrent Neural Network</h1>
  <div class="post-line"></div>

  <p><img src="./Backpropagation Through Time for Recurrent Neural Network _ Mustafa Murat ARAT_files/BPTT.png" alt=""></p>

<p>The dynamical system is defined by:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 9.454em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.675em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(0.612em, 1007.42em, 3.356em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="mtable" id="MathJax-Span-3" style="padding-right: 0.155em; padding-left: 0.155em;"><span style="display: inline-block; position: relative; width: 7.37em; height: 0px;"><span style="position: absolute; clip: rect(2.543em, 1000.92em, 5.135em, -999.997em); top: -4.012em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.92em, 4.322em, -999.997em); top: -4.672em; right: 0em;"><span class="mtd" id="MathJax-Span-4"><span class="mrow" id="MathJax-Span-5"><span class="msubsup" id="MathJax-Span-6"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-7" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-8"><span class="mrow" id="MathJax-Span-9"><span class="mi" id="MathJax-Span-10" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1000.92em, 4.423em, -999.997em); top: -3.3em; right: 0em;"><span class="mtd" id="MathJax-Span-35"><span class="mrow" id="MathJax-Span-36"><span class="msubsup" id="MathJax-Span-37"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.51em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="texatom" id="MathJax-Span-38"><span class="mrow" id="MathJax-Span-39"><span class="munderover" id="MathJax-Span-40"><span style="display: inline-block; position: relative; width: 0.612em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.372em, -999.997em); top: -4.012em; left: 0.003em;"><span class="mi" id="MathJax-Span-41" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1000.41em, 3.661em, -999.997em); top: -4.063em; left: 0.104em;"><span class="mo" id="MathJax-Span-42" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.758em; left: 0.612em;"><span class="texatom" id="MathJax-Span-43"><span class="mrow" id="MathJax-Span-44"><span class="mi" id="MathJax-Span-45" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(2.442em, 1006.35em, 5.135em, -999.997em); top: -4.012em; left: 0.917em;"><span style="display: inline-block; position: relative; width: 6.456em; height: 0px;"><span style="position: absolute; clip: rect(3.102em, 1006.35em, 4.423em, -999.997em); top: -4.672em; left: 0em;"><span class="mtd" id="MathJax-Span-11"><span class="mrow" id="MathJax-Span-12"><span class="mi" id="MathJax-Span-13"></span><span class="mo" id="MathJax-Span-14" style="font-family: MathJax_Main; padding-left: 0.257em;">=</span><span class="msubsup" id="MathJax-Span-15" style="padding-left: 0.257em;"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-16" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.511em;"><span class="texatom" id="MathJax-Span-17"><span class="mrow" id="MathJax-Span-18"><span class="mi" id="MathJax-Span-19" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-20" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-21"><span style="display: inline-block; position: relative; width: 1.171em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1000.87em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-22" style="font-family: MathJax_Math-italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.816em;"><span class="texatom" id="MathJax-Span-23"><span class="mrow" id="MathJax-Span-24"><span class="mi" id="MathJax-Span-25" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-26" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-27" style="padding-left: 0.155em;"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-28" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-29"><span class="mrow" id="MathJax-Span-30"><span class="mi" id="MathJax-Span-31" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-32" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-33" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-34" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.102em, 1003.81em, 4.423em, -999.997em); top: -3.3em; left: 0em;"><span class="mtd" id="MathJax-Span-46"><span class="mrow" id="MathJax-Span-47"><span class="mi" id="MathJax-Span-48"></span><span class="mo" id="MathJax-Span-49" style="font-family: MathJax_Main; padding-left: 0.257em;">=</span><span class="msubsup" id="MathJax-Span-50" style="padding-left: 0.257em;"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-51" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.511em;"><span class="texatom" id="MathJax-Span-52"><span class="mrow" id="MathJax-Span-53"><span class="mi" id="MathJax-Span-54" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-55" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-56"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-57" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-58"><span class="mrow" id="MathJax-Span-59"><span class="mi" id="MathJax-Span-60" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-61" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left" rowspacing="3pt" columnspacing="0em" displaystyle="true"><mtr><mtd><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></mtd><mtd><mi></mi><mo>=</mo><msub><mi>f</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi></mrow></msub><mo stretchy="false">(</mo><msub><mi>X</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub><mo>,</mo><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></mtd><mtd><mi></mi><mo>=</mo><msub><mi>f</mi><mrow class="MJX-TeXAtom-ORD"><mi>o</mi></mrow></msub><mo stretchy="false">(</mo><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub><mo stretchy="false">)</mo></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-1">\begin{split}
    h_{t} & = f_{h} (X_{t}, h_{t-1})\\
    \hat{y}_{t} &= f_{o}(h_{t})
\end{split}</script>

<p>A conventional RNN is constructed by defining the transition function and the output function for a single instance:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-62" style="width: 27.187em; display: inline-block;"><span style="display: inline-block; position: relative; width: 22.106em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(0.46em, 1021.85em, 3.509em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-63"><span class="mtable" id="MathJax-Span-64" style="padding-right: 0.155em; padding-left: 0.155em;"><span style="display: inline-block; position: relative; width: 21.801em; height: 0px;"><span style="position: absolute; clip: rect(2.391em, 1000.92em, 5.084em, -999.997em); top: -4.012em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.92em, 4.322em, -999.997em); top: -4.825em; right: 0em;"><span class="mtd" id="MathJax-Span-65"><span class="mrow" id="MathJax-Span-66"><span class="msubsup" id="MathJax-Span-67"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-68" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-69"><span class="mrow" id="MathJax-Span-70"><span class="mi" id="MathJax-Span-71" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1000.92em, 4.423em, -999.997em); top: -3.351em; right: 0em;"><span class="mtd" id="MathJax-Span-143"><span class="mrow" id="MathJax-Span-144"><span class="msubsup" id="MathJax-Span-145"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.51em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="texatom" id="MathJax-Span-146"><span class="mrow" id="MathJax-Span-147"><span class="munderover" id="MathJax-Span-148"><span style="display: inline-block; position: relative; width: 0.612em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.372em, -999.997em); top: -4.012em; left: 0.003em;"><span class="mi" id="MathJax-Span-149" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1000.41em, 3.661em, -999.997em); top: -4.063em; left: 0.104em;"><span class="mo" id="MathJax-Span-150" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.758em; left: 0.612em;"><span class="texatom" id="MathJax-Span-151"><span class="mrow" id="MathJax-Span-152"><span class="mi" id="MathJax-Span-153" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(2.238em, 1020.78em, 5.287em, -999.997em); top: -4.012em; left: 0.917em;"><span style="display: inline-block; position: relative; width: 20.887em; height: 0px;"><span style="position: absolute; clip: rect(3.051em, 1020.78em, 4.525em, -999.997em); top: -4.825em; left: 0em;"><span class="mtd" id="MathJax-Span-72"><span class="mrow" id="MathJax-Span-73"><span class="mi" id="MathJax-Span-74"></span><span class="mo" id="MathJax-Span-75" style="font-family: MathJax_Main; padding-left: 0.257em;">=</span><span class="msubsup" id="MathJax-Span-76" style="padding-left: 0.257em;"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-77" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.511em;"><span class="texatom" id="MathJax-Span-78"><span class="mrow" id="MathJax-Span-79"><span class="mi" id="MathJax-Span-80" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-81" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-82"><span style="display: inline-block; position: relative; width: 1.171em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1000.87em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-83" style="font-family: MathJax_Math-italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.816em;"><span class="texatom" id="MathJax-Span-84"><span class="mrow" id="MathJax-Span-85"><span class="mi" id="MathJax-Span-86" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-87" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-88" style="padding-left: 0.155em;"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-89" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-90"><span class="mrow" id="MathJax-Span-91"><span class="mi" id="MathJax-Span-92" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-93" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-94" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-95" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-96" style="font-family: MathJax_Main; padding-left: 0.257em;">=</span><span class="msubsup" id="MathJax-Span-97" style="padding-left: 0.257em;"><span style="display: inline-block; position: relative; width: 1.07em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-98" style="font-family: MathJax_Math-italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.612em;"><span class="texatom" id="MathJax-Span-99"><span class="mrow" id="MathJax-Span-100"><span class="mi" id="MathJax-Span-101" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-102" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-103"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1001.07em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-104" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.407em, 1000.56em, 4.169em, -999.997em); top: -4.367em; left: 1.12em;"><span class="texatom" id="MathJax-Span-105"><span class="mrow" id="MathJax-Span-106"><span class="mi" id="MathJax-Span-107" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.356em, 1000.87em, 4.169em, -999.997em); top: -3.707em; left: 0.968em;"><span class="texatom" id="MathJax-Span-108"><span class="mrow" id="MathJax-Span-109"><span class="mi" id="MathJax-Span-110" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mi" id="MathJax-Span-111" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-112" style="font-family: MathJax_Main; padding-left: 0.206em;">⋅</span><span class="msubsup" id="MathJax-Span-113" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 1.171em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1000.87em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-114" style="font-family: MathJax_Math-italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.816em;"><span class="texatom" id="MathJax-Span-115"><span class="mrow" id="MathJax-Span-116"><span class="mi" id="MathJax-Span-117" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-118" style="font-family: MathJax_Main; padding-left: 0.206em;">+</span><span class="msubsup" id="MathJax-Span-119" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1001.07em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-120" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.407em, 1000.56em, 4.169em, -999.997em); top: -4.367em; left: 1.12em;"><span class="texatom" id="MathJax-Span-121"><span class="mrow" id="MathJax-Span-122"><span class="mi" id="MathJax-Span-123" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.356em, 1000.92em, 4.169em, -999.997em); top: -3.707em; left: 0.968em;"><span class="texatom" id="MathJax-Span-124"><span class="mrow" id="MathJax-Span-125"><span class="mi" id="MathJax-Span-126" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span class="mi" id="MathJax-Span-127" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-128" style="font-family: MathJax_Main; padding-left: 0.206em;">⋅</span><span class="msubsup" id="MathJax-Span-129" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-130" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-131"><span class="mrow" id="MathJax-Span-132"><span class="mi" id="MathJax-Span-133" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-134" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-135" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-136" style="font-family: MathJax_Main; padding-left: 0.206em;">+</span><span class="msubsup" id="MathJax-Span-137" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.41em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-138" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.409em;"><span class="texatom" id="MathJax-Span-139"><span class="mrow" id="MathJax-Span-140"><span class="mi" id="MathJax-Span-141" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-142" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.051em, 1012.3em, 4.627em, -999.997em); top: -3.351em; left: 0em;"><span class="mtd" id="MathJax-Span-154"><span class="mrow" id="MathJax-Span-155"><span class="mi" id="MathJax-Span-156"></span><span class="mo" id="MathJax-Span-157" style="font-family: MathJax_Main; padding-left: 0.257em;">=</span><span class="msubsup" id="MathJax-Span-158" style="padding-left: 0.257em;"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-159" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.511em;"><span class="texatom" id="MathJax-Span-160"><span class="mrow" id="MathJax-Span-161"><span class="mi" id="MathJax-Span-162" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-163" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-164"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-165" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-166"><span class="mrow" id="MathJax-Span-167"><span class="mi" id="MathJax-Span-168" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-169" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-170" style="font-family: MathJax_Main; padding-left: 0.257em;">=</span><span class="msubsup" id="MathJax-Span-171" style="padding-left: 0.257em;"><span style="display: inline-block; position: relative; width: 1.019em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-172" style="font-family: MathJax_Math-italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.612em;"><span class="texatom" id="MathJax-Span-173"><span class="mrow" id="MathJax-Span-174"><span class="mi" id="MathJax-Span-175" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-176" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-177"><span style="display: inline-block; position: relative; width: 1.781em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1001.07em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-178" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.407em, 1000.56em, 4.169em, -999.997em); top: -4.367em; left: 1.12em;"><span class="texatom" id="MathJax-Span-179"><span class="mrow" id="MathJax-Span-180"><span class="mi" id="MathJax-Span-181" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.356em, 1000.82em, 4.322em, -999.997em); top: -3.707em; left: 0.968em;"><span class="texatom" id="MathJax-Span-182"><span class="mrow" id="MathJax-Span-183"><span class="mi" id="MathJax-Span-184" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-185" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-186" style="font-family: MathJax_Main; padding-left: 0.206em;">⋅</span><span class="msubsup" id="MathJax-Span-187" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-188" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-189"><span class="mrow" id="MathJax-Span-190"><span class="mi" id="MathJax-Span-191" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-192" style="font-family: MathJax_Main; padding-left: 0.206em;">+</span><span class="msubsup" id="MathJax-Span-193" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 0.866em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.41em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-194" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.409em;"><span class="texatom" id="MathJax-Span-195"><span class="mrow" id="MathJax-Span-196"><span class="mi" id="MathJax-Span-197" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-198" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.434em; border-left: 0px solid; width: 0px; height: 3.503em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left" rowspacing="3pt" columnspacing="0em" displaystyle="true"><mtr><mtd><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></mtd><mtd><mi></mi><mo>=</mo><msub><mi>f</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi></mrow></msub><mo stretchy="false">(</mo><msub><mi>X</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub><mo>,</mo><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mo>=</mo><msub><mi>ϕ</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi></mrow></msub><mo stretchy="false">(</mo><msubsup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mi>h</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>T</mi></mrow></msubsup><mo>⋅</mo><msub><mi>X</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub><mo>+</mo><msubsup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi><mi>h</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>T</mi></mrow></msubsup><mo>⋅</mo><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi></mrow></msub><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></mtd><mtd><mi></mi><mo>=</mo><msub><mi>f</mi><mrow class="MJX-TeXAtom-ORD"><mi>o</mi></mrow></msub><mo stretchy="false">(</mo><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub><mo stretchy="false">)</mo><mo>=</mo><msub><mi>ϕ</mi><mrow class="MJX-TeXAtom-ORD"><mi>o</mi></mrow></msub><mo stretchy="false">(</mo><msubsup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>y</mi><mi>h</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>T</mi></mrow></msubsup><mo>⋅</mo><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub><mo>+</mo><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>y</mi></mrow></msub><mo stretchy="false">)</mo></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-2">\begin{split}
    h_{t} & = f_{h} (X_{t}, h_{t-1}) = \phi_{h}(W_{xh}^{T} \cdot X_{t} + W_{hh}^{T}\cdot h_{t-1} +b_{h})\\
    \hat{y}_{t} &= f_{o}(h_{t}) = \phi_{o}(W_{yh}^{T}\cdot h_{t} + b_{y})
\end{split}</script>

<p>where <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-199" style="width: 2.289em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.425em, 1001.83em, 2.543em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-200"><span class="msubsup" id="MathJax-Span-201"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1001.07em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-202" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.968em;"><span class="texatom" id="MathJax-Span-203"><span class="mrow" id="MathJax-Span-204"><span class="mi" id="MathJax-Span-205" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mi" id="MathJax-Span-206" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mi>h</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-3">W_{xh}</script>, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-207" style="width: 2.289em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.425em, 1001.83em, 2.543em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-208"><span class="msubsup" id="MathJax-Span-209"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1001.07em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-210" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.968em;"><span class="texatom" id="MathJax-Span-211"><span class="mrow" id="MathJax-Span-212"><span class="mi" id="MathJax-Span-213" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span class="mi" id="MathJax-Span-214" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi><mi>h</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-4">W_{hh}</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-215" style="width: 2.188em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.781em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.425em, 1001.78em, 2.696em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-216"><span class="msubsup" id="MathJax-Span-217"><span style="display: inline-block; position: relative; width: 1.781em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1001.07em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-218" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.968em;"><span class="texatom" id="MathJax-Span-219"><span class="mrow" id="MathJax-Span-220"><span class="mi" id="MathJax-Span-221" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-222" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>y</mi><mi>h</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-5">W_{yh}</script> are weight matrices for the input, reccurent connections, and the output,  respectively and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-223" style="width: 1.324em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.07em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.374em, 1001.07em, 2.594em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-224"><span class="msubsup" id="MathJax-Span-225"><span style="display: inline-block; position: relative; width: 1.07em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-226" style="font-family: MathJax_Math-italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.612em;"><span class="texatom" id="MathJax-Span-227"><span class="mrow" id="MathJax-Span-228"><span class="mi" id="MathJax-Span-229" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>ϕ</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-6">\phi_{h}</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-230" style="width: 1.273em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.019em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.374em, 1001.02em, 2.594em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-231"><span class="msubsup" id="MathJax-Span-232"><span style="display: inline-block; position: relative; width: 1.019em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-233" style="font-family: MathJax_Math-italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.612em;"><span class="texatom" id="MathJax-Span-234"><span class="mrow" id="MathJax-Span-235"><span class="mi" id="MathJax-Span-236" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>ϕ</mi><mrow class="MJX-TeXAtom-ORD"><mi>o</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-7">\phi_{o}</script> are element-wise nonlinear functions. It is usual to use a saturating nonlinear function such as logistic sigmoid function or a hyperbolic tangent function for <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-237" style="width: 1.324em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.07em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.374em, 1001.07em, 2.594em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-238"><span class="msubsup" id="MathJax-Span-239"><span style="display: inline-block; position: relative; width: 1.07em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-240" style="font-family: MathJax_Math-italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.612em;"><span class="texatom" id="MathJax-Span-241"><span class="mrow" id="MathJax-Span-242"><span class="mi" id="MathJax-Span-243" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>ϕ</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-8">\phi_{h}</script>. <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-244" style="width: 1.273em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.019em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.374em, 1001.02em, 2.594em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-245"><span class="msubsup" id="MathJax-Span-246"><span style="display: inline-block; position: relative; width: 1.019em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-247" style="font-family: MathJax_Math-italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.612em;"><span class="texatom" id="MathJax-Span-248"><span class="mrow" id="MathJax-Span-249"><span class="mi" id="MathJax-Span-250" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>ϕ</mi><mrow class="MJX-TeXAtom-ORD"><mi>o</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-9">\phi_{o}</script>  is generally softmax activation for classification problem.</p>

<p><strong>NOTE</strong>: Reusing same weight matrix every time step! <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-251" style="width: 1.324em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.07em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.425em, 1001.07em, 2.391em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-252"><span class="mi" id="MathJax-Span-253" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>W</mi></math></span></span><script type="math/tex" id="MathJax-Element-10">W</script> is shared across time - reduces the number of parameters!</p>

<p>Just like for feedforward neural networks, we can compute a recurrent layer’s output in one shot for a whole mini-batch by placing all the inputs at time step <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-254" style="width: 0.46em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.358em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.476em, 1000.31em, 2.391em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-255"><span class="mi" id="MathJax-Span-256" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-11">t</script> in an input matrix <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-257" style="width: 1.476em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.171em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.425em, 1001.17em, 2.543em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-258"><span class="msubsup" id="MathJax-Span-259"><span style="display: inline-block; position: relative; width: 1.171em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1000.87em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-260" style="font-family: MathJax_Math-italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.816em;"><span class="texatom" id="MathJax-Span-261"><span class="mrow" id="MathJax-Span-262"><span class="mi" id="MathJax-Span-263" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>X</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-12">X_{t}</script>:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-264" style="width: 20.531em; display: inline-block;"><span style="display: inline-block; position: relative; width: 16.669em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(-0.76em, 1016.41em, 4.728em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-265"><span class="mtable" id="MathJax-Span-266" style="padding-right: 0.155em; padding-left: 0.155em;"><span style="display: inline-block; position: relative; width: 16.364em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1000.92em, 8.539em, -999.997em); top: -6.044em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.92em, 4.322em, -999.997em); top: -6.044em; right: 0em;"><span class="mtd" id="MathJax-Span-267"><span class="mrow" id="MathJax-Span-268"><span class="msubsup" id="MathJax-Span-269"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-270" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-271"><span class="mrow" id="MathJax-Span-272"><span class="mi" id="MathJax-Span-273" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.864em, 1000em, 4.169em, -999.997em); top: -4.672em; right: 0em;"><span class="mtd" id="MathJax-Span-317"><span class="mrow" id="MathJax-Span-318"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.407em, 1000.82em, 4.322em, -999.997em); top: -3.351em; right: 0em;"><span class="mtd" id="MathJax-Span-352"><span class="mrow" id="MathJax-Span-353"><span class="msubsup" id="MathJax-Span-354"><span style="display: inline-block; position: relative; width: 0.816em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.46em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-355" style="font-family: MathJax_Math-italic;">o</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.511em;"><span class="texatom" id="MathJax-Span-356"><span class="mrow" id="MathJax-Span-357"><span class="mi" id="MathJax-Span-358" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1000.92em, 4.423em, -999.997em); top: -1.928em; right: 0em;"><span class="mtd" id="MathJax-Span-381"><span class="mrow" id="MathJax-Span-382"><span class="msubsup" id="MathJax-Span-383"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.51em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="texatom" id="MathJax-Span-384"><span class="mrow" id="MathJax-Span-385"><span class="munderover" id="MathJax-Span-386"><span style="display: inline-block; position: relative; width: 0.612em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.372em, -999.997em); top: -4.012em; left: 0.003em;"><span class="mi" id="MathJax-Span-387" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1000.41em, 3.661em, -999.997em); top: -4.063em; left: 0.104em;"><span class="mo" id="MathJax-Span-388" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.758em; left: 0.612em;"><span class="texatom" id="MathJax-Span-389"><span class="mrow" id="MathJax-Span-390"><span class="mi" id="MathJax-Span-391" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span><span style="display: inline-block; width: 0px; height: 6.049em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1015.35em, 8.59em, -999.997em); top: -6.095em; left: 0.917em;"><span style="display: inline-block; position: relative; width: 15.45em; height: 0px;"><span style="position: absolute; clip: rect(3.102em, 1015.35em, 4.423em, -999.997em); top: -6.044em; left: 0em;"><span class="mtd" id="MathJax-Span-274"><span class="mrow" id="MathJax-Span-275"><span class="mi" id="MathJax-Span-276"></span><span class="mo" id="MathJax-Span-277" style="font-family: MathJax_Main; padding-left: 0.257em;">=</span><span class="mi" id="MathJax-Span-278" style="font-family: MathJax_Math-italic; padding-left: 0.257em;">t</span><span class="mi" id="MathJax-Span-279" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-280" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-281" style="font-family: MathJax_Math-italic;">h</span><span class="mo" id="MathJax-Span-282" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-283"><span style="display: inline-block; position: relative; width: 1.171em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1000.87em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-284" style="font-family: MathJax_Math-italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.816em;"><span class="texatom" id="MathJax-Span-285"><span class="mrow" id="MathJax-Span-286"><span class="mi" id="MathJax-Span-287" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-288" style="font-family: MathJax_Main; padding-left: 0.206em;">⋅</span><span class="msubsup" id="MathJax-Span-289" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1001.07em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-290" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.968em;"><span class="texatom" id="MathJax-Span-291"><span class="mrow" id="MathJax-Span-292"><span class="mi" id="MathJax-Span-293" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mi" id="MathJax-Span-294" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-295" style="font-family: MathJax_Main; padding-left: 0.206em;">+</span><span class="msubsup" id="MathJax-Span-296" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-297" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-298"><span class="mrow" id="MathJax-Span-299"><span class="mi" id="MathJax-Span-300" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-301" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-302" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-303" style="font-family: MathJax_Main; padding-left: 0.206em;">⋅</span><span class="msubsup" id="MathJax-Span-304" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1001.07em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-305" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.968em;"><span class="texatom" id="MathJax-Span-306"><span class="mrow" id="MathJax-Span-307"><span class="mi" id="MathJax-Span-308" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span class="mi" id="MathJax-Span-309" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-310" style="font-family: MathJax_Main; padding-left: 0.206em;">+</span><span class="msubsup" id="MathJax-Span-311" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.41em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-312" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.409em;"><span class="texatom" id="MathJax-Span-313"><span class="mrow" id="MathJax-Span-314"><span class="mi" id="MathJax-Span-315" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-316" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.102em, 1010.42em, 4.423em, -999.997em); top: -4.672em; left: 0em;"><span class="mtd" id="MathJax-Span-319"><span class="mrow" id="MathJax-Span-320"><span class="mi" id="MathJax-Span-321"></span><span class="mo" id="MathJax-Span-322" style="font-family: MathJax_Main; padding-left: 0.257em;">=</span><span class="msubsup" id="MathJax-Span-323" style="padding-left: 0.257em;"><span style="display: inline-block; position: relative; width: 1.07em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-324" style="font-family: MathJax_Math-italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.612em;"><span class="texatom" id="MathJax-Span-325"><span class="mrow" id="MathJax-Span-326"><span class="mi" id="MathJax-Span-327" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-328" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-329" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-330"><span style="display: inline-block; position: relative; width: 1.171em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1000.87em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-331" style="font-family: MathJax_Math-italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.816em;"><span class="texatom" id="MathJax-Span-332"><span class="mrow" id="MathJax-Span-333"><span class="mi" id="MathJax-Span-334" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-335"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-336" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-337"><span class="mrow" id="MathJax-Span-338"><span class="mi" id="MathJax-Span-339" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-340" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-341" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-342" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-343" style="font-family: MathJax_Main; padding-left: 0.206em;">⋅</span><span class="mi" id="MathJax-Span-344" style="font-family: MathJax_Math-italic; padding-left: 0.206em;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span class="mo" id="MathJax-Span-345" style="font-family: MathJax_Main; padding-left: 0.206em;">+</span><span class="msubsup" id="MathJax-Span-346" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.41em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-347" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.409em;"><span class="texatom" id="MathJax-Span-348"><span class="mrow" id="MathJax-Span-349"><span class="mi" id="MathJax-Span-350" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-351" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1006.71em, 4.474em, -999.997em); top: -3.351em; left: 0em;"><span class="mtd" id="MathJax-Span-359"><span class="mrow" id="MathJax-Span-360"><span class="mi" id="MathJax-Span-361"></span><span class="mo" id="MathJax-Span-362" style="font-family: MathJax_Main; padding-left: 0.257em;">=</span><span class="msubsup" id="MathJax-Span-363" style="padding-left: 0.257em;"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-364" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-365"><span class="mrow" id="MathJax-Span-366"><span class="mi" id="MathJax-Span-367" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-368" style="font-family: MathJax_Main; padding-left: 0.206em;">⋅</span><span class="msubsup" id="MathJax-Span-369" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 1.781em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1001.07em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-370" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.968em;"><span class="texatom" id="MathJax-Span-371"><span class="mrow" id="MathJax-Span-372"><span class="mi" id="MathJax-Span-373" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-374" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-375" style="font-family: MathJax_Main; padding-left: 0.206em;">+</span><span class="msubsup" id="MathJax-Span-376" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 0.866em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.41em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-377" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.409em;"><span class="texatom" id="MathJax-Span-378"><span class="mrow" id="MathJax-Span-379"><span class="mi" id="MathJax-Span-380" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.102em, 1006.66em, 4.423em, -999.997em); top: -1.928em; left: 0em;"><span class="mtd" id="MathJax-Span-392"><span class="mrow" id="MathJax-Span-393"><span class="mi" id="MathJax-Span-394"></span><span class="mo" id="MathJax-Span-395" style="font-family: MathJax_Main; padding-left: 0.257em;">=</span><span class="mi" id="MathJax-Span-396" style="font-family: MathJax_Math-italic; padding-left: 0.257em;">s</span><span class="mi" id="MathJax-Span-397" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-398" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="mi" id="MathJax-Span-399" style="font-family: MathJax_Math-italic;">t</span><span class="mi" id="MathJax-Span-400" style="font-family: MathJax_Math-italic;">m</span><span class="mi" id="MathJax-Span-401" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-402" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-403" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-404"><span style="display: inline-block; position: relative; width: 0.816em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.46em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-405" style="font-family: MathJax_Math-italic;">o</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.511em;"><span class="texatom" id="MathJax-Span-406"><span class="mrow" id="MathJax-Span-407"><span class="mi" id="MathJax-Span-408" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-409" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span><span style="display: inline-block; width: 0px; height: 6.1em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.934em; border-left: 0px solid; width: 0px; height: 6.441em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left" rowspacing="3pt" columnspacing="0em" displaystyle="true"><mtr><mtd><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></mtd><mtd><mi></mi><mo>=</mo><mi>t</mi><mi>a</mi><mi>n</mi><mi>h</mi><mo stretchy="false">(</mo><msub><mi>X</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub><mo>⋅</mo><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mi>h</mi></mrow></msub><mo>+</mo><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>⋅</mo><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi><mi>h</mi></mrow></msub><mo>+</mo><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi></mrow></msub><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo><msub><mi>ϕ</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi></mrow></msub><mo stretchy="false">(</mo><mo stretchy="false">[</mo><msub><mi>X</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">]</mo><mo>⋅</mo><mi>W</mi><mo>+</mo><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi></mrow></msub><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><msub><mi>o</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></mtd><mtd><mi></mi><mo>=</mo><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub><mo>⋅</mo><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>y</mi><mi>h</mi></mrow></msub><mo>+</mo><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>y</mi></mrow></msub></mtd></mtr><mtr><mtd><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></mtd><mtd><mi></mi><mo>=</mo><mi>s</mi><mi>o</mi><mi>f</mi><mi>t</mi><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy="false">(</mo><msub><mi>o</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub><mo stretchy="false">)</mo></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-13">\begin{split}
    h_{t} & = tanh(X_{t}\cdot W_{xh} + h_{t-1}\cdot  W_{hh} + b_{h})\\
    &= \phi_{h}( [X_{t} h_{t-1}] \cdot W + b_{h})\\
    o_{t} &= h_{t}\cdot W_{yh} + b_{y}\\
    \hat{y}_{t} &= softmax(o_{t})
\end{split}</script>

<ol>
  <li>The weight matrices <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-410" style="width: 2.289em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.425em, 1001.83em, 2.543em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-411"><span class="msubsup" id="MathJax-Span-412"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1001.07em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-413" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.968em;"><span class="texatom" id="MathJax-Span-414"><span class="mrow" id="MathJax-Span-415"><span class="mi" id="MathJax-Span-416" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mi" id="MathJax-Span-417" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mi>h</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-14">W_{xh}</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-15-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-418" style="width: 2.188em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.781em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.425em, 1001.78em, 2.696em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-419"><span class="msubsup" id="MathJax-Span-420"><span style="display: inline-block; position: relative; width: 1.781em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1001.07em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-421" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.968em;"><span class="texatom" id="MathJax-Span-422"><span class="mrow" id="MathJax-Span-423"><span class="mi" id="MathJax-Span-424" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-425" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>y</mi><mi>h</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-15">W_{yh}</script> are often concatenated vertically into a single weight matrix <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-426" style="width: 1.324em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.07em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.425em, 1001.07em, 2.391em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-427"><span class="mi" id="MathJax-Span-428" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>W</mi></math></span></span><script type="math/tex" id="MathJax-Element-16">W</script> of shape <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-429" style="width: 15.196em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.35em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.324em, 1012.35em, 2.696em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-430"><span class="mo" id="MathJax-Span-431" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-432"><span style="display: inline-block; position: relative; width: 2.696em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-433" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.612em;"><span class="texatom" id="MathJax-Span-434"><span class="mrow" id="MathJax-Span-435"><span class="mi" id="MathJax-Span-436" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-437" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-438" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span class="mi" id="MathJax-Span-439" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-440" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mi" id="MathJax-Span-441" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-442" style="font-family: MathJax_Main; padding-left: 0.206em;">+</span><span class="msubsup" id="MathJax-Span-443" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 3.255em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-444" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.612em;"><span class="texatom" id="MathJax-Span-445"><span class="mrow" id="MathJax-Span-446"><span class="mi" id="MathJax-Span-447" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-448" style="font-size: 70.7%; font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-449" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-450" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span><span class="mi" id="MathJax-Span-451" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-452" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-453" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-454" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-455" style="font-family: MathJax_Main; padding-left: 0.206em;">×</span><span class="msubsup" id="MathJax-Span-456" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 3.255em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-457" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.612em;"><span class="texatom" id="MathJax-Span-458"><span class="mrow" id="MathJax-Span-459"><span class="mi" id="MathJax-Span-460" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-461" style="font-size: 70.7%; font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-462" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-463" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span><span class="mi" id="MathJax-Span-464" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-465" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-466" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>n</mi><mi>p</mi><mi>u</mi><mi>t</mi><mi>s</mi></mrow></msub><mo>+</mo><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mi>e</mi><mi>u</mi><mi>r</mi><mi>o</mi><mi>n</mi><mi>s</mi></mrow></msub><mo stretchy="false">)</mo><mo>×</mo><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mi>e</mi><mi>u</mi><mi>r</mi><mi>o</mi><mi>n</mi><mi>s</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-17">(n_{inputs} +  n_{neurons}) \times  n_{neurons}</script>.</li>
  <li>The notation <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-18-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-467" style="width: 4.372em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.559em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.324em, 1003.46em, 2.645em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-468"><span class="mo" id="MathJax-Span-469" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-470"><span style="display: inline-block; position: relative; width: 1.171em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1000.87em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-471" style="font-family: MathJax_Math-italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.816em;"><span class="texatom" id="MathJax-Span-472"><span class="mrow" id="MathJax-Span-473"><span class="mi" id="MathJax-Span-474" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-475"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-476" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-477"><span class="mrow" id="MathJax-Span-478"><span class="mi" id="MathJax-Span-479" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-480" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-481" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-482" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><msub><mi>X</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-18">[X_{t} h_{t-1}]</script> represents the horizontal concatenation of the matrices <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-19-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-483" style="width: 1.476em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.171em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.425em, 1001.17em, 2.543em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-484"><span class="msubsup" id="MathJax-Span-485"><span style="display: inline-block; position: relative; width: 1.171em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1000.87em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-486" style="font-family: MathJax_Math-italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.816em;"><span class="texatom" id="MathJax-Span-487"><span class="mrow" id="MathJax-Span-488"><span class="mi" id="MathJax-Span-489" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>X</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-19">X_{t}</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-20-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-490" style="width: 2.289em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.374em, 1001.83em, 2.594em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-491"><span class="msubsup" id="MathJax-Span-492"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-493" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-494"><span class="mrow" id="MathJax-Span-495"><span class="mi" id="MathJax-Span-496" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-497" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-498" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-20">h_{t-1}</script>, shape of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-21-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-499" style="width: 12.35em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.013em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.324em, 1009.91em, 2.696em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-500"><span class="mi" id="MathJax-Span-501" style="font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-502" style="font-family: MathJax_Main; padding-left: 0.206em;">×</span><span class="mo" id="MathJax-Span-503" style="font-family: MathJax_Main; padding-left: 0.206em;">(</span><span class="msubsup" id="MathJax-Span-504"><span style="display: inline-block; position: relative; width: 2.696em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-505" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.612em;"><span class="texatom" id="MathJax-Span-506"><span class="mrow" id="MathJax-Span-507"><span class="mi" id="MathJax-Span-508" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-509" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-510" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span class="mi" id="MathJax-Span-511" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-512" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mi" id="MathJax-Span-513" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-514" style="font-family: MathJax_Main; padding-left: 0.206em;">+</span><span class="msubsup" id="MathJax-Span-515" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 3.255em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-516" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.612em;"><span class="texatom" id="MathJax-Span-517"><span class="mrow" id="MathJax-Span-518"><span class="mi" id="MathJax-Span-519" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-520" style="font-size: 70.7%; font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-521" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-522" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span><span class="mi" id="MathJax-Span-523" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-524" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-525" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-526" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi><mo>×</mo><mo stretchy="false">(</mo><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>n</mi><mi>p</mi><mi>u</mi><mi>t</mi><mi>s</mi></mrow></msub><mo>+</mo><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mi>e</mi><mi>u</mi><mi>r</mi><mi>o</mi><mi>n</mi><mi>s</mi></mrow></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-21">m \times (n_{inputs} + n_{neurons})</script></li>
</ol>

<p>Let’s denote <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-22-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-527" style="width: 1.07em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.866em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.629em, 1000.87em, 2.391em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-528"><span class="mi" id="MathJax-Span-529" style="font-family: MathJax_Math-italic;">m</span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi></math></span></span><script type="math/tex" id="MathJax-Element-22">m</script> as the number of instances in the mini-batch, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-23-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-530" style="width: 4.017em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.255em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.629em, 1003.25em, 2.543em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-531"><span class="msubsup" id="MathJax-Span-532"><span style="display: inline-block; position: relative; width: 3.255em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-533" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.612em;"><span class="texatom" id="MathJax-Span-534"><span class="mrow" id="MathJax-Span-535"><span class="mi" id="MathJax-Span-536" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-537" style="font-size: 70.7%; font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-538" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-539" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span><span class="mi" id="MathJax-Span-540" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-541" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-542" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mi>e</mi><mi>u</mi><mi>r</mi><mi>o</mi><mi>n</mi><mi>s</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-23">n_{neurons}</script> as the number of neurons, and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-24-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-543" style="width: 3.305em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.696em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.629em, 1002.7em, 2.696em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-544"><span class="msubsup" id="MathJax-Span-545"><span style="display: inline-block; position: relative; width: 2.696em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-546" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.612em;"><span class="texatom" id="MathJax-Span-547"><span class="mrow" id="MathJax-Span-548"><span class="mi" id="MathJax-Span-549" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-550" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-551" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span class="mi" id="MathJax-Span-552" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-553" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mi" id="MathJax-Span-554" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>n</mi><mi>p</mi><mi>u</mi><mi>t</mi><mi>s</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-24">n_{inputs}</script> as the number of input features.</p>

<ol>
  <li><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-25-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-555" style="width: 1.476em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.171em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.425em, 1001.17em, 2.543em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-556"><span class="msubsup" id="MathJax-Span-557"><span style="display: inline-block; position: relative; width: 1.171em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1000.87em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-558" style="font-family: MathJax_Math-italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.816em;"><span class="texatom" id="MathJax-Span-559"><span class="mrow" id="MathJax-Span-560"><span class="mi" id="MathJax-Span-561" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>X</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-25">X_{t}</script> is an <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-26-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-562" style="width: 5.897em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.779em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.578em, 1004.78em, 2.696em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-563"><span class="mi" id="MathJax-Span-564" style="font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-565" style="font-family: MathJax_Main; padding-left: 0.206em;">×</span><span class="msubsup" id="MathJax-Span-566" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 2.696em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-567" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.612em;"><span class="texatom" id="MathJax-Span-568"><span class="mrow" id="MathJax-Span-569"><span class="mi" id="MathJax-Span-570" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-571" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-572" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span class="mi" id="MathJax-Span-573" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-574" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mi" id="MathJax-Span-575" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi><mo>×</mo><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>n</mi><mi>p</mi><mi>u</mi><mi>t</mi><mi>s</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-26">m \times n_{inputs}</script> matrix containing the inputs for all instances.</li>
  <li><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-27-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-576" style="width: 2.289em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.374em, 1001.83em, 2.594em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-577"><span class="msubsup" id="MathJax-Span-578"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-579" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-580"><span class="mrow" id="MathJax-Span-581"><span class="mi" id="MathJax-Span-582" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-583" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-584" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-27">h_{t-1}</script> is an <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-28-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-585" style="width: 6.557em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.338em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.578em, 1005.34em, 2.543em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-586"><span class="mi" id="MathJax-Span-587" style="font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-588" style="font-family: MathJax_Main; padding-left: 0.206em;">×</span><span class="msubsup" id="MathJax-Span-589" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 3.255em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-590" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.612em;"><span class="texatom" id="MathJax-Span-591"><span class="mrow" id="MathJax-Span-592"><span class="mi" id="MathJax-Span-593" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-594" style="font-size: 70.7%; font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-595" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-596" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span><span class="mi" id="MathJax-Span-597" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-598" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-599" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi><mo>×</mo><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mi>e</mi><mi>u</mi><mi>r</mi><mi>o</mi><mi>n</mi><mi>s</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-28">m \times n_{neurons}</script> matrix containing the hidden state of the previous time-step for all instances.</li>
  <li><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-29-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-600" style="width: 2.289em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.425em, 1001.83em, 2.543em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-601"><span class="msubsup" id="MathJax-Span-602"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1001.07em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-603" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.968em;"><span class="texatom" id="MathJax-Span-604"><span class="mrow" id="MathJax-Span-605"><span class="mi" id="MathJax-Span-606" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mi" id="MathJax-Span-607" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mi>h</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-29">W_{xh}</script> is an <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-30-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-608" style="width: 8.844em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.167em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.578em, 1007.17em, 2.696em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-609"><span class="msubsup" id="MathJax-Span-610"><span style="display: inline-block; position: relative; width: 2.696em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-611" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.612em;"><span class="texatom" id="MathJax-Span-612"><span class="mrow" id="MathJax-Span-613"><span class="mi" id="MathJax-Span-614" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-615" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-616" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span class="mi" id="MathJax-Span-617" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-618" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mi" id="MathJax-Span-619" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-620" style="font-family: MathJax_Main; padding-left: 0.206em;">×</span><span class="msubsup" id="MathJax-Span-621" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 3.255em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-622" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.612em;"><span class="texatom" id="MathJax-Span-623"><span class="mrow" id="MathJax-Span-624"><span class="mi" id="MathJax-Span-625" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-626" style="font-size: 70.7%; font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-627" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-628" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span><span class="mi" id="MathJax-Span-629" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-630" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-631" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>n</mi><mi>p</mi><mi>u</mi><mi>t</mi><mi>s</mi></mrow></msub><mo>×</mo><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mi>e</mi><mi>u</mi><mi>r</mi><mi>o</mi><mi>n</mi><mi>s</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-30">n_{inputs} \times n_{neurons}</script> matrix containing the connection weights between input and the hidden layer.</li>
  <li><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-31-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-632" style="width: 2.289em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.425em, 1001.83em, 2.543em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-633"><span class="msubsup" id="MathJax-Span-634"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1001.07em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-635" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.968em;"><span class="texatom" id="MathJax-Span-636"><span class="mrow" id="MathJax-Span-637"><span class="mi" id="MathJax-Span-638" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span class="mi" id="MathJax-Span-639" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi><mi>h</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-31">W_{hh}</script> is an <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-32-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-640" style="width: 9.505em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.726em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.578em, 1007.73em, 2.543em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-641"><span class="msubsup" id="MathJax-Span-642"><span style="display: inline-block; position: relative; width: 3.255em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-643" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.612em;"><span class="texatom" id="MathJax-Span-644"><span class="mrow" id="MathJax-Span-645"><span class="mi" id="MathJax-Span-646" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-647" style="font-size: 70.7%; font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-648" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-649" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span><span class="mi" id="MathJax-Span-650" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-651" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-652" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-653" style="font-family: MathJax_Main; padding-left: 0.206em;">×</span><span class="msubsup" id="MathJax-Span-654" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 3.255em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-655" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.612em;"><span class="texatom" id="MathJax-Span-656"><span class="mrow" id="MathJax-Span-657"><span class="mi" id="MathJax-Span-658" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-659" style="font-size: 70.7%; font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-660" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-661" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span><span class="mi" id="MathJax-Span-662" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-663" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-664" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mi>e</mi><mi>u</mi><mi>r</mi><mi>o</mi><mi>n</mi><mi>s</mi></mrow></msub><mo>×</mo><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mi>e</mi><mi>u</mi><mi>r</mi><mi>o</mi><mi>n</mi><mi>s</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-32">n_{neurons} \times n_{neurons}</script> matrix containing the connection weights between two hidden layers.</li>
  <li><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-33-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-665" style="width: 2.188em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.781em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.425em, 1001.78em, 2.696em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-666"><span class="msubsup" id="MathJax-Span-667"><span style="display: inline-block; position: relative; width: 1.781em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1001.07em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-668" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.968em;"><span class="texatom" id="MathJax-Span-669"><span class="mrow" id="MathJax-Span-670"><span class="mi" id="MathJax-Span-671" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-672" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>y</mi><mi>h</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-33">W_{yh}</script> is an <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-34-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-673" style="width: 9.505em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.726em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.578em, 1007.73em, 2.543em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-674"><span class="msubsup" id="MathJax-Span-675"><span style="display: inline-block; position: relative; width: 3.255em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-676" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.612em;"><span class="texatom" id="MathJax-Span-677"><span class="mrow" id="MathJax-Span-678"><span class="mi" id="MathJax-Span-679" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-680" style="font-size: 70.7%; font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-681" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-682" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span><span class="mi" id="MathJax-Span-683" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-684" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-685" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-686" style="font-family: MathJax_Main; padding-left: 0.206em;">×</span><span class="msubsup" id="MathJax-Span-687" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 3.255em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-688" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.612em;"><span class="texatom" id="MathJax-Span-689"><span class="mrow" id="MathJax-Span-690"><span class="mi" id="MathJax-Span-691" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-692" style="font-size: 70.7%; font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-693" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-694" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span><span class="mi" id="MathJax-Span-695" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-696" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-697" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mi>e</mi><mi>u</mi><mi>r</mi><mi>o</mi><mi>n</mi><mi>s</mi></mrow></msub><mo>×</mo><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mi>e</mi><mi>u</mi><mi>r</mi><mi>o</mi><mi>n</mi><mi>s</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-34">n_{neurons} \times n_{neurons}</script> matrix containing the connection weights between the hidden layer and the output.</li>
  <li><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-35-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-698" style="width: 1.12em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.374em, 1000.92em, 2.543em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-699"><span class="msubsup" id="MathJax-Span-700"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.41em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-701" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.409em;"><span class="texatom" id="MathJax-Span-702"><span class="mrow" id="MathJax-Span-703"><span class="mi" id="MathJax-Span-704" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-35">b_{h}</script> is a vector of size <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-36-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-705" style="width: 4.017em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.255em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.629em, 1003.25em, 2.543em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-706"><span class="msubsup" id="MathJax-Span-707"><span style="display: inline-block; position: relative; width: 3.255em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-708" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.612em;"><span class="texatom" id="MathJax-Span-709"><span class="mrow" id="MathJax-Span-710"><span class="mi" id="MathJax-Span-711" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-712" style="font-size: 70.7%; font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-713" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-714" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span><span class="mi" id="MathJax-Span-715" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-716" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-717" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mi>e</mi><mi>u</mi><mi>r</mi><mi>o</mi><mi>n</mi><mi>s</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-36">n_{neurons}</script> containing each neuron’s bias term.</li>
  <li><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-37-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-718" style="width: 1.07em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.866em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.374em, 1000.87em, 2.696em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-719"><span class="msubsup" id="MathJax-Span-720"><span style="display: inline-block; position: relative; width: 0.866em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.41em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-721" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.409em;"><span class="texatom" id="MathJax-Span-722"><span class="mrow" id="MathJax-Span-723"><span class="mi" id="MathJax-Span-724" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>y</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-37">b_{y}</script> is a vector of size <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-38-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-725" style="width: 4.017em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.255em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.629em, 1003.25em, 2.543em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-726"><span class="msubsup" id="MathJax-Span-727"><span style="display: inline-block; position: relative; width: 3.255em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-728" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.612em;"><span class="texatom" id="MathJax-Span-729"><span class="mrow" id="MathJax-Span-730"><span class="mi" id="MathJax-Span-731" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-732" style="font-size: 70.7%; font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-733" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-734" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span><span class="mi" id="MathJax-Span-735" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-736" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-737" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mi>e</mi><mi>u</mi><mi>r</mi><mi>o</mi><mi>n</mi><mi>s</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-38">n_{neurons}</script> containing each output’s bias term.</li>
  <li><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-39-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-738" style="width: 1.019em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.816em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.629em, 1000.82em, 2.594em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-739"><span class="msubsup" id="MathJax-Span-740"><span style="display: inline-block; position: relative; width: 0.816em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-741" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.511em;"><span class="texatom" id="MathJax-Span-742"><span class="mrow" id="MathJax-Span-743"><span class="mi" id="MathJax-Span-744" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-39">y_{t}</script> is an <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-40-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-745" style="width: 6.557em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.338em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.578em, 1005.34em, 2.543em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-746"><span class="mi" id="MathJax-Span-747" style="font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-748" style="font-family: MathJax_Main; padding-left: 0.206em;">×</span><span class="msubsup" id="MathJax-Span-749" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 3.255em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-750" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.612em;"><span class="texatom" id="MathJax-Span-751"><span class="mrow" id="MathJax-Span-752"><span class="mi" id="MathJax-Span-753" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-754" style="font-size: 70.7%; font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-755" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-756" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span><span class="mi" id="MathJax-Span-757" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-758" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-759" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi><mo>×</mo><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mi>e</mi><mi>u</mi><mi>r</mi><mi>o</mi><mi>n</mi><mi>s</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-40">m \times n_{neurons}</script> matrix containing the layer’s outputs at time step <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-41-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-760" style="width: 0.46em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.358em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.476em, 1000.31em, 2.391em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-761"><span class="mi" id="MathJax-Span-762" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-41">t</script> for each instance in the mini-batch</li>
</ol>

<p><strong>NOTE:</strong> At the first time step, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-42-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-763" style="width: 2.645em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.137em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.425em, 1002.09em, 2.391em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-764"><span class="mi" id="MathJax-Span-765" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-766" style="font-family: MathJax_Main; padding-left: 0.257em;">=</span><span class="mn" id="MathJax-Span-767" style="font-family: MathJax_Main; padding-left: 0.257em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mo>=</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-42">t = 0</script>, there are no previous outputs, so they are typically assumed to be all zeros.</p>

<h1 id="backpropagation-through-time">Backpropagation Through Time</h1>
<p>In order to do backpropagation through time to train an RNN, we need to compute the loss function first:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-43-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-768" style="width: 18.905em; display: inline-block;"><span style="display: inline-block; position: relative; width: 15.348em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(-2.843em, 1015.09em, 6.811em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-769"><span class="mtable" id="MathJax-Span-770" style="padding-right: 0.155em; padding-left: 0.155em;"><span style="display: inline-block; position: relative; width: 15.043em; height: 0px;"><span style="position: absolute; clip: rect(4.068em, 1002.9em, 11.537em, -999.997em); top: -8.178em; left: 0em;"><span style="display: inline-block; position: relative; width: 2.95em; height: 0px;"><span style="position: absolute; clip: rect(3.102em, 1002.9em, 4.423em, -999.997em); top: -7.213em; right: 0em;"><span class="mtd" id="MathJax-Span-771"><span class="mrow" id="MathJax-Span-772"><span class="mi" id="MathJax-Span-773" style="font-family: MathJax_Math-italic;">L</span><span class="mo" id="MathJax-Span-774" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-775"><span class="mrow" id="MathJax-Span-776"><span class="munderover" id="MathJax-Span-777"><span style="display: inline-block; position: relative; width: 0.612em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.372em, -999.997em); top: -4.012em; left: 0.003em;"><span class="mi" id="MathJax-Span-778" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1000.41em, 3.661em, -999.997em); top: -4.063em; left: 0.104em;"><span class="mo" id="MathJax-Span-779" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-780" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-781" style="font-family: MathJax_Math-italic; padding-left: 0.155em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-782" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.864em, 1000em, 4.169em, -999.997em); top: -3.961em; right: 0em;"><span class="mtd" id="MathJax-Span-819"><span class="mrow" id="MathJax-Span-820"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.864em, 1000em, 4.169em, -999.997em); top: -0.81em; right: 0em;"><span class="mtd" id="MathJax-Span-850"><span class="mrow" id="MathJax-Span-851"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span><span style="display: inline-block; width: 0px; height: 8.183em;"></span></span><span style="position: absolute; clip: rect(5.287em, 1011.94em, 14.942em, -999.997em); top: -10.363em; left: 2.95em;"><span style="display: inline-block; position: relative; width: 12.045em; height: 0px;"><span style="position: absolute; clip: rect(2.137em, 1006.76em, 5.389em, -999.997em); top: -7.213em; left: 0em;"><span class="mtd" id="MathJax-Span-783"><span class="mrow" id="MathJax-Span-784"><span class="mi" id="MathJax-Span-785"></span><span class="mo" id="MathJax-Span-786" style="font-family: MathJax_Main; padding-left: 0.257em;">=</span><span class="munderover" id="MathJax-Span-787" style="padding-left: 0.257em;"><span style="display: inline-block; position: relative; width: 1.425em; height: 0px;"><span style="position: absolute; clip: rect(2.899em, 1001.37em, 4.627em, -999.997em); top: -4.012em; left: 0em;"><span class="mo" id="MathJax-Span-788" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.407em, 1001.12em, 4.271em, -999.997em); top: -2.945em; left: 0.155em;"><span class="texatom" id="MathJax-Span-789"><span class="mrow" id="MathJax-Span-790"><span class="mi" id="MathJax-Span-791" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-792" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-793" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.305em, 1000.51em, 4.169em, -999.997em); top: -5.18em; left: 0.46em;"><span class="texatom" id="MathJax-Span-794"><span class="mrow" id="MathJax-Span-795"><span class="mi" id="MathJax-Span-796" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-797" style="padding-left: 0.155em;"><span style="display: inline-block; position: relative; width: 1.019em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1000.66em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-798" style="font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.663em;"><span class="texatom" id="MathJax-Span-799"><span class="mrow" id="MathJax-Span-800"><span class="mi" id="MathJax-Span-801" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-802" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-803"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.51em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="texatom" id="MathJax-Span-804"><span class="mrow" id="MathJax-Span-805"><span class="munderover" id="MathJax-Span-806"><span style="display: inline-block; position: relative; width: 0.612em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.372em, -999.997em); top: -4.012em; left: 0.003em;"><span class="mi" id="MathJax-Span-807" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1000.41em, 3.661em, -999.997em); top: -4.063em; left: 0.104em;"><span class="mo" id="MathJax-Span-808" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.758em; left: 0.612em;"><span class="texatom" id="MathJax-Span-809"><span class="mrow" id="MathJax-Span-810"><span class="mi" id="MathJax-Span-811" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-812" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-813" style="padding-left: 0.155em;"><span style="display: inline-block; position: relative; width: 0.816em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-814" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.511em;"><span class="texatom" id="MathJax-Span-815"><span class="mrow" id="MathJax-Span-816"><span class="mi" id="MathJax-Span-817" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-818" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(2.137em, 1007.17em, 5.338em, -999.997em); top: -3.961em; left: 0em;"><span class="mtd" id="MathJax-Span-821"><span class="mrow" id="MathJax-Span-822"><span class="mi" id="MathJax-Span-823"></span><span class="mo" id="MathJax-Span-824" style="font-family: MathJax_Main; padding-left: 0.257em;">=</span><span class="mo" id="MathJax-Span-825" style="font-family: MathJax_Main; padding-left: 0.257em;">−</span><span class="munderover" id="MathJax-Span-826" style="padding-left: 0.155em;"><span style="display: inline-block; position: relative; width: 1.425em; height: 0px;"><span style="position: absolute; clip: rect(2.899em, 1001.37em, 4.627em, -999.997em); top: -4.012em; left: 0em;"><span class="mo" id="MathJax-Span-827" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.407em, 1000.26em, 4.271em, -999.997em); top: -2.945em; left: 0.612em;"><span class="texatom" id="MathJax-Span-828"><span class="mrow" id="MathJax-Span-829"><span class="mi" id="MathJax-Span-830" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.305em, 1000.51em, 4.169em, -999.997em); top: -5.18em; left: 0.46em;"><span class="texatom" id="MathJax-Span-831"><span class="mrow" id="MathJax-Span-832"><span class="mi" id="MathJax-Span-833" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-834" style="padding-left: 0.155em;"><span style="display: inline-block; position: relative; width: 0.816em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-835" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.511em;"><span class="texatom" id="MathJax-Span-836"><span class="mrow" id="MathJax-Span-837"><span class="mi" id="MathJax-Span-838" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mi" id="MathJax-Span-839" style="font-family: MathJax_Main; padding-left: 0.155em;">log</span><span class="mo" id="MathJax-Span-840"></span><span class="msubsup" id="MathJax-Span-841" style="padding-left: 0.155em;"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.51em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="texatom" id="MathJax-Span-842"><span class="mrow" id="MathJax-Span-843"><span class="munderover" id="MathJax-Span-844"><span style="display: inline-block; position: relative; width: 0.612em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.372em, -999.997em); top: -4.012em; left: 0.003em;"><span class="mi" id="MathJax-Span-845" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1000.41em, 3.661em, -999.997em); top: -4.063em; left: 0.104em;"><span class="mo" id="MathJax-Span-846" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.758em; left: 0.612em;"><span class="texatom" id="MathJax-Span-847"><span class="mrow" id="MathJax-Span-848"><span class="mi" id="MathJax-Span-849" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(2.137em, 1011.94em, 5.389em, -999.997em); top: -0.81em; left: 0em;"><span class="mtd" id="MathJax-Span-852"><span class="mrow" id="MathJax-Span-853"><span class="mi" id="MathJax-Span-854"></span><span class="mo" id="MathJax-Span-855" style="font-family: MathJax_Main; padding-left: 0.257em;">=</span><span class="mo" id="MathJax-Span-856" style="font-family: MathJax_Main; padding-left: 0.257em;">−</span><span class="munderover" id="MathJax-Span-857" style="padding-left: 0.155em;"><span style="display: inline-block; position: relative; width: 1.425em; height: 0px;"><span style="position: absolute; clip: rect(2.899em, 1001.37em, 4.627em, -999.997em); top: -4.012em; left: 0em;"><span class="mo" id="MathJax-Span-858" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.407em, 1001.12em, 4.271em, -999.997em); top: -2.945em; left: 0.155em;"><span class="texatom" id="MathJax-Span-859"><span class="mrow" id="MathJax-Span-860"><span class="mi" id="MathJax-Span-861" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-862" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-863" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.305em, 1000.51em, 4.169em, -999.997em); top: -5.18em; left: 0.46em;"><span class="texatom" id="MathJax-Span-864"><span class="mrow" id="MathJax-Span-865"><span class="mi" id="MathJax-Span-866" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-867" style="padding-left: 0.155em;"><span style="display: inline-block; position: relative; width: 0.816em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-868" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.511em;"><span class="texatom" id="MathJax-Span-869"><span class="mrow" id="MathJax-Span-870"><span class="mi" id="MathJax-Span-871" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mi" id="MathJax-Span-872" style="font-family: MathJax_Math-italic;">l</span><span class="mi" id="MathJax-Span-873" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-874" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mrow" id="MathJax-Span-875" style="padding-left: 0.155em;"><span class="mo" id="MathJax-Span-876" style="font-family: MathJax_Main;">[</span><span class="mrow" id="MathJax-Span-877"><span class="mi" id="MathJax-Span-878" style="font-family: MathJax_Math-italic;">s</span><span class="mi" id="MathJax-Span-879" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-880" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="mi" id="MathJax-Span-881" style="font-family: MathJax_Math-italic;">t</span><span class="mi" id="MathJax-Span-882" style="font-family: MathJax_Math-italic;">m</span><span class="mi" id="MathJax-Span-883" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-884" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-885" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-886"><span style="display: inline-block; position: relative; width: 0.816em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.46em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-887" style="font-family: MathJax_Math-italic;">o</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.511em;"><span class="texatom" id="MathJax-Span-888"><span class="mrow" id="MathJax-Span-889"><span class="mi" id="MathJax-Span-890" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-891" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-892" style="font-family: MathJax_Main;">]</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span><span style="display: inline-block; width: 0px; height: 10.368em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -5.497em; border-left: 0px solid; width: 0px; height: 11.628em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left" rowspacing="3pt" columnspacing="0em" displaystyle="true"><mtr><mtd><mi>L</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mtd><mtd><mi></mi><mo>=</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>T</mi></mrow></munderover><msub><mi>L</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub><mo stretchy="false">(</mo><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub><mo>,</mo><msub><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo><mo>−</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>T</mi></mrow></munderover><msub><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub><mi>log</mi><mo>⁡</mo><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo><mo>−</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>T</mi></mrow></munderover><msub><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub><mi>l</mi><mi>o</mi><mi>g</mi><mrow><mo>[</mo><mrow><mi>s</mi><mi>o</mi><mi>f</mi><mi>t</mi><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy="false">(</mo><msub><mi>o</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub><mo stretchy="false">)</mo></mrow><mo>]</mo></mrow></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-43">\begin{split}
L (\hat{y}, y) & = \sum_{t = 1}^{T} L_{t}(\hat{y}_{t}, y_{t}) \\
& = - \sum_{t}^{T} y_{t} \log \hat{y}_{t} \\
& = -\sum_{t = 1}^{T}y_{t} log \left[softmax(o_{t}) \right]
\end{split}</script>

<p>Note that the weight <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-44-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-893" style="width: 2.188em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.781em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.425em, 1001.78em, 2.696em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-894"><span class="msubsup" id="MathJax-Span-895"><span style="display: inline-block; position: relative; width: 1.781em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1001.07em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-896" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.968em;"><span class="texatom" id="MathJax-Span-897"><span class="mrow" id="MathJax-Span-898"><span class="mi" id="MathJax-Span-899" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-900" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>y</mi><mi>h</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-44">W_{yh}</script> is shared across all the time sequence. Therefore, we can differentiate to it at the each time step and sum all together:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-45-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2297;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-901" style="width: 15.246em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.401em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(-2.792em, 1012.25em, 6.761em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-902"><span class="mtable" id="MathJax-Span-903" style="padding-right: 0.155em; padding-left: 0.155em;"><span style="display: inline-block; position: relative; width: 12.096em; height: 0px;"><span style="position: absolute; clip: rect(4.068em, 1002.7em, 12.147em, -999.997em); top: -8.788em; left: 0em;"><span style="display: inline-block; position: relative; width: 2.696em; height: 0px;"><span style="position: absolute; clip: rect(2.492em, 1002.7em, 5.135em, -999.997em); top: -7.162em; right: 0em;"><span class="mtd" id="MathJax-Span-904"><span class="mrow" id="MathJax-Span-905"><span class="mfrac" id="MathJax-Span-906"><span style="display: inline-block; position: relative; width: 2.442em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1001.22em, 4.169em, -999.997em); top: -4.672em; left: 50%; margin-left: -0.607em;"><span class="mrow" id="MathJax-Span-907"><span class="mi" id="MathJax-Span-908" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="mi" id="MathJax-Span-909" style="font-family: MathJax_Math-italic;">L</span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1002.34em, 4.474em, -999.997em); top: -3.351em; left: 50%; margin-left: -1.166em;"><span class="mrow" id="MathJax-Span-910"><span class="mi" id="MathJax-Span-911" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-912"><span style="display: inline-block; position: relative; width: 1.781em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1001.07em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-913" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.968em;"><span class="texatom" id="MathJax-Span-914"><span class="mrow" id="MathJax-Span-915"><span class="mi" id="MathJax-Span-916" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-917" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.44em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.442em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.864em, 1000em, 4.169em, -999.997em); top: -3.961em; right: 0em;"><span class="mtd" id="MathJax-Span-946"><span class="mrow" id="MathJax-Span-947"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.864em, 1000em, 4.169em, -999.997em); top: -0.81em; right: 0em;"><span class="mtd" id="MathJax-Span-1014"><span class="mrow" id="MathJax-Span-1015"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span><span style="display: inline-block; width: 0px; height: 8.793em;"></span></span><span style="position: absolute; clip: rect(5.236em, 1009.35em, 14.789em, -999.997em); top: -10.262em; left: 2.696em;"><span style="display: inline-block; position: relative; width: 9.352em; height: 0px;"><span style="position: absolute; clip: rect(2.137em, 1005.59em, 5.338em, -999.997em); top: -7.162em; left: 0em;"><span class="mtd" id="MathJax-Span-918"><span class="mrow" id="MathJax-Span-919"><span class="mi" id="MathJax-Span-920"></span><span class="mo" id="MathJax-Span-921" style="font-family: MathJax_Main; padding-left: 0.257em;">=</span><span class="munderover" id="MathJax-Span-922" style="padding-left: 0.257em;"><span style="display: inline-block; position: relative; width: 1.425em; height: 0px;"><span style="position: absolute; clip: rect(2.899em, 1001.37em, 4.627em, -999.997em); top: -4.012em; left: 0em;"><span class="mo" id="MathJax-Span-923" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.407em, 1000.26em, 4.271em, -999.997em); top: -2.945em; left: 0.612em;"><span class="texatom" id="MathJax-Span-924"><span class="mrow" id="MathJax-Span-925"><span class="mi" id="MathJax-Span-926" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.305em, 1000.51em, 4.169em, -999.997em); top: -5.18em; left: 0.46em;"><span class="texatom" id="MathJax-Span-927"><span class="mrow" id="MathJax-Span-928"><span class="mi" id="MathJax-Span-929" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-930" style="padding-left: 0.155em;"><span style="display: inline-block; position: relative; width: 2.442em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1001.58em, 4.322em, -999.997em); top: -4.672em; left: 50%; margin-left: -0.81em;"><span class="mrow" id="MathJax-Span-931"><span class="mi" id="MathJax-Span-932" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-933"><span style="display: inline-block; position: relative; width: 1.019em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1000.66em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-934" style="font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.663em;"><span class="texatom" id="MathJax-Span-935"><span class="mrow" id="MathJax-Span-936"><span class="mi" id="MathJax-Span-937" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1002.34em, 4.474em, -999.997em); top: -3.351em; left: 50%; margin-left: -1.166em;"><span class="mrow" id="MathJax-Span-938"><span class="mi" id="MathJax-Span-939" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-940"><span style="display: inline-block; position: relative; width: 1.781em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1001.07em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-941" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.968em;"><span class="texatom" id="MathJax-Span-942"><span class="mrow" id="MathJax-Span-943"><span class="mi" id="MathJax-Span-944" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-945" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.44em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.442em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(2.137em, 1009.35em, 5.338em, -999.997em); top: -3.961em; left: 0em;"><span class="mtd" id="MathJax-Span-948"><span class="mrow" id="MathJax-Span-949"><span class="mi" id="MathJax-Span-950"></span><span class="mo" id="MathJax-Span-951" style="font-family: MathJax_Main; padding-left: 0.257em;">=</span><span class="munderover" id="MathJax-Span-952" style="padding-left: 0.257em;"><span style="display: inline-block; position: relative; width: 1.425em; height: 0px;"><span style="position: absolute; clip: rect(2.899em, 1001.37em, 4.627em, -999.997em); top: -4.012em; left: 0em;"><span class="mo" id="MathJax-Span-953" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.407em, 1000.26em, 4.271em, -999.997em); top: -2.945em; left: 0.612em;"><span class="texatom" id="MathJax-Span-954"><span class="mrow" id="MathJax-Span-955"><span class="mi" id="MathJax-Span-956" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.305em, 1000.51em, 4.169em, -999.997em); top: -5.18em; left: 0.46em;"><span class="texatom" id="MathJax-Span-957"><span class="mrow" id="MathJax-Span-958"><span class="mi" id="MathJax-Span-959" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-960" style="padding-left: 0.155em;"><span style="display: inline-block; position: relative; width: 1.679em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1001.58em, 4.322em, -999.997em); top: -4.672em; left: 50%; margin-left: -0.81em;"><span class="mrow" id="MathJax-Span-961"><span class="mi" id="MathJax-Span-962" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-963"><span style="display: inline-block; position: relative; width: 1.019em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1000.66em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-964" style="font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.663em;"><span class="texatom" id="MathJax-Span-965"><span class="mrow" id="MathJax-Span-966"><span class="mi" id="MathJax-Span-967" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1001.48em, 4.423em, -999.997em); top: -3.3em; left: 50%; margin-left: -0.76em;"><span class="mrow" id="MathJax-Span-968"><span class="mi" id="MathJax-Span-969" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-970"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.51em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="texatom" id="MathJax-Span-971"><span class="mrow" id="MathJax-Span-972"><span class="munderover" id="MathJax-Span-973"><span style="display: inline-block; position: relative; width: 0.612em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.372em, -999.997em); top: -4.012em; left: 0.003em;"><span class="mi" id="MathJax-Span-974" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1000.41em, 3.661em, -999.997em); top: -4.063em; left: 0.104em;"><span class="mo" id="MathJax-Span-975" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.758em; left: 0.612em;"><span class="texatom" id="MathJax-Span-976"><span class="mrow" id="MathJax-Span-977"><span class="mi" id="MathJax-Span-978" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1001.68em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.679em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-979"><span style="display: inline-block; position: relative; width: 1.629em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1001.48em, 4.423em, -999.997em); top: -4.723em; left: 50%; margin-left: -0.76em;"><span class="mrow" id="MathJax-Span-980"><span class="mi" id="MathJax-Span-981" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-982"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.51em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="texatom" id="MathJax-Span-983"><span class="mrow" id="MathJax-Span-984"><span class="munderover" id="MathJax-Span-985"><span style="display: inline-block; position: relative; width: 0.612em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.372em, -999.997em); top: -4.012em; left: 0.003em;"><span class="mi" id="MathJax-Span-986" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1000.41em, 3.661em, -999.997em); top: -4.063em; left: 0.104em;"><span class="mo" id="MathJax-Span-987" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.758em; left: 0.612em;"><span class="texatom" id="MathJax-Span-988"><span class="mrow" id="MathJax-Span-989"><span class="mi" id="MathJax-Span-990" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1001.37em, 4.322em, -999.997em); top: -3.351em; left: 50%; margin-left: -0.709em;"><span class="mrow" id="MathJax-Span-991"><span class="mi" id="MathJax-Span-992" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-993"><span style="display: inline-block; position: relative; width: 0.816em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.46em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-994" style="font-family: MathJax_Math-italic;">o</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.511em;"><span class="texatom" id="MathJax-Span-995"><span class="mrow" id="MathJax-Span-996"><span class="mi" id="MathJax-Span-997" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1001.63em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.629em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-998"><span style="display: inline-block; position: relative; width: 2.442em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1001.37em, 4.322em, -999.997em); top: -4.672em; left: 50%; margin-left: -0.709em;"><span class="mrow" id="MathJax-Span-999"><span class="mi" id="MathJax-Span-1000" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-1001"><span style="display: inline-block; position: relative; width: 0.816em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.46em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1002" style="font-family: MathJax_Math-italic;">o</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.511em;"><span class="texatom" id="MathJax-Span-1003"><span class="mrow" id="MathJax-Span-1004"><span class="mi" id="MathJax-Span-1005" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1002.34em, 4.474em, -999.997em); top: -3.351em; left: 50%; margin-left: -1.166em;"><span class="mrow" id="MathJax-Span-1006"><span class="mi" id="MathJax-Span-1007" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-1008"><span style="display: inline-block; position: relative; width: 1.781em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1001.07em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1009" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.968em;"><span class="texatom" id="MathJax-Span-1010"><span class="mrow" id="MathJax-Span-1011"><span class="mi" id="MathJax-Span-1012" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-1013" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.44em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.442em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(2.137em, 1008.54em, 5.338em, -999.997em); top: -0.81em; left: 0em;"><span class="mtd" id="MathJax-Span-1016"><span class="mrow" id="MathJax-Span-1017"><span class="mi" id="MathJax-Span-1018"></span><span class="mo" id="MathJax-Span-1019" style="font-family: MathJax_Main; padding-left: 0.257em;">=</span><span class="munderover" id="MathJax-Span-1020" style="padding-left: 0.257em;"><span style="display: inline-block; position: relative; width: 1.425em; height: 0px;"><span style="position: absolute; clip: rect(2.899em, 1001.37em, 4.627em, -999.997em); top: -4.012em; left: 0em;"><span class="mo" id="MathJax-Span-1021" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.407em, 1000.26em, 4.271em, -999.997em); top: -2.945em; left: 0.612em;"><span class="texatom" id="MathJax-Span-1022"><span class="mrow" id="MathJax-Span-1023"><span class="mi" id="MathJax-Span-1024" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.305em, 1000.51em, 4.169em, -999.997em); top: -5.18em; left: 0.46em;"><span class="texatom" id="MathJax-Span-1025"><span class="mrow" id="MathJax-Span-1026"><span class="mi" id="MathJax-Span-1027" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-1028" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1029"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.51em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="texatom" id="MathJax-Span-1030"><span class="mrow" id="MathJax-Span-1031"><span class="munderover" id="MathJax-Span-1032"><span style="display: inline-block; position: relative; width: 0.612em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.372em, -999.997em); top: -4.012em; left: 0.003em;"><span class="mi" id="MathJax-Span-1033" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1000.41em, 3.661em, -999.997em); top: -4.063em; left: 0.104em;"><span class="mo" id="MathJax-Span-1034" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.758em; left: 0.612em;"><span class="texatom" id="MathJax-Span-1035"><span class="mrow" id="MathJax-Span-1036"><span class="mi" id="MathJax-Span-1037" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-1038" style="font-family: MathJax_Main; padding-left: 0.206em;">−</span><span class="msubsup" id="MathJax-Span-1039" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 0.816em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1040" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.511em;"><span class="texatom" id="MathJax-Span-1041"><span class="mrow" id="MathJax-Span-1042"><span class="mi" id="MathJax-Span-1043" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-1044" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1045" style="font-family: MathJax_Main; padding-left: 0.206em;">⊗</span><span class="msubsup" id="MathJax-Span-1046" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1047" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-1048"><span class="mrow" id="MathJax-Span-1049"><span class="mi" id="MathJax-Span-1050" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span><span style="display: inline-block; width: 0px; height: 10.267em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -5.434em; border-left: 0px solid; width: 0px; height: 11.566em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left" rowspacing="3pt" columnspacing="0em" displaystyle="true"><mtr><mtd><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>y</mi><mi>h</mi></mrow></msub></mrow></mfrac></mtd><mtd><mi></mi><mo>=</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>T</mi></mrow></munderover><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>L</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>y</mi><mi>h</mi></mrow></msub></mrow></mfrac></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>T</mi></mrow></munderover><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>L</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>o</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>o</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>y</mi><mi>h</mi></mrow></msub></mrow></mfrac></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>T</mi></mrow></munderover><mo stretchy="false">(</mo><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub><mo>−</mo><msub><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub><mo stretchy="false">)</mo><mo>⊗</mo><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-45">\begin{split}
\frac{\partial L}{\partial W_{yh}} &= \sum_{t}^{T} \frac{\partial L_{t}}{\partial W_{yh}} \\
&= \sum_{t}^{T} \frac{\partial L_{t}}{\partial \hat{y}_{t}} \frac{\partial \hat{y}_{t}}{\partial o_{t}} \frac{\partial o_{t}}{\partial W_{yh}}\\
&=\sum_{t}^{T} (\hat{y}_{t} - y_{t}) \otimes h_{t}
\end{split}</script>

<p>where derivative of Loss Function w.r.t. softmax function is proved <a href="https://mmuratarat.github.io/2019-02-10/derivative-of-softmax-loss" target="_blank">here</a> and  <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-46-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1051" style="width: 5.185em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.22em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.07em, 1004.22em, 3.001em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-1052"><span class="mfrac" id="MathJax-Span-1053"><span style="display: inline-block; position: relative; width: 1.781em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.356em, 1000.97em, 4.271em, -999.997em); top: -4.52em; left: 50%; margin-left: -0.506em;"><span class="mrow" id="MathJax-Span-1054"><span class="mi" id="MathJax-Span-1055" style="font-size: 70.7%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-1056"><span style="display: inline-block; position: relative; width: 0.561em; height: 0px;"><span style="position: absolute; clip: rect(3.559em, 1000.36em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1057" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.91em; left: 0.358em;"><span class="texatom" id="MathJax-Span-1058"><span class="mrow" id="MathJax-Span-1059"><span class="mi" id="MathJax-Span-1060" style="font-size: 50%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.356em, 1001.68em, 4.372em, -999.997em); top: -3.605em; left: 50%; margin-left: -0.81em;"><span class="mrow" id="MathJax-Span-1061"><span class="mi" id="MathJax-Span-1062" style="font-size: 70.7%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-1063"><span style="display: inline-block; position: relative; width: 1.273em; height: 0px;"><span style="position: absolute; clip: rect(3.356em, 1000.76em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1064" style="font-size: 70.7%; font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.91em; left: 0.663em;"><span class="texatom" id="MathJax-Span-1065"><span class="mrow" id="MathJax-Span-1066"><span class="mi" id="MathJax-Span-1067" style="font-size: 50%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-1068" style="font-size: 50%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1001.78em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.781em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="mo" id="MathJax-Span-1069" style="font-family: MathJax_Main; padding-left: 0.257em;">=</span><span class="msubsup" id="MathJax-Span-1070" style="padding-left: 0.257em;"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1071" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-1072"><span class="mrow" id="MathJax-Span-1073"><span class="mi" id="MathJax-Span-1074" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.809em; border-left: 0px solid; width: 0px; height: 2.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>o</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>y</mi><mi>h</mi></mrow></msub></mrow></mfrac><mo>=</mo><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-46">\frac{\partial o_{t}}{\partial W_{yh}} = h_{t}</script> since <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-47-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1075" style="width: 9.352em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.574em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.374em, 1007.57em, 2.696em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-1076"><span class="msubsup" id="MathJax-Span-1077"><span style="display: inline-block; position: relative; width: 0.816em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.46em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1078" style="font-family: MathJax_Math-italic;">o</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.511em;"><span class="texatom" id="MathJax-Span-1079"><span class="mrow" id="MathJax-Span-1080"><span class="mi" id="MathJax-Span-1081" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-1082" style="font-family: MathJax_Main; padding-left: 0.257em;">=</span><span class="msubsup" id="MathJax-Span-1083" style="padding-left: 0.257em;"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1084" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-1085"><span class="mrow" id="MathJax-Span-1086"><span class="mi" id="MathJax-Span-1087" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-1088" style="font-family: MathJax_Main; padding-left: 0.206em;">⋅</span><span class="msubsup" id="MathJax-Span-1089" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 1.781em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1001.07em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1090" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.968em;"><span class="texatom" id="MathJax-Span-1091"><span class="mrow" id="MathJax-Span-1092"><span class="mi" id="MathJax-Span-1093" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-1094" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-1095" style="font-family: MathJax_Main; padding-left: 0.206em;">+</span><span class="msubsup" id="MathJax-Span-1096" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 0.866em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.41em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1097" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.409em;"><span class="texatom" id="MathJax-Span-1098"><span class="mrow" id="MathJax-Span-1099"><span class="mi" id="MathJax-Span-1100" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>o</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub><mo>=</mo><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub><mo>⋅</mo><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>y</mi><mi>h</mi></mrow></msub><mo>+</mo><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>y</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-47">o_{t} = h_{t}\cdot W_{yh} + b_{y}</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-48-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;#x2297;&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1101" style="width: 0.968em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.765em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.527em, 1000.71em, 2.492em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-1102"><span class="mo" id="MathJax-Span-1103" style="font-family: MathJax_Main;">⊗</span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>⊗</mo></math></span></span><script type="math/tex" id="MathJax-Element-48">\otimes</script> is the outer product of two vectors.</p>

<p>Similarly, we can get the gradient w.r.t. bias <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-49-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1104" style="width: 1.07em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.866em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.374em, 1000.87em, 2.696em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-1105"><span class="msubsup" id="MathJax-Span-1106"><span style="display: inline-block; position: relative; width: 0.866em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.41em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1107" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.409em;"><span class="texatom" id="MathJax-Span-1108"><span class="mrow" id="MathJax-Span-1109"><span class="mi" id="MathJax-Span-1110" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>y</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-49">b_{y}</script>:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-50-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1111" style="width: 12.96em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.521em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(-1.217em, 1010.37em, 5.185em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-1112"><span class="mtable" id="MathJax-Span-1113" style="padding-right: 0.155em; padding-left: 0.155em;"><span style="display: inline-block; position: relative; width: 10.216em; height: 0px;"><span style="position: absolute; clip: rect(2.492em, 1001.78em, 7.37em, -999.997em); top: -5.587em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.781em; height: 0px;"><span style="position: absolute; clip: rect(2.492em, 1001.78em, 5.135em, -999.997em); top: -5.587em; right: 0em;"><span class="mtd" id="MathJax-Span-1114"><span class="mrow" id="MathJax-Span-1115"><span class="mfrac" id="MathJax-Span-1116"><span style="display: inline-block; position: relative; width: 1.527em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1001.22em, 4.169em, -999.997em); top: -4.672em; left: 50%; margin-left: -0.607em;"><span class="mrow" id="MathJax-Span-1117"><span class="mi" id="MathJax-Span-1118" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="mi" id="MathJax-Span-1119" style="font-family: MathJax_Math-italic;">L</span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1001.42em, 4.474em, -999.997em); top: -3.351em; left: 50%; margin-left: -0.709em;"><span class="mrow" id="MathJax-Span-1120"><span class="mi" id="MathJax-Span-1121" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-1122"><span style="display: inline-block; position: relative; width: 0.866em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.41em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1123" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.409em;"><span class="texatom" id="MathJax-Span-1124"><span class="mrow" id="MathJax-Span-1125"><span class="mi" id="MathJax-Span-1126" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1001.53em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.527em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.864em, 1000em, 4.169em, -999.997em); top: -2.386em; right: 0em;"><span class="mtd" id="MathJax-Span-1192"><span class="mrow" id="MathJax-Span-1193"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.592em;"></span></span><span style="position: absolute; clip: rect(3.661em, 1008.44em, 10.064em, -999.997em); top: -7.111em; left: 1.781em;"><span style="display: inline-block; position: relative; width: 8.438em; height: 0px;"><span style="position: absolute; clip: rect(2.137em, 1008.44em, 5.338em, -999.997em); top: -5.587em; left: 0em;"><span class="mtd" id="MathJax-Span-1127"><span class="mrow" id="MathJax-Span-1128"><span class="mi" id="MathJax-Span-1129"></span><span class="mo" id="MathJax-Span-1130" style="font-family: MathJax_Main; padding-left: 0.257em;">=</span><span class="munderover" id="MathJax-Span-1131" style="padding-left: 0.257em;"><span style="display: inline-block; position: relative; width: 1.425em; height: 0px;"><span style="position: absolute; clip: rect(2.899em, 1001.37em, 4.627em, -999.997em); top: -4.012em; left: 0em;"><span class="mo" id="MathJax-Span-1132" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.407em, 1000.26em, 4.271em, -999.997em); top: -2.945em; left: 0.612em;"><span class="texatom" id="MathJax-Span-1133"><span class="mrow" id="MathJax-Span-1134"><span class="mi" id="MathJax-Span-1135" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.305em, 1000.51em, 4.169em, -999.997em); top: -5.18em; left: 0.46em;"><span class="texatom" id="MathJax-Span-1136"><span class="mrow" id="MathJax-Span-1137"><span class="mi" id="MathJax-Span-1138" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-1139" style="padding-left: 0.155em;"><span style="display: inline-block; position: relative; width: 1.679em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1001.58em, 4.322em, -999.997em); top: -4.672em; left: 50%; margin-left: -0.81em;"><span class="mrow" id="MathJax-Span-1140"><span class="mi" id="MathJax-Span-1141" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-1142"><span style="display: inline-block; position: relative; width: 1.019em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1000.66em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1143" style="font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.663em;"><span class="texatom" id="MathJax-Span-1144"><span class="mrow" id="MathJax-Span-1145"><span class="mi" id="MathJax-Span-1146" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1001.48em, 4.423em, -999.997em); top: -3.3em; left: 50%; margin-left: -0.76em;"><span class="mrow" id="MathJax-Span-1147"><span class="mi" id="MathJax-Span-1148" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-1149"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.51em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="texatom" id="MathJax-Span-1150"><span class="mrow" id="MathJax-Span-1151"><span class="munderover" id="MathJax-Span-1152"><span style="display: inline-block; position: relative; width: 0.612em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.372em, -999.997em); top: -4.012em; left: 0.003em;"><span class="mi" id="MathJax-Span-1153" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1000.41em, 3.661em, -999.997em); top: -4.063em; left: 0.104em;"><span class="mo" id="MathJax-Span-1154" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.758em; left: 0.612em;"><span class="texatom" id="MathJax-Span-1155"><span class="mrow" id="MathJax-Span-1156"><span class="mi" id="MathJax-Span-1157" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1001.68em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.679em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-1158"><span style="display: inline-block; position: relative; width: 1.629em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1001.48em, 4.423em, -999.997em); top: -4.723em; left: 50%; margin-left: -0.76em;"><span class="mrow" id="MathJax-Span-1159"><span class="mi" id="MathJax-Span-1160" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-1161"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.51em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="texatom" id="MathJax-Span-1162"><span class="mrow" id="MathJax-Span-1163"><span class="munderover" id="MathJax-Span-1164"><span style="display: inline-block; position: relative; width: 0.612em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.372em, -999.997em); top: -4.012em; left: 0.003em;"><span class="mi" id="MathJax-Span-1165" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1000.41em, 3.661em, -999.997em); top: -4.063em; left: 0.104em;"><span class="mo" id="MathJax-Span-1166" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.758em; left: 0.612em;"><span class="texatom" id="MathJax-Span-1167"><span class="mrow" id="MathJax-Span-1168"><span class="mi" id="MathJax-Span-1169" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1001.37em, 4.322em, -999.997em); top: -3.351em; left: 50%; margin-left: -0.709em;"><span class="mrow" id="MathJax-Span-1170"><span class="mi" id="MathJax-Span-1171" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-1172"><span style="display: inline-block; position: relative; width: 0.816em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.46em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1173" style="font-family: MathJax_Math-italic;">o</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.511em;"><span class="texatom" id="MathJax-Span-1174"><span class="mrow" id="MathJax-Span-1175"><span class="mi" id="MathJax-Span-1176" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1001.63em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.629em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-1177"><span style="display: inline-block; position: relative; width: 1.527em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1001.37em, 4.322em, -999.997em); top: -4.672em; left: 50%; margin-left: -0.709em;"><span class="mrow" id="MathJax-Span-1178"><span class="mi" id="MathJax-Span-1179" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-1180"><span style="display: inline-block; position: relative; width: 0.816em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.46em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1181" style="font-family: MathJax_Math-italic;">o</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.511em;"><span class="texatom" id="MathJax-Span-1182"><span class="mrow" id="MathJax-Span-1183"><span class="mi" id="MathJax-Span-1184" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1001.42em, 4.474em, -999.997em); top: -3.351em; left: 50%; margin-left: -0.709em;"><span class="mrow" id="MathJax-Span-1185"><span class="mi" id="MathJax-Span-1186" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-1187"><span style="display: inline-block; position: relative; width: 0.866em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.41em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1188" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.409em;"><span class="texatom" id="MathJax-Span-1189"><span class="mrow" id="MathJax-Span-1190"><span class="mi" id="MathJax-Span-1191" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1001.53em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.527em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(2.137em, 1006.35em, 5.338em, -999.997em); top: -2.386em; left: 0em;"><span class="mtd" id="MathJax-Span-1194"><span class="mrow" id="MathJax-Span-1195"><span class="mi" id="MathJax-Span-1196"></span><span class="mo" id="MathJax-Span-1197" style="font-family: MathJax_Main; padding-left: 0.257em;">=</span><span class="munderover" id="MathJax-Span-1198" style="padding-left: 0.257em;"><span style="display: inline-block; position: relative; width: 1.425em; height: 0px;"><span style="position: absolute; clip: rect(2.899em, 1001.37em, 4.627em, -999.997em); top: -4.012em; left: 0em;"><span class="mo" id="MathJax-Span-1199" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.407em, 1000.26em, 4.271em, -999.997em); top: -2.945em; left: 0.612em;"><span class="texatom" id="MathJax-Span-1200"><span class="mrow" id="MathJax-Span-1201"><span class="mi" id="MathJax-Span-1202" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.305em, 1000.51em, 4.169em, -999.997em); top: -5.18em; left: 0.46em;"><span class="texatom" id="MathJax-Span-1203"><span class="mrow" id="MathJax-Span-1204"><span class="mi" id="MathJax-Span-1205" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-1206" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1207"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.51em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="texatom" id="MathJax-Span-1208"><span class="mrow" id="MathJax-Span-1209"><span class="munderover" id="MathJax-Span-1210"><span style="display: inline-block; position: relative; width: 0.612em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.372em, -999.997em); top: -4.012em; left: 0.003em;"><span class="mi" id="MathJax-Span-1211" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1000.41em, 3.661em, -999.997em); top: -4.063em; left: 0.104em;"><span class="mo" id="MathJax-Span-1212" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.758em; left: 0.612em;"><span class="texatom" id="MathJax-Span-1213"><span class="mrow" id="MathJax-Span-1214"><span class="mi" id="MathJax-Span-1215" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-1216" style="font-family: MathJax_Main; padding-left: 0.206em;">−</span><span class="msubsup" id="MathJax-Span-1217" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 0.816em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1218" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.511em;"><span class="texatom" id="MathJax-Span-1219"><span class="mrow" id="MathJax-Span-1220"><span class="mi" id="MathJax-Span-1221" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-1222" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span><span style="display: inline-block; width: 0px; height: 7.116em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -3.497em; border-left: 0px solid; width: 0px; height: 7.628em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left" rowspacing="3pt" columnspacing="0em" displaystyle="true"><mtr><mtd><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>y</mi></mrow></msub></mrow></mfrac></mtd><mtd><mi></mi><mo>=</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>T</mi></mrow></munderover><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>L</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>o</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>o</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>y</mi></mrow></msub></mrow></mfrac></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>T</mi></mrow></munderover><mo stretchy="false">(</mo><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub><mo>−</mo><msub><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub><mo stretchy="false">)</mo></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-50">\begin{split}
\frac{\partial L}{\partial b_{y}}  &= \sum_{t}^{T} \frac{\partial L_{t}}{\partial \hat{y}_{t}} \frac{\partial \hat{y}_{t}}{\partial o_{t}} \frac{\partial o_{t}}{\partial b_{y}}\\
&=\sum_{t}^{T} (\hat{y}_{t} - y_{t})
\end{split}</script>

<p>Further, let’s use <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-51-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1223" style="width: 2.391em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.933em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.425em, 1001.93em, 2.594em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-1224"><span class="msubsup" id="MathJax-Span-1225"><span style="display: inline-block; position: relative; width: 1.933em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1000.66em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1226" style="font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.663em;"><span class="texatom" id="MathJax-Span-1227"><span class="mrow" id="MathJax-Span-1228"><span class="mi" id="MathJax-Span-1229" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1230" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-1231" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>L</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-51">L_{t+1}</script> to denote the output of the time-step <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-52-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1232" style="width: 2.543em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.035em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.425em, 1001.98em, 2.492em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-1233"><span class="mi" id="MathJax-Span-1234" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1235" style="font-family: MathJax_Main; padding-left: 0.206em;">+</span><span class="mn" id="MathJax-Span-1236" style="font-family: MathJax_Main; padding-left: 0.206em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mo>+</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-52">t+1</script>, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-53-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1237" style="width: 10.877em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.844em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.374em, 1008.84em, 2.696em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-1238"><span class="msubsup" id="MathJax-Span-1239"><span style="display: inline-block; position: relative; width: 1.933em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1000.66em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1240" style="font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.663em;"><span class="texatom" id="MathJax-Span-1241"><span class="mrow" id="MathJax-Span-1242"><span class="mi" id="MathJax-Span-1243" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1244" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-1245" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-1246" style="font-family: MathJax_Main; padding-left: 0.257em;">=</span><span class="mo" id="MathJax-Span-1247" style="font-family: MathJax_Main; padding-left: 0.257em;">−</span><span class="msubsup" id="MathJax-Span-1248"><span style="display: inline-block; position: relative; width: 1.73em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1249" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.511em;"><span class="texatom" id="MathJax-Span-1250"><span class="mrow" id="MathJax-Span-1251"><span class="mi" id="MathJax-Span-1252" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1253" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-1254" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mi" id="MathJax-Span-1255" style="font-family: MathJax_Math-italic;">l</span><span class="mi" id="MathJax-Span-1256" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-1257" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-1258"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.51em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="texatom" id="MathJax-Span-1259"><span class="mrow" id="MathJax-Span-1260"><span class="munderover" id="MathJax-Span-1261"><span style="display: inline-block; position: relative; width: 0.612em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.372em, -999.997em); top: -4.012em; left: 0.003em;"><span class="mi" id="MathJax-Span-1262" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1000.41em, 3.661em, -999.997em); top: -4.063em; left: 0.104em;"><span class="mo" id="MathJax-Span-1263" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.758em; left: 0.612em;"><span class="texatom" id="MathJax-Span-1264"><span class="mrow" id="MathJax-Span-1265"><span class="mi" id="MathJax-Span-1266" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1267" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-1268" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>L</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><mo>−</mo><msub><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mi>l</mi><mi>o</mi><mi>g</mi><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-53">L_{t+1} = -y_{t+1} log \hat{y}_{t+1}</script>.</p>

<p>Now, let’s go throught the details to derive the gradient with respect to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-54-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1269" style="width: 2.289em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.425em, 1001.83em, 2.543em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-1270"><span class="msubsup" id="MathJax-Span-1271"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1001.07em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1272" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.968em;"><span class="texatom" id="MathJax-Span-1273"><span class="mrow" id="MathJax-Span-1274"><span class="mi" id="MathJax-Span-1275" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span class="mi" id="MathJax-Span-1276" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi><mi>h</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-54">W_{hh}</script>, considering at the time step <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-55-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1277" style="width: 4.83em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.915em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.425em, 1003.86em, 2.492em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-1278"><span class="mi" id="MathJax-Span-1279" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1280" style="font-family: MathJax_Main; padding-left: 0.257em;">→</span><span class="mi" id="MathJax-Span-1281" style="font-family: MathJax_Math-italic; padding-left: 0.257em;">t</span><span class="mo" id="MathJax-Span-1282" style="font-family: MathJax_Main; padding-left: 0.206em;">+</span><span class="mn" id="MathJax-Span-1283" style="font-family: MathJax_Main; padding-left: 0.206em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mo stretchy="false">→</mo><mi>t</mi><mo>+</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-55">t \rightarrow t+1</script> (from time-step <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-56-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1284" style="width: 0.46em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.358em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.476em, 1000.31em, 2.391em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-1285"><span class="mi" id="MathJax-Span-1286" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-56">t</script> to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-57-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1287" style="width: 2.543em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.035em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.425em, 1001.98em, 2.492em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-1288"><span class="mi" id="MathJax-Span-1289" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1290" style="font-family: MathJax_Main; padding-left: 0.206em;">+</span><span class="mn" id="MathJax-Span-1291" style="font-family: MathJax_Main; padding-left: 0.206em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mo>+</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-57">t+1</script>).</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-58-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1292" style="width: 15.196em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.35em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(0.612em, 1012.35em, 3.407em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-1293"><span class="mfrac" id="MathJax-Span-1294"><span style="display: inline-block; position: relative; width: 2.594em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1002.49em, 4.372em, -999.997em); top: -4.672em; left: 50%; margin-left: -1.217em;"><span class="mrow" id="MathJax-Span-1295"><span class="mi" id="MathJax-Span-1296" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-1297"><span style="display: inline-block; position: relative; width: 1.933em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1000.66em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1298" style="font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.663em;"><span class="texatom" id="MathJax-Span-1299"><span class="mrow" id="MathJax-Span-1300"><span class="mi" id="MathJax-Span-1301" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1302" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-1303" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.322em, -999.997em); top: -3.351em; left: 50%; margin-left: -1.217em;"><span class="mrow" id="MathJax-Span-1304"><span class="mi" id="MathJax-Span-1305" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-1306"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1001.07em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1307" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.968em;"><span class="texatom" id="MathJax-Span-1308"><span class="mrow" id="MathJax-Span-1309"><span class="mi" id="MathJax-Span-1310" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span class="mi" id="MathJax-Span-1311" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.59em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.594em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="mo" id="MathJax-Span-1312" style="font-family: MathJax_Main; padding-left: 0.257em;">=</span><span class="mfrac" id="MathJax-Span-1313" style="padding-left: 0.257em;"><span style="display: inline-block; position: relative; width: 2.594em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1002.49em, 4.372em, -999.997em); top: -4.672em; left: 50%; margin-left: -1.217em;"><span class="mrow" id="MathJax-Span-1314"><span class="mi" id="MathJax-Span-1315" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-1316"><span style="display: inline-block; position: relative; width: 1.933em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1000.66em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1317" style="font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.663em;"><span class="texatom" id="MathJax-Span-1318"><span class="mrow" id="MathJax-Span-1319"><span class="mi" id="MathJax-Span-1320" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1321" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-1322" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.474em, -999.997em); top: -3.3em; left: 50%; margin-left: -1.166em;"><span class="mrow" id="MathJax-Span-1323"><span class="mi" id="MathJax-Span-1324" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-1325"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.51em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="texatom" id="MathJax-Span-1326"><span class="mrow" id="MathJax-Span-1327"><span class="munderover" id="MathJax-Span-1328"><span style="display: inline-block; position: relative; width: 0.612em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.372em, -999.997em); top: -4.012em; left: 0.003em;"><span class="mi" id="MathJax-Span-1329" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1000.41em, 3.661em, -999.997em); top: -4.063em; left: 0.104em;"><span class="mo" id="MathJax-Span-1330" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.758em; left: 0.612em;"><span class="texatom" id="MathJax-Span-1331"><span class="mrow" id="MathJax-Span-1332"><span class="mi" id="MathJax-Span-1333" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1334" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-1335" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.59em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.594em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-1336"><span style="display: inline-block; position: relative; width: 2.492em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.474em, -999.997em); top: -4.774em; left: 50%; margin-left: -1.166em;"><span class="mrow" id="MathJax-Span-1337"><span class="mi" id="MathJax-Span-1338" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-1339"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.51em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="texatom" id="MathJax-Span-1340"><span class="mrow" id="MathJax-Span-1341"><span class="munderover" id="MathJax-Span-1342"><span style="display: inline-block; position: relative; width: 0.612em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.372em, -999.997em); top: -4.012em; left: 0.003em;"><span class="mi" id="MathJax-Span-1343" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1000.41em, 3.661em, -999.997em); top: -4.063em; left: 0.104em;"><span class="mo" id="MathJax-Span-1344" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.758em; left: 0.612em;"><span class="texatom" id="MathJax-Span-1345"><span class="mrow" id="MathJax-Span-1346"><span class="mi" id="MathJax-Span-1347" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1348" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-1349" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.372em, -999.997em); top: -3.351em; left: 50%; margin-left: -1.166em;"><span class="mrow" id="MathJax-Span-1350"><span class="mi" id="MathJax-Span-1351" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-1352"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1353" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-1354"><span class="mrow" id="MathJax-Span-1355"><span class="mi" id="MathJax-Span-1356" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1357" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-1358" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.49em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.492em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-1359"><span style="display: inline-block; position: relative; width: 2.543em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.372em, -999.997em); top: -4.672em; left: 50%; margin-left: -1.166em;"><span class="mrow" id="MathJax-Span-1360"><span class="mi" id="MathJax-Span-1361" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-1362"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1363" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-1364"><span class="mrow" id="MathJax-Span-1365"><span class="mi" id="MathJax-Span-1366" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1367" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-1368" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.322em, -999.997em); top: -3.351em; left: 50%; margin-left: -1.217em;"><span class="mrow" id="MathJax-Span-1369"><span class="mi" id="MathJax-Span-1370" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-1371"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1001.07em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1372" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.968em;"><span class="texatom" id="MathJax-Span-1373"><span class="mrow" id="MathJax-Span-1374"><span class="mi" id="MathJax-Span-1375" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span class="mi" id="MathJax-Span-1376" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.54em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.543em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.309em; border-left: 0px solid; width: 0px; height: 3.191em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>L</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi><mi>h</mi></mrow></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>L</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi><mi>h</mi></mrow></msub></mrow></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-58">\frac{\partial L_{t+1}}{\partial W_{hh}} =  \frac{\partial L_{t+1}}{\partial \hat{y}_{t+1}} \frac{\partial \hat{y}_{t+1}}{\partial h_{t+1}} \frac{\partial h_{t+1}}{\partial W_{hh}}</script>

<p>where we consider only one time-step (<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-59-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1377" style="width: 4.83em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.915em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.425em, 1003.86em, 2.492em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-1378"><span class="mi" id="MathJax-Span-1379" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1380" style="font-family: MathJax_Main; padding-left: 0.257em;">→</span><span class="mi" id="MathJax-Span-1381" style="font-family: MathJax_Math-italic; padding-left: 0.257em;">t</span><span class="mo" id="MathJax-Span-1382" style="font-family: MathJax_Main; padding-left: 0.206em;">+</span><span class="mn" id="MathJax-Span-1383" style="font-family: MathJax_Main; padding-left: 0.206em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mo stretchy="false">→</mo><mi>t</mi><mo>+</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-59">t \rightarrow t+1</script>). But, the hidden state <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-60-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1384" style="width: 2.289em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.374em, 1001.83em, 2.594em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-1385"><span class="msubsup" id="MathJax-Span-1386"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1387" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-1388"><span class="mrow" id="MathJax-Span-1389"><span class="mi" id="MathJax-Span-1390" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1391" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-1392" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-60">h_{t+1}</script> partially depends also on <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-61-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1393" style="width: 1.12em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.374em, 1000.92em, 2.543em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-1394"><span class="msubsup" id="MathJax-Span-1395"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1396" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-1397"><span class="mrow" id="MathJax-Span-1398"><span class="mi" id="MathJax-Span-1399" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-61">h_{t}</script> according to the recursive formulation (<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-62-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1400" style="width: 20.226em; display: inline-block;"><span style="display: inline-block; position: relative; width: 16.415em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.273em, 1016.31em, 2.746em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-1401"><span class="msubsup" id="MathJax-Span-1402"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1403" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-1404"><span class="mrow" id="MathJax-Span-1405"><span class="mi" id="MathJax-Span-1406" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-1407" style="font-family: MathJax_Main; padding-left: 0.257em;">=</span><span class="mi" id="MathJax-Span-1408" style="font-family: MathJax_Math-italic; padding-left: 0.257em;">t</span><span class="mi" id="MathJax-Span-1409" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-1410" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-1411" style="font-family: MathJax_Math-italic;">h</span><span class="mo" id="MathJax-Span-1412" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1413"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1001.07em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1414" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.407em, 1000.56em, 4.169em, -999.997em); top: -4.367em; left: 1.12em;"><span class="texatom" id="MathJax-Span-1415"><span class="mrow" id="MathJax-Span-1416"><span class="mi" id="MathJax-Span-1417" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.356em, 1000.87em, 4.169em, -999.997em); top: -3.707em; left: 0.968em;"><span class="texatom" id="MathJax-Span-1418"><span class="mrow" id="MathJax-Span-1419"><span class="mi" id="MathJax-Span-1420" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mi" id="MathJax-Span-1421" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-1422" style="font-family: MathJax_Main; padding-left: 0.206em;">⋅</span><span class="msubsup" id="MathJax-Span-1423" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 1.171em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1000.87em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1424" style="font-family: MathJax_Math-italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.816em;"><span class="texatom" id="MathJax-Span-1425"><span class="mrow" id="MathJax-Span-1426"><span class="mi" id="MathJax-Span-1427" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-1428" style="font-family: MathJax_Main; padding-left: 0.206em;">+</span><span class="msubsup" id="MathJax-Span-1429" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1001.07em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1430" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.407em, 1000.56em, 4.169em, -999.997em); top: -4.367em; left: 1.12em;"><span class="texatom" id="MathJax-Span-1431"><span class="mrow" id="MathJax-Span-1432"><span class="mi" id="MathJax-Span-1433" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.356em, 1000.92em, 4.169em, -999.997em); top: -3.707em; left: 0.968em;"><span class="texatom" id="MathJax-Span-1434"><span class="mrow" id="MathJax-Span-1435"><span class="mi" id="MathJax-Span-1436" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span class="mi" id="MathJax-Span-1437" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-1438" style="font-family: MathJax_Main; padding-left: 0.206em;">⋅</span><span class="msubsup" id="MathJax-Span-1439" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1440" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-1441"><span class="mrow" id="MathJax-Span-1442"><span class="mi" id="MathJax-Span-1443" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1444" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1445" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-1446" style="font-family: MathJax_Main; padding-left: 0.206em;">+</span><span class="msubsup" id="MathJax-Span-1447" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.41em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1448" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.409em;"><span class="texatom" id="MathJax-Span-1449"><span class="mrow" id="MathJax-Span-1450"><span class="mi" id="MathJax-Span-1451" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-1452" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub><mo>=</mo><mi>t</mi><mi>a</mi><mi>n</mi><mi>h</mi><mo stretchy="false">(</mo><msubsup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mi>h</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>T</mi></mrow></msubsup><mo>⋅</mo><msub><mi>X</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub><mo>+</mo><msubsup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi><mi>h</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>T</mi></mrow></msubsup><mo>⋅</mo><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi></mrow></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-62">h_{t} = tanh(W_{xh}^{T} \cdot X_{t} + W_{hh}^{T}\cdot h_{t-1} +b_{h})</script>). Thus, at the time-step <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-63-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1453" style="width: 4.83em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.915em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.425em, 1003.86em, 2.492em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-1454"><span class="mi" id="MathJax-Span-1455" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1456" style="font-family: MathJax_Main; padding-left: 0.206em;">−</span><span class="mn" id="MathJax-Span-1457" style="font-family: MathJax_Main; padding-left: 0.206em;">1</span><span class="mo" id="MathJax-Span-1458" style="font-family: MathJax_Main; padding-left: 0.257em;">→</span><span class="mi" id="MathJax-Span-1459" style="font-family: MathJax_Math-italic; padding-left: 0.257em;">t</span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mo>−</mo><mn>1</mn><mo stretchy="false">→</mo><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-63">t-1 \rightarrow t</script>, we can further get the partial derivative with respect to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-64-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1460" style="width: 2.289em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.425em, 1001.83em, 2.543em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-1461"><span class="msubsup" id="MathJax-Span-1462"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1001.07em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1463" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.968em;"><span class="texatom" id="MathJax-Span-1464"><span class="mrow" id="MathJax-Span-1465"><span class="mi" id="MathJax-Span-1466" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span class="mi" id="MathJax-Span-1467" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi><mi>h</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-64">W_{hh}</script> as the following:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-65-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1468" style="width: 18.498em; display: inline-block;"><span style="display: inline-block; position: relative; width: 15.043em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(0.612em, 1015.04em, 3.407em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-1469"><span class="mfrac" id="MathJax-Span-1470"><span style="display: inline-block; position: relative; width: 2.594em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1002.49em, 4.372em, -999.997em); top: -4.672em; left: 50%; margin-left: -1.217em;"><span class="mrow" id="MathJax-Span-1471"><span class="mi" id="MathJax-Span-1472" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-1473"><span style="display: inline-block; position: relative; width: 1.933em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1000.66em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1474" style="font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.663em;"><span class="texatom" id="MathJax-Span-1475"><span class="mrow" id="MathJax-Span-1476"><span class="mi" id="MathJax-Span-1477" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1478" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-1479" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.322em, -999.997em); top: -3.351em; left: 50%; margin-left: -1.217em;"><span class="mrow" id="MathJax-Span-1480"><span class="mi" id="MathJax-Span-1481" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-1482"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1001.07em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1483" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.968em;"><span class="texatom" id="MathJax-Span-1484"><span class="mrow" id="MathJax-Span-1485"><span class="mi" id="MathJax-Span-1486" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span class="mi" id="MathJax-Span-1487" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.59em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.594em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="mo" id="MathJax-Span-1488" style="font-family: MathJax_Main; padding-left: 0.257em;">=</span><span class="mfrac" id="MathJax-Span-1489" style="padding-left: 0.257em;"><span style="display: inline-block; position: relative; width: 2.594em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1002.49em, 4.372em, -999.997em); top: -4.672em; left: 50%; margin-left: -1.217em;"><span class="mrow" id="MathJax-Span-1490"><span class="mi" id="MathJax-Span-1491" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-1492"><span style="display: inline-block; position: relative; width: 1.933em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1000.66em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1493" style="font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.663em;"><span class="texatom" id="MathJax-Span-1494"><span class="mrow" id="MathJax-Span-1495"><span class="mi" id="MathJax-Span-1496" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1497" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-1498" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.474em, -999.997em); top: -3.3em; left: 50%; margin-left: -1.166em;"><span class="mrow" id="MathJax-Span-1499"><span class="mi" id="MathJax-Span-1500" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-1501"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.51em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="texatom" id="MathJax-Span-1502"><span class="mrow" id="MathJax-Span-1503"><span class="munderover" id="MathJax-Span-1504"><span style="display: inline-block; position: relative; width: 0.612em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.372em, -999.997em); top: -4.012em; left: 0.003em;"><span class="mi" id="MathJax-Span-1505" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1000.41em, 3.661em, -999.997em); top: -4.063em; left: 0.104em;"><span class="mo" id="MathJax-Span-1506" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.758em; left: 0.612em;"><span class="texatom" id="MathJax-Span-1507"><span class="mrow" id="MathJax-Span-1508"><span class="mi" id="MathJax-Span-1509" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1510" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-1511" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.59em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.594em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-1512"><span style="display: inline-block; position: relative; width: 2.492em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.474em, -999.997em); top: -4.774em; left: 50%; margin-left: -1.166em;"><span class="mrow" id="MathJax-Span-1513"><span class="mi" id="MathJax-Span-1514" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-1515"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.51em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="texatom" id="MathJax-Span-1516"><span class="mrow" id="MathJax-Span-1517"><span class="munderover" id="MathJax-Span-1518"><span style="display: inline-block; position: relative; width: 0.612em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.372em, -999.997em); top: -4.012em; left: 0.003em;"><span class="mi" id="MathJax-Span-1519" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1000.41em, 3.661em, -999.997em); top: -4.063em; left: 0.104em;"><span class="mo" id="MathJax-Span-1520" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.758em; left: 0.612em;"><span class="texatom" id="MathJax-Span-1521"><span class="mrow" id="MathJax-Span-1522"><span class="mi" id="MathJax-Span-1523" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1524" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-1525" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.372em, -999.997em); top: -3.351em; left: 50%; margin-left: -1.166em;"><span class="mrow" id="MathJax-Span-1526"><span class="mi" id="MathJax-Span-1527" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-1528"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1529" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-1530"><span class="mrow" id="MathJax-Span-1531"><span class="mi" id="MathJax-Span-1532" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1533" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-1534" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.49em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.492em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-1535"><span style="display: inline-block; position: relative; width: 2.492em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.372em, -999.997em); top: -4.672em; left: 50%; margin-left: -1.166em;"><span class="mrow" id="MathJax-Span-1536"><span class="mi" id="MathJax-Span-1537" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-1538"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1539" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-1540"><span class="mrow" id="MathJax-Span-1541"><span class="mi" id="MathJax-Span-1542" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1543" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-1544" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1001.48em, 4.322em, -999.997em); top: -3.351em; left: 50%; margin-left: -0.709em;"><span class="mrow" id="MathJax-Span-1545"><span class="mi" id="MathJax-Span-1546" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-1547"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1548" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-1549"><span class="mrow" id="MathJax-Span-1550"><span class="mi" id="MathJax-Span-1551" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.49em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.492em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-1552"><span style="display: inline-block; position: relative; width: 2.543em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1001.48em, 4.322em, -999.997em); top: -4.672em; left: 50%; margin-left: -0.709em;"><span class="mrow" id="MathJax-Span-1553"><span class="mi" id="MathJax-Span-1554" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-1555"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1556" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-1557"><span class="mrow" id="MathJax-Span-1558"><span class="mi" id="MathJax-Span-1559" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.322em, -999.997em); top: -3.351em; left: 50%; margin-left: -1.217em;"><span class="mrow" id="MathJax-Span-1560"><span class="mi" id="MathJax-Span-1561" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-1562"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1001.07em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1563" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.968em;"><span class="texatom" id="MathJax-Span-1564"><span class="mrow" id="MathJax-Span-1565"><span class="mi" id="MathJax-Span-1566" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span class="mi" id="MathJax-Span-1567" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.54em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.543em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.309em; border-left: 0px solid; width: 0px; height: 3.191em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>L</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi><mi>h</mi></mrow></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>L</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi><mi>h</mi></mrow></msub></mrow></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-65">\frac{\partial L_{t+1}}{\partial W_{hh}} =  \frac{\partial L_{t+1}}{\partial \hat{y}_{t+1}} \frac{\partial \hat{y}_{t+1}}{\partial h_{t+1}}\frac{\partial h_{t+1}}{\partial h_{t}} \frac{\partial h_{t}}{\partial W_{hh}}</script>

<p>Thus, at the time-step <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-66-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1568" style="width: 2.543em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.035em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.425em, 1001.98em, 2.492em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-1569"><span class="mi" id="MathJax-Span-1570" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1571" style="font-family: MathJax_Main; padding-left: 0.206em;">+</span><span class="mn" id="MathJax-Span-1572" style="font-family: MathJax_Main; padding-left: 0.206em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mo>+</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-66">t+1</script>, we can compute the gradient and further use backpropagation through time from <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-67-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1573" style="width: 2.543em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.035em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.425em, 1001.98em, 2.492em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-1574"><span class="mi" id="MathJax-Span-1575" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1576" style="font-family: MathJax_Main; padding-left: 0.206em;">+</span><span class="mn" id="MathJax-Span-1577" style="font-family: MathJax_Main; padding-left: 0.206em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mo>+</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-67">t+1</script> to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-68-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1578" style="width: 0.663em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.511em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.425em, 1000.46em, 2.391em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-1579"><span class="mn" id="MathJax-Span-1580" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-68">1</script> to compute the overall gradient with respect to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-69-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1581" style="width: 2.289em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.425em, 1001.83em, 2.543em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-1582"><span class="msubsup" id="MathJax-Span-1583"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1001.07em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1584" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.968em;"><span class="texatom" id="MathJax-Span-1585"><span class="mrow" id="MathJax-Span-1586"><span class="mi" id="MathJax-Span-1587" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span class="mi" id="MathJax-Span-1588" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi><mi>h</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-69">W_{hh}</script>:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-70-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1589" style="width: 20.48em; display: inline-block;"><span style="display: inline-block; position: relative; width: 16.618em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(0.358em, 1016.62em, 3.61em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-1590"><span class="mfrac" id="MathJax-Span-1591"><span style="display: inline-block; position: relative; width: 2.594em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1002.49em, 4.372em, -999.997em); top: -4.672em; left: 50%; margin-left: -1.217em;"><span class="mrow" id="MathJax-Span-1592"><span class="mi" id="MathJax-Span-1593" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-1594"><span style="display: inline-block; position: relative; width: 1.933em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1000.66em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1595" style="font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.663em;"><span class="texatom" id="MathJax-Span-1596"><span class="mrow" id="MathJax-Span-1597"><span class="mi" id="MathJax-Span-1598" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1599" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-1600" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.322em, -999.997em); top: -3.351em; left: 50%; margin-left: -1.217em;"><span class="mrow" id="MathJax-Span-1601"><span class="mi" id="MathJax-Span-1602" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-1603"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1001.07em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1604" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.968em;"><span class="texatom" id="MathJax-Span-1605"><span class="mrow" id="MathJax-Span-1606"><span class="mi" id="MathJax-Span-1607" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span class="mi" id="MathJax-Span-1608" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.59em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.594em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="mo" id="MathJax-Span-1609" style="font-family: MathJax_Main; padding-left: 0.257em;">=</span><span class="munderover" id="MathJax-Span-1610" style="padding-left: 0.257em;"><span style="display: inline-block; position: relative; width: 1.425em; height: 0px;"><span style="position: absolute; clip: rect(2.899em, 1001.37em, 4.627em, -999.997em); top: -4.012em; left: 0em;"><span class="mo" id="MathJax-Span-1611" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.356em, 1001.22em, 4.271em, -999.997em); top: -2.894em; left: 0.104em;"><span class="texatom" id="MathJax-Span-1612"><span class="mrow" id="MathJax-Span-1613"><span class="mi" id="MathJax-Span-1614" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-1615" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-1616" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.305em, 1001.12em, 4.22em, -999.997em); top: -5.18em; left: 0.155em;"><span class="texatom" id="MathJax-Span-1617"><span class="mrow" id="MathJax-Span-1618"><span class="mi" id="MathJax-Span-1619" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1620" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-1621" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-1622" style="padding-left: 0.155em;"><span style="display: inline-block; position: relative; width: 2.594em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1002.49em, 4.372em, -999.997em); top: -4.672em; left: 50%; margin-left: -1.217em;"><span class="mrow" id="MathJax-Span-1623"><span class="mi" id="MathJax-Span-1624" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-1625"><span style="display: inline-block; position: relative; width: 1.933em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1000.66em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1626" style="font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.663em;"><span class="texatom" id="MathJax-Span-1627"><span class="mrow" id="MathJax-Span-1628"><span class="mi" id="MathJax-Span-1629" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1630" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-1631" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.474em, -999.997em); top: -3.3em; left: 50%; margin-left: -1.166em;"><span class="mrow" id="MathJax-Span-1632"><span class="mi" id="MathJax-Span-1633" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-1634"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.51em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="texatom" id="MathJax-Span-1635"><span class="mrow" id="MathJax-Span-1636"><span class="munderover" id="MathJax-Span-1637"><span style="display: inline-block; position: relative; width: 0.612em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.372em, -999.997em); top: -4.012em; left: 0.003em;"><span class="mi" id="MathJax-Span-1638" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1000.41em, 3.661em, -999.997em); top: -4.063em; left: 0.104em;"><span class="mo" id="MathJax-Span-1639" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.758em; left: 0.612em;"><span class="texatom" id="MathJax-Span-1640"><span class="mrow" id="MathJax-Span-1641"><span class="mi" id="MathJax-Span-1642" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1643" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-1644" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.59em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.594em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-1645"><span style="display: inline-block; position: relative; width: 2.492em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.474em, -999.997em); top: -4.774em; left: 50%; margin-left: -1.166em;"><span class="mrow" id="MathJax-Span-1646"><span class="mi" id="MathJax-Span-1647" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-1648"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.51em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="texatom" id="MathJax-Span-1649"><span class="mrow" id="MathJax-Span-1650"><span class="munderover" id="MathJax-Span-1651"><span style="display: inline-block; position: relative; width: 0.612em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.372em, -999.997em); top: -4.012em; left: 0.003em;"><span class="mi" id="MathJax-Span-1652" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1000.41em, 3.661em, -999.997em); top: -4.063em; left: 0.104em;"><span class="mo" id="MathJax-Span-1653" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.758em; left: 0.612em;"><span class="texatom" id="MathJax-Span-1654"><span class="mrow" id="MathJax-Span-1655"><span class="mi" id="MathJax-Span-1656" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1657" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-1658" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.372em, -999.997em); top: -3.351em; left: 50%; margin-left: -1.166em;"><span class="mrow" id="MathJax-Span-1659"><span class="mi" id="MathJax-Span-1660" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-1661"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1662" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-1663"><span class="mrow" id="MathJax-Span-1664"><span class="mi" id="MathJax-Span-1665" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1666" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-1667" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.49em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.492em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-1668"><span style="display: inline-block; position: relative; width: 2.492em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.372em, -999.997em); top: -4.672em; left: 50%; margin-left: -1.166em;"><span class="mrow" id="MathJax-Span-1669"><span class="mi" id="MathJax-Span-1670" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-1671"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1672" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-1673"><span class="mrow" id="MathJax-Span-1674"><span class="mi" id="MathJax-Span-1675" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1676" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-1677" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1001.58em, 4.322em, -999.997em); top: -3.351em; left: 50%; margin-left: -0.81em;"><span class="mrow" id="MathJax-Span-1678"><span class="mi" id="MathJax-Span-1679" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-1680"><span style="display: inline-block; position: relative; width: 1.019em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1681" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-1682"><span class="mrow" id="MathJax-Span-1683"><span class="mi" id="MathJax-Span-1684" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.49em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.492em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-1685"><span style="display: inline-block; position: relative; width: 2.543em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1001.58em, 4.322em, -999.997em); top: -4.672em; left: 50%; margin-left: -0.81em;"><span class="mrow" id="MathJax-Span-1686"><span class="mi" id="MathJax-Span-1687" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-1688"><span style="display: inline-block; position: relative; width: 1.019em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1689" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-1690"><span class="mrow" id="MathJax-Span-1691"><span class="mi" id="MathJax-Span-1692" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.322em, -999.997em); top: -3.351em; left: 50%; margin-left: -1.217em;"><span class="mrow" id="MathJax-Span-1693"><span class="mi" id="MathJax-Span-1694" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-1695"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1001.07em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1696" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.968em;"><span class="texatom" id="MathJax-Span-1697"><span class="mrow" id="MathJax-Span-1698"><span class="mi" id="MathJax-Span-1699" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span class="mi" id="MathJax-Span-1700" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.54em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.543em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.559em; border-left: 0px solid; width: 0px; height: 3.753em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>L</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi><mi>h</mi></mrow></msub></mrow></mfrac><mo>=</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></munderover><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>L</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>k</mi></mrow></msub></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>k</mi></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi><mi>h</mi></mrow></msub></mrow></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-70">\frac{\partial L_{t+1}}{\partial W_{hh}} = \sum_{k=1}^{t+1} \frac{\partial L_{t+1}}{\partial \hat{y}_{t+1}} \frac{\partial \hat{y}_{t+1}}{\partial h_{t+1}}\frac{\partial h_{t+1}}{\partial h_{k}} \frac{\partial h_{k}}{\partial W_{hh}}</script>

<p>Note that <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-71-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1701" style="width: 2.442em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.984em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.019em, 1001.98em, 2.899em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-1702"><span class="mfrac" id="MathJax-Span-1703"><span style="display: inline-block; position: relative; width: 1.781em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.356em, 1001.68em, 4.322em, -999.997em); top: -4.571em; left: 50%; margin-left: -0.861em;"><span class="mrow" id="MathJax-Span-1704"><span class="mi" id="MathJax-Span-1705" style="font-size: 70.7%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-1706"><span style="display: inline-block; position: relative; width: 1.273em; height: 0px;"><span style="position: absolute; clip: rect(3.356em, 1000.41em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1707" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.91em; left: 0.409em;"><span class="texatom" id="MathJax-Span-1708"><span class="mrow" id="MathJax-Span-1709"><span class="mi" id="MathJax-Span-1710" style="font-size: 50%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1711" style="font-size: 50%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-1712" style="font-size: 50%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.356em, 1001.12em, 4.271em, -999.997em); top: -3.605em; left: 50%; margin-left: -0.556em;"><span class="mrow" id="MathJax-Span-1713"><span class="mi" id="MathJax-Span-1714" style="font-size: 70.7%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-1715"><span style="display: inline-block; position: relative; width: 0.714em; height: 0px;"><span style="position: absolute; clip: rect(3.356em, 1000.41em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1716" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.91em; left: 0.409em;"><span class="texatom" id="MathJax-Span-1717"><span class="mrow" id="MathJax-Span-1718"><span class="mi" id="MathJax-Span-1719" style="font-size: 50%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1001.78em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.781em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.684em; border-left: 0px solid; width: 0px; height: 2.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>k</mi></mrow></msub></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-71">\frac{\partial h_{t+1}}{\partial h_{k}}</script> is a chain rule in itself!  For example, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-72-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1720" style="width: 6.913em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.592em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.07em, 1005.59em, 2.899em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-1721"><span class="mfrac" id="MathJax-Span-1722"><span style="display: inline-block; position: relative; width: 1.222em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.356em, 1001.12em, 4.271em, -999.997em); top: -4.52em; left: 50%; margin-left: -0.556em;"><span class="mrow" id="MathJax-Span-1723"><span class="mi" id="MathJax-Span-1724" style="font-size: 70.7%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-1725"><span style="display: inline-block; position: relative; width: 0.714em; height: 0px;"><span style="position: absolute; clip: rect(3.356em, 1000.41em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1726" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.91em; left: 0.409em;"><span class="texatom" id="MathJax-Span-1727"><span class="mrow" id="MathJax-Span-1728"><span class="mn" id="MathJax-Span-1729" style="font-size: 50%; font-family: MathJax_Main;">3</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.356em, 1001.12em, 4.271em, -999.997em); top: -3.605em; left: 50%; margin-left: -0.556em;"><span class="mrow" id="MathJax-Span-1730"><span class="mi" id="MathJax-Span-1731" style="font-size: 70.7%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-1732"><span style="display: inline-block; position: relative; width: 0.714em; height: 0px;"><span style="position: absolute; clip: rect(3.356em, 1000.41em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1733" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.91em; left: 0.409em;"><span class="texatom" id="MathJax-Span-1734"><span class="mrow" id="MathJax-Span-1735"><span class="mn" id="MathJax-Span-1736" style="font-size: 50%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1001.22em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.222em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="mo" id="MathJax-Span-1737" style="font-family: MathJax_Main; padding-left: 0.257em;">=</span><span class="mfrac" id="MathJax-Span-1738" style="padding-left: 0.257em;"><span style="display: inline-block; position: relative; width: 1.222em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.356em, 1001.12em, 4.271em, -999.997em); top: -4.52em; left: 50%; margin-left: -0.556em;"><span class="mrow" id="MathJax-Span-1739"><span class="mi" id="MathJax-Span-1740" style="font-size: 70.7%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-1741"><span style="display: inline-block; position: relative; width: 0.714em; height: 0px;"><span style="position: absolute; clip: rect(3.356em, 1000.41em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1742" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.91em; left: 0.409em;"><span class="texatom" id="MathJax-Span-1743"><span class="mrow" id="MathJax-Span-1744"><span class="mn" id="MathJax-Span-1745" style="font-size: 50%; font-family: MathJax_Main;">3</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.356em, 1001.12em, 4.271em, -999.997em); top: -3.605em; left: 50%; margin-left: -0.556em;"><span class="mrow" id="MathJax-Span-1746"><span class="mi" id="MathJax-Span-1747" style="font-size: 70.7%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-1748"><span style="display: inline-block; position: relative; width: 0.714em; height: 0px;"><span style="position: absolute; clip: rect(3.356em, 1000.41em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1749" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.91em; left: 0.409em;"><span class="texatom" id="MathJax-Span-1750"><span class="mrow" id="MathJax-Span-1751"><span class="mn" id="MathJax-Span-1752" style="font-size: 50%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1001.22em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.222em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-1753"><span style="display: inline-block; position: relative; width: 1.222em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.356em, 1001.12em, 4.271em, -999.997em); top: -4.52em; left: 50%; margin-left: -0.556em;"><span class="mrow" id="MathJax-Span-1754"><span class="mi" id="MathJax-Span-1755" style="font-size: 70.7%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-1756"><span style="display: inline-block; position: relative; width: 0.714em; height: 0px;"><span style="position: absolute; clip: rect(3.356em, 1000.41em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1757" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.91em; left: 0.409em;"><span class="texatom" id="MathJax-Span-1758"><span class="mrow" id="MathJax-Span-1759"><span class="mn" id="MathJax-Span-1760" style="font-size: 50%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.356em, 1001.12em, 4.271em, -999.997em); top: -3.605em; left: 50%; margin-left: -0.556em;"><span class="mrow" id="MathJax-Span-1761"><span class="mi" id="MathJax-Span-1762" style="font-size: 70.7%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-1763"><span style="display: inline-block; position: relative; width: 0.714em; height: 0px;"><span style="position: absolute; clip: rect(3.356em, 1000.41em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1764" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.91em; left: 0.409em;"><span class="texatom" id="MathJax-Span-1765"><span class="mrow" id="MathJax-Span-1766"><span class="mn" id="MathJax-Span-1767" style="font-size: 50%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1001.22em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.222em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.684em; border-left: 0px solid; width: 0px; height: 2.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mn>3</mn></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mn>3</mn></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msub></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-72">\frac{\partial h_{3}}{\partial h_{1}} = \frac{\partial h_{3}}{\partial h_{2}}\frac{\partial h_{2}}{\partial h_{1}}</script>. Also note that because we are taking the derivative of a vector function with respect to a vector, the result is a matrix (called the Jacobian matrix) whose elements are all the pointwise derivatives. We can rewrite the above gradient:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-73-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x220F;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1768" style="width: 24.393em; display: inline-block;"><span style="display: inline-block; position: relative; width: 19.82em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(2.137em, 1019.82em, 5.541em, -999.997em); top: -4.012em; left: 0em;"><span class="mrow" id="MathJax-Span-1769"><span class="mfrac" id="MathJax-Span-1770"><span style="display: inline-block; position: relative; width: 2.594em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1002.49em, 4.372em, -999.997em); top: -4.672em; left: 50%; margin-left: -1.217em;"><span class="mrow" id="MathJax-Span-1771"><span class="mi" id="MathJax-Span-1772" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-1773"><span style="display: inline-block; position: relative; width: 1.933em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1000.66em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1774" style="font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.663em;"><span class="texatom" id="MathJax-Span-1775"><span class="mrow" id="MathJax-Span-1776"><span class="mi" id="MathJax-Span-1777" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1778" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-1779" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.322em, -999.997em); top: -3.351em; left: 50%; margin-left: -1.217em;"><span class="mrow" id="MathJax-Span-1780"><span class="mi" id="MathJax-Span-1781" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-1782"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1001.07em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1783" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.968em;"><span class="texatom" id="MathJax-Span-1784"><span class="mrow" id="MathJax-Span-1785"><span class="mi" id="MathJax-Span-1786" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span class="mi" id="MathJax-Span-1787" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.59em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.594em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="mo" id="MathJax-Span-1788" style="font-family: MathJax_Main; padding-left: 0.257em;">=</span><span class="munderover" id="MathJax-Span-1789" style="padding-left: 0.257em;"><span style="display: inline-block; position: relative; width: 1.425em; height: 0px;"><span style="position: absolute; clip: rect(2.899em, 1001.37em, 4.627em, -999.997em); top: -4.012em; left: 0em;"><span class="mo" id="MathJax-Span-1790" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.356em, 1001.22em, 4.271em, -999.997em); top: -2.894em; left: 0.104em;"><span class="texatom" id="MathJax-Span-1791"><span class="mrow" id="MathJax-Span-1792"><span class="mi" id="MathJax-Span-1793" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-1794" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-1795" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.305em, 1001.12em, 4.22em, -999.997em); top: -5.18em; left: 0.155em;"><span class="texatom" id="MathJax-Span-1796"><span class="mrow" id="MathJax-Span-1797"><span class="mi" id="MathJax-Span-1798" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1799" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-1800" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-1801" style="padding-left: 0.155em;"><span style="display: inline-block; position: relative; width: 2.594em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1002.49em, 4.372em, -999.997em); top: -4.672em; left: 50%; margin-left: -1.217em;"><span class="mrow" id="MathJax-Span-1802"><span class="mi" id="MathJax-Span-1803" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-1804"><span style="display: inline-block; position: relative; width: 1.933em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1000.66em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1805" style="font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.663em;"><span class="texatom" id="MathJax-Span-1806"><span class="mrow" id="MathJax-Span-1807"><span class="mi" id="MathJax-Span-1808" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1809" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-1810" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.474em, -999.997em); top: -3.3em; left: 50%; margin-left: -1.166em;"><span class="mrow" id="MathJax-Span-1811"><span class="mi" id="MathJax-Span-1812" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-1813"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.51em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="texatom" id="MathJax-Span-1814"><span class="mrow" id="MathJax-Span-1815"><span class="munderover" id="MathJax-Span-1816"><span style="display: inline-block; position: relative; width: 0.612em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.372em, -999.997em); top: -4.012em; left: 0.003em;"><span class="mi" id="MathJax-Span-1817" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1000.41em, 3.661em, -999.997em); top: -4.063em; left: 0.104em;"><span class="mo" id="MathJax-Span-1818" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.758em; left: 0.612em;"><span class="texatom" id="MathJax-Span-1819"><span class="mrow" id="MathJax-Span-1820"><span class="mi" id="MathJax-Span-1821" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1822" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-1823" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.59em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.594em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-1824"><span style="display: inline-block; position: relative; width: 2.492em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.474em, -999.997em); top: -4.774em; left: 50%; margin-left: -1.166em;"><span class="mrow" id="MathJax-Span-1825"><span class="mi" id="MathJax-Span-1826" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-1827"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.51em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="texatom" id="MathJax-Span-1828"><span class="mrow" id="MathJax-Span-1829"><span class="munderover" id="MathJax-Span-1830"><span style="display: inline-block; position: relative; width: 0.612em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.372em, -999.997em); top: -4.012em; left: 0.003em;"><span class="mi" id="MathJax-Span-1831" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1000.41em, 3.661em, -999.997em); top: -4.063em; left: 0.104em;"><span class="mo" id="MathJax-Span-1832" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.758em; left: 0.612em;"><span class="texatom" id="MathJax-Span-1833"><span class="mrow" id="MathJax-Span-1834"><span class="mi" id="MathJax-Span-1835" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1836" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-1837" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.372em, -999.997em); top: -3.351em; left: 50%; margin-left: -1.166em;"><span class="mrow" id="MathJax-Span-1838"><span class="mi" id="MathJax-Span-1839" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-1840"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1841" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-1842"><span class="mrow" id="MathJax-Span-1843"><span class="mi" id="MathJax-Span-1844" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1845" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-1846" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.49em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.492em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="mrow" id="MathJax-Span-1847"><span class="mo" id="MathJax-Span-1848" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">(</span></span><span class="mrow" id="MathJax-Span-1849"><span class="munderover" id="MathJax-Span-1850"><span style="display: inline-block; position: relative; width: 1.273em; height: 0px;"><span style="position: absolute; clip: rect(2.899em, 1001.22em, 4.627em, -999.997em); top: -4.012em; left: 0em;"><span class="mo" id="MathJax-Span-1851" style="font-family: MathJax_Size2; vertical-align: 0em;">∏</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.356em, 1001.22em, 4.423em, -999.997em); top: -2.894em; left: 0.053em;"><span class="texatom" id="MathJax-Span-1852"><span class="mrow" id="MathJax-Span-1853"><span class="mi" id="MathJax-Span-1854" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-1855" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mi" id="MathJax-Span-1856" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.305em, 1000.26em, 4.169em, -999.997em); top: -5.18em; left: 0.511em;"><span class="texatom" id="MathJax-Span-1857"><span class="mrow" id="MathJax-Span-1858"><span class="mi" id="MathJax-Span-1859" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-1860" style="padding-left: 0.155em;"><span style="display: inline-block; position: relative; width: 2.543em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.474em, -999.997em); top: -4.774em; left: 50%; margin-left: -1.217em;"><span class="mrow" id="MathJax-Span-1861"><span class="mi" id="MathJax-Span-1862" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-1863"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1864" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-1865"><span class="mrow" id="MathJax-Span-1866"><span class="mi" id="MathJax-Span-1867" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-1868" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-1869" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1001.53em, 4.474em, -999.997em); top: -3.351em; left: 50%; margin-left: -0.76em;"><span class="mrow" id="MathJax-Span-1870"><span class="mi" id="MathJax-Span-1871" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-1872"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1873" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-1874"><span class="mrow" id="MathJax-Span-1875"><span class="mi" id="MathJax-Span-1876" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.54em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.543em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-1877" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">)</span></span></span><span class="mfrac" id="MathJax-Span-1878" style="padding-left: 0.155em;"><span style="display: inline-block; position: relative; width: 2.543em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1001.58em, 4.322em, -999.997em); top: -4.672em; left: 50%; margin-left: -0.81em;"><span class="mrow" id="MathJax-Span-1879"><span class="mi" id="MathJax-Span-1880" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-1881"><span style="display: inline-block; position: relative; width: 1.019em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1882" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-1883"><span class="mrow" id="MathJax-Span-1884"><span class="mi" id="MathJax-Span-1885" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.322em, -999.997em); top: -3.351em; left: 50%; margin-left: -1.217em;"><span class="mrow" id="MathJax-Span-1886"><span class="mi" id="MathJax-Span-1887" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-1888"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1001.07em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1889" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.968em;"><span class="texatom" id="MathJax-Span-1890"><span class="mrow" id="MathJax-Span-1891"><span class="mi" id="MathJax-Span-1892" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span class="mi" id="MathJax-Span-1893" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.54em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.543em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.747em; border-left: 0px solid; width: 0px; height: 3.941em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>L</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi><mi>h</mi></mrow></msub></mrow></mfrac><mo>=</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></munderover><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>L</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow></mfrac><mrow><mo>(</mo><mrow><munderover><mo>∏</mo><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>=</mo><mi>k</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></munderover><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi></mrow></msub></mrow></mfrac></mrow><mo>)</mo></mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>k</mi></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi><mi>h</mi></mrow></msub></mrow></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-73">\frac{\partial L_{t+1}}{\partial W_{hh}} = \sum_{k=1}^{t+1} \frac{\partial L_{t+1}}{\partial \hat{y}_{t+1}} \frac{\partial \hat{y}_{t+1}}{\partial h_{t+1}}  \left( \prod_{j = k} ^{t} \frac{\partial h_{j+1}}{\partial h_{j}} \right) \frac{\partial h_{k}}{\partial W_{hh}}</script>

<p>where</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-74-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x220F;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1894" style="width: 23.326em; display: inline-block;"><span style="display: inline-block; position: relative; width: 18.956em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(0.409em, 1018.96em, 3.763em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-1895"><span class="munderover" id="MathJax-Span-1896"><span style="display: inline-block; position: relative; width: 1.273em; height: 0px;"><span style="position: absolute; clip: rect(2.899em, 1001.22em, 4.627em, -999.997em); top: -4.012em; left: 0em;"><span class="mo" id="MathJax-Span-1897" style="font-family: MathJax_Size2; vertical-align: 0em;">∏</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.356em, 1001.22em, 4.423em, -999.997em); top: -2.894em; left: 0.053em;"><span class="texatom" id="MathJax-Span-1898"><span class="mrow" id="MathJax-Span-1899"><span class="mi" id="MathJax-Span-1900" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-1901" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mi" id="MathJax-Span-1902" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.305em, 1000.26em, 4.169em, -999.997em); top: -5.18em; left: 0.511em;"><span class="texatom" id="MathJax-Span-1903"><span class="mrow" id="MathJax-Span-1904"><span class="mi" id="MathJax-Span-1905" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-1906" style="padding-left: 0.155em;"><span style="display: inline-block; position: relative; width: 2.543em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.474em, -999.997em); top: -4.774em; left: 50%; margin-left: -1.217em;"><span class="mrow" id="MathJax-Span-1907"><span class="mi" id="MathJax-Span-1908" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-1909"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1910" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-1911"><span class="mrow" id="MathJax-Span-1912"><span class="mi" id="MathJax-Span-1913" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-1914" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-1915" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1001.53em, 4.474em, -999.997em); top: -3.351em; left: 50%; margin-left: -0.76em;"><span class="mrow" id="MathJax-Span-1916"><span class="mi" id="MathJax-Span-1917" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-1918"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1919" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-1920"><span class="mrow" id="MathJax-Span-1921"><span class="mi" id="MathJax-Span-1922" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.54em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.543em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="mo" id="MathJax-Span-1923" style="font-family: MathJax_Main; padding-left: 0.257em;">=</span><span class="mfrac" id="MathJax-Span-1924" style="padding-left: 0.257em;"><span style="display: inline-block; position: relative; width: 2.492em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.372em, -999.997em); top: -4.672em; left: 50%; margin-left: -1.166em;"><span class="mrow" id="MathJax-Span-1925"><span class="mi" id="MathJax-Span-1926" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-1927"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1928" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-1929"><span class="mrow" id="MathJax-Span-1930"><span class="mi" id="MathJax-Span-1931" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1932" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-1933" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1001.58em, 4.322em, -999.997em); top: -3.351em; left: 50%; margin-left: -0.81em;"><span class="mrow" id="MathJax-Span-1934"><span class="mi" id="MathJax-Span-1935" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-1936"><span style="display: inline-block; position: relative; width: 1.019em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1937" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="mi" id="MathJax-Span-1938" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.49em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.492em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="mo" id="MathJax-Span-1939" style="font-family: MathJax_Main; padding-left: 0.257em;">=</span><span class="mfrac" id="MathJax-Span-1940" style="padding-left: 0.257em;"><span style="display: inline-block; position: relative; width: 2.492em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.372em, -999.997em); top: -4.672em; left: 50%; margin-left: -1.166em;"><span class="mrow" id="MathJax-Span-1941"><span class="mi" id="MathJax-Span-1942" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-1943"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1944" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-1945"><span class="mrow" id="MathJax-Span-1946"><span class="mi" id="MathJax-Span-1947" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1948" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-1949" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1001.48em, 4.322em, -999.997em); top: -3.351em; left: 50%; margin-left: -0.709em;"><span class="mrow" id="MathJax-Span-1950"><span class="mi" id="MathJax-Span-1951" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-1952"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1953" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-1954"><span class="mrow" id="MathJax-Span-1955"><span class="mi" id="MathJax-Span-1956" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.49em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.492em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-1957"><span style="display: inline-block; position: relative; width: 2.492em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1001.48em, 4.322em, -999.997em); top: -4.672em; left: 50%; margin-left: -0.709em;"><span class="mrow" id="MathJax-Span-1958"><span class="mi" id="MathJax-Span-1959" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-1960"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1961" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-1962"><span class="mrow" id="MathJax-Span-1963"><span class="mi" id="MathJax-Span-1964" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.372em, -999.997em); top: -3.351em; left: 50%; margin-left: -1.166em;"><span class="mrow" id="MathJax-Span-1965"><span class="mi" id="MathJax-Span-1966" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-1967"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1968" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-1969"><span class="mrow" id="MathJax-Span-1970"><span class="mi" id="MathJax-Span-1971" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1972" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1973" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.49em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.492em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="mo" id="MathJax-Span-1974" style="font-family: MathJax_Main;">.</span><span class="mo" id="MathJax-Span-1975" style="font-family: MathJax_Main; padding-left: 0.155em;">.</span><span class="mo" id="MathJax-Span-1976" style="font-family: MathJax_Main; padding-left: 0.155em;">.</span><span class="mfrac" id="MathJax-Span-1977" style="padding-left: 0.155em;"><span style="display: inline-block; position: relative; width: 2.594em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1002.49em, 4.372em, -999.997em); top: -4.672em; left: 50%; margin-left: -1.217em;"><span class="mrow" id="MathJax-Span-1978"><span class="mi" id="MathJax-Span-1979" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-1980"><span style="display: inline-block; position: relative; width: 1.933em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1981" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-1982"><span class="mrow" id="MathJax-Span-1983"><span class="mi" id="MathJax-Span-1984" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-1985" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-1986" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1001.58em, 4.322em, -999.997em); top: -3.351em; left: 50%; margin-left: -0.81em;"><span class="mrow" id="MathJax-Span-1987"><span class="mi" id="MathJax-Span-1988" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-1989"><span style="display: inline-block; position: relative; width: 1.019em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1990" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="mi" id="MathJax-Span-1991" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.59em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.594em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.747em; border-left: 0px solid; width: 0px; height: 3.878em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><munderover><mo>∏</mo><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>=</mo><mi>k</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></munderover><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi></mrow></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mi>k</mi></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow></mfrac><mo>.</mo><mo>.</mo><mo>.</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mi>k</mi></msub></mrow></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-74">\prod^{t}_{j=k} \frac{\partial h_{j+1}}{\partial h_{j}} = \frac{\partial h_{t+1}}{\partial h_k} = \frac{\partial h_{t+1}}{\partial h_{t}}\frac{\partial h_{t}}{\partial h_{t-1}}...\frac{\partial h_{k+1}}{\partial h_k}</script>

<p><strong>NOTE:</strong> It turns out that the 2-norm, which you can think of it as an absolute value, of the above Jacobian matrix has an upper bound of 1. This makes intuitive sense because our tanh (or sigmoid) activation function maps all values into a range between -1 and 1, and the derivative is bounded by 1 (1/4 in the case of sigmoid) as well.</p>

<p>Let’s continue…</p>

<p>Aggregate the gradients with respect to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-75-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1992" style="width: 2.289em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.425em, 1001.83em, 2.543em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-1993"><span class="msubsup" id="MathJax-Span-1994"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1001.07em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-1995" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.968em;"><span class="texatom" id="MathJax-Span-1996"><span class="mrow" id="MathJax-Span-1997"><span class="mi" id="MathJax-Span-1998" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span class="mi" id="MathJax-Span-1999" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi><mi>h</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-75">W_{hh}</script> over the whole time-steps with backpropagation, we can finally yield the following gradient with respect to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-76-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2000" style="width: 2.289em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.425em, 1001.83em, 2.543em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-2001"><span class="msubsup" id="MathJax-Span-2002"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1001.07em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2003" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.968em;"><span class="texatom" id="MathJax-Span-2004"><span class="mrow" id="MathJax-Span-2005"><span class="mi" id="MathJax-Span-2006" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span class="mi" id="MathJax-Span-2007" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi><mi>h</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-76">W_{hh}</script>:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-77-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2008" style="width: 22.309em; display: inline-block;"><span style="display: inline-block; position: relative; width: 18.143em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(0.358em, 1018.14em, 3.61em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-2009"><span class="mfrac" id="MathJax-Span-2010"><span style="display: inline-block; position: relative; width: 2.543em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1001.22em, 4.169em, -999.997em); top: -4.672em; left: 50%; margin-left: -0.607em;"><span class="mrow" id="MathJax-Span-2011"><span class="mi" id="MathJax-Span-2012" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="mi" id="MathJax-Span-2013" style="font-family: MathJax_Math-italic;">L</span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.322em, -999.997em); top: -3.351em; left: 50%; margin-left: -1.217em;"><span class="mrow" id="MathJax-Span-2014"><span class="mi" id="MathJax-Span-2015" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-2016"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1001.07em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2017" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.968em;"><span class="texatom" id="MathJax-Span-2018"><span class="mrow" id="MathJax-Span-2019"><span class="mi" id="MathJax-Span-2020" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span class="mi" id="MathJax-Span-2021" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.54em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.543em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="mo" id="MathJax-Span-2022" style="font-family: MathJax_Main; padding-left: 0.257em;">=</span><span class="munderover" id="MathJax-Span-2023" style="padding-left: 0.257em;"><span style="display: inline-block; position: relative; width: 1.425em; height: 0px;"><span style="position: absolute; clip: rect(2.899em, 1001.37em, 4.627em, -999.997em); top: -4.012em; left: 0em;"><span class="mo" id="MathJax-Span-2024" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.407em, 1000.26em, 4.271em, -999.997em); top: -2.945em; left: 0.612em;"><span class="texatom" id="MathJax-Span-2025"><span class="mrow" id="MathJax-Span-2026"><span class="mi" id="MathJax-Span-2027" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.305em, 1000.51em, 4.169em, -999.997em); top: -5.18em; left: 0.46em;"><span class="texatom" id="MathJax-Span-2028"><span class="mrow" id="MathJax-Span-2029"><span class="mi" id="MathJax-Span-2030" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="munderover" id="MathJax-Span-2031" style="padding-left: 0.155em;"><span style="display: inline-block; position: relative; width: 1.425em; height: 0px;"><span style="position: absolute; clip: rect(2.899em, 1001.37em, 4.627em, -999.997em); top: -4.012em; left: 0em;"><span class="mo" id="MathJax-Span-2032" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.356em, 1001.22em, 4.271em, -999.997em); top: -2.894em; left: 0.104em;"><span class="texatom" id="MathJax-Span-2033"><span class="mrow" id="MathJax-Span-2034"><span class="mi" id="MathJax-Span-2035" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-2036" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-2037" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.305em, 1001.12em, 4.22em, -999.997em); top: -5.18em; left: 0.155em;"><span class="texatom" id="MathJax-Span-2038"><span class="mrow" id="MathJax-Span-2039"><span class="mi" id="MathJax-Span-2040" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2041" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2042" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-2043" style="padding-left: 0.155em;"><span style="display: inline-block; position: relative; width: 2.594em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1002.49em, 4.372em, -999.997em); top: -4.672em; left: 50%; margin-left: -1.217em;"><span class="mrow" id="MathJax-Span-2044"><span class="mi" id="MathJax-Span-2045" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-2046"><span style="display: inline-block; position: relative; width: 1.933em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1000.66em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2047" style="font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.663em;"><span class="texatom" id="MathJax-Span-2048"><span class="mrow" id="MathJax-Span-2049"><span class="mi" id="MathJax-Span-2050" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2051" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2052" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.474em, -999.997em); top: -3.3em; left: 50%; margin-left: -1.166em;"><span class="mrow" id="MathJax-Span-2053"><span class="mi" id="MathJax-Span-2054" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-2055"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.51em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="texatom" id="MathJax-Span-2056"><span class="mrow" id="MathJax-Span-2057"><span class="munderover" id="MathJax-Span-2058"><span style="display: inline-block; position: relative; width: 0.612em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.372em, -999.997em); top: -4.012em; left: 0.003em;"><span class="mi" id="MathJax-Span-2059" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1000.41em, 3.661em, -999.997em); top: -4.063em; left: 0.104em;"><span class="mo" id="MathJax-Span-2060" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.758em; left: 0.612em;"><span class="texatom" id="MathJax-Span-2061"><span class="mrow" id="MathJax-Span-2062"><span class="mi" id="MathJax-Span-2063" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2064" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2065" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.59em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.594em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-2066"><span style="display: inline-block; position: relative; width: 2.492em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.474em, -999.997em); top: -4.774em; left: 50%; margin-left: -1.166em;"><span class="mrow" id="MathJax-Span-2067"><span class="mi" id="MathJax-Span-2068" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-2069"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.51em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="texatom" id="MathJax-Span-2070"><span class="mrow" id="MathJax-Span-2071"><span class="munderover" id="MathJax-Span-2072"><span style="display: inline-block; position: relative; width: 0.612em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.372em, -999.997em); top: -4.012em; left: 0.003em;"><span class="mi" id="MathJax-Span-2073" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1000.41em, 3.661em, -999.997em); top: -4.063em; left: 0.104em;"><span class="mo" id="MathJax-Span-2074" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.758em; left: 0.612em;"><span class="texatom" id="MathJax-Span-2075"><span class="mrow" id="MathJax-Span-2076"><span class="mi" id="MathJax-Span-2077" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2078" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2079" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.372em, -999.997em); top: -3.351em; left: 50%; margin-left: -1.166em;"><span class="mrow" id="MathJax-Span-2080"><span class="mi" id="MathJax-Span-2081" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-2082"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2083" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-2084"><span class="mrow" id="MathJax-Span-2085"><span class="mi" id="MathJax-Span-2086" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2087" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2088" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.49em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.492em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-2089"><span style="display: inline-block; position: relative; width: 2.492em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.372em, -999.997em); top: -4.672em; left: 50%; margin-left: -1.166em;"><span class="mrow" id="MathJax-Span-2090"><span class="mi" id="MathJax-Span-2091" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-2092"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2093" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-2094"><span class="mrow" id="MathJax-Span-2095"><span class="mi" id="MathJax-Span-2096" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2097" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2098" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1001.58em, 4.322em, -999.997em); top: -3.351em; left: 50%; margin-left: -0.81em;"><span class="mrow" id="MathJax-Span-2099"><span class="mi" id="MathJax-Span-2100" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-2101"><span style="display: inline-block; position: relative; width: 1.019em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2102" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-2103"><span class="mrow" id="MathJax-Span-2104"><span class="mi" id="MathJax-Span-2105" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.49em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.492em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-2106"><span style="display: inline-block; position: relative; width: 2.543em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1001.58em, 4.322em, -999.997em); top: -4.672em; left: 50%; margin-left: -0.81em;"><span class="mrow" id="MathJax-Span-2107"><span class="mi" id="MathJax-Span-2108" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-2109"><span style="display: inline-block; position: relative; width: 1.019em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2110" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-2111"><span class="mrow" id="MathJax-Span-2112"><span class="mi" id="MathJax-Span-2113" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.322em, -999.997em); top: -3.351em; left: 50%; margin-left: -1.217em;"><span class="mrow" id="MathJax-Span-2114"><span class="mi" id="MathJax-Span-2115" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-2116"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1001.07em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2117" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.968em;"><span class="texatom" id="MathJax-Span-2118"><span class="mrow" id="MathJax-Span-2119"><span class="mi" id="MathJax-Span-2120" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span class="mi" id="MathJax-Span-2121" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.54em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.543em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.559em; border-left: 0px solid; width: 0px; height: 3.753em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi><mi>h</mi></mrow></msub></mrow></mfrac><mo>=</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>T</mi></mrow></munderover><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></munderover><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>L</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>k</mi></mrow></msub></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>k</mi></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi><mi>h</mi></mrow></msub></mrow></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-77">\frac{\partial L}{\partial W_{hh}} = \sum_{t}^{T} \sum_{k=1}^{t+1} \frac{\partial L_{t+1}}{\partial \hat{y}_{t+1}} \frac{\partial \hat{y}_{t+1}}{\partial h_{t+1}} \frac{\partial h_{t+1}}{\partial h_{k}}\frac{\partial h_{k}}{\partial W_{hh}}</script>

<p>Now, let’s work on to derive the gradient with respect to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-78-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2122" style="width: 2.289em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.425em, 1001.83em, 2.543em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-2123"><span class="msubsup" id="MathJax-Span-2124"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1001.07em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2125" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.968em;"><span class="texatom" id="MathJax-Span-2126"><span class="mrow" id="MathJax-Span-2127"><span class="mi" id="MathJax-Span-2128" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mi" id="MathJax-Span-2129" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mi>h</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-78">W_{xh}</script>. Similarly, we consider the time-step <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-79-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2130" style="width: 2.543em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.035em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.425em, 1001.98em, 2.492em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-2131"><span class="mi" id="MathJax-Span-2132" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2133" style="font-family: MathJax_Main; padding-left: 0.206em;">+</span><span class="mn" id="MathJax-Span-2134" style="font-family: MathJax_Main; padding-left: 0.206em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mo>+</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-79">t+1</script> (which gets only contribution from <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-80-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2135" style="width: 2.594em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.086em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.425em, 1002.09em, 2.594em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-2136"><span class="msubsup" id="MathJax-Span-2137"><span style="display: inline-block; position: relative; width: 2.086em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1000.87em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2138" style="font-family: MathJax_Math-italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.816em;"><span class="texatom" id="MathJax-Span-2139"><span class="mrow" id="MathJax-Span-2140"><span class="mi" id="MathJax-Span-2141" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2142" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2143" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>X</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-80">X_{t+1}</script>) and calculate the gradients with respect to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-81-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2144" style="width: 2.289em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.425em, 1001.83em, 2.543em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-2145"><span class="msubsup" id="MathJax-Span-2146"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1001.07em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2147" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.968em;"><span class="texatom" id="MathJax-Span-2148"><span class="mrow" id="MathJax-Span-2149"><span class="mi" id="MathJax-Span-2150" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mi" id="MathJax-Span-2151" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mi>h</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-81">W_{xh}</script> as follows:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-82-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2152" style="width: 15.196em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.35em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(0.612em, 1012.35em, 3.407em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-2153"><span class="mfrac" id="MathJax-Span-2154"><span style="display: inline-block; position: relative; width: 2.594em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1002.49em, 4.372em, -999.997em); top: -4.672em; left: 50%; margin-left: -1.217em;"><span class="mrow" id="MathJax-Span-2155"><span class="mi" id="MathJax-Span-2156" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-2157"><span style="display: inline-block; position: relative; width: 1.933em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1000.66em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2158" style="font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.663em;"><span class="texatom" id="MathJax-Span-2159"><span class="mrow" id="MathJax-Span-2160"><span class="mi" id="MathJax-Span-2161" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2162" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2163" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.322em, -999.997em); top: -3.351em; left: 50%; margin-left: -1.217em;"><span class="mrow" id="MathJax-Span-2164"><span class="mi" id="MathJax-Span-2165" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-2166"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1001.07em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2167" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.968em;"><span class="texatom" id="MathJax-Span-2168"><span class="mrow" id="MathJax-Span-2169"><span class="mi" id="MathJax-Span-2170" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mi" id="MathJax-Span-2171" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.59em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.594em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="mo" id="MathJax-Span-2172" style="font-family: MathJax_Main; padding-left: 0.257em;">=</span><span class="mfrac" id="MathJax-Span-2173" style="padding-left: 0.257em;"><span style="display: inline-block; position: relative; width: 2.594em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1002.49em, 4.372em, -999.997em); top: -4.672em; left: 50%; margin-left: -1.217em;"><span class="mrow" id="MathJax-Span-2174"><span class="mi" id="MathJax-Span-2175" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-2176"><span style="display: inline-block; position: relative; width: 1.933em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1000.66em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2177" style="font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.663em;"><span class="texatom" id="MathJax-Span-2178"><span class="mrow" id="MathJax-Span-2179"><span class="mi" id="MathJax-Span-2180" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2181" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2182" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.474em, -999.997em); top: -3.3em; left: 50%; margin-left: -1.166em;"><span class="mrow" id="MathJax-Span-2183"><span class="mi" id="MathJax-Span-2184" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-2185"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.51em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="texatom" id="MathJax-Span-2186"><span class="mrow" id="MathJax-Span-2187"><span class="munderover" id="MathJax-Span-2188"><span style="display: inline-block; position: relative; width: 0.612em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.372em, -999.997em); top: -4.012em; left: 0.003em;"><span class="mi" id="MathJax-Span-2189" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1000.41em, 3.661em, -999.997em); top: -4.063em; left: 0.104em;"><span class="mo" id="MathJax-Span-2190" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.758em; left: 0.612em;"><span class="texatom" id="MathJax-Span-2191"><span class="mrow" id="MathJax-Span-2192"><span class="mi" id="MathJax-Span-2193" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2194" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2195" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.59em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.594em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-2196"><span style="display: inline-block; position: relative; width: 2.492em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.474em, -999.997em); top: -4.774em; left: 50%; margin-left: -1.166em;"><span class="mrow" id="MathJax-Span-2197"><span class="mi" id="MathJax-Span-2198" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-2199"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.51em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="texatom" id="MathJax-Span-2200"><span class="mrow" id="MathJax-Span-2201"><span class="munderover" id="MathJax-Span-2202"><span style="display: inline-block; position: relative; width: 0.612em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.372em, -999.997em); top: -4.012em; left: 0.003em;"><span class="mi" id="MathJax-Span-2203" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1000.41em, 3.661em, -999.997em); top: -4.063em; left: 0.104em;"><span class="mo" id="MathJax-Span-2204" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.758em; left: 0.612em;"><span class="texatom" id="MathJax-Span-2205"><span class="mrow" id="MathJax-Span-2206"><span class="mi" id="MathJax-Span-2207" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2208" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2209" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.372em, -999.997em); top: -3.351em; left: 50%; margin-left: -1.166em;"><span class="mrow" id="MathJax-Span-2210"><span class="mi" id="MathJax-Span-2211" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-2212"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2213" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-2214"><span class="mrow" id="MathJax-Span-2215"><span class="mi" id="MathJax-Span-2216" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2217" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2218" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.49em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.492em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-2219"><span style="display: inline-block; position: relative; width: 2.543em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.372em, -999.997em); top: -4.672em; left: 50%; margin-left: -1.166em;"><span class="mrow" id="MathJax-Span-2220"><span class="mi" id="MathJax-Span-2221" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-2222"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2223" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-2224"><span class="mrow" id="MathJax-Span-2225"><span class="mi" id="MathJax-Span-2226" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2227" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2228" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.322em, -999.997em); top: -3.351em; left: 50%; margin-left: -1.217em;"><span class="mrow" id="MathJax-Span-2229"><span class="mi" id="MathJax-Span-2230" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-2231"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1001.07em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2232" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.968em;"><span class="texatom" id="MathJax-Span-2233"><span class="mrow" id="MathJax-Span-2234"><span class="mi" id="MathJax-Span-2235" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mi" id="MathJax-Span-2236" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.54em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.543em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.309em; border-left: 0px solid; width: 0px; height: 3.191em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>L</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mi>h</mi></mrow></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>L</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mi>h</mi></mrow></msub></mrow></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-82">\frac{\partial L_{t+1}}{\partial W_{xh}} = \frac{\partial L_{t+1}}{\partial \hat{y}_{t+1}} \frac{\partial \hat{y}_{t+1}}{\partial h_{t+1}}\frac{\partial h_{t+1}}{\partial W_{xh}}</script>

<p>Because <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-83-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2237" style="width: 1.12em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.374em, 1000.92em, 2.543em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-2238"><span class="msubsup" id="MathJax-Span-2239"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2240" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-2241"><span class="mrow" id="MathJax-Span-2242"><span class="mi" id="MathJax-Span-2243" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-83">h_{t}</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-84-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2244" style="width: 2.594em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.086em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.425em, 1002.09em, 2.594em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-2245"><span class="msubsup" id="MathJax-Span-2246"><span style="display: inline-block; position: relative; width: 2.086em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1000.87em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2247" style="font-family: MathJax_Math-italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.816em;"><span class="texatom" id="MathJax-Span-2248"><span class="mrow" id="MathJax-Span-2249"><span class="mi" id="MathJax-Span-2250" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2251" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2252" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>X</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-84">X_{t+1}</script> both make contribution to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-85-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2253" style="width: 2.289em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.374em, 1001.83em, 2.594em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-2254"><span class="msubsup" id="MathJax-Span-2255"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2256" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-2257"><span class="mrow" id="MathJax-Span-2258"><span class="mi" id="MathJax-Span-2259" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2260" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2261" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-85">h_{t+1}</script>, we need to backpropagate to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-86-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2262" style="width: 1.12em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.374em, 1000.92em, 2.543em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-2263"><span class="msubsup" id="MathJax-Span-2264"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2265" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-2266"><span class="mrow" id="MathJax-Span-2267"><span class="mi" id="MathJax-Span-2268" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-86">h_{t}</script> as well.</p>

<p>If we consider the contribution from the time-step, we can further get:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-87-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2269" style="width: 30.135em; display: inline-block;"><span style="display: inline-block; position: relative; width: 24.494em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(0.612em, 1024.49em, 3.407em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-2270"><span class="mfrac" id="MathJax-Span-2271"><span style="display: inline-block; position: relative; width: 2.594em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1002.49em, 4.372em, -999.997em); top: -4.672em; left: 50%; margin-left: -1.217em;"><span class="mrow" id="MathJax-Span-2272"><span class="mi" id="MathJax-Span-2273" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-2274"><span style="display: inline-block; position: relative; width: 1.933em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1000.66em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2275" style="font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.663em;"><span class="texatom" id="MathJax-Span-2276"><span class="mrow" id="MathJax-Span-2277"><span class="mi" id="MathJax-Span-2278" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2279" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2280" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.322em, -999.997em); top: -3.351em; left: 50%; margin-left: -1.217em;"><span class="mrow" id="MathJax-Span-2281"><span class="mi" id="MathJax-Span-2282" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-2283"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1001.07em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2284" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.968em;"><span class="texatom" id="MathJax-Span-2285"><span class="mrow" id="MathJax-Span-2286"><span class="mi" id="MathJax-Span-2287" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mi" id="MathJax-Span-2288" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.59em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.594em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="mo" id="MathJax-Span-2289" style="font-family: MathJax_Main; padding-left: 0.257em;">=</span><span class="mfrac" id="MathJax-Span-2290" style="padding-left: 0.257em;"><span style="display: inline-block; position: relative; width: 2.594em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1002.49em, 4.372em, -999.997em); top: -4.672em; left: 50%; margin-left: -1.217em;"><span class="mrow" id="MathJax-Span-2291"><span class="mi" id="MathJax-Span-2292" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-2293"><span style="display: inline-block; position: relative; width: 1.933em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1000.66em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2294" style="font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.663em;"><span class="texatom" id="MathJax-Span-2295"><span class="mrow" id="MathJax-Span-2296"><span class="mi" id="MathJax-Span-2297" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2298" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2299" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.474em, -999.997em); top: -3.3em; left: 50%; margin-left: -1.166em;"><span class="mrow" id="MathJax-Span-2300"><span class="mi" id="MathJax-Span-2301" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-2302"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.51em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="texatom" id="MathJax-Span-2303"><span class="mrow" id="MathJax-Span-2304"><span class="munderover" id="MathJax-Span-2305"><span style="display: inline-block; position: relative; width: 0.612em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.372em, -999.997em); top: -4.012em; left: 0.003em;"><span class="mi" id="MathJax-Span-2306" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1000.41em, 3.661em, -999.997em); top: -4.063em; left: 0.104em;"><span class="mo" id="MathJax-Span-2307" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.758em; left: 0.612em;"><span class="texatom" id="MathJax-Span-2308"><span class="mrow" id="MathJax-Span-2309"><span class="mi" id="MathJax-Span-2310" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2311" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2312" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.59em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.594em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-2313"><span style="display: inline-block; position: relative; width: 2.492em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.474em, -999.997em); top: -4.774em; left: 50%; margin-left: -1.166em;"><span class="mrow" id="MathJax-Span-2314"><span class="mi" id="MathJax-Span-2315" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-2316"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.51em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="texatom" id="MathJax-Span-2317"><span class="mrow" id="MathJax-Span-2318"><span class="munderover" id="MathJax-Span-2319"><span style="display: inline-block; position: relative; width: 0.612em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.372em, -999.997em); top: -4.012em; left: 0.003em;"><span class="mi" id="MathJax-Span-2320" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1000.41em, 3.661em, -999.997em); top: -4.063em; left: 0.104em;"><span class="mo" id="MathJax-Span-2321" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.758em; left: 0.612em;"><span class="texatom" id="MathJax-Span-2322"><span class="mrow" id="MathJax-Span-2323"><span class="mi" id="MathJax-Span-2324" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2325" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2326" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.372em, -999.997em); top: -3.351em; left: 50%; margin-left: -1.166em;"><span class="mrow" id="MathJax-Span-2327"><span class="mi" id="MathJax-Span-2328" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-2329"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2330" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-2331"><span class="mrow" id="MathJax-Span-2332"><span class="mi" id="MathJax-Span-2333" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2334" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2335" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.49em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.492em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-2336"><span style="display: inline-block; position: relative; width: 2.543em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.372em, -999.997em); top: -4.672em; left: 50%; margin-left: -1.166em;"><span class="mrow" id="MathJax-Span-2337"><span class="mi" id="MathJax-Span-2338" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-2339"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2340" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-2341"><span class="mrow" id="MathJax-Span-2342"><span class="mi" id="MathJax-Span-2343" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2344" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2345" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.322em, -999.997em); top: -3.351em; left: 50%; margin-left: -1.217em;"><span class="mrow" id="MathJax-Span-2346"><span class="mi" id="MathJax-Span-2347" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-2348"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1001.07em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2349" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.968em;"><span class="texatom" id="MathJax-Span-2350"><span class="mrow" id="MathJax-Span-2351"><span class="mi" id="MathJax-Span-2352" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mi" id="MathJax-Span-2353" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.54em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.543em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="mo" id="MathJax-Span-2354" style="font-family: MathJax_Main; padding-left: 0.206em;">+</span><span class="mfrac" id="MathJax-Span-2355" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 2.594em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1002.49em, 4.372em, -999.997em); top: -4.672em; left: 50%; margin-left: -1.217em;"><span class="mrow" id="MathJax-Span-2356"><span class="mi" id="MathJax-Span-2357" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-2358"><span style="display: inline-block; position: relative; width: 1.933em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1000.66em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2359" style="font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.663em;"><span class="texatom" id="MathJax-Span-2360"><span class="mrow" id="MathJax-Span-2361"><span class="mi" id="MathJax-Span-2362" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2363" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2364" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.474em, -999.997em); top: -3.3em; left: 50%; margin-left: -1.166em;"><span class="mrow" id="MathJax-Span-2365"><span class="mi" id="MathJax-Span-2366" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-2367"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.51em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="texatom" id="MathJax-Span-2368"><span class="mrow" id="MathJax-Span-2369"><span class="munderover" id="MathJax-Span-2370"><span style="display: inline-block; position: relative; width: 0.612em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.372em, -999.997em); top: -4.012em; left: 0.003em;"><span class="mi" id="MathJax-Span-2371" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1000.41em, 3.661em, -999.997em); top: -4.063em; left: 0.104em;"><span class="mo" id="MathJax-Span-2372" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.758em; left: 0.612em;"><span class="texatom" id="MathJax-Span-2373"><span class="mrow" id="MathJax-Span-2374"><span class="mi" id="MathJax-Span-2375" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2376" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2377" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.59em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.594em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-2378"><span style="display: inline-block; position: relative; width: 2.492em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.474em, -999.997em); top: -4.774em; left: 50%; margin-left: -1.166em;"><span class="mrow" id="MathJax-Span-2379"><span class="mi" id="MathJax-Span-2380" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-2381"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.51em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="texatom" id="MathJax-Span-2382"><span class="mrow" id="MathJax-Span-2383"><span class="munderover" id="MathJax-Span-2384"><span style="display: inline-block; position: relative; width: 0.612em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.372em, -999.997em); top: -4.012em; left: 0.003em;"><span class="mi" id="MathJax-Span-2385" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1000.41em, 3.661em, -999.997em); top: -4.063em; left: 0.104em;"><span class="mo" id="MathJax-Span-2386" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.758em; left: 0.612em;"><span class="texatom" id="MathJax-Span-2387"><span class="mrow" id="MathJax-Span-2388"><span class="mi" id="MathJax-Span-2389" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2390" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2391" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.372em, -999.997em); top: -3.351em; left: 50%; margin-left: -1.166em;"><span class="mrow" id="MathJax-Span-2392"><span class="mi" id="MathJax-Span-2393" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-2394"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2395" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-2396"><span class="mrow" id="MathJax-Span-2397"><span class="mi" id="MathJax-Span-2398" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2399" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2400" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.49em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.492em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-2401"><span style="display: inline-block; position: relative; width: 2.492em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.372em, -999.997em); top: -4.672em; left: 50%; margin-left: -1.166em;"><span class="mrow" id="MathJax-Span-2402"><span class="mi" id="MathJax-Span-2403" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-2404"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2405" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-2406"><span class="mrow" id="MathJax-Span-2407"><span class="mi" id="MathJax-Span-2408" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2409" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2410" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1001.48em, 4.322em, -999.997em); top: -3.351em; left: 50%; margin-left: -0.709em;"><span class="mrow" id="MathJax-Span-2411"><span class="mi" id="MathJax-Span-2412" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-2413"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2414" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-2415"><span class="mrow" id="MathJax-Span-2416"><span class="mi" id="MathJax-Span-2417" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.49em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.492em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-2418"><span style="display: inline-block; position: relative; width: 2.543em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1001.48em, 4.322em, -999.997em); top: -4.672em; left: 50%; margin-left: -0.709em;"><span class="mrow" id="MathJax-Span-2419"><span class="mi" id="MathJax-Span-2420" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-2421"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2422" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-2423"><span class="mrow" id="MathJax-Span-2424"><span class="mi" id="MathJax-Span-2425" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.322em, -999.997em); top: -3.351em; left: 50%; margin-left: -1.217em;"><span class="mrow" id="MathJax-Span-2426"><span class="mi" id="MathJax-Span-2427" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-2428"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1001.07em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2429" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.968em;"><span class="texatom" id="MathJax-Span-2430"><span class="mrow" id="MathJax-Span-2431"><span class="mi" id="MathJax-Span-2432" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mi" id="MathJax-Span-2433" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.54em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.543em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.309em; border-left: 0px solid; width: 0px; height: 3.191em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>L</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mi>h</mi></mrow></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>L</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mi>h</mi></mrow></msub></mrow></mfrac><mo>+</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>L</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mi>h</mi></mrow></msub></mrow></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-87">\frac{\partial L_{t+1}}{\partial W_{xh}} = \frac{\partial L_{t+1}}{\partial \hat{y}_{t+1}} \frac{\partial \hat{y}_{t+1}}{\partial h_{t+1}}\frac{\partial h_{t+1}}{\partial W_{xh}}  + \frac{\partial L_{t+1}}{\partial \hat{y}_{t+1}} \frac{\partial \hat{y}_{t+1}}{\partial h_{t+1}}\frac{\partial h_{t+1}}{\partial  h_{t}} \frac{\partial h_{t}}{\partial W_{xh}}</script>

<p>Thus, summing up all the contributions from <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-88-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2434" style="width: 2.543em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.035em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.425em, 1001.98em, 2.492em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-2435"><span class="mi" id="MathJax-Span-2436" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2437" style="font-family: MathJax_Main; padding-left: 0.206em;">+</span><span class="mn" id="MathJax-Span-2438" style="font-family: MathJax_Main; padding-left: 0.206em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mo>+</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-88">t+1</script> to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-89-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2439" style="width: 0.663em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.511em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.425em, 1000.46em, 2.391em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-2440"><span class="mn" id="MathJax-Span-2441" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-89">1</script> via Backpropagation, we can yield the gradient at the time-step <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-90-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2442" style="width: 2.543em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.035em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.425em, 1001.98em, 2.492em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-2443"><span class="mi" id="MathJax-Span-2444" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2445" style="font-family: MathJax_Main; padding-left: 0.206em;">+</span><span class="mn" id="MathJax-Span-2446" style="font-family: MathJax_Main; padding-left: 0.206em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mo>+</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-90">t+1</script>:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-91-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2447" style="width: 20.48em; display: inline-block;"><span style="display: inline-block; position: relative; width: 16.618em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(0.358em, 1016.62em, 3.61em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-2448"><span class="mfrac" id="MathJax-Span-2449"><span style="display: inline-block; position: relative; width: 2.594em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1002.49em, 4.372em, -999.997em); top: -4.672em; left: 50%; margin-left: -1.217em;"><span class="mrow" id="MathJax-Span-2450"><span class="mi" id="MathJax-Span-2451" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-2452"><span style="display: inline-block; position: relative; width: 1.933em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1000.66em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2453" style="font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.663em;"><span class="texatom" id="MathJax-Span-2454"><span class="mrow" id="MathJax-Span-2455"><span class="mi" id="MathJax-Span-2456" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2457" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2458" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.322em, -999.997em); top: -3.351em; left: 50%; margin-left: -1.217em;"><span class="mrow" id="MathJax-Span-2459"><span class="mi" id="MathJax-Span-2460" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-2461"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1001.07em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2462" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.968em;"><span class="texatom" id="MathJax-Span-2463"><span class="mrow" id="MathJax-Span-2464"><span class="mi" id="MathJax-Span-2465" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mi" id="MathJax-Span-2466" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.59em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.594em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="mo" id="MathJax-Span-2467" style="font-family: MathJax_Main; padding-left: 0.257em;">=</span><span class="munderover" id="MathJax-Span-2468" style="padding-left: 0.257em;"><span style="display: inline-block; position: relative; width: 1.425em; height: 0px;"><span style="position: absolute; clip: rect(2.899em, 1001.37em, 4.627em, -999.997em); top: -4.012em; left: 0em;"><span class="mo" id="MathJax-Span-2469" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.356em, 1001.22em, 4.271em, -999.997em); top: -2.894em; left: 0.104em;"><span class="texatom" id="MathJax-Span-2470"><span class="mrow" id="MathJax-Span-2471"><span class="mi" id="MathJax-Span-2472" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-2473" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-2474" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.305em, 1001.12em, 4.22em, -999.997em); top: -5.18em; left: 0.155em;"><span class="texatom" id="MathJax-Span-2475"><span class="mrow" id="MathJax-Span-2476"><span class="mi" id="MathJax-Span-2477" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2478" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2479" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-2480" style="padding-left: 0.155em;"><span style="display: inline-block; position: relative; width: 2.594em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1002.49em, 4.372em, -999.997em); top: -4.672em; left: 50%; margin-left: -1.217em;"><span class="mrow" id="MathJax-Span-2481"><span class="mi" id="MathJax-Span-2482" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-2483"><span style="display: inline-block; position: relative; width: 1.933em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1000.66em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2484" style="font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.663em;"><span class="texatom" id="MathJax-Span-2485"><span class="mrow" id="MathJax-Span-2486"><span class="mi" id="MathJax-Span-2487" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2488" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2489" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.474em, -999.997em); top: -3.3em; left: 50%; margin-left: -1.166em;"><span class="mrow" id="MathJax-Span-2490"><span class="mi" id="MathJax-Span-2491" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-2492"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.51em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="texatom" id="MathJax-Span-2493"><span class="mrow" id="MathJax-Span-2494"><span class="munderover" id="MathJax-Span-2495"><span style="display: inline-block; position: relative; width: 0.612em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.372em, -999.997em); top: -4.012em; left: 0.003em;"><span class="mi" id="MathJax-Span-2496" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1000.41em, 3.661em, -999.997em); top: -4.063em; left: 0.104em;"><span class="mo" id="MathJax-Span-2497" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.758em; left: 0.612em;"><span class="texatom" id="MathJax-Span-2498"><span class="mrow" id="MathJax-Span-2499"><span class="mi" id="MathJax-Span-2500" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2501" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2502" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.59em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.594em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-2503"><span style="display: inline-block; position: relative; width: 2.492em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.474em, -999.997em); top: -4.774em; left: 50%; margin-left: -1.166em;"><span class="mrow" id="MathJax-Span-2504"><span class="mi" id="MathJax-Span-2505" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-2506"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.51em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="texatom" id="MathJax-Span-2507"><span class="mrow" id="MathJax-Span-2508"><span class="munderover" id="MathJax-Span-2509"><span style="display: inline-block; position: relative; width: 0.612em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.372em, -999.997em); top: -4.012em; left: 0.003em;"><span class="mi" id="MathJax-Span-2510" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1000.41em, 3.661em, -999.997em); top: -4.063em; left: 0.104em;"><span class="mo" id="MathJax-Span-2511" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.758em; left: 0.612em;"><span class="texatom" id="MathJax-Span-2512"><span class="mrow" id="MathJax-Span-2513"><span class="mi" id="MathJax-Span-2514" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2515" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2516" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.372em, -999.997em); top: -3.351em; left: 50%; margin-left: -1.166em;"><span class="mrow" id="MathJax-Span-2517"><span class="mi" id="MathJax-Span-2518" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-2519"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2520" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-2521"><span class="mrow" id="MathJax-Span-2522"><span class="mi" id="MathJax-Span-2523" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2524" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2525" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.49em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.492em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-2526"><span style="display: inline-block; position: relative; width: 2.492em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.372em, -999.997em); top: -4.672em; left: 50%; margin-left: -1.166em;"><span class="mrow" id="MathJax-Span-2527"><span class="mi" id="MathJax-Span-2528" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-2529"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2530" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-2531"><span class="mrow" id="MathJax-Span-2532"><span class="mi" id="MathJax-Span-2533" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2534" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2535" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1001.58em, 4.322em, -999.997em); top: -3.351em; left: 50%; margin-left: -0.81em;"><span class="mrow" id="MathJax-Span-2536"><span class="mi" id="MathJax-Span-2537" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-2538"><span style="display: inline-block; position: relative; width: 1.019em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2539" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-2540"><span class="mrow" id="MathJax-Span-2541"><span class="mi" id="MathJax-Span-2542" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.49em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.492em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-2543"><span style="display: inline-block; position: relative; width: 2.543em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1001.58em, 4.322em, -999.997em); top: -4.672em; left: 50%; margin-left: -0.81em;"><span class="mrow" id="MathJax-Span-2544"><span class="mi" id="MathJax-Span-2545" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-2546"><span style="display: inline-block; position: relative; width: 1.019em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2547" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-2548"><span class="mrow" id="MathJax-Span-2549"><span class="mi" id="MathJax-Span-2550" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.322em, -999.997em); top: -3.351em; left: 50%; margin-left: -1.217em;"><span class="mrow" id="MathJax-Span-2551"><span class="mi" id="MathJax-Span-2552" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-2553"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1001.07em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2554" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.968em;"><span class="texatom" id="MathJax-Span-2555"><span class="mrow" id="MathJax-Span-2556"><span class="mi" id="MathJax-Span-2557" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mi" id="MathJax-Span-2558" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.54em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.543em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.559em; border-left: 0px solid; width: 0px; height: 3.753em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>L</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mi>h</mi></mrow></msub></mrow></mfrac><mo>=</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></munderover><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>L</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>k</mi></mrow></msub></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>k</mi></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mi>h</mi></mrow></msub></mrow></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-91">\frac{\partial L_{t+1}}{\partial W_{xh}} = \sum_{k=1}^{t+1} \frac{\partial L_{t+1}}{\partial \hat{y}_{t+1}} \frac{\partial \hat{y}_{t+1}}{\partial h_{t+1}}\frac{\partial h_{t+1}}{\partial h_{k}} \frac{\partial h_{k}}{\partial W_{xh}}</script>

<p>Further, we can take the derivative with respect to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-92-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2559" style="width: 2.289em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.425em, 1001.83em, 2.543em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-2560"><span class="msubsup" id="MathJax-Span-2561"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1001.07em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2562" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.968em;"><span class="texatom" id="MathJax-Span-2563"><span class="mrow" id="MathJax-Span-2564"><span class="mi" id="MathJax-Span-2565" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mi" id="MathJax-Span-2566" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mi>h</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-92">W_{xh}</script> over the whole sequence as :</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-93-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2567" style="width: 22.309em; display: inline-block;"><span style="display: inline-block; position: relative; width: 18.143em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(0.358em, 1018.14em, 3.61em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-2568"><span class="mfrac" id="MathJax-Span-2569"><span style="display: inline-block; position: relative; width: 2.543em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1001.22em, 4.169em, -999.997em); top: -4.672em; left: 50%; margin-left: -0.607em;"><span class="mrow" id="MathJax-Span-2570"><span class="mi" id="MathJax-Span-2571" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="mi" id="MathJax-Span-2572" style="font-family: MathJax_Math-italic;">L</span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.322em, -999.997em); top: -3.351em; left: 50%; margin-left: -1.217em;"><span class="mrow" id="MathJax-Span-2573"><span class="mi" id="MathJax-Span-2574" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-2575"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1001.07em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2576" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.968em;"><span class="texatom" id="MathJax-Span-2577"><span class="mrow" id="MathJax-Span-2578"><span class="mi" id="MathJax-Span-2579" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mi" id="MathJax-Span-2580" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.54em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.543em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="mo" id="MathJax-Span-2581" style="font-family: MathJax_Main; padding-left: 0.257em;">=</span><span class="munderover" id="MathJax-Span-2582" style="padding-left: 0.257em;"><span style="display: inline-block; position: relative; width: 1.425em; height: 0px;"><span style="position: absolute; clip: rect(2.899em, 1001.37em, 4.627em, -999.997em); top: -4.012em; left: 0em;"><span class="mo" id="MathJax-Span-2583" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.407em, 1000.26em, 4.271em, -999.997em); top: -2.945em; left: 0.612em;"><span class="texatom" id="MathJax-Span-2584"><span class="mrow" id="MathJax-Span-2585"><span class="mi" id="MathJax-Span-2586" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.305em, 1000.51em, 4.169em, -999.997em); top: -5.18em; left: 0.46em;"><span class="texatom" id="MathJax-Span-2587"><span class="mrow" id="MathJax-Span-2588"><span class="mi" id="MathJax-Span-2589" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="munderover" id="MathJax-Span-2590" style="padding-left: 0.155em;"><span style="display: inline-block; position: relative; width: 1.425em; height: 0px;"><span style="position: absolute; clip: rect(2.899em, 1001.37em, 4.627em, -999.997em); top: -4.012em; left: 0em;"><span class="mo" id="MathJax-Span-2591" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.356em, 1001.22em, 4.271em, -999.997em); top: -2.894em; left: 0.104em;"><span class="texatom" id="MathJax-Span-2592"><span class="mrow" id="MathJax-Span-2593"><span class="mi" id="MathJax-Span-2594" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-2595" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-2596" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.305em, 1001.12em, 4.22em, -999.997em); top: -5.18em; left: 0.155em;"><span class="texatom" id="MathJax-Span-2597"><span class="mrow" id="MathJax-Span-2598"><span class="mi" id="MathJax-Span-2599" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2600" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2601" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-2602" style="padding-left: 0.155em;"><span style="display: inline-block; position: relative; width: 2.594em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1002.49em, 4.372em, -999.997em); top: -4.672em; left: 50%; margin-left: -1.217em;"><span class="mrow" id="MathJax-Span-2603"><span class="mi" id="MathJax-Span-2604" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-2605"><span style="display: inline-block; position: relative; width: 1.933em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1000.66em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2606" style="font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.663em;"><span class="texatom" id="MathJax-Span-2607"><span class="mrow" id="MathJax-Span-2608"><span class="mi" id="MathJax-Span-2609" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2610" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2611" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.474em, -999.997em); top: -3.3em; left: 50%; margin-left: -1.166em;"><span class="mrow" id="MathJax-Span-2612"><span class="mi" id="MathJax-Span-2613" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-2614"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.51em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="texatom" id="MathJax-Span-2615"><span class="mrow" id="MathJax-Span-2616"><span class="munderover" id="MathJax-Span-2617"><span style="display: inline-block; position: relative; width: 0.612em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.372em, -999.997em); top: -4.012em; left: 0.003em;"><span class="mi" id="MathJax-Span-2618" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1000.41em, 3.661em, -999.997em); top: -4.063em; left: 0.104em;"><span class="mo" id="MathJax-Span-2619" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.758em; left: 0.612em;"><span class="texatom" id="MathJax-Span-2620"><span class="mrow" id="MathJax-Span-2621"><span class="mi" id="MathJax-Span-2622" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2623" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2624" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.59em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.594em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-2625"><span style="display: inline-block; position: relative; width: 2.492em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.474em, -999.997em); top: -4.774em; left: 50%; margin-left: -1.166em;"><span class="mrow" id="MathJax-Span-2626"><span class="mi" id="MathJax-Span-2627" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-2628"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.51em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="texatom" id="MathJax-Span-2629"><span class="mrow" id="MathJax-Span-2630"><span class="munderover" id="MathJax-Span-2631"><span style="display: inline-block; position: relative; width: 0.612em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.372em, -999.997em); top: -4.012em; left: 0.003em;"><span class="mi" id="MathJax-Span-2632" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1000.41em, 3.661em, -999.997em); top: -4.063em; left: 0.104em;"><span class="mo" id="MathJax-Span-2633" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.758em; left: 0.612em;"><span class="texatom" id="MathJax-Span-2634"><span class="mrow" id="MathJax-Span-2635"><span class="mi" id="MathJax-Span-2636" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2637" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2638" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.372em, -999.997em); top: -3.351em; left: 50%; margin-left: -1.166em;"><span class="mrow" id="MathJax-Span-2639"><span class="mi" id="MathJax-Span-2640" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-2641"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2642" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-2643"><span class="mrow" id="MathJax-Span-2644"><span class="mi" id="MathJax-Span-2645" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2646" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2647" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.49em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.492em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-2648"><span style="display: inline-block; position: relative; width: 2.492em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.372em, -999.997em); top: -4.672em; left: 50%; margin-left: -1.166em;"><span class="mrow" id="MathJax-Span-2649"><span class="mi" id="MathJax-Span-2650" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-2651"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2652" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-2653"><span class="mrow" id="MathJax-Span-2654"><span class="mi" id="MathJax-Span-2655" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2656" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2657" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1001.58em, 4.322em, -999.997em); top: -3.351em; left: 50%; margin-left: -0.81em;"><span class="mrow" id="MathJax-Span-2658"><span class="mi" id="MathJax-Span-2659" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-2660"><span style="display: inline-block; position: relative; width: 1.019em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2661" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-2662"><span class="mrow" id="MathJax-Span-2663"><span class="mi" id="MathJax-Span-2664" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.49em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.492em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-2665"><span style="display: inline-block; position: relative; width: 2.543em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1001.58em, 4.322em, -999.997em); top: -4.672em; left: 50%; margin-left: -0.81em;"><span class="mrow" id="MathJax-Span-2666"><span class="mi" id="MathJax-Span-2667" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-2668"><span style="display: inline-block; position: relative; width: 1.019em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2669" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-2670"><span class="mrow" id="MathJax-Span-2671"><span class="mi" id="MathJax-Span-2672" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.322em, -999.997em); top: -3.351em; left: 50%; margin-left: -1.217em;"><span class="mrow" id="MathJax-Span-2673"><span class="mi" id="MathJax-Span-2674" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-2675"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1001.07em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2676" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.968em;"><span class="texatom" id="MathJax-Span-2677"><span class="mrow" id="MathJax-Span-2678"><span class="mi" id="MathJax-Span-2679" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mi" id="MathJax-Span-2680" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.54em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.543em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.559em; border-left: 0px solid; width: 0px; height: 3.753em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mi>h</mi></mrow></msub></mrow></mfrac><mo>=</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>T</mi></mrow></munderover><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></munderover><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>L</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>k</mi></mrow></msub></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>k</mi></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mi>h</mi></mrow></msub></mrow></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-93">\frac{\partial L} {\partial W_{xh}} = \sum_{t}^{T} \sum_{k=1}^{t+1} \frac{\partial L_{t+1}}{\partial \hat{y}_{t+1}} \frac{\partial \hat{y}_{t+1}}{\partial h_{t+1}} \frac{\partial h_{t+1}}{\partial h_{k}} \frac{\partial h_{k}}{\partial W_{xh}}</script>

<p>Do not forget that <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-94-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2681" style="width: 2.442em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.984em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.019em, 1001.98em, 2.899em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-2682"><span class="mfrac" id="MathJax-Span-2683"><span style="display: inline-block; position: relative; width: 1.781em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.356em, 1001.68em, 4.322em, -999.997em); top: -4.571em; left: 50%; margin-left: -0.861em;"><span class="mrow" id="MathJax-Span-2684"><span class="mi" id="MathJax-Span-2685" style="font-size: 70.7%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-2686"><span style="display: inline-block; position: relative; width: 1.273em; height: 0px;"><span style="position: absolute; clip: rect(3.356em, 1000.41em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2687" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.91em; left: 0.409em;"><span class="texatom" id="MathJax-Span-2688"><span class="mrow" id="MathJax-Span-2689"><span class="mi" id="MathJax-Span-2690" style="font-size: 50%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2691" style="font-size: 50%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2692" style="font-size: 50%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.356em, 1001.12em, 4.271em, -999.997em); top: -3.605em; left: 50%; margin-left: -0.556em;"><span class="mrow" id="MathJax-Span-2693"><span class="mi" id="MathJax-Span-2694" style="font-size: 70.7%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-2695"><span style="display: inline-block; position: relative; width: 0.714em; height: 0px;"><span style="position: absolute; clip: rect(3.356em, 1000.41em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2696" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.91em; left: 0.409em;"><span class="texatom" id="MathJax-Span-2697"><span class="mrow" id="MathJax-Span-2698"><span class="mi" id="MathJax-Span-2699" style="font-size: 50%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1001.78em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.781em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.684em; border-left: 0px solid; width: 0px; height: 2.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>k</mi></mrow></msub></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-94">\frac{\partial h_{t+1}}{\partial h_{k}}</script> is a chain rule in itself, again!</p>

<h1 id="vanishingexploding-gradients-with-vanilla-rnns">Vanishing/Exploding Gradients with vanilla RNNs</h1>

<p>There are two factors that affect the magnitude of gradients - the weights and the activation functions (or more precisely, their derivatives) that the gradient passes through. In vanilla RNNs, vanishing/exploding gradient comes from the repeated application of the recurrent connections. More explicitly, they happen because of recursive derivative we need to compute <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-95-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2700" style="width: 2.442em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.984em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.019em, 1001.98em, 2.899em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-2701"><span class="mfrac" id="MathJax-Span-2702"><span style="display: inline-block; position: relative; width: 1.781em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.356em, 1001.68em, 4.322em, -999.997em); top: -4.571em; left: 50%; margin-left: -0.861em;"><span class="mrow" id="MathJax-Span-2703"><span class="mi" id="MathJax-Span-2704" style="font-size: 70.7%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-2705"><span style="display: inline-block; position: relative; width: 1.273em; height: 0px;"><span style="position: absolute; clip: rect(3.356em, 1000.41em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2706" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.91em; left: 0.409em;"><span class="texatom" id="MathJax-Span-2707"><span class="mrow" id="MathJax-Span-2708"><span class="mi" id="MathJax-Span-2709" style="font-size: 50%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2710" style="font-size: 50%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2711" style="font-size: 50%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.356em, 1001.12em, 4.271em, -999.997em); top: -3.605em; left: 50%; margin-left: -0.556em;"><span class="mrow" id="MathJax-Span-2712"><span class="mi" id="MathJax-Span-2713" style="font-size: 70.7%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-2714"><span style="display: inline-block; position: relative; width: 0.714em; height: 0px;"><span style="position: absolute; clip: rect(3.356em, 1000.41em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2715" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.91em; left: 0.409em;"><span class="mi" id="MathJax-Span-2716" style="font-size: 50%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1001.78em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.781em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.684em; border-left: 0px solid; width: 0px; height: 2.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mi>k</mi></msub></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-95">\frac{\partial h_{t+1}}{\partial h_k}</script>:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-96-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x220F;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2717" style="width: 23.326em; display: inline-block;"><span style="display: inline-block; position: relative; width: 18.956em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(0.409em, 1018.96em, 3.763em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-2718"><span class="munderover" id="MathJax-Span-2719"><span style="display: inline-block; position: relative; width: 1.273em; height: 0px;"><span style="position: absolute; clip: rect(2.899em, 1001.22em, 4.627em, -999.997em); top: -4.012em; left: 0em;"><span class="mo" id="MathJax-Span-2720" style="font-family: MathJax_Size2; vertical-align: 0em;">∏</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.356em, 1001.22em, 4.423em, -999.997em); top: -2.894em; left: 0.053em;"><span class="texatom" id="MathJax-Span-2721"><span class="mrow" id="MathJax-Span-2722"><span class="mi" id="MathJax-Span-2723" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-2724" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mi" id="MathJax-Span-2725" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.305em, 1000.26em, 4.169em, -999.997em); top: -5.18em; left: 0.511em;"><span class="texatom" id="MathJax-Span-2726"><span class="mrow" id="MathJax-Span-2727"><span class="mi" id="MathJax-Span-2728" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-2729" style="padding-left: 0.155em;"><span style="display: inline-block; position: relative; width: 2.543em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.474em, -999.997em); top: -4.774em; left: 50%; margin-left: -1.217em;"><span class="mrow" id="MathJax-Span-2730"><span class="mi" id="MathJax-Span-2731" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-2732"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2733" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-2734"><span class="mrow" id="MathJax-Span-2735"><span class="mi" id="MathJax-Span-2736" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-2737" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2738" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1001.53em, 4.474em, -999.997em); top: -3.351em; left: 50%; margin-left: -0.76em;"><span class="mrow" id="MathJax-Span-2739"><span class="mi" id="MathJax-Span-2740" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-2741"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2742" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-2743"><span class="mrow" id="MathJax-Span-2744"><span class="mi" id="MathJax-Span-2745" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.54em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.543em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="mo" id="MathJax-Span-2746" style="font-family: MathJax_Main; padding-left: 0.257em;">=</span><span class="mfrac" id="MathJax-Span-2747" style="padding-left: 0.257em;"><span style="display: inline-block; position: relative; width: 2.492em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.372em, -999.997em); top: -4.672em; left: 50%; margin-left: -1.166em;"><span class="mrow" id="MathJax-Span-2748"><span class="mi" id="MathJax-Span-2749" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-2750"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2751" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-2752"><span class="mrow" id="MathJax-Span-2753"><span class="mi" id="MathJax-Span-2754" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2755" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2756" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1001.58em, 4.322em, -999.997em); top: -3.351em; left: 50%; margin-left: -0.81em;"><span class="mrow" id="MathJax-Span-2757"><span class="mi" id="MathJax-Span-2758" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-2759"><span style="display: inline-block; position: relative; width: 1.019em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2760" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="mi" id="MathJax-Span-2761" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.49em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.492em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="mo" id="MathJax-Span-2762" style="font-family: MathJax_Main; padding-left: 0.257em;">=</span><span class="mfrac" id="MathJax-Span-2763" style="padding-left: 0.257em;"><span style="display: inline-block; position: relative; width: 2.492em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.372em, -999.997em); top: -4.672em; left: 50%; margin-left: -1.166em;"><span class="mrow" id="MathJax-Span-2764"><span class="mi" id="MathJax-Span-2765" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-2766"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2767" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-2768"><span class="mrow" id="MathJax-Span-2769"><span class="mi" id="MathJax-Span-2770" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2771" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2772" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1001.48em, 4.322em, -999.997em); top: -3.351em; left: 50%; margin-left: -0.709em;"><span class="mrow" id="MathJax-Span-2773"><span class="mi" id="MathJax-Span-2774" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-2775"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2776" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-2777"><span class="mrow" id="MathJax-Span-2778"><span class="mi" id="MathJax-Span-2779" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.49em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.492em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-2780"><span style="display: inline-block; position: relative; width: 2.492em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1001.48em, 4.322em, -999.997em); top: -4.672em; left: 50%; margin-left: -0.709em;"><span class="mrow" id="MathJax-Span-2781"><span class="mi" id="MathJax-Span-2782" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-2783"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2784" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-2785"><span class="mrow" id="MathJax-Span-2786"><span class="mi" id="MathJax-Span-2787" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.372em, -999.997em); top: -3.351em; left: 50%; margin-left: -1.166em;"><span class="mrow" id="MathJax-Span-2788"><span class="mi" id="MathJax-Span-2789" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-2790"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2791" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-2792"><span class="mrow" id="MathJax-Span-2793"><span class="mi" id="MathJax-Span-2794" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2795" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-2796" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.49em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.492em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="mo" id="MathJax-Span-2797" style="font-family: MathJax_Main;">.</span><span class="mo" id="MathJax-Span-2798" style="font-family: MathJax_Main; padding-left: 0.155em;">.</span><span class="mo" id="MathJax-Span-2799" style="font-family: MathJax_Main; padding-left: 0.155em;">.</span><span class="mfrac" id="MathJax-Span-2800" style="padding-left: 0.155em;"><span style="display: inline-block; position: relative; width: 2.594em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1002.49em, 4.372em, -999.997em); top: -4.672em; left: 50%; margin-left: -1.217em;"><span class="mrow" id="MathJax-Span-2801"><span class="mi" id="MathJax-Span-2802" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-2803"><span style="display: inline-block; position: relative; width: 1.933em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2804" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-2805"><span class="mrow" id="MathJax-Span-2806"><span class="mi" id="MathJax-Span-2807" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-2808" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2809" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1001.58em, 4.322em, -999.997em); top: -3.351em; left: 50%; margin-left: -0.81em;"><span class="mrow" id="MathJax-Span-2810"><span class="mi" id="MathJax-Span-2811" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-2812"><span style="display: inline-block; position: relative; width: 1.019em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2813" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="mi" id="MathJax-Span-2814" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.59em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.594em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.747em; border-left: 0px solid; width: 0px; height: 3.878em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><munderover><mo>∏</mo><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>=</mo><mi>k</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></munderover><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi></mrow></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mi>k</mi></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow></mfrac><mo>.</mo><mo>.</mo><mo>.</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mi>k</mi></msub></mrow></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-96">\prod^{t}_{j=k} \frac{\partial h_{j+1}}{\partial h_{j}} = \frac{\partial h_{t+1}}{\partial h_k} = \frac{\partial h_{t+1}}{\partial h_{t}}\frac{\partial h_{t}}{\partial h_{t-1}}...\frac{\partial h_{k+1}}{\partial h_k}</script>

<p>Now let us look at a single one of these terms by taking the derivative of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-97-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2815" style="width: 2.289em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.374em, 1001.83em, 2.696em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-2816"><span class="msubsup" id="MathJax-Span-2817"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2818" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-2819"><span class="mrow" id="MathJax-Span-2820"><span class="mi" id="MathJax-Span-2821" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-2822" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2823" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>+</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-97">h_{j+1}</script> with respect to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-98-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2824" style="width: 1.222em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.374em, 1000.97em, 2.696em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-2825"><span class="msubsup" id="MathJax-Span-2826"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2827" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-2828"><span class="mrow" id="MathJax-Span-2829"><span class="mi" id="MathJax-Span-2830" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-98">h_{j}</script> where diag turns a vector into a diagonal matrix because this recursive partial derivative is a Jacobian matrix:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-99-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-variant&quot; mathvariant=&quot;normal&quot;&gt;&amp;#x2032;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2831" style="width: 26.324em; display: inline-block;"><span style="display: inline-block; position: relative; width: 21.395em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(0.612em, 1021.39em, 3.356em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-2832"><span class="mfrac" id="MathJax-Span-2833"><span style="display: inline-block; position: relative; width: 2.543em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.474em, -999.997em); top: -4.774em; left: 50%; margin-left: -1.217em;"><span class="mrow" id="MathJax-Span-2834"><span class="mi" id="MathJax-Span-2835" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-2836"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2837" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-2838"><span class="mrow" id="MathJax-Span-2839"><span class="mi" id="MathJax-Span-2840" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-2841" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2842" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1001.53em, 4.474em, -999.997em); top: -3.351em; left: 50%; margin-left: -0.76em;"><span class="mrow" id="MathJax-Span-2843"><span class="mi" id="MathJax-Span-2844" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-2845"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2846" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-2847"><span class="mrow" id="MathJax-Span-2848"><span class="mi" id="MathJax-Span-2849" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.54em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.543em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="mo" id="MathJax-Span-2850" style="font-family: MathJax_Main; padding-left: 0.257em;">=</span><span class="mi" id="MathJax-Span-2851" style="font-family: MathJax_Math-italic; padding-left: 0.257em;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-2852" style="font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-2853" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-2854" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2855" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2856"><span style="display: inline-block; position: relative; width: 1.07em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2857" style="font-family: MathJax_Math-italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.458em, 1000.26em, 4.118em, -999.997em); top: -4.317em; left: 0.612em;"><span class="texatom" id="MathJax-Span-2858"><span class="mrow" id="MathJax-Span-2859"><span class="mi" id="MathJax-Span-2860" style="font-size: 70.7%; font-family: MathJax_Main;">′</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.356em, 1000.46em, 4.169em, -999.997em); top: -3.707em; left: 0.612em;"><span class="texatom" id="MathJax-Span-2861"><span class="mrow" id="MathJax-Span-2862"><span class="mi" id="MathJax-Span-2863" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-2864" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2865"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1001.07em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2866" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.407em, 1000.56em, 4.169em, -999.997em); top: -4.367em; left: 1.12em;"><span class="texatom" id="MathJax-Span-2867"><span class="mrow" id="MathJax-Span-2868"><span class="mi" id="MathJax-Span-2869" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.356em, 1000.87em, 4.169em, -999.997em); top: -3.707em; left: 0.968em;"><span class="texatom" id="MathJax-Span-2870"><span class="mrow" id="MathJax-Span-2871"><span class="mi" id="MathJax-Span-2872" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mi" id="MathJax-Span-2873" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-2874" style="font-family: MathJax_Main; padding-left: 0.206em;">⋅</span><span class="msubsup" id="MathJax-Span-2875" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 2.086em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1000.87em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2876" style="font-family: MathJax_Math-italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.816em;"><span class="texatom" id="MathJax-Span-2877"><span class="mrow" id="MathJax-Span-2878"><span class="mi" id="MathJax-Span-2879" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-2880" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2881" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-2882" style="font-family: MathJax_Main; padding-left: 0.206em;">+</span><span class="msubsup" id="MathJax-Span-2883" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1001.07em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2884" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.407em, 1000.56em, 4.169em, -999.997em); top: -4.367em; left: 1.12em;"><span class="texatom" id="MathJax-Span-2885"><span class="mrow" id="MathJax-Span-2886"><span class="mi" id="MathJax-Span-2887" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.356em, 1000.92em, 4.169em, -999.997em); top: -3.707em; left: 0.968em;"><span class="texatom" id="MathJax-Span-2888"><span class="mrow" id="MathJax-Span-2889"><span class="mi" id="MathJax-Span-2890" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span class="mi" id="MathJax-Span-2891" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-2892" style="font-family: MathJax_Main; padding-left: 0.206em;">⋅</span><span class="msubsup" id="MathJax-Span-2893" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2894" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-2895"><span class="mrow" id="MathJax-Span-2896"><span class="mi" id="MathJax-Span-2897" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-2898" style="font-family: MathJax_Main; padding-left: 0.206em;">+</span><span class="msubsup" id="MathJax-Span-2899" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.41em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2900" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.409em;"><span class="texatom" id="MathJax-Span-2901"><span class="mrow" id="MathJax-Span-2902"><span class="mi" id="MathJax-Span-2903" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-2904" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-2905"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1001.07em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2906" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.968em;"><span class="texatom" id="MathJax-Span-2907"><span class="mrow" id="MathJax-Span-2908"><span class="mi" id="MathJax-Span-2909" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span class="mi" id="MathJax-Span-2910" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.128em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi></mrow></msub></mrow></mfrac><mo>=</mo><mi>d</mi><mi>i</mi><mi>a</mi><mi>g</mi><mo stretchy="false">(</mo><msubsup><mi>ϕ</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-variant" mathvariant="normal">′</mi></mrow></msubsup><mo stretchy="false">(</mo><msubsup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mi>h</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>T</mi></mrow></msubsup><mo>⋅</mo><msub><mi>X</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>+</mo><msubsup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi><mi>h</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>T</mi></mrow></msubsup><mo>⋅</mo><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi></mrow></msub><mo>+</mo><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi></mrow></msub><mo stretchy="false">)</mo><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi><mi>h</mi></mrow></msub></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-99">\frac{\partial h_{j+1}}{\partial h_{j}} =  diag(\phi_{h}^{\prime}(W_{xh}^{T} \cdot X_{j+1} + W_{hh}^{T}\cdot h_{j} +b_{h})W_{hh}</script>

<p>Thus, if we want to backpropagate through <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-100-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2911" style="width: 2.594em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.086em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.374em, 1002.09em, 2.492em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-2912"><span class="mi" id="MathJax-Span-2913" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2914" style="font-family: MathJax_Main; padding-left: 0.206em;">−</span><span class="mi" id="MathJax-Span-2915" style="font-family: MathJax_Math-italic; padding-left: 0.206em;">k</span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mo>−</mo><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-100">t-k</script> timesteps, this gradient will be:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-101-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x220F;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x220F;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-variant&quot; mathvariant=&quot;normal&quot;&gt;&amp;#x2032;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2916" style="width: 29.83em; display: inline-block;"><span style="display: inline-block; position: relative; width: 24.24em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(0.409em, 1024.24em, 3.763em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-2917"><span class="munderover" id="MathJax-Span-2918"><span style="display: inline-block; position: relative; width: 1.273em; height: 0px;"><span style="position: absolute; clip: rect(2.899em, 1001.22em, 4.627em, -999.997em); top: -4.012em; left: 0em;"><span class="mo" id="MathJax-Span-2919" style="font-family: MathJax_Size2; vertical-align: 0em;">∏</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.356em, 1001.22em, 4.423em, -999.997em); top: -2.894em; left: 0.053em;"><span class="texatom" id="MathJax-Span-2920"><span class="mrow" id="MathJax-Span-2921"><span class="mi" id="MathJax-Span-2922" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-2923" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mi" id="MathJax-Span-2924" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.305em, 1000.26em, 4.169em, -999.997em); top: -5.18em; left: 0.511em;"><span class="texatom" id="MathJax-Span-2925"><span class="mrow" id="MathJax-Span-2926"><span class="mi" id="MathJax-Span-2927" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-2928" style="padding-left: 0.155em;"><span style="display: inline-block; position: relative; width: 2.543em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.474em, -999.997em); top: -4.774em; left: 50%; margin-left: -1.217em;"><span class="mrow" id="MathJax-Span-2929"><span class="mi" id="MathJax-Span-2930" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-2931"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2932" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-2933"><span class="mrow" id="MathJax-Span-2934"><span class="mi" id="MathJax-Span-2935" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-2936" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2937" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1001.53em, 4.474em, -999.997em); top: -3.351em; left: 50%; margin-left: -0.76em;"><span class="mrow" id="MathJax-Span-2938"><span class="mi" id="MathJax-Span-2939" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-2940"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2941" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-2942"><span class="mrow" id="MathJax-Span-2943"><span class="mi" id="MathJax-Span-2944" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.54em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.543em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="mo" id="MathJax-Span-2945" style="font-family: MathJax_Main; padding-left: 0.257em;">=</span><span class="munderover" id="MathJax-Span-2946" style="padding-left: 0.257em;"><span style="display: inline-block; position: relative; width: 1.273em; height: 0px;"><span style="position: absolute; clip: rect(2.899em, 1001.22em, 4.627em, -999.997em); top: -4.012em; left: 0em;"><span class="mo" id="MathJax-Span-2947" style="font-family: MathJax_Size2; vertical-align: 0em;">∏</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.356em, 1001.22em, 4.423em, -999.997em); top: -2.894em; left: 0.053em;"><span class="texatom" id="MathJax-Span-2948"><span class="mrow" id="MathJax-Span-2949"><span class="mi" id="MathJax-Span-2950" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-2951" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mi" id="MathJax-Span-2952" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.305em, 1000.26em, 4.169em, -999.997em); top: -5.18em; left: 0.511em;"><span class="texatom" id="MathJax-Span-2953"><span class="mrow" id="MathJax-Span-2954"><span class="mi" id="MathJax-Span-2955" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mi" id="MathJax-Span-2956" style="font-family: MathJax_Math-italic; padding-left: 0.155em;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-2957" style="font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-2958" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-2959" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2960" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2961"><span style="display: inline-block; position: relative; width: 1.07em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2962" style="font-family: MathJax_Math-italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.458em, 1000.26em, 4.118em, -999.997em); top: -4.317em; left: 0.612em;"><span class="texatom" id="MathJax-Span-2963"><span class="mrow" id="MathJax-Span-2964"><span class="mi" id="MathJax-Span-2965" style="font-size: 70.7%; font-family: MathJax_Main;">′</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.356em, 1000.46em, 4.169em, -999.997em); top: -3.707em; left: 0.612em;"><span class="texatom" id="MathJax-Span-2966"><span class="mrow" id="MathJax-Span-2967"><span class="mi" id="MathJax-Span-2968" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-2969" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2970"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1001.07em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2971" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.407em, 1000.56em, 4.169em, -999.997em); top: -4.367em; left: 1.12em;"><span class="texatom" id="MathJax-Span-2972"><span class="mrow" id="MathJax-Span-2973"><span class="mi" id="MathJax-Span-2974" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.356em, 1000.87em, 4.169em, -999.997em); top: -3.707em; left: 0.968em;"><span class="texatom" id="MathJax-Span-2975"><span class="mrow" id="MathJax-Span-2976"><span class="mi" id="MathJax-Span-2977" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mi" id="MathJax-Span-2978" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-2979" style="font-family: MathJax_Main; padding-left: 0.206em;">⋅</span><span class="msubsup" id="MathJax-Span-2980" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 2.086em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1000.87em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2981" style="font-family: MathJax_Math-italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.816em;"><span class="texatom" id="MathJax-Span-2982"><span class="mrow" id="MathJax-Span-2983"><span class="mi" id="MathJax-Span-2984" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-2985" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2986" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-2987" style="font-family: MathJax_Main; padding-left: 0.206em;">+</span><span class="msubsup" id="MathJax-Span-2988" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1001.07em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2989" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.407em, 1000.56em, 4.169em, -999.997em); top: -4.367em; left: 1.12em;"><span class="texatom" id="MathJax-Span-2990"><span class="mrow" id="MathJax-Span-2991"><span class="mi" id="MathJax-Span-2992" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.356em, 1000.92em, 4.169em, -999.997em); top: -3.707em; left: 0.968em;"><span class="texatom" id="MathJax-Span-2993"><span class="mrow" id="MathJax-Span-2994"><span class="mi" id="MathJax-Span-2995" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span class="mi" id="MathJax-Span-2996" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-2997" style="font-family: MathJax_Main; padding-left: 0.206em;">⋅</span><span class="msubsup" id="MathJax-Span-2998" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-2999" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-3000"><span class="mrow" id="MathJax-Span-3001"><span class="mi" id="MathJax-Span-3002" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-3003" style="font-family: MathJax_Main; padding-left: 0.206em;">+</span><span class="msubsup" id="MathJax-Span-3004" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.41em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3005" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.409em;"><span class="texatom" id="MathJax-Span-3006"><span class="mrow" id="MathJax-Span-3007"><span class="mi" id="MathJax-Span-3008" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-3009" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-3010"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1001.07em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3011" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.968em;"><span class="texatom" id="MathJax-Span-3012"><span class="mrow" id="MathJax-Span-3013"><span class="mi" id="MathJax-Span-3014" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span class="mi" id="MathJax-Span-3015" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.747em; border-left: 0px solid; width: 0px; height: 3.878em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><munderover><mo>∏</mo><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>=</mo><mi>k</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></munderover><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi></mrow></msub></mrow></mfrac><mo>=</mo><munderover><mo>∏</mo><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>=</mo><mi>k</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></munderover><mi>d</mi><mi>i</mi><mi>a</mi><mi>g</mi><mo stretchy="false">(</mo><msubsup><mi>ϕ</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-variant" mathvariant="normal">′</mi></mrow></msubsup><mo stretchy="false">(</mo><msubsup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mi>h</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>T</mi></mrow></msubsup><mo>⋅</mo><msub><mi>X</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>+</mo><msubsup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi><mi>h</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>T</mi></mrow></msubsup><mo>⋅</mo><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi></mrow></msub><mo>+</mo><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi></mrow></msub><mo stretchy="false">)</mo><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi><mi>h</mi></mrow></msub></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-101">\prod^{t}_{j=k} \frac{\partial h_{j+1}}{\partial h_{j}} = \prod^{t}_{j=k} diag(\phi_{h}^{\prime}(W_{xh}^{T} \cdot X_{j+1} + W_{hh}^{T}\cdot h_{j} +b_{h})W_{hh}</script>

<p>If we perform eigendecomposition on the Jacobian matrix <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-102-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3016" style="width: 2.543em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.035em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(0.968em, 1002.03em, 3.001em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-3017"><span class="mfrac" id="MathJax-Span-3018"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.356em, 1001.73em, 4.372em, -999.997em); top: -4.621em; left: 50%; margin-left: -0.861em;"><span class="mrow" id="MathJax-Span-3019"><span class="mi" id="MathJax-Span-3020" style="font-size: 70.7%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-3021"><span style="display: inline-block; position: relative; width: 1.324em; height: 0px;"><span style="position: absolute; clip: rect(3.356em, 1000.41em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3022" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.91em; left: 0.409em;"><span class="texatom" id="MathJax-Span-3023"><span class="mrow" id="MathJax-Span-3024"><span class="mi" id="MathJax-Span-3025" style="font-size: 50%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-3026" style="font-size: 50%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-3027" style="font-size: 50%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.356em, 1001.07em, 4.372em, -999.997em); top: -3.605em; left: 50%; margin-left: -0.506em;"><span class="mrow" id="MathJax-Span-3028"><span class="mi" id="MathJax-Span-3029" style="font-size: 70.7%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-3030"><span style="display: inline-block; position: relative; width: 0.663em; height: 0px;"><span style="position: absolute; clip: rect(3.356em, 1000.41em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3031" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.91em; left: 0.409em;"><span class="texatom" id="MathJax-Span-3032"><span class="mrow" id="MathJax-Span-3033"><span class="mi" id="MathJax-Span-3034" style="font-size: 50%; font-family: MathJax_Math-italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1001.83em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.832em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.809em; border-left: 0px solid; width: 0px; height: 2.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi></mrow></msub></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-102">\frac{\partial h_{j+1}}{\partial h_{j}}</script>, we get the eigenvalues <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-103-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x22EF;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3035" style="width: 7.066em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.744em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.374em, 1005.74em, 2.594em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-3036"><span class="msubsup" id="MathJax-Span-3037"><span style="display: inline-block; position: relative; width: 1.019em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3038" style="font-family: MathJax_Math-italic;">λ</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-3039"><span class="mrow" id="MathJax-Span-3040"><span class="mn" id="MathJax-Span-3041" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-3042" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-3043" style="padding-left: 0.155em;"><span style="display: inline-block; position: relative; width: 1.019em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3044" style="font-family: MathJax_Math-italic;">λ</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-3045"><span class="mrow" id="MathJax-Span-3046"><span class="mn" id="MathJax-Span-3047" style="font-size: 70.7%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-3048" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-3049" style="font-family: MathJax_Main; padding-left: 0.155em;">⋯</span><span class="mo" id="MathJax-Span-3050" style="font-family: MathJax_Main; padding-left: 0.155em;">,</span><span class="msubsup" id="MathJax-Span-3051" style="padding-left: 0.155em;"><span style="display: inline-block; position: relative; width: 1.07em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3052" style="font-family: MathJax_Math-italic;">λ</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-3053"><span class="mrow" id="MathJax-Span-3054"><span class="mi" id="MathJax-Span-3055" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>λ</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>λ</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msub><mo>,</mo><mo>⋯</mo><mo>,</mo><msub><mi>λ</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-103">\lambda_{1}, \lambda_{2}, \cdots, \lambda_{n}</script> where <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-104-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x007C;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x007C;&lt;/mo&gt;&lt;mo&gt;&amp;#x003E;&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x007C;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x007C;&lt;/mo&gt;&lt;mo&gt;&amp;#x003E;&lt;/mo&gt;&lt;mo&gt;&amp;#x22EF;&lt;/mo&gt;&lt;mo&gt;&amp;#x003E;&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x007C;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x007C;&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3056" style="width: 12.096em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.809em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.324em, 1009.71em, 2.645em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-3057"><span class="mo" id="MathJax-Span-3058" style="font-family: MathJax_Main;">|</span><span class="msubsup" id="MathJax-Span-3059"><span style="display: inline-block; position: relative; width: 1.019em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3060" style="font-family: MathJax_Math-italic;">λ</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-3061"><span class="mrow" id="MathJax-Span-3062"><span class="mn" id="MathJax-Span-3063" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-3064" style="font-family: MathJax_Main;">|</span><span class="mo" id="MathJax-Span-3065" style="font-family: MathJax_Main; padding-left: 0.257em;">&gt;</span><span class="mo" id="MathJax-Span-3066" style="font-family: MathJax_Main; padding-left: 0.257em;">|</span><span class="msubsup" id="MathJax-Span-3067"><span style="display: inline-block; position: relative; width: 1.019em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3068" style="font-family: MathJax_Math-italic;">λ</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-3069"><span class="mrow" id="MathJax-Span-3070"><span class="mn" id="MathJax-Span-3071" style="font-size: 70.7%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-3072" style="font-family: MathJax_Main;">|</span><span class="mo" id="MathJax-Span-3073" style="font-family: MathJax_Main; padding-left: 0.257em;">&gt;</span><span class="mo" id="MathJax-Span-3074" style="font-family: MathJax_Main; padding-left: 0.257em;">⋯</span><span class="mo" id="MathJax-Span-3075" style="font-family: MathJax_Main; padding-left: 0.257em;">&gt;</span><span class="mo" id="MathJax-Span-3076" style="font-family: MathJax_Main; padding-left: 0.257em;">|</span><span class="msubsup" id="MathJax-Span-3077"><span style="display: inline-block; position: relative; width: 1.07em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3078" style="font-family: MathJax_Math-italic;">λ</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-3079"><span class="mrow" id="MathJax-Span-3080"><span class="mi" id="MathJax-Span-3081" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-3082" style="font-family: MathJax_Main;">|</span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">|</mo><msub><mi>λ</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub><mo fence="false" stretchy="false">|</mo><mo>&gt;</mo><mo fence="false" stretchy="false">|</mo><msub><mi>λ</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msub><mo fence="false" stretchy="false">|</mo><mo>&gt;</mo><mo>⋯</mo><mo>&gt;</mo><mo fence="false" stretchy="false">|</mo><msub><mi>λ</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi></mrow></msub><mo fence="false" stretchy="false">|</mo></math></span></span><script type="math/tex" id="MathJax-Element-104">\lvert\lambda_{1}\rvert \gt \lvert\lambda_{2}\rvert \gt\cdots \gt \lvert\lambda_{n}\rvert</script> and the corresponding eigenvectors <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-105-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x22EF;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3083" style="width: 6.71em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.44em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.629em, 1005.44em, 2.594em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-3084"><span class="msubsup" id="MathJax-Span-3085"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.46em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3086" style="font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.511em;"><span class="texatom" id="MathJax-Span-3087"><span class="mrow" id="MathJax-Span-3088"><span class="mn" id="MathJax-Span-3089" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-3090" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-3091" style="padding-left: 0.155em;"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.46em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3092" style="font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.511em;"><span class="texatom" id="MathJax-Span-3093"><span class="mrow" id="MathJax-Span-3094"><span class="mn" id="MathJax-Span-3095" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-3096" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-3097" style="font-family: MathJax_Main; padding-left: 0.155em;">⋯</span><span class="mo" id="MathJax-Span-3098" style="font-family: MathJax_Main; padding-left: 0.155em;">,</span><span class="msubsup" id="MathJax-Span-3099" style="padding-left: 0.155em;"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.46em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3100" style="font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.511em;"><span class="texatom" id="MathJax-Span-3101"><span class="mrow" id="MathJax-Span-3102"><span class="mi" id="MathJax-Span-3103" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>v</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>v</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub><mo>,</mo><mo>⋯</mo><mo>,</mo><msub><mi>v</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-105">v_{1}, v_{1},\cdots,v_{n}</script>.</p>

<p>Any change on the hidden state <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-106-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3104" style="width: 3.255em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.645em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.374em, 1002.64em, 2.696em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-3105"><span class="mi" id="MathJax-Span-3106" style="font-family: MathJax_Main;">Δ</span><span class="msubsup" id="MathJax-Span-3107"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3108" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-3109"><span class="mrow" id="MathJax-Span-3110"><span class="mi" id="MathJax-Span-3111" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-3112" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-3113" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Δ</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>+</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-106">\Delta h_{j+1}</script> in the direction of a vector <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-107-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3114" style="width: 1.019em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.816em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.629em, 1000.82em, 2.543em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-3115"><span class="msubsup" id="MathJax-Span-3116"><span style="display: inline-block; position: relative; width: 0.816em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.46em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3117" style="font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.511em;"><span class="texatom" id="MathJax-Span-3118"><span class="mrow" id="MathJax-Span-3119"><span class="mi" id="MathJax-Span-3120" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>v</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-107">v_{i}</script> has the effect of multiplying the change with the eigenvalue associated with this eigenvector i.e <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-108-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3121" style="width: 4.372em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.559em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.374em, 1003.56em, 2.696em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-3122"><span class="msubsup" id="MathJax-Span-3123"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3124" style="font-family: MathJax_Math-italic;">λ</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-3125"><span class="mrow" id="MathJax-Span-3126"><span class="mi" id="MathJax-Span-3127" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mi" id="MathJax-Span-3128" style="font-family: MathJax_Main;">Δ</span><span class="msubsup" id="MathJax-Span-3129"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3130" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-3131"><span class="mrow" id="MathJax-Span-3132"><span class="mi" id="MathJax-Span-3133" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-3134" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-3135" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>λ</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub><mi mathvariant="normal">Δ</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>+</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-108">\lambda_{i}\Delta h_{j+1}</script>.</p>

<p>The product of these Jacobians implies that subsequent time steps, will result in scaling the change with a factor equivalent to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-109-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3136" style="width: 1.12em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.273em, 1000.92em, 2.696em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-3137"><span class="msubsup" id="MathJax-Span-3138"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3139" style="font-family: MathJax_Math-italic;">λ</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.407em, 1000.31em, 4.169em, -999.997em); top: -4.367em; left: 0.561em;"><span class="texatom" id="MathJax-Span-3140"><span class="mrow" id="MathJax-Span-3141"><span class="mi" id="MathJax-Span-3142" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.407em, 1000.31em, 4.169em, -999.997em); top: -3.707em; left: 0.561em;"><span class="texatom" id="MathJax-Span-3143"><span class="mrow" id="MathJax-Span-3144"><span class="mi" id="MathJax-Span-3145" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.503em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>λ</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-109">\lambda_{i}^{t}</script>, where <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-110-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3146" style="width: 1.12em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.273em, 1000.92em, 2.696em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-3147"><span class="msubsup" id="MathJax-Span-3148"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3149" style="font-family: MathJax_Math-italic;">λ</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.407em, 1000.31em, 4.169em, -999.997em); top: -4.367em; left: 0.561em;"><span class="texatom" id="MathJax-Span-3150"><span class="mrow" id="MathJax-Span-3151"><span class="mi" id="MathJax-Span-3152" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.407em, 1000.31em, 4.169em, -999.997em); top: -3.707em; left: 0.561em;"><span class="texatom" id="MathJax-Span-3153"><span class="mrow" id="MathJax-Span-3154"><span class="mi" id="MathJax-Span-3155" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.503em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>λ</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-110">\lambda_{i}^{t}</script> represents the <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-111-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3156" style="width: 0.46em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.358em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.425em, 1000.31em, 2.391em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-3157"><span class="mi" id="MathJax-Span-3158" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-111">i</script>-th eigenvalue raised to the power of the current time step <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-112-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3159" style="width: 0.46em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.358em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.476em, 1000.31em, 2.391em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-3160"><span class="mi" id="MathJax-Span-3161" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-112">t</script>.</p>

<p>Looking at the sequence <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-113-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3162" style="width: 13.976em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.334em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.273em, 1011.33em, 2.696em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-3163"><span class="msubsup" id="MathJax-Span-3164"><span style="display: inline-block; position: relative; width: 1.019em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3165" style="font-family: MathJax_Math-italic;">λ</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.407em, 1000.41em, 4.169em, -999.997em); top: -4.367em; left: 0.561em;"><span class="texatom" id="MathJax-Span-3166"><span class="mrow" id="MathJax-Span-3167"><span class="mn" id="MathJax-Span-3168" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.407em, 1000.31em, 4.169em, -999.997em); top: -3.707em; left: 0.561em;"><span class="texatom" id="MathJax-Span-3169"><span class="mrow" id="MathJax-Span-3170"><span class="mi" id="MathJax-Span-3171" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mi" id="MathJax-Span-3172" style="font-family: MathJax_Main;">Δ</span><span class="msubsup" id="MathJax-Span-3173"><span style="display: inline-block; position: relative; width: 1.019em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3174" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-3175"><span class="mrow" id="MathJax-Span-3176"><span class="mn" id="MathJax-Span-3177" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-3178" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-3179" style="padding-left: 0.155em;"><span style="display: inline-block; position: relative; width: 1.019em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3180" style="font-family: MathJax_Math-italic;">λ</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.407em, 1000.41em, 4.169em, -999.997em); top: -4.367em; left: 0.561em;"><span class="texatom" id="MathJax-Span-3181"><span class="mrow" id="MathJax-Span-3182"><span class="mn" id="MathJax-Span-3183" style="font-size: 70.7%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.407em, 1000.31em, 4.169em, -999.997em); top: -3.707em; left: 0.561em;"><span class="texatom" id="MathJax-Span-3184"><span class="mrow" id="MathJax-Span-3185"><span class="mi" id="MathJax-Span-3186" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mi" id="MathJax-Span-3187" style="font-family: MathJax_Main;">Δ</span><span class="msubsup" id="MathJax-Span-3188"><span style="display: inline-block; position: relative; width: 1.019em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3189" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-3190"><span class="mrow" id="MathJax-Span-3191"><span class="mn" id="MathJax-Span-3192" style="font-size: 70.7%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-3193" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-3194" style="font-family: MathJax_Main; padding-left: 0.155em;">…</span><span class="mo" id="MathJax-Span-3195" style="font-family: MathJax_Main; padding-left: 0.155em;">,</span><span class="msubsup" id="MathJax-Span-3196" style="padding-left: 0.155em;"><span style="display: inline-block; position: relative; width: 1.07em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3197" style="font-family: MathJax_Math-italic;">λ</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.407em, 1000.41em, 4.169em, -999.997em); top: -4.367em; left: 0.561em;"><span class="texatom" id="MathJax-Span-3198"><span class="mrow" id="MathJax-Span-3199"><span class="mn" id="MathJax-Span-3200" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.559em, 1000.51em, 4.169em, -999.997em); top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-3201"><span class="mrow" id="MathJax-Span-3202"><span class="mi" id="MathJax-Span-3203" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mi" id="MathJax-Span-3204" style="font-family: MathJax_Main;">Δ</span><span class="msubsup" id="MathJax-Span-3205"><span style="display: inline-block; position: relative; width: 1.07em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3206" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-3207"><span class="mrow" id="MathJax-Span-3208"><span class="mi" id="MathJax-Span-3209" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.503em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>λ</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msubsup><mi mathvariant="normal">Δ</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub><mo>,</mo><msubsup><mi>λ</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msubsup><mi mathvariant="normal">Δ</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msub><mo>,</mo><mo>…</mo><mo>,</mo><msubsup><mi>λ</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msubsup><mi mathvariant="normal">Δ</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-113">\lambda_{i}^{1}\Delta h_{1}, \lambda_{i}^{2}\Delta h_{2}, \dots, \lambda_{n}^{1}\Delta h_{n}</script>, it is easy to see that the factor <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-114-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3210" style="width: 1.12em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.273em, 1000.92em, 2.696em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-3211"><span class="msubsup" id="MathJax-Span-3212"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3213" style="font-family: MathJax_Math-italic;">λ</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.407em, 1000.31em, 4.169em, -999.997em); top: -4.367em; left: 0.561em;"><span class="texatom" id="MathJax-Span-3214"><span class="mrow" id="MathJax-Span-3215"><span class="mi" id="MathJax-Span-3216" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.407em, 1000.31em, 4.169em, -999.997em); top: -3.707em; left: 0.561em;"><span class="texatom" id="MathJax-Span-3217"><span class="mrow" id="MathJax-Span-3218"><span class="mi" id="MathJax-Span-3219" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.503em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>λ</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-114">\lambda_{i}^{t}</script> will end up dominating the <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-115-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3220" style="width: 2.137em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.73em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.374em, 1001.73em, 2.543em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-3221"><span class="mi" id="MathJax-Span-3222" style="font-family: MathJax_Main;">Δ</span><span class="msubsup" id="MathJax-Span-3223"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3224" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-3225"><span class="mrow" id="MathJax-Span-3226"><span class="mi" id="MathJax-Span-3227" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Δ</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-115">\Delta h_{t}</script>’s because this term grows exponentially fast as <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-116-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3228" style="width: 0.46em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.358em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.476em, 1000.31em, 2.391em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-3229"><span class="mi" id="MathJax-Span-3230" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-116">t</script> goes to infinity.</p>

<p>This means that if the largest eigenvalue <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-117-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3231" style="width: 3.458em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.797em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.374em, 1002.75em, 2.543em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-3232"><span class="msubsup" id="MathJax-Span-3233"><span style="display: inline-block; position: relative; width: 1.019em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3234" style="font-family: MathJax_Math-italic;">λ</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-3235"><span class="mrow" id="MathJax-Span-3236"><span class="mn" id="MathJax-Span-3237" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-3238" style="font-family: MathJax_Main; padding-left: 0.257em;">&lt;</span><span class="mn" id="MathJax-Span-3239" style="font-family: MathJax_Main; padding-left: 0.257em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>λ</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub><mo>&lt;</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-117">\lambda_{1} <1</script> then the gradient will vanish while if the value of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-118-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;gt;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3240" style="width: 3.458em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.797em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.374em, 1002.75em, 2.543em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-3241"><span class="msubsup" id="MathJax-Span-3242"><span style="display: inline-block; position: relative; width: 1.019em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3243" style="font-family: MathJax_Math-italic;">λ</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-3244"><span class="mrow" id="MathJax-Span-3245"><span class="mn" id="MathJax-Span-3246" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-3247" style="font-family: MathJax_Main; padding-left: 0.257em;">&gt;</span><span class="mn" id="MathJax-Span-3248" style="font-family: MathJax_Main; padding-left: 0.257em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>λ</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub><mo>&gt;</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-118">\lambda_{1} > 1</script>, the gradient explodes.</p>

<p><img src="./Backpropagation Through Time for Recurrent Neural Network _ Mustafa Murat ARAT_files/tanh.png" alt=""></p>

<p>As also shown in <a href="https://arxiv.org/pdf/1211.5063.pdf" target="_blank">this paper</a>, if the dominant eigenvalue of the matrix <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-119-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3249" style="width: 2.289em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.425em, 1001.83em, 2.543em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-3250"><span class="msubsup" id="MathJax-Span-3251"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1001.07em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3252" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.968em;"><span class="texatom" id="MathJax-Span-3253"><span class="mrow" id="MathJax-Span-3254"><span class="mi" id="MathJax-Span-3255" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span class="mi" id="MathJax-Span-3256" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi><mi>h</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-119">W_{hh}</script> is greater than 1, the gradient explodes. If it is less than 1, the gradient vanishes. The fact that this equation leads to either vanishing or exploding gradients should make intuitive sense. Note that the values of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-120-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-variant&quot; mathvariant=&quot;normal&quot;&gt;&amp;#x2032;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3257" style="width: 1.324em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.07em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.374em, 1001.07em, 2.746em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-3258"><span class="msubsup" id="MathJax-Span-3259"><span style="display: inline-block; position: relative; width: 1.07em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3260" style="font-family: MathJax_Math-italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.458em, 1000.26em, 4.118em, -999.997em); top: -4.317em; left: 0.612em;"><span class="texatom" id="MathJax-Span-3261"><span class="mrow" id="MathJax-Span-3262"><span class="mi" id="MathJax-Span-3263" style="font-size: 70.7%; font-family: MathJax_Main;">′</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.356em, 1000.46em, 4.169em, -999.997em); top: -3.707em; left: 0.612em;"><span class="texatom" id="MathJax-Span-3264"><span class="mrow" id="MathJax-Span-3265"><span class="mi" id="MathJax-Span-3266" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>ϕ</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-variant" mathvariant="normal">′</mi></mrow></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-120">\phi_{h}^{\prime}</script> will always be less than 1. Because in vanilla RNN, the activation function  <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-121-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3267" style="width: 1.324em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.07em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.374em, 1001.07em, 2.594em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-3268"><span class="msubsup" id="MathJax-Span-3269"><span style="display: inline-block; position: relative; width: 1.07em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3270" style="font-family: MathJax_Math-italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.612em;"><span class="texatom" id="MathJax-Span-3271"><span class="mrow" id="MathJax-Span-3272"><span class="mi" id="MathJax-Span-3273" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>ϕ</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-121">\phi_{h}</script> is used to be hyperbolic tangent whose derivative is at most <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-122-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1.0&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3274" style="width: 1.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.273em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.425em, 1001.22em, 2.391em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-3275"><span class="mn" id="MathJax-Span-3276" style="font-family: MathJax_Main;">1.0</span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1.0</mn></math></span></span><script type="math/tex" id="MathJax-Element-122">1.0</script>. So if the magnitude of the values of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-123-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3277" style="width: 2.289em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.425em, 1001.83em, 2.543em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-3278"><span class="msubsup" id="MathJax-Span-3279"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1001.07em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3280" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.968em;"><span class="texatom" id="MathJax-Span-3281"><span class="mrow" id="MathJax-Span-3282"><span class="mi" id="MathJax-Span-3283" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span class="mi" id="MathJax-Span-3284" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi><mi>h</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-123">W_{hh}</script> are too small, then inevitably the derivative will go to 0. The repeated multiplications of values less than one would overpower the repeated multiplications of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-124-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3285" style="width: 2.289em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.425em, 1001.83em, 2.543em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-3286"><span class="msubsup" id="MathJax-Span-3287"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1001.07em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3288" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.968em;"><span class="texatom" id="MathJax-Span-3289"><span class="mrow" id="MathJax-Span-3290"><span class="mi" id="MathJax-Span-3291" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span class="mi" id="MathJax-Span-3292" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi><mi>h</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-124">W_{hh}</script>. On the contrary, make <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-125-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3293" style="width: 2.289em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.425em, 1001.83em, 2.543em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-3294"><span class="msubsup" id="MathJax-Span-3295"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1001.07em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3296" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.968em;"><span class="texatom" id="MathJax-Span-3297"><span class="mrow" id="MathJax-Span-3298"><span class="mi" id="MathJax-Span-3299" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span class="mi" id="MathJax-Span-3300" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi><mi>h</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-125">W_{hh}</script> too big and the derivative will go to infinity since the exponentiation of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-126-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3301" style="width: 2.289em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.425em, 1001.83em, 2.543em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-3302"><span class="msubsup" id="MathJax-Span-3303"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1001.07em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3304" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.968em;"><span class="texatom" id="MathJax-Span-3305"><span class="mrow" id="MathJax-Span-3306"><span class="mi" id="MathJax-Span-3307" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span class="mi" id="MathJax-Span-3308" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi><mi>h</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-126">W_{hh}</script> will overpower the repeated multiplication of the values less than 1.</p>

<p>Vanishing gradients aren’t exclusive to RNNs. They also happen in deep Feedforward Neural Networks. It’s just that RNNs tend to be very deep, which makes the problem a lot more common.</p>

<p>These problems ultimately shows that if the gradient vanishes, it means that the earlier hidden states have no real effect on the later hidden states, meaning no long term dependencies are learned!</p>

<p>Fortunately, there are a few ways to come over the vanishing gradient problem. Proper initialization of the weight matrices can reduce the effect of vanishing gradients. So can regularization. A more preferred solution is to use ReLU activation function instead of hyperbolic tangent or sigmoid activation functions. The ReLU derivative is a constant of either 0 or 1, so it isn’t as likely to suffer from vanishing gradients. An even more popular solution is to use Long Short-Term Memory (LSTM) or Gated Recurrent Unit (GRU) architectures.</p>

<h1 id="additional-explanation">Additional Explanation</h1>
<p>Let’s take the norms of these Jacobians:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-127-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow&gt;&lt;mo symmetric=&quot;true&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo symmetric=&quot;true&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mrow&gt;&lt;mo symmetric=&quot;true&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo symmetric=&quot;true&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo symmetric=&quot;true&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-variant&quot; mathvariant=&quot;normal&quot;&gt;&amp;#x2032;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo symmetric=&quot;true&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3309" style="width: 30.287em; display: inline-block;"><span style="display: inline-block; position: relative; width: 24.596em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(2.086em, 1024.44em, 4.83em, -999.997em); top: -3.707em; left: 0em;"><span class="mrow" id="MathJax-Span-3310"><span class="mrow" id="MathJax-Span-3311"><span class="mo" id="MathJax-Span-3312" style="vertical-align: 1.476em;"><span style="display: inline-block; position: relative; width: 0.511em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.249em; left: 0em;">∥<span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -1.776em; left: 0em;">∥<span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -2.538em; left: 0em;">∥<span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-3313"><span style="display: inline-block; position: relative; width: 2.543em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.474em, -999.997em); top: -4.774em; left: 50%; margin-left: -1.217em;"><span class="mrow" id="MathJax-Span-3314"><span class="mi" id="MathJax-Span-3315" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-3316"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3317" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-3318"><span class="mrow" id="MathJax-Span-3319"><span class="mi" id="MathJax-Span-3320" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-3321" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-3322" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1001.53em, 4.474em, -999.997em); top: -3.351em; left: 50%; margin-left: -0.76em;"><span class="mrow" id="MathJax-Span-3323"><span class="mi" id="MathJax-Span-3324" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-3325"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3326" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-3327"><span class="mrow" id="MathJax-Span-3328"><span class="mi" id="MathJax-Span-3329" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.54em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.543em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="mo" id="MathJax-Span-3330" style="vertical-align: 1.476em;"><span style="display: inline-block; position: relative; width: 0.511em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.249em; left: 0em;">∥<span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -1.776em; left: 0em;">∥<span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -2.538em; left: 0em;">∥<span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-3331" style="font-family: MathJax_Main; padding-left: 0.257em;">≤</span><span class="mrow" id="MathJax-Span-3332" style="padding-left: 0.257em;"><span class="mo" id="MathJax-Span-3333" style="font-family: MathJax_Main;">∥</span><span class="msubsup" id="MathJax-Span-3334"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1001.07em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3335" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.968em;"><span class="texatom" id="MathJax-Span-3336"><span class="mrow" id="MathJax-Span-3337"><span class="mi" id="MathJax-Span-3338" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span class="mi" id="MathJax-Span-3339" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-3340" style="font-family: MathJax_Main;">∥</span></span><span class="mrow" id="MathJax-Span-3341" style="padding-left: 0.155em;"><span class="mo" id="MathJax-Span-3342" style="vertical-align: 0.816em;"><span style="display: inline-block; position: relative; width: 0.511em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.249em; left: 0em;">∥<span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -3.097em; left: 0em;">∥<span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mrow" id="MathJax-Span-3343"><span class="mi" id="MathJax-Span-3344" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-3345" style="font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-3346" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-3347" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3348" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-3349"><span style="display: inline-block; position: relative; width: 1.07em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3350" style="font-family: MathJax_Math-italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.458em, 1000.26em, 4.118em, -999.997em); top: -4.317em; left: 0.612em;"><span class="texatom" id="MathJax-Span-3351"><span class="mrow" id="MathJax-Span-3352"><span class="mi" id="MathJax-Span-3353" style="font-size: 70.7%; font-family: MathJax_Main;">′</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.356em, 1000.46em, 4.169em, -999.997em); top: -3.707em; left: 0.612em;"><span class="texatom" id="MathJax-Span-3354"><span class="mrow" id="MathJax-Span-3355"><span class="mi" id="MathJax-Span-3356" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-3357" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-3358"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1001.07em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3359" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.407em, 1000.56em, 4.169em, -999.997em); top: -4.367em; left: 1.12em;"><span class="texatom" id="MathJax-Span-3360"><span class="mrow" id="MathJax-Span-3361"><span class="mi" id="MathJax-Span-3362" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.356em, 1000.87em, 4.169em, -999.997em); top: -3.707em; left: 0.968em;"><span class="texatom" id="MathJax-Span-3363"><span class="mrow" id="MathJax-Span-3364"><span class="mi" id="MathJax-Span-3365" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mi" id="MathJax-Span-3366" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-3367" style="font-family: MathJax_Main; padding-left: 0.206em;">⋅</span><span class="msubsup" id="MathJax-Span-3368" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 2.086em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1000.87em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3369" style="font-family: MathJax_Math-italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.816em;"><span class="texatom" id="MathJax-Span-3370"><span class="mrow" id="MathJax-Span-3371"><span class="mi" id="MathJax-Span-3372" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-3373" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-3374" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-3375" style="font-family: MathJax_Main; padding-left: 0.206em;">+</span><span class="msubsup" id="MathJax-Span-3376" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1001.07em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3377" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.407em, 1000.56em, 4.169em, -999.997em); top: -4.367em; left: 1.12em;"><span class="texatom" id="MathJax-Span-3378"><span class="mrow" id="MathJax-Span-3379"><span class="mi" id="MathJax-Span-3380" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.356em, 1000.92em, 4.169em, -999.997em); top: -3.707em; left: 0.968em;"><span class="texatom" id="MathJax-Span-3381"><span class="mrow" id="MathJax-Span-3382"><span class="mi" id="MathJax-Span-3383" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span class="mi" id="MathJax-Span-3384" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-3385" style="font-family: MathJax_Main; padding-left: 0.206em;">⋅</span><span class="msubsup" id="MathJax-Span-3386" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3387" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-3388"><span class="mrow" id="MathJax-Span-3389"><span class="mi" id="MathJax-Span-3390" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-3391" style="font-family: MathJax_Main; padding-left: 0.206em;">+</span><span class="msubsup" id="MathJax-Span-3392" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.41em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3393" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.409em;"><span class="texatom" id="MathJax-Span-3394"><span class="mrow" id="MathJax-Span-3395"><span class="mi" id="MathJax-Span-3396" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-3397" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-3398" style="vertical-align: 0.816em;"><span style="display: inline-block; position: relative; width: 0.511em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.249em; left: 0em;">∥<span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -3.097em; left: 0em;">∥<span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.712em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.128em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo symmetric="true">‖</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi></mrow></msub></mrow></mfrac><mo symmetric="true">‖</mo></mrow><mo>≤</mo><mrow><mo symmetric="true">‖</mo><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi><mi>h</mi></mrow></msub><mo symmetric="true">‖</mo></mrow><mrow><mo symmetric="true">‖</mo><mrow><mi>d</mi><mi>i</mi><mi>a</mi><mi>g</mi><mo stretchy="false">(</mo><msubsup><mi>ϕ</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-variant" mathvariant="normal">′</mi></mrow></msubsup><mo stretchy="false">(</mo><msubsup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mi>h</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>T</mi></mrow></msubsup><mo>⋅</mo><msub><mi>X</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>+</mo><msubsup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi><mi>h</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>T</mi></mrow></msubsup><mo>⋅</mo><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi></mrow></msub><mo>+</mo><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi></mrow></msub><mo stretchy="false">)</mo></mrow><mo symmetric="true">‖</mo></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-127">\left\Vert \frac{\partial h_{j+1}}{\partial h_{j}} \right\Vert \leq \left\Vert W_{hh} \right\Vert \left\Vert diag(\phi_{h}^{\prime}(W_{xh}^{T} \cdot X_{j+1} + W_{hh}^{T}\cdot h_{j} +b_{h}) \right\Vert</script>

<p>In this equation, we set <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-128-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3399" style="width: 1.629em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.324em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.629em, 1001.32em, 2.594em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-3400"><span class="msubsup" id="MathJax-Span-3401"><span style="display: inline-block; position: relative; width: 1.324em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.56em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3402" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.511em;"><span class="texatom" id="MathJax-Span-3403"><span class="mrow" id="MathJax-Span-3404"><span class="mi" id="MathJax-Span-3405" style="font-size: 70.7%; font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>γ</mi><mrow class="MJX-TeXAtom-ORD"><mi>W</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-128">\gamma_{W}</script>, the largest eigenvalue associated with <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-129-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow&gt;&lt;mo symmetric=&quot;true&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo symmetric=&quot;true&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3406" style="width: 3.509em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.848em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.324em, 1002.7em, 2.645em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-3407"><span class="mrow" id="MathJax-Span-3408"><span class="mo" id="MathJax-Span-3409" style="font-family: MathJax_Main;">∥</span><span class="msubsup" id="MathJax-Span-3410"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1001.07em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3411" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.968em;"><span class="texatom" id="MathJax-Span-3412"><span class="mrow" id="MathJax-Span-3413"><span class="mi" id="MathJax-Span-3414" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span class="mi" id="MathJax-Span-3415" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-3416" style="font-family: MathJax_Main;">∥</span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo symmetric="true">‖</mo><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi><mi>h</mi></mrow></msub><mo symmetric="true">‖</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-129">\left\Vert W_{hh} \right\Vert</script> as its upper bound, while <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-130-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3417" style="width: 1.273em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.019em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.629em, 1001.02em, 2.594em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-3418"><span class="msubsup" id="MathJax-Span-3419"><span style="display: inline-block; position: relative; width: 1.019em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.56em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3420" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.511em;"><span class="texatom" id="MathJax-Span-3421"><span class="mrow" id="MathJax-Span-3422"><span class="mi" id="MathJax-Span-3423" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>γ</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-130">\gamma_{h}</script> largest eigenvalue associated with <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-131-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow&gt;&lt;mo symmetric=&quot;true&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-variant&quot; mathvariant=&quot;normal&quot;&gt;&amp;#x2032;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo symmetric=&quot;true&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3424" style="width: 20.328em; display: inline-block;"><span style="display: inline-block; position: relative; width: 16.517em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(2.086em, 1016.36em, 3.559em, -999.997em); top: -3.046em; left: 0em;"><span class="mrow" id="MathJax-Span-3425"><span class="mrow" id="MathJax-Span-3426"><span class="mo" id="MathJax-Span-3427" style="vertical-align: 0.816em;"><span style="display: inline-block; position: relative; width: 0.511em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.249em; left: 0em;">∥<span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -3.097em; left: 0em;">∥<span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mrow" id="MathJax-Span-3428"><span class="mi" id="MathJax-Span-3429" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-3430" style="font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-3431" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-3432" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3433" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-3434"><span style="display: inline-block; position: relative; width: 1.07em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3435" style="font-family: MathJax_Math-italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.458em, 1000.26em, 4.118em, -999.997em); top: -4.317em; left: 0.612em;"><span class="texatom" id="MathJax-Span-3436"><span class="mrow" id="MathJax-Span-3437"><span class="mi" id="MathJax-Span-3438" style="font-size: 70.7%; font-family: MathJax_Main;">′</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.356em, 1000.46em, 4.169em, -999.997em); top: -3.707em; left: 0.612em;"><span class="texatom" id="MathJax-Span-3439"><span class="mrow" id="MathJax-Span-3440"><span class="mi" id="MathJax-Span-3441" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-3442" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-3443"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1001.07em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3444" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.407em, 1000.56em, 4.169em, -999.997em); top: -4.367em; left: 1.12em;"><span class="texatom" id="MathJax-Span-3445"><span class="mrow" id="MathJax-Span-3446"><span class="mi" id="MathJax-Span-3447" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.356em, 1000.87em, 4.169em, -999.997em); top: -3.707em; left: 0.968em;"><span class="texatom" id="MathJax-Span-3448"><span class="mrow" id="MathJax-Span-3449"><span class="mi" id="MathJax-Span-3450" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mi" id="MathJax-Span-3451" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-3452" style="font-family: MathJax_Main; padding-left: 0.206em;">⋅</span><span class="msubsup" id="MathJax-Span-3453" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 2.086em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1000.87em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3454" style="font-family: MathJax_Math-italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.816em;"><span class="texatom" id="MathJax-Span-3455"><span class="mrow" id="MathJax-Span-3456"><span class="mi" id="MathJax-Span-3457" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-3458" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-3459" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-3460" style="font-family: MathJax_Main; padding-left: 0.206em;">+</span><span class="msubsup" id="MathJax-Span-3461" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1001.07em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3462" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.407em, 1000.56em, 4.169em, -999.997em); top: -4.367em; left: 1.12em;"><span class="texatom" id="MathJax-Span-3463"><span class="mrow" id="MathJax-Span-3464"><span class="mi" id="MathJax-Span-3465" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.356em, 1000.92em, 4.169em, -999.997em); top: -3.707em; left: 0.968em;"><span class="texatom" id="MathJax-Span-3466"><span class="mrow" id="MathJax-Span-3467"><span class="mi" id="MathJax-Span-3468" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span class="mi" id="MathJax-Span-3469" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-3470" style="font-family: MathJax_Main; padding-left: 0.206em;">⋅</span><span class="msubsup" id="MathJax-Span-3471" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3472" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-3473"><span class="mrow" id="MathJax-Span-3474"><span class="mi" id="MathJax-Span-3475" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-3476" style="font-family: MathJax_Main; padding-left: 0.206em;">+</span><span class="msubsup" id="MathJax-Span-3477" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.41em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3478" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.409em;"><span class="texatom" id="MathJax-Span-3479"><span class="mrow" id="MathJax-Span-3480"><span class="mi" id="MathJax-Span-3481" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-3482" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-3483" style="vertical-align: 0.816em;"><span style="display: inline-block; position: relative; width: 0.511em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.249em; left: 0em;">∥<span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -3.097em; left: 0em;">∥<span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.051em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo symmetric="true">‖</mo><mrow><mi>d</mi><mi>i</mi><mi>a</mi><mi>g</mi><mo stretchy="false">(</mo><msubsup><mi>ϕ</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-variant" mathvariant="normal">′</mi></mrow></msubsup><mo stretchy="false">(</mo><msubsup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mi>h</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>T</mi></mrow></msubsup><mo>⋅</mo><msub><mi>X</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>+</mo><msubsup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi><mi>h</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>T</mi></mrow></msubsup><mo>⋅</mo><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi></mrow></msub><mo>+</mo><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi></mrow></msub><mo stretchy="false">)</mo></mrow><mo symmetric="true">‖</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-131">\left\Vert diag(\phi_{h}^{\prime}(W_{xh}^{T} \cdot X_{j+1} + W_{hh}^{T}\cdot h_{j} +b_{h}) \right\Vert</script> as its corresponding upper-bound.</p>

<p>Depending on the chosen activation function <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-132-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3484" style="width: 1.324em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.07em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.374em, 1001.07em, 2.594em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-3485"><span class="msubsup" id="MathJax-Span-3486"><span style="display: inline-block; position: relative; width: 1.07em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3487" style="font-family: MathJax_Math-italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.612em;"><span class="texatom" id="MathJax-Span-3488"><span class="mrow" id="MathJax-Span-3489"><span class="mi" id="MathJax-Span-3490" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>ϕ</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-132">\phi_{h}</script>, the derivative <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-133-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-variant&quot; mathvariant=&quot;normal&quot;&gt;&amp;#x2032;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3491" style="width: 1.324em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.07em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.374em, 1001.07em, 2.746em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-3492"><span class="msubsup" id="MathJax-Span-3493"><span style="display: inline-block; position: relative; width: 1.07em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3494" style="font-family: MathJax_Math-italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.458em, 1000.26em, 4.118em, -999.997em); top: -4.317em; left: 0.612em;"><span class="texatom" id="MathJax-Span-3495"><span class="mrow" id="MathJax-Span-3496"><span class="mi" id="MathJax-Span-3497" style="font-size: 70.7%; font-family: MathJax_Main;">′</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.356em, 1000.46em, 4.169em, -999.997em); top: -3.707em; left: 0.612em;"><span class="texatom" id="MathJax-Span-3498"><span class="mrow" id="MathJax-Span-3499"><span class="mi" id="MathJax-Span-3500" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>ϕ</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-variant" mathvariant="normal">′</mi></mrow></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-133">\phi_{h}^{\prime}</script> will be upper bounded by different values. For hyperbolic tangent function, we have <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-134-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3501" style="width: 3.458em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.797em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.425em, 1002.75em, 2.594em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-3502"><span class="msubsup" id="MathJax-Span-3503"><span style="display: inline-block; position: relative; width: 1.019em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.56em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3504" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.511em;"><span class="texatom" id="MathJax-Span-3505"><span class="mrow" id="MathJax-Span-3506"><span class="mi" id="MathJax-Span-3507" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-3508" style="font-family: MathJax_Main; padding-left: 0.257em;">=</span><span class="mn" id="MathJax-Span-3509" style="font-family: MathJax_Main; padding-left: 0.257em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>γ</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi></mrow></msub><mo>=</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-134">\gamma_{h} = 1</script> while for sigmoid function, we have <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-135-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0.25&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3510" style="width: 5.033em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.068em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.425em, 1004.02em, 2.594em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-3511"><span class="msubsup" id="MathJax-Span-3512"><span style="display: inline-block; position: relative; width: 1.019em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.56em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3513" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.511em;"><span class="texatom" id="MathJax-Span-3514"><span class="mrow" id="MathJax-Span-3515"><span class="mi" id="MathJax-Span-3516" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-3517" style="font-family: MathJax_Main; padding-left: 0.257em;">=</span><span class="mn" id="MathJax-Span-3518" style="font-family: MathJax_Main; padding-left: 0.257em;">0.25</span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>γ</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi></mrow></msub><mo>=</mo><mn>0.25</mn></math></span></span><script type="math/tex" id="MathJax-Element-135">\gamma_{h} = 0.25</script>. Thus, the chosen upper bounds <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-136-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3519" style="width: 1.629em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.324em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.629em, 1001.32em, 2.594em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-3520"><span class="msubsup" id="MathJax-Span-3521"><span style="display: inline-block; position: relative; width: 1.324em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.56em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3522" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.511em;"><span class="texatom" id="MathJax-Span-3523"><span class="mrow" id="MathJax-Span-3524"><span class="mi" id="MathJax-Span-3525" style="font-size: 70.7%; font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>γ</mi><mrow class="MJX-TeXAtom-ORD"><mi>W</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-136">\gamma_{W}</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-137-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3526" style="width: 1.273em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.019em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.629em, 1001.02em, 2.594em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-3527"><span class="msubsup" id="MathJax-Span-3528"><span style="display: inline-block; position: relative; width: 1.019em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.56em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3529" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.511em;"><span class="texatom" id="MathJax-Span-3530"><span class="mrow" id="MathJax-Span-3531"><span class="mi" id="MathJax-Span-3532" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>γ</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-137">\gamma_{h}</script> end up being a constant term resulting from their product:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-138-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow&gt;&lt;mo symmetric=&quot;true&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo symmetric=&quot;true&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mrow&gt;&lt;mo symmetric=&quot;true&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo symmetric=&quot;true&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo symmetric=&quot;true&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-variant&quot; mathvariant=&quot;normal&quot;&gt;&amp;#x2032;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo symmetric=&quot;true&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3533" style="width: 34.708em; display: inline-block;"><span style="display: inline-block; position: relative; width: 28.204em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(2.086em, 1028.2em, 4.83em, -999.997em); top: -3.707em; left: 0em;"><span class="mrow" id="MathJax-Span-3534"><span class="mrow" id="MathJax-Span-3535"><span class="mo" id="MathJax-Span-3536" style="vertical-align: 1.476em;"><span style="display: inline-block; position: relative; width: 0.511em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.249em; left: 0em;">∥<span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -1.776em; left: 0em;">∥<span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -2.538em; left: 0em;">∥<span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-3537"><span style="display: inline-block; position: relative; width: 2.543em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.474em, -999.997em); top: -4.774em; left: 50%; margin-left: -1.217em;"><span class="mrow" id="MathJax-Span-3538"><span class="mi" id="MathJax-Span-3539" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-3540"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3541" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-3542"><span class="mrow" id="MathJax-Span-3543"><span class="mi" id="MathJax-Span-3544" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-3545" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-3546" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1001.53em, 4.474em, -999.997em); top: -3.351em; left: 50%; margin-left: -0.76em;"><span class="mrow" id="MathJax-Span-3547"><span class="mi" id="MathJax-Span-3548" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-3549"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3550" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-3551"><span class="mrow" id="MathJax-Span-3552"><span class="mi" id="MathJax-Span-3553" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.54em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.543em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="mo" id="MathJax-Span-3554" style="vertical-align: 1.476em;"><span style="display: inline-block; position: relative; width: 0.511em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.249em; left: 0em;">∥<span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -1.776em; left: 0em;">∥<span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -2.538em; left: 0em;">∥<span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-3555" style="font-family: MathJax_Main; padding-left: 0.257em;">≤</span><span class="mrow" id="MathJax-Span-3556" style="padding-left: 0.257em;"><span class="mo" id="MathJax-Span-3557" style="font-family: MathJax_Main;">∥</span><span class="msubsup" id="MathJax-Span-3558"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1001.07em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3559" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.968em;"><span class="texatom" id="MathJax-Span-3560"><span class="mrow" id="MathJax-Span-3561"><span class="mi" id="MathJax-Span-3562" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span class="mi" id="MathJax-Span-3563" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-3564" style="font-family: MathJax_Main;">∥</span></span><span class="mrow" id="MathJax-Span-3565" style="padding-left: 0.155em;"><span class="mo" id="MathJax-Span-3566" style="vertical-align: 0.816em;"><span style="display: inline-block; position: relative; width: 0.511em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.249em; left: 0em;">∥<span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -3.097em; left: 0em;">∥<span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mrow" id="MathJax-Span-3567"><span class="mi" id="MathJax-Span-3568" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-3569" style="font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-3570" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-3571" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3572" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-3573"><span style="display: inline-block; position: relative; width: 1.07em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3574" style="font-family: MathJax_Math-italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.458em, 1000.26em, 4.118em, -999.997em); top: -4.317em; left: 0.612em;"><span class="texatom" id="MathJax-Span-3575"><span class="mrow" id="MathJax-Span-3576"><span class="mi" id="MathJax-Span-3577" style="font-size: 70.7%; font-family: MathJax_Main;">′</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.356em, 1000.46em, 4.169em, -999.997em); top: -3.707em; left: 0.612em;"><span class="texatom" id="MathJax-Span-3578"><span class="mrow" id="MathJax-Span-3579"><span class="mi" id="MathJax-Span-3580" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-3581" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-3582"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1001.07em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3583" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.407em, 1000.56em, 4.169em, -999.997em); top: -4.367em; left: 1.12em;"><span class="texatom" id="MathJax-Span-3584"><span class="mrow" id="MathJax-Span-3585"><span class="mi" id="MathJax-Span-3586" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.356em, 1000.87em, 4.169em, -999.997em); top: -3.707em; left: 0.968em;"><span class="texatom" id="MathJax-Span-3587"><span class="mrow" id="MathJax-Span-3588"><span class="mi" id="MathJax-Span-3589" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mi" id="MathJax-Span-3590" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-3591" style="font-family: MathJax_Main; padding-left: 0.206em;">⋅</span><span class="msubsup" id="MathJax-Span-3592" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 2.086em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1000.87em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3593" style="font-family: MathJax_Math-italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.816em;"><span class="texatom" id="MathJax-Span-3594"><span class="mrow" id="MathJax-Span-3595"><span class="mi" id="MathJax-Span-3596" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-3597" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-3598" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-3599" style="font-family: MathJax_Main; padding-left: 0.206em;">+</span><span class="msubsup" id="MathJax-Span-3600" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1001.07em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3601" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.407em, 1000.56em, 4.169em, -999.997em); top: -4.367em; left: 1.12em;"><span class="texatom" id="MathJax-Span-3602"><span class="mrow" id="MathJax-Span-3603"><span class="mi" id="MathJax-Span-3604" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.356em, 1000.92em, 4.169em, -999.997em); top: -3.707em; left: 0.968em;"><span class="texatom" id="MathJax-Span-3605"><span class="mrow" id="MathJax-Span-3606"><span class="mi" id="MathJax-Span-3607" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span class="mi" id="MathJax-Span-3608" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-3609" style="font-family: MathJax_Main; padding-left: 0.206em;">⋅</span><span class="msubsup" id="MathJax-Span-3610" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3611" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-3612"><span class="mrow" id="MathJax-Span-3613"><span class="mi" id="MathJax-Span-3614" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-3615" style="font-family: MathJax_Main; padding-left: 0.206em;">+</span><span class="msubsup" id="MathJax-Span-3616" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.41em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3617" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.409em;"><span class="texatom" id="MathJax-Span-3618"><span class="mrow" id="MathJax-Span-3619"><span class="mi" id="MathJax-Span-3620" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-3621" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-3622" style="vertical-align: 0.816em;"><span style="display: inline-block; position: relative; width: 0.511em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.249em; left: 0em;">∥<span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -3.097em; left: 0em;">∥<span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-3623" style="font-family: MathJax_Main; padding-left: 0.257em;">≤</span><span class="msubsup" id="MathJax-Span-3624" style="padding-left: 0.257em;"><span style="display: inline-block; position: relative; width: 1.324em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.56em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3625" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.511em;"><span class="texatom" id="MathJax-Span-3626"><span class="mrow" id="MathJax-Span-3627"><span class="mi" id="MathJax-Span-3628" style="font-size: 70.7%; font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3629"><span style="display: inline-block; position: relative; width: 1.019em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.56em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3630" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.511em;"><span class="texatom" id="MathJax-Span-3631"><span class="mrow" id="MathJax-Span-3632"><span class="mi" id="MathJax-Span-3633" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.712em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.128em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo symmetric="true">‖</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi></mrow></msub></mrow></mfrac><mo symmetric="true">‖</mo></mrow><mo>≤</mo><mrow><mo symmetric="true">‖</mo><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi><mi>h</mi></mrow></msub><mo symmetric="true">‖</mo></mrow><mrow><mo symmetric="true">‖</mo><mrow><mi>d</mi><mi>i</mi><mi>a</mi><mi>g</mi><mo stretchy="false">(</mo><msubsup><mi>ϕ</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-variant" mathvariant="normal">′</mi></mrow></msubsup><mo stretchy="false">(</mo><msubsup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mi>h</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>T</mi></mrow></msubsup><mo>⋅</mo><msub><mi>X</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>+</mo><msubsup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi><mi>h</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>T</mi></mrow></msubsup><mo>⋅</mo><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi></mrow></msub><mo>+</mo><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi></mrow></msub><mo stretchy="false">)</mo></mrow><mo symmetric="true">‖</mo></mrow><mo>≤</mo><msub><mi>γ</mi><mrow class="MJX-TeXAtom-ORD"><mi>W</mi></mrow></msub><msub><mi>γ</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi></mrow></msub></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-138">\left\Vert \frac{\partial h_{j+1}}{\partial h_{j}} \right\Vert \leq \left\Vert W_{hh} \right\Vert \left\Vert diag(\phi_{h}^{\prime}(W_{xh}^{T} \cdot X_{j+1} + W_{hh}^{T}\cdot h_{j} +b_{h}) \right\Vert \leq \gamma_{W} \gamma_{h}</script>

<p>The gradient <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-139-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3634" style="width: 2.442em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.984em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.019em, 1001.98em, 2.899em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-3635"><span class="mfrac" id="MathJax-Span-3636"><span style="display: inline-block; position: relative; width: 1.781em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.356em, 1001.68em, 4.322em, -999.997em); top: -4.571em; left: 50%; margin-left: -0.861em;"><span class="mrow" id="MathJax-Span-3637"><span class="mi" id="MathJax-Span-3638" style="font-size: 70.7%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-3639"><span style="display: inline-block; position: relative; width: 1.273em; height: 0px;"><span style="position: absolute; clip: rect(3.356em, 1000.41em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3640" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.91em; left: 0.409em;"><span class="texatom" id="MathJax-Span-3641"><span class="mrow" id="MathJax-Span-3642"><span class="mi" id="MathJax-Span-3643" style="font-size: 50%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-3644" style="font-size: 50%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-3645" style="font-size: 50%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.356em, 1001.12em, 4.271em, -999.997em); top: -3.605em; left: 50%; margin-left: -0.556em;"><span class="mrow" id="MathJax-Span-3646"><span class="mi" id="MathJax-Span-3647" style="font-size: 70.7%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-3648"><span style="display: inline-block; position: relative; width: 0.714em; height: 0px;"><span style="position: absolute; clip: rect(3.356em, 1000.41em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3649" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.91em; left: 0.409em;"><span class="mi" id="MathJax-Span-3650" style="font-size: 50%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1001.78em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.781em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.684em; border-left: 0px solid; width: 0px; height: 2.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mi>k</mi></msub></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-139">\frac{\partial h_{t+1}}{\partial h_k}</script> is a product of Jacobian matrices that are multiplied many times, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-140-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3651" style="width: 2.594em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.086em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.374em, 1002.09em, 2.492em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-3652"><span class="mi" id="MathJax-Span-3653" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-3654" style="font-family: MathJax_Main; padding-left: 0.206em;">−</span><span class="mi" id="MathJax-Span-3655" style="font-family: MathJax_Math-italic; padding-left: 0.206em;">k</span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mo>−</mo><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-140">t-k</script> times in our case:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-141-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow&gt;&lt;mo symmetric=&quot;true&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo symmetric=&quot;true&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo symmetric=&quot;true&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;mrow&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x220F;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;mo symmetric=&quot;true&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3656" style="width: 19.515em; display: inline-block;"><span style="display: inline-block; position: relative; width: 15.856em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(2.086em, 1015.86em, 5.592em, -999.997em); top: -4.063em; left: 0em;"><span class="mrow" id="MathJax-Span-3657"><span class="mrow" id="MathJax-Span-3658"><span class="mo" id="MathJax-Span-3659" style="vertical-align: 1.374em;"><span style="display: inline-block; position: relative; width: 0.511em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.249em; left: 0em;">∥<span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -1.979em; left: 0em;">∥<span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -2.64em; left: 0em;">∥<span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-3660"><span style="display: inline-block; position: relative; width: 2.492em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.372em, -999.997em); top: -4.672em; left: 50%; margin-left: -1.166em;"><span class="mrow" id="MathJax-Span-3661"><span class="mi" id="MathJax-Span-3662" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-3663"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3664" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-3665"><span class="mrow" id="MathJax-Span-3666"><span class="mi" id="MathJax-Span-3667" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-3668" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-3669" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1001.58em, 4.322em, -999.997em); top: -3.351em; left: 50%; margin-left: -0.81em;"><span class="mrow" id="MathJax-Span-3670"><span class="mi" id="MathJax-Span-3671" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-3672"><span style="display: inline-block; position: relative; width: 1.019em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3673" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="mi" id="MathJax-Span-3674" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.49em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.492em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="mo" id="MathJax-Span-3675" style="vertical-align: 1.374em;"><span style="display: inline-block; position: relative; width: 0.511em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.249em; left: 0em;">∥<span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -1.979em; left: 0em;">∥<span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -2.64em; left: 0em;">∥<span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-3676" style="font-family: MathJax_Main; padding-left: 0.257em;">=</span><span class="mrow" id="MathJax-Span-3677" style="padding-left: 0.257em;"><span class="mo" id="MathJax-Span-3678" style="vertical-align: 1.832em;"><span style="display: inline-block; position: relative; width: 0.511em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.249em; left: 0em;">∥<span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -1.065em; left: 0em;">∥<span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -2.538em; left: 0em;">∥<span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -1.776em; left: 0em;">∥<span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mrow" id="MathJax-Span-3679"><span class="munderover" id="MathJax-Span-3680"><span style="display: inline-block; position: relative; width: 1.273em; height: 0px;"><span style="position: absolute; clip: rect(2.899em, 1001.22em, 4.627em, -999.997em); top: -4.012em; left: 0em;"><span class="mo" id="MathJax-Span-3681" style="font-family: MathJax_Size2; vertical-align: 0em;">∏</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.356em, 1001.22em, 4.423em, -999.997em); top: -2.894em; left: 0.053em;"><span class="texatom" id="MathJax-Span-3682"><span class="mrow" id="MathJax-Span-3683"><span class="mi" id="MathJax-Span-3684" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-3685" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mi" id="MathJax-Span-3686" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.305em, 1000.26em, 4.169em, -999.997em); top: -5.18em; left: 0.511em;"><span class="texatom" id="MathJax-Span-3687"><span class="mrow" id="MathJax-Span-3688"><span class="mi" id="MathJax-Span-3689" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-3690" style="padding-left: 0.155em;"><span style="display: inline-block; position: relative; width: 2.543em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.474em, -999.997em); top: -4.774em; left: 50%; margin-left: -1.217em;"><span class="mrow" id="MathJax-Span-3691"><span class="mi" id="MathJax-Span-3692" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-3693"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3694" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-3695"><span class="mrow" id="MathJax-Span-3696"><span class="mi" id="MathJax-Span-3697" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-3698" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-3699" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1001.53em, 4.474em, -999.997em); top: -3.351em; left: 50%; margin-left: -0.76em;"><span class="mrow" id="MathJax-Span-3700"><span class="mi" id="MathJax-Span-3701" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-3702"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3703" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-3704"><span class="mrow" id="MathJax-Span-3705"><span class="mi" id="MathJax-Span-3706" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.54em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.543em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-3707" style="vertical-align: 1.832em;"><span style="display: inline-block; position: relative; width: 0.511em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.249em; left: 0em;">∥<span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -1.065em; left: 0em;">∥<span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -2.538em; left: 0em;">∥<span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -1.776em; left: 0em;">∥<span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-3708" style="font-family: MathJax_Main; padding-left: 0.257em;">≤</span><span class="mo" id="MathJax-Span-3709" style="font-family: MathJax_Main; padding-left: 0.257em;">(</span><span class="msubsup" id="MathJax-Span-3710"><span style="display: inline-block; position: relative; width: 1.324em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.56em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3711" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.511em;"><span class="texatom" id="MathJax-Span-3712"><span class="mrow" id="MathJax-Span-3713"><span class="mi" id="MathJax-Span-3714" style="font-size: 70.7%; font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3715"><span style="display: inline-block; position: relative; width: 1.019em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.56em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3716" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.511em;"><span class="texatom" id="MathJax-Span-3717"><span class="mrow" id="MathJax-Span-3718"><span class="mi" id="MathJax-Span-3719" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3720"><span style="display: inline-block; position: relative; width: 1.629em; height: 0px;"><span style="position: absolute; clip: rect(3.102em, 1000.31em, 4.423em, -999.997em); top: -4.012em; left: 0em;"><span class="mo" id="MathJax-Span-3721" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -4.418em; left: 0.409em;"><span class="texatom" id="MathJax-Span-3722"><span class="mrow" id="MathJax-Span-3723"><span class="mi" id="MathJax-Span-3724" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-3725" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-3726" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.068em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.747em; border-left: 0px solid; width: 0px; height: 4.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo symmetric="true">‖</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mi>k</mi></msub></mrow></mfrac><mo symmetric="true">‖</mo></mrow><mo>=</mo><mrow><mo symmetric="true">‖</mo><mrow><munderover><mo>∏</mo><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>=</mo><mi>k</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></munderover><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi></mrow></msub></mrow></mfrac></mrow><mo symmetric="true">‖</mo></mrow><mo>≤</mo><mo stretchy="false">(</mo><msub><mi>γ</mi><mrow class="MJX-TeXAtom-ORD"><mi>W</mi></mrow></msub><msub><mi>γ</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi></mrow></msub><msup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mi>k</mi></mrow></msup></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-141">\left\Vert \frac{\partial h_{t+1}}{\partial h_k} \right\Vert = \left\Vert \prod^{t}_{j=k} \frac{\partial h_{j+1}}{\partial h_{j}} \right\Vert \leq (\gamma_{W} \gamma_{h})^{t-k}</script>

<p>This can become very small or very large quickly, and the locality assumption of gradient descent breaks down as the sequence gets longer (i.e the distance between <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-142-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3727" style="width: 0.46em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.358em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.476em, 1000.31em, 2.391em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-3728"><span class="mi" id="MathJax-Span-3729" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-142">t</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-143-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3730" style="width: 0.663em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.511em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.374em, 1000.51em, 2.391em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-3731"><span class="mi" id="MathJax-Span-3732" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-143">k</script> increases). Then the value of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-144-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3733" style="width: 0.663em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.511em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.629em, 1000.51em, 2.594em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-3734"><span class="mi" id="MathJax-Span-3735" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>γ</mi></math></span></span><script type="math/tex" id="MathJax-Element-144">\gamma</script> will determine if the gradient either gets very large (explodes) or gets very small (vanishes).</p>

<p>Since <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-145-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3736" style="width: 0.663em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.511em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.629em, 1000.51em, 2.594em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-3737"><span class="mi" id="MathJax-Span-3738" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>γ</mi></math></span></span><script type="math/tex" id="MathJax-Element-145">\gamma</script>  is associated with the leading eigenvalues of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-146-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3739" style="width: 2.543em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.035em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(0.968em, 1002.03em, 3.001em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-3740"><span class="mfrac" id="MathJax-Span-3741"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.356em, 1001.73em, 4.372em, -999.997em); top: -4.621em; left: 50%; margin-left: -0.861em;"><span class="mrow" id="MathJax-Span-3742"><span class="mi" id="MathJax-Span-3743" style="font-size: 70.7%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-3744"><span style="display: inline-block; position: relative; width: 1.324em; height: 0px;"><span style="position: absolute; clip: rect(3.356em, 1000.41em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3745" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.91em; left: 0.409em;"><span class="texatom" id="MathJax-Span-3746"><span class="mrow" id="MathJax-Span-3747"><span class="mi" id="MathJax-Span-3748" style="font-size: 50%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-3749" style="font-size: 50%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-3750" style="font-size: 50%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.356em, 1001.07em, 4.372em, -999.997em); top: -3.605em; left: 50%; margin-left: -0.506em;"><span class="mrow" id="MathJax-Span-3751"><span class="mi" id="MathJax-Span-3752" style="font-size: 70.7%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-3753"><span style="display: inline-block; position: relative; width: 0.663em; height: 0px;"><span style="position: absolute; clip: rect(3.356em, 1000.41em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3754" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.91em; left: 0.409em;"><span class="texatom" id="MathJax-Span-3755"><span class="mrow" id="MathJax-Span-3756"><span class="mi" id="MathJax-Span-3757" style="font-size: 50%; font-family: MathJax_Math-italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1001.83em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.832em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.809em; border-left: 0px solid; width: 0px; height: 2.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi></mrow></msub></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-146"> \frac{\partial h_{j+1}}{\partial h_{j}}</script>, the recursive product of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-147-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3758" style="width: 2.594em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.086em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.374em, 1002.09em, 2.492em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-3759"><span class="mi" id="MathJax-Span-3760" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-3761" style="font-family: MathJax_Main; padding-left: 0.206em;">−</span><span class="mi" id="MathJax-Span-3762" style="font-family: MathJax_Math-italic; padding-left: 0.206em;">k</span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mo>−</mo><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-147">t-k</script> Jacobian matrices makes it possible to influence the overall gradient in such a way that for <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-148-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3763" style="width: 2.899em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.34em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.425em, 1002.29em, 2.594em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-3764"><span class="mi" id="MathJax-Span-3765" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3766" style="font-family: MathJax_Main; padding-left: 0.257em;">&lt;</span><span class="mn" id="MathJax-Span-3767" style="font-family: MathJax_Main; padding-left: 0.257em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>γ</mi><mo>&lt;</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-148">\gamma < 1</script> the gradient tends to vanish while for <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-149-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo&gt;&amp;gt;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3768" style="width: 2.899em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.34em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.425em, 1002.29em, 2.594em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-3769"><span class="mi" id="MathJax-Span-3770" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3771" style="font-family: MathJax_Main; padding-left: 0.257em;">&gt;</span><span class="mn" id="MathJax-Span-3772" style="font-family: MathJax_Main; padding-left: 0.257em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>γ</mi><mo>&gt;</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-149">\gamma > 1</script> the gradient tends to explode.</p>

<h1 id="vanishingexploding-gradients-with-lstms">Vanishing/Exploding Gradients with LSTMs</h1>
<p>As can be seen easily above, the biggest problem with causing gradients to vanish is the multiplication of recursive derivatives. One of the approaches that was proposed to overcome this issue is to use gated structures such as Long Short-Term Memory Networks.</p>

<p>In the <a href="http://www.bioinf.jku.at/publications/older/2604.pdf" target="_blank">original LSTM formulation</a>, the value of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-150-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3773" style="width: 1.324em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.07em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.374em, 1001.07em, 2.543em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-3774"><span class="msubsup" id="MathJax-Span-3775"><span style="display: inline-block; position: relative; width: 1.07em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.76em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3776" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.714em;"><span class="texatom" id="MathJax-Span-3777"><span class="mrow" id="MathJax-Span-3778"><span class="mi" id="MathJax-Span-3779" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-150">C_{t}</script> depends on the previous value of cell state and an update term weighted by the input gate (pp. 7):</p>

<p><img src="./Backpropagation Through Time for Recurrent Neural Network _ Mustafa Murat ARAT_files/lstm_internal_state.png" alt=""></p>

<p>which we can re-write it in our terms as:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-151-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2218;&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3780" style="width: 10.064em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.183em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.12em, 1008.18em, 2.594em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-3781"><span class="msubsup" id="MathJax-Span-3782"><span style="display: inline-block; position: relative; width: 1.07em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.76em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3783" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.714em;"><span class="texatom" id="MathJax-Span-3784"><span class="mrow" id="MathJax-Span-3785"><span class="mi" id="MathJax-Span-3786" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-3787" style="font-family: MathJax_Main; padding-left: 0.257em;">=</span><span class="msubsup" id="MathJax-Span-3788" style="padding-left: 0.257em;"><span style="display: inline-block; position: relative; width: 1.933em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.76em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3789" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.714em;"><span class="texatom" id="MathJax-Span-3790"><span class="mrow" id="MathJax-Span-3791"><span class="mi" id="MathJax-Span-3792" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-3793" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-3794" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-3795" style="font-family: MathJax_Main; padding-left: 0.206em;">+</span><span class="msubsup" id="MathJax-Span-3796" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 0.663em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1000.31em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3797" style="font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.358em;"><span class="texatom" id="MathJax-Span-3798"><span class="mrow" id="MathJax-Span-3799"><span class="mi" id="MathJax-Span-3800" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-3801" style="font-family: MathJax_Main; padding-left: 0.206em;">∘</span><span class="msubsup" id="MathJax-Span-3802" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px;"><span style="position: absolute; clip: rect(2.899em, 1000.82em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="texatom" id="MathJax-Span-3803"><span class="mrow" id="MathJax-Span-3804"><span class="munderover" id="MathJax-Span-3805"><span style="display: inline-block; position: relative; width: 0.816em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.76em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3806" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1000.56em, 3.559em, -999.997em); top: -4.266em; left: 0.257em;"><span class="mo" id="MathJax-Span-3807" style=""><span style="font-family: MathJax_Size1;">˜</span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.816em;"><span class="texatom" id="MathJax-Span-3808"><span class="mrow" id="MathJax-Span-3809"><span class="mi" id="MathJax-Span-3810" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub><mo>=</mo><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>i</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub><mo>∘</mo><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>C</mi><mo>~</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-151">C_{t} = C_{t-1} + i_{t}  \circ \widetilde{C}_{t}</script>

<p>The original motivation behind this LSTM was to make this recursive derivative have a constant value, which was equal to 1 because of the  truncated BPTT algorithm. In other words, the gradient calculation was truncated so as not to flow back to the input or candidate gates. If this is the case, then our gradients would neither explode or vanish. However, this formulation doesn’t work well because the cell state tends to grow uncontrollably. In order to prevent this unbounded growth, a forget gate was added to scale the previous cell state, leading to the more <a href="ftp://ftp.idsia.ch/pub/juergen/nn_2005.pdf" target="_blank">modern formulation (Appendix A)</a>:</p>

<p><img src="./Backpropagation Through Time for Recurrent Neural Network _ Mustafa Murat ARAT_files/modern_lstm_internal_state.png" alt=""></p>

<p>which we can re-write it in our terms as:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-152-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2218;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2218;&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3811" style="width: 12.198em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.911em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.12em, 1009.91em, 2.594em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-3812"><span class="msubsup" id="MathJax-Span-3813"><span style="display: inline-block; position: relative; width: 1.07em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.76em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3814" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.714em;"><span class="texatom" id="MathJax-Span-3815"><span class="mrow" id="MathJax-Span-3816"><span class="mi" id="MathJax-Span-3817" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-3818" style="font-family: MathJax_Main; padding-left: 0.257em;">=</span><span class="msubsup" id="MathJax-Span-3819" style="padding-left: 0.257em;"><span style="display: inline-block; position: relative; width: 0.816em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3820" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.511em;"><span class="texatom" id="MathJax-Span-3821"><span class="mrow" id="MathJax-Span-3822"><span class="mi" id="MathJax-Span-3823" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-3824" style="font-family: MathJax_Main; padding-left: 0.206em;">∘</span><span class="msubsup" id="MathJax-Span-3825" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 1.933em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.76em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3826" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.714em;"><span class="texatom" id="MathJax-Span-3827"><span class="mrow" id="MathJax-Span-3828"><span class="mi" id="MathJax-Span-3829" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-3830" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-3831" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-3832" style="font-family: MathJax_Main; padding-left: 0.206em;">+</span><span class="msubsup" id="MathJax-Span-3833" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 0.663em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1000.31em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3834" style="font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.358em;"><span class="texatom" id="MathJax-Span-3835"><span class="mrow" id="MathJax-Span-3836"><span class="mi" id="MathJax-Span-3837" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-3838" style="font-family: MathJax_Main; padding-left: 0.206em;">∘</span><span class="msubsup" id="MathJax-Span-3839" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px;"><span style="position: absolute; clip: rect(2.899em, 1000.82em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="texatom" id="MathJax-Span-3840"><span class="mrow" id="MathJax-Span-3841"><span class="munderover" id="MathJax-Span-3842"><span style="display: inline-block; position: relative; width: 0.816em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.76em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3843" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1000.56em, 3.559em, -999.997em); top: -4.266em; left: 0.257em;"><span class="mo" id="MathJax-Span-3844" style=""><span style="font-family: MathJax_Size1;">˜</span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.816em;"><span class="texatom" id="MathJax-Span-3845"><span class="mrow" id="MathJax-Span-3846"><span class="mi" id="MathJax-Span-3847" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub><mo>=</mo><msub><mi>f</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub><mo>∘</mo><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>i</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub><mo>∘</mo><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>C</mi><mo>~</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-152">C_{t} = f_{t}\circ C_{t-1} + i_{t}  \circ \widetilde{C}_{t}</script>

<p>However, there are so many documents out there online, that claim that the reason of LSTM solving this vanishing gradient problem is that under this update rule the recursive derivative is equal to 1 in the case of original LSTM or <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-153-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3848" style="width: 0.714em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.561em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.374em, 1000.56em, 2.594em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-3849"><span class="mi" id="MathJax-Span-3850" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi></math></span></span><script type="math/tex" id="MathJax-Element-153">f</script> (forget gate) in the case of modern LSTM. However, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-154-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3851" style="width: 1.019em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.816em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.374em, 1000.82em, 2.594em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-3852"><span class="msubsup" id="MathJax-Span-3853"><span style="display: inline-block; position: relative; width: 0.816em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3854" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.511em;"><span class="texatom" id="MathJax-Span-3855"><span class="mrow" id="MathJax-Span-3856"><span class="mi" id="MathJax-Span-3857" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>f</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-154">f_{t}</script>, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-155-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3858" style="width: 0.816em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.663em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.425em, 1000.66em, 2.543em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-3859"><span class="msubsup" id="MathJax-Span-3860"><span style="display: inline-block; position: relative; width: 0.663em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1000.31em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3861" style="font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.358em;"><span class="texatom" id="MathJax-Span-3862"><span class="mrow" id="MathJax-Span-3863"><span class="mi" id="MathJax-Span-3864" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>i</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-155">i_{t}</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-156-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3865" style="width: 1.324em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.07em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.12em, 1001.07em, 2.543em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-3866"><span class="texatom" id="MathJax-Span-3867"><span class="mrow" id="MathJax-Span-3868"><span class="munderover" id="MathJax-Span-3869"><span style="display: inline-block; position: relative; width: 1.07em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1001.07em, 4.322em, -999.997em); top: -4.012em; left: 0em;"><span class="msubsup" id="MathJax-Span-3870"><span style="display: inline-block; position: relative; width: 1.07em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.76em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3871" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.714em;"><span class="texatom" id="MathJax-Span-3872"><span class="mrow" id="MathJax-Span-3873"><span class="mi" id="MathJax-Span-3874" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.102em, 1001.02em, 3.559em, -999.997em); top: -4.215em; left: 0.003em;"><span class="mo" id="MathJax-Span-3875" style=""><span style="font-family: MathJax_Size2;">˜</span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.503em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mover><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub><mo>~</mo></mover></mrow></math></span></span><script type="math/tex" id="MathJax-Element-156">\widetilde{C_{t}}</script> are all functions of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-157-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3876" style="width: 1.324em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.07em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.374em, 1001.07em, 2.543em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-3877"><span class="msubsup" id="MathJax-Span-3878"><span style="display: inline-block; position: relative; width: 1.07em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.76em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3879" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.714em;"><span class="texatom" id="MathJax-Span-3880"><span class="mrow" id="MathJax-Span-3881"><span class="mi" id="MathJax-Span-3882" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-157">C_{t}</script> and so we have to take them into consideration when calculating the derivation of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-158-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3883" style="width: 1.324em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.07em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.374em, 1001.07em, 2.543em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-3884"><span class="msubsup" id="MathJax-Span-3885"><span style="display: inline-block; position: relative; width: 1.07em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.76em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3886" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.714em;"><span class="texatom" id="MathJax-Span-3887"><span class="mrow" id="MathJax-Span-3888"><span class="mi" id="MathJax-Span-3889" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-158">C_{t}</script> with respect to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-159-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3890" style="width: 2.391em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.933em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.374em, 1001.93em, 2.594em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-3891"><span class="msubsup" id="MathJax-Span-3892"><span style="display: inline-block; position: relative; width: 1.933em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.76em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3893" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.714em;"><span class="texatom" id="MathJax-Span-3894"><span class="mrow" id="MathJax-Span-3895"><span class="mi" id="MathJax-Span-3896" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-3897" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-3898" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-159">C_{t-1}</script> .</p>

<p><strong>NOTE:</strong> In the case of the forget gate LSTM, the recursive derivative will still be a produce of many terms between 0 and 1 (the forget gates at each time step), however in practice this is not as much of a problem compared to the case of RNNs. One thing to remember is that our network has direct control over what the values of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-160-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3899" style="width: 0.714em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.561em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.374em, 1000.56em, 2.594em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-3900"><span class="mi" id="MathJax-Span-3901" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi></math></span></span><script type="math/tex" id="MathJax-Element-160">f</script> will be. If it needs to remember something, it can easily set the value of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-161-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3902" style="width: 0.714em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.561em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.374em, 1000.56em, 2.594em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-3903"><span class="mi" id="MathJax-Span-3904" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi></math></span></span><script type="math/tex" id="MathJax-Element-161">f</script> to be high (lets say around 0.95). These values thus tend to shrink at a much slower rate than when compared to the derivative values of hyperbolic tangent function, which later on during the training processes, are likely to be saturated and thus have a value close to 0.</p>

<p>Therefore, let’s find the full derivative <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-162-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3905" style="width: 2.594em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.086em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.07em, 1002.09em, 2.95em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-3906"><span class="mfrac" id="MathJax-Span-3907"><span style="display: inline-block; position: relative; width: 1.883em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.356em, 1001.12em, 4.271em, -999.997em); top: -4.52em; left: 50%; margin-left: -0.556em;"><span class="mrow" id="MathJax-Span-3908"><span class="mi" id="MathJax-Span-3909" style="font-size: 70.7%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-3910"><span style="display: inline-block; position: relative; width: 0.765em; height: 0px;"><span style="position: absolute; clip: rect(3.356em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3911" style="font-size: 70.7%; font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.91em; left: 0.511em;"><span class="texatom" id="MathJax-Span-3912"><span class="mrow" id="MathJax-Span-3913"><span class="mi" id="MathJax-Span-3914" style="font-size: 50%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.356em, 1001.78em, 4.322em, -999.997em); top: -3.605em; left: 50%; margin-left: -0.861em;"><span class="mrow" id="MathJax-Span-3915"><span class="mi" id="MathJax-Span-3916" style="font-size: 70.7%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-3917"><span style="display: inline-block; position: relative; width: 1.374em; height: 0px;"><span style="position: absolute; clip: rect(3.356em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3918" style="font-size: 70.7%; font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.91em; left: 0.511em;"><span class="texatom" id="MathJax-Span-3919"><span class="mrow" id="MathJax-Span-3920"><span class="mi" id="MathJax-Span-3921" style="font-size: 50%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-3922" style="font-size: 50%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-3923" style="font-size: 50%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1001.88em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.883em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.747em; border-left: 0px solid; width: 0px; height: 2.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-162">\frac{\partial C_{t}}{\partial C_{t-1}}</script>. Remember that <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-163-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3924" style="width: 1.324em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.07em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.374em, 1001.07em, 2.543em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-3925"><span class="msubsup" id="MathJax-Span-3926"><span style="display: inline-block; position: relative; width: 1.07em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.76em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3927" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.714em;"><span class="texatom" id="MathJax-Span-3928"><span class="mrow" id="MathJax-Span-3929"><span class="mi" id="MathJax-Span-3930" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-163">C_{t}</script> is a function of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-164-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3931" style="width: 1.019em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.816em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.374em, 1000.82em, 2.594em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-3932"><span class="msubsup" id="MathJax-Span-3933"><span style="display: inline-block; position: relative; width: 0.816em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3934" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.511em;"><span class="texatom" id="MathJax-Span-3935"><span class="mrow" id="MathJax-Span-3936"><span class="mi" id="MathJax-Span-3937" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>f</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-164">f_{t}</script> (the forget gate), <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-165-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3938" style="width: 0.816em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.663em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.425em, 1000.66em, 2.543em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-3939"><span class="msubsup" id="MathJax-Span-3940"><span style="display: inline-block; position: relative; width: 0.663em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1000.31em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3941" style="font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.358em;"><span class="texatom" id="MathJax-Span-3942"><span class="mrow" id="MathJax-Span-3943"><span class="mi" id="MathJax-Span-3944" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>i</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-165">i_{t}</script> (input gate) and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-166-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3945" style="width: 1.324em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.07em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.12em, 1001.07em, 2.543em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-3946"><span class="texatom" id="MathJax-Span-3947"><span class="mrow" id="MathJax-Span-3948"><span class="munderover" id="MathJax-Span-3949"><span style="display: inline-block; position: relative; width: 1.07em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1001.07em, 4.322em, -999.997em); top: -4.012em; left: 0em;"><span class="msubsup" id="MathJax-Span-3950"><span style="display: inline-block; position: relative; width: 1.07em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.76em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3951" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.714em;"><span class="texatom" id="MathJax-Span-3952"><span class="mrow" id="MathJax-Span-3953"><span class="mi" id="MathJax-Span-3954" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.102em, 1001.02em, 3.559em, -999.997em); top: -4.215em; left: 0.003em;"><span class="mo" id="MathJax-Span-3955" style=""><span style="font-family: MathJax_Size2;">˜</span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.503em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mover><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub><mo>~</mo></mover></mrow></math></span></span><script type="math/tex" id="MathJax-Element-166">\widetilde{C_{t}}</script> (candidate input), each of these being a function of 
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-167-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3956" style="width: 2.391em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.933em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.374em, 1001.93em, 2.594em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-3957"><span class="msubsup" id="MathJax-Span-3958"><span style="display: inline-block; position: relative; width: 1.933em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.76em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3959" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.714em;"><span class="texatom" id="MathJax-Span-3960"><span class="mrow" id="MathJax-Span-3961"><span class="mi" id="MathJax-Span-3962" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-3963" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-3964" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-167">C_{t-1}</script> (since they are all functions of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-168-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3965" style="width: 2.289em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.374em, 1001.83em, 2.594em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-3966"><span class="msubsup" id="MathJax-Span-3967"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3968" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-3969"><span class="mrow" id="MathJax-Span-3970"><span class="mi" id="MathJax-Span-3971" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-3972" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-3973" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-168">h_{t-1}</script>). Via the multivariate chain rule we get:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-169-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3974" style="width: 40.755em; display: inline-block;"><span style="display: inline-block; position: relative; width: 33.133em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(0.46em, 1033.13em, 3.458em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-3975"><span class="mfrac" id="MathJax-Span-3976"><span style="display: inline-block; position: relative; width: 2.645em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1001.63em, 4.322em, -999.997em); top: -4.672em; left: 50%; margin-left: -0.81em;"><span class="mrow" id="MathJax-Span-3977"><span class="mi" id="MathJax-Span-3978" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-3979"><span style="display: inline-block; position: relative; width: 1.07em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.76em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3980" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.714em;"><span class="texatom" id="MathJax-Span-3981"><span class="mrow" id="MathJax-Span-3982"><span class="mi" id="MathJax-Span-3983" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1002.49em, 4.372em, -999.997em); top: -3.351em; left: 50%; margin-left: -1.268em;"><span class="mrow" id="MathJax-Span-3984"><span class="mi" id="MathJax-Span-3985" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-3986"><span style="display: inline-block; position: relative; width: 1.933em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.76em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3987" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.714em;"><span class="texatom" id="MathJax-Span-3988"><span class="mrow" id="MathJax-Span-3989"><span class="mi" id="MathJax-Span-3990" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-3991" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-3992" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.64em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.645em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="mo" id="MathJax-Span-3993" style="font-family: MathJax_Main; padding-left: 0.257em;">=</span><span class="mfrac" id="MathJax-Span-3994" style="padding-left: 0.257em;"><span style="display: inline-block; position: relative; width: 1.73em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1001.63em, 4.322em, -999.997em); top: -4.672em; left: 50%; margin-left: -0.81em;"><span class="mrow" id="MathJax-Span-3995"><span class="mi" id="MathJax-Span-3996" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-3997"><span style="display: inline-block; position: relative; width: 1.07em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.76em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-3998" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.714em;"><span class="texatom" id="MathJax-Span-3999"><span class="mrow" id="MathJax-Span-4000"><span class="mi" id="MathJax-Span-4001" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1001.37em, 4.372em, -999.997em); top: -3.351em; left: 50%; margin-left: -0.709em;"><span class="mrow" id="MathJax-Span-4002"><span class="mi" id="MathJax-Span-4003" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-4004"><span style="display: inline-block; position: relative; width: 0.816em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-4005" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.511em;"><span class="texatom" id="MathJax-Span-4006"><span class="mrow" id="MathJax-Span-4007"><span class="mi" id="MathJax-Span-4008" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1001.73em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.73em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-4009"><span style="display: inline-block; position: relative; width: 2.492em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1001.37em, 4.372em, -999.997em); top: -4.672em; left: 50%; margin-left: -0.709em;"><span class="mrow" id="MathJax-Span-4010"><span class="mi" id="MathJax-Span-4011" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-4012"><span style="display: inline-block; position: relative; width: 0.816em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-4013" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.511em;"><span class="texatom" id="MathJax-Span-4014"><span class="mrow" id="MathJax-Span-4015"><span class="mi" id="MathJax-Span-4016" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.372em, -999.997em); top: -3.351em; left: 50%; margin-left: -1.166em;"><span class="mrow" id="MathJax-Span-4017"><span class="mi" id="MathJax-Span-4018" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-4019"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-4020" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-4021"><span class="mrow" id="MathJax-Span-4022"><span class="mi" id="MathJax-Span-4023" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-4024" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-4025" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.49em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.492em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-4026"><span style="display: inline-block; position: relative; width: 2.645em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.372em, -999.997em); top: -4.672em; left: 50%; margin-left: -1.166em;"><span class="mrow" id="MathJax-Span-4027"><span class="mi" id="MathJax-Span-4028" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-4029"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-4030" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-4031"><span class="mrow" id="MathJax-Span-4032"><span class="mi" id="MathJax-Span-4033" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-4034" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-4035" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1002.49em, 4.372em, -999.997em); top: -3.351em; left: 50%; margin-left: -1.268em;"><span class="mrow" id="MathJax-Span-4036"><span class="mi" id="MathJax-Span-4037" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-4038"><span style="display: inline-block; position: relative; width: 1.933em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.76em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-4039" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.714em;"><span class="texatom" id="MathJax-Span-4040"><span class="mrow" id="MathJax-Span-4041"><span class="mi" id="MathJax-Span-4042" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-4043" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-4044" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.64em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.645em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="mo" id="MathJax-Span-4045" style="font-family: MathJax_Main; padding-left: 0.206em;">+</span><span class="mfrac" id="MathJax-Span-4046" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 1.73em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1001.63em, 4.322em, -999.997em); top: -4.672em; left: 50%; margin-left: -0.81em;"><span class="mrow" id="MathJax-Span-4047"><span class="mi" id="MathJax-Span-4048" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-4049"><span style="display: inline-block; position: relative; width: 1.07em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.76em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-4050" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.714em;"><span class="texatom" id="MathJax-Span-4051"><span class="mrow" id="MathJax-Span-4052"><span class="mi" id="MathJax-Span-4053" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1001.22em, 4.322em, -999.997em); top: -3.351em; left: 50%; margin-left: -0.607em;"><span class="mrow" id="MathJax-Span-4054"><span class="mi" id="MathJax-Span-4055" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-4056"><span style="display: inline-block; position: relative; width: 0.663em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1000.31em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-4057" style="font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.358em;"><span class="texatom" id="MathJax-Span-4058"><span class="mrow" id="MathJax-Span-4059"><span class="mi" id="MathJax-Span-4060" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1001.73em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.73em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-4061"><span style="display: inline-block; position: relative; width: 2.492em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1001.22em, 4.322em, -999.997em); top: -4.672em; left: 50%; margin-left: -0.607em;"><span class="mrow" id="MathJax-Span-4062"><span class="mi" id="MathJax-Span-4063" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-4064"><span style="display: inline-block; position: relative; width: 0.663em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1000.31em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-4065" style="font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.358em;"><span class="texatom" id="MathJax-Span-4066"><span class="mrow" id="MathJax-Span-4067"><span class="mi" id="MathJax-Span-4068" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.372em, -999.997em); top: -3.351em; left: 50%; margin-left: -1.166em;"><span class="mrow" id="MathJax-Span-4069"><span class="mi" id="MathJax-Span-4070" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-4071"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-4072" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-4073"><span class="mrow" id="MathJax-Span-4074"><span class="mi" id="MathJax-Span-4075" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-4076" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-4077" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.49em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.492em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-4078"><span style="display: inline-block; position: relative; width: 2.645em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.372em, -999.997em); top: -4.672em; left: 50%; margin-left: -1.166em;"><span class="mrow" id="MathJax-Span-4079"><span class="mi" id="MathJax-Span-4080" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-4081"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-4082" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-4083"><span class="mrow" id="MathJax-Span-4084"><span class="mi" id="MathJax-Span-4085" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-4086" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-4087" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1002.49em, 4.372em, -999.997em); top: -3.351em; left: 50%; margin-left: -1.268em;"><span class="mrow" id="MathJax-Span-4088"><span class="mi" id="MathJax-Span-4089" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-4090"><span style="display: inline-block; position: relative; width: 1.933em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.76em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-4091" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.714em;"><span class="texatom" id="MathJax-Span-4092"><span class="mrow" id="MathJax-Span-4093"><span class="mi" id="MathJax-Span-4094" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-4095" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-4096" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.64em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.645em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="mo" id="MathJax-Span-4097" style="font-family: MathJax_Main; padding-left: 0.206em;">+</span><span class="mfrac" id="MathJax-Span-4098" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1001.63em, 4.322em, -999.997em); top: -4.672em; left: 50%; margin-left: -0.81em;"><span class="mrow" id="MathJax-Span-4099"><span class="mi" id="MathJax-Span-4100" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-4101"><span style="display: inline-block; position: relative; width: 1.07em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.76em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-4102" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.714em;"><span class="texatom" id="MathJax-Span-4103"><span class="mrow" id="MathJax-Span-4104"><span class="mi" id="MathJax-Span-4105" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(2.899em, 1001.68em, 4.322em, -999.997em); top: -3.097em; left: 50%; margin-left: -0.861em;"><span class="mrow" id="MathJax-Span-4106"><span class="mi" id="MathJax-Span-4107" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-4108"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px;"><span style="position: absolute; clip: rect(2.899em, 1000.82em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="texatom" id="MathJax-Span-4109"><span class="mrow" id="MathJax-Span-4110"><span class="munderover" id="MathJax-Span-4111"><span style="display: inline-block; position: relative; width: 0.816em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.76em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-4112" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1000.56em, 3.559em, -999.997em); top: -4.266em; left: 0.257em;"><span class="mo" id="MathJax-Span-4113" style=""><span style="font-family: MathJax_Size1;">˜</span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.816em;"><span class="texatom" id="MathJax-Span-4114"><span class="mrow" id="MathJax-Span-4115"><span class="mi" id="MathJax-Span-4116" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1001.83em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.832em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-4117"><span style="display: inline-block; position: relative; width: 2.492em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(2.899em, 1001.68em, 4.322em, -999.997em); top: -4.672em; left: 50%; margin-left: -0.861em;"><span class="mrow" id="MathJax-Span-4118"><span class="mi" id="MathJax-Span-4119" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-4120"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px;"><span style="position: absolute; clip: rect(2.899em, 1000.82em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="texatom" id="MathJax-Span-4121"><span class="mrow" id="MathJax-Span-4122"><span class="munderover" id="MathJax-Span-4123"><span style="display: inline-block; position: relative; width: 0.816em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.76em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-4124" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1000.56em, 3.559em, -999.997em); top: -4.266em; left: 0.257em;"><span class="mo" id="MathJax-Span-4125" style=""><span style="font-family: MathJax_Size1;">˜</span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.816em;"><span class="texatom" id="MathJax-Span-4126"><span class="mrow" id="MathJax-Span-4127"><span class="mi" id="MathJax-Span-4128" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.372em, -999.997em); top: -3.351em; left: 50%; margin-left: -1.166em;"><span class="mrow" id="MathJax-Span-4129"><span class="mi" id="MathJax-Span-4130" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-4131"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-4132" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-4133"><span class="mrow" id="MathJax-Span-4134"><span class="mi" id="MathJax-Span-4135" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-4136" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-4137" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.49em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.492em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-4138"><span style="display: inline-block; position: relative; width: 2.645em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1002.39em, 4.372em, -999.997em); top: -4.672em; left: 50%; margin-left: -1.166em;"><span class="mrow" id="MathJax-Span-4139"><span class="mi" id="MathJax-Span-4140" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-4141"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-4142" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-4143"><span class="mrow" id="MathJax-Span-4144"><span class="mi" id="MathJax-Span-4145" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-4146" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-4147" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1002.49em, 4.372em, -999.997em); top: -3.351em; left: 50%; margin-left: -1.268em;"><span class="mrow" id="MathJax-Span-4148"><span class="mi" id="MathJax-Span-4149" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-4150"><span style="display: inline-block; position: relative; width: 1.933em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.76em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-4151" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.714em;"><span class="texatom" id="MathJax-Span-4152"><span class="mrow" id="MathJax-Span-4153"><span class="mi" id="MathJax-Span-4154" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-4155" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-4156" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.64em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.645em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="mo" id="MathJax-Span-4157" style="font-family: MathJax_Main; padding-left: 0.206em;">+</span><span class="mfrac" id="MathJax-Span-4158" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 2.645em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1001.63em, 4.322em, -999.997em); top: -4.672em; left: 50%; margin-left: -0.81em;"><span class="mrow" id="MathJax-Span-4159"><span class="mi" id="MathJax-Span-4160" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-4161"><span style="display: inline-block; position: relative; width: 1.07em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.76em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-4162" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.714em;"><span class="texatom" id="MathJax-Span-4163"><span class="mrow" id="MathJax-Span-4164"><span class="mi" id="MathJax-Span-4165" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1002.49em, 4.372em, -999.997em); top: -3.351em; left: 50%; margin-left: -1.268em;"><span class="mrow" id="MathJax-Span-4166"><span class="mi" id="MathJax-Span-4167" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-4168"><span style="display: inline-block; position: relative; width: 1.933em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.76em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-4169" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.714em;"><span class="texatom" id="MathJax-Span-4170"><span class="mrow" id="MathJax-Span-4171"><span class="mi" id="MathJax-Span-4172" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-4173" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-4174" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.64em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.645em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.372em; border-left: 0px solid; width: 0px; height: 3.441em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>f</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>f</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow></mfrac><mo>+</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>i</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>i</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow></mfrac><mo>+</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>C</mi><mo>~</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>C</mi><mo>~</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow></mfrac><mo>+</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-169">\frac{\partial C_{t}}{\partial C_{t-1}} = \frac{\partial C_{t}}{\partial f_{t}} \frac{\partial f_{t}}{\partial h_{t-1}} \frac{\partial h_{t-1}}{\partial C_{t-1}} + \frac{\partial C_{t}}{\partial i_{t}} \frac{\partial i_{t}}{\partial h_{t-1}} \frac{\partial h_{t-1}}{\partial C_{t-1}} + \frac{\partial C_{t}}{\partial \widetilde{C}_{t}} \frac{\partial \widetilde{C}_{t}}{\partial h_{t-1}} \frac{\partial h_{t-1}}{\partial C_{t-1}} + \frac{\partial C_{t}}{\partial C_{t-1}}</script>

<p>If we explicitly write out these derivatives:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-170-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-variant&quot; mathvariant=&quot;normal&quot;&gt;&amp;#x2032;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-variant&quot; mathvariant=&quot;normal&quot;&gt;&amp;#x2032;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-variant&quot; mathvariant=&quot;normal&quot;&gt;&amp;#x2032;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-variant&quot; mathvariant=&quot;normal&quot;&gt;&amp;#x2032;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mi&gt;tanh&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-variant&quot; mathvariant=&quot;normal&quot;&gt;&amp;#x2032;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-variant&quot; mathvariant=&quot;normal&quot;&gt;&amp;#x2032;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4175" style="width: 22.005em; display: inline-block;"><span style="display: inline-block; position: relative; width: 17.889em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(-1.42em, 1017.63em, 5.389em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-4176"><span class="mtable" id="MathJax-Span-4177" style="padding-right: 0.155em; padding-left: 0.155em;"><span style="display: inline-block; position: relative; width: 17.584em; height: 0px;"><span style="position: absolute; clip: rect(3.61em, 1002.9em, 10.216em, -999.997em); top: -7.264em; left: 0em;"><span style="display: inline-block; position: relative; width: 2.899em; height: 0px;"><span style="position: absolute; clip: rect(2.492em, 1002.9em, 5.084em, -999.997em); top: -6.095em; right: 0em;"><span class="mtd" id="MathJax-Span-4178"><span class="mrow" id="MathJax-Span-4179"><span class="mfrac" id="MathJax-Span-4180"><span style="display: inline-block; position: relative; width: 2.645em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.153em, 1001.63em, 4.322em, -999.997em); top: -4.672em; left: 50%; margin-left: -0.81em;"><span class="mrow" id="MathJax-Span-4181"><span class="mi" id="MathJax-Span-4182" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-4183"><span style="display: inline-block; position: relative; width: 1.07em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.76em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-4184" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.714em;"><span class="mi" id="MathJax-Span-4185" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1002.49em, 4.372em, -999.997em); top: -3.351em; left: 50%; margin-left: -1.268em;"><span class="mrow" id="MathJax-Span-4186"><span class="mi" id="MathJax-Span-4187" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-4188"><span style="display: inline-block; position: relative; width: 1.933em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.76em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-4189" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.714em;"><span class="texatom" id="MathJax-Span-4190"><span class="mrow" id="MathJax-Span-4191"><span class="mi" id="MathJax-Span-4192" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-4193" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-4194" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1002.64em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.645em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.864em, 1000em, 4.169em, -999.997em); top: -3.961em; right: 0em;"><span class="mtd" id="MathJax-Span-4245"><span class="mrow" id="MathJax-Span-4246"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.864em, 1000em, 4.169em, -999.997em); top: -2.589em; right: 0em;"><span class="mtd" id="MathJax-Span-4297"><span class="mrow" id="MathJax-Span-4298"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.864em, 1000em, 4.169em, -999.997em); top: -1.217em; right: 0em;"><span class="mtd" id="MathJax-Span-4343"><span class="mrow" id="MathJax-Span-4344"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span><span style="display: inline-block; width: 0px; height: 7.269em;"></span></span><span style="position: absolute; clip: rect(3.814em, 1014.59em, 10.013em, -999.997em); top: -6.857em; left: 2.899em;"><span style="display: inline-block; position: relative; width: 14.688em; height: 0px;"><span style="position: absolute; clip: rect(3.051em, 1014.59em, 4.474em, -999.997em); top: -6.095em; left: 0em;"><span class="mtd" id="MathJax-Span-4195"><span class="mrow" id="MathJax-Span-4196"><span class="mi" id="MathJax-Span-4197"></span><span class="mo" id="MathJax-Span-4198" style="font-family: MathJax_Main; padding-left: 0.257em;">=</span><span class="msubsup" id="MathJax-Span-4199" style="padding-left: 0.257em;"><span style="display: inline-block; position: relative; width: 1.933em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.76em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-4200" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.714em;"><span class="texatom" id="MathJax-Span-4201"><span class="mrow" id="MathJax-Span-4202"><span class="mi" id="MathJax-Span-4203" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-4204" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-4205" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4206"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.458em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-4207" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -4.418em; left: 0.612em;"><span class="texatom" id="MathJax-Span-4208"><span class="mrow" id="MathJax-Span-4209"><span class="mi" id="MathJax-Span-4210" style="font-size: 70.7%; font-family: MathJax_Main;">′</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-4211" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-4212" style="font-family: MathJax_Main;">⋅</span><span class="mo" id="MathJax-Span-4213" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-4214"><span style="display: inline-block; position: relative; width: 1.832em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1001.07em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-4215" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.968em;"><span class="texatom" id="MathJax-Span-4216"><span class="mrow" id="MathJax-Span-4217"><span class="mi" id="MathJax-Span-4218" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span class="mi" id="MathJax-Span-4219" style="font-size: 70.7%; font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-4220" style="font-family: MathJax_Main; padding-left: 0.206em;">∗</span><span class="msubsup" id="MathJax-Span-4221" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 1.73em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.46em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-4222" style="font-family: MathJax_Math-italic;">o</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.511em;"><span class="texatom" id="MathJax-Span-4223"><span class="mrow" id="MathJax-Span-4224"><span class="mi" id="MathJax-Span-4225" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-4226" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-4227" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mi" id="MathJax-Span-4228" style="font-family: MathJax_Math-italic;">t</span><span class="mi" id="MathJax-Span-4229" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-4230" style="font-family: MathJax_Math-italic;">n</span><span class="msubsup" id="MathJax-Span-4231"><span style="display: inline-block; position: relative; width: 0.866em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-4232" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -4.418em; left: 0.561em;"><span class="texatom" id="MathJax-Span-4233"><span class="mrow" id="MathJax-Span-4234"><span class="mi" id="MathJax-Span-4235" style="font-size: 70.7%; font-family: MathJax_Main;">′</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-4236" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-4237"><span style="display: inline-block; position: relative; width: 1.933em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.76em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-4238" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.714em;"><span class="texatom" id="MathJax-Span-4239"><span class="mrow" id="MathJax-Span-4240"><span class="mi" id="MathJax-Span-4241" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-4242" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-4243" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-4244" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(2.899em, 1013.52em, 4.423em, -999.997em); top: -3.961em; left: 0em;"><span class="mtd" id="MathJax-Span-4247"><span class="mrow" id="MathJax-Span-4248"><span class="mi" id="MathJax-Span-4249"></span><span class="mo" id="MathJax-Span-4250" style="font-family: MathJax_Main; padding-left: 0.206em;">+</span><span class="msubsup" id="MathJax-Span-4251" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px;"><span style="position: absolute; clip: rect(2.899em, 1000.82em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="texatom" id="MathJax-Span-4252"><span class="mrow" id="MathJax-Span-4253"><span class="munderover" id="MathJax-Span-4254"><span style="display: inline-block; position: relative; width: 0.816em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.76em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-4255" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1000.56em, 3.559em, -999.997em); top: -4.266em; left: 0.257em;"><span class="mo" id="MathJax-Span-4256" style=""><span style="font-family: MathJax_Size1;">˜</span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.816em;"><span class="mi" id="MathJax-Span-4257" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4258"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.458em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-4259" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -4.418em; left: 0.612em;"><span class="texatom" id="MathJax-Span-4260"><span class="mrow" id="MathJax-Span-4261"><span class="mi" id="MathJax-Span-4262" style="font-size: 70.7%; font-family: MathJax_Main;">′</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-4263" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-4264" style="font-family: MathJax_Main;">⋅</span><span class="mo" id="MathJax-Span-4265" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-4266"><span style="display: inline-block; position: relative; width: 1.679em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1001.07em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-4267" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.968em;"><span class="texatom" id="MathJax-Span-4268"><span class="mrow" id="MathJax-Span-4269"><span class="mi" id="MathJax-Span-4270" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span class="mi" id="MathJax-Span-4271" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-4272" style="font-family: MathJax_Main; padding-left: 0.206em;">∗</span><span class="msubsup" id="MathJax-Span-4273" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 1.73em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.46em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-4274" style="font-family: MathJax_Math-italic;">o</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.511em;"><span class="texatom" id="MathJax-Span-4275"><span class="mrow" id="MathJax-Span-4276"><span class="mi" id="MathJax-Span-4277" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-4278" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-4279" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mi" id="MathJax-Span-4280" style="font-family: MathJax_Math-italic;">t</span><span class="mi" id="MathJax-Span-4281" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-4282" style="font-family: MathJax_Math-italic;">n</span><span class="msubsup" id="MathJax-Span-4283"><span style="display: inline-block; position: relative; width: 0.866em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-4284" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -4.418em; left: 0.561em;"><span class="texatom" id="MathJax-Span-4285"><span class="mrow" id="MathJax-Span-4286"><span class="mi" id="MathJax-Span-4287" style="font-size: 70.7%; font-family: MathJax_Main;">′</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-4288" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-4289"><span style="display: inline-block; position: relative; width: 1.933em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.76em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-4290" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.714em;"><span class="texatom" id="MathJax-Span-4291"><span class="mrow" id="MathJax-Span-4292"><span class="mi" id="MathJax-Span-4293" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-4294" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-4295" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-4296" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.051em, 1014.48em, 4.423em, -999.997em); top: -2.589em; left: 0em;"><span class="mtd" id="MathJax-Span-4299"><span class="mrow" id="MathJax-Span-4300"><span class="mi" id="MathJax-Span-4301"></span><span class="mo" id="MathJax-Span-4302" style="font-family: MathJax_Main; padding-left: 0.206em;">+</span><span class="msubsup" id="MathJax-Span-4303" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 0.663em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1000.31em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-4304" style="font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.358em;"><span class="mi" id="MathJax-Span-4305" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4306" style="padding-left: 0.155em;"><span style="display: inline-block; position: relative; width: 2.289em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1001.98em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-4307" style="font-family: MathJax_Main;">tanh</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -4.418em; left: 1.984em;"><span class="texatom" id="MathJax-Span-4308"><span class="mrow" id="MathJax-Span-4309"><span class="mi" id="MathJax-Span-4310" style="font-size: 70.7%; font-family: MathJax_Main;">′</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-4311"></span><span class="mo" id="MathJax-Span-4312" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-4313" style="font-family: MathJax_Main;">⋅</span><span class="mo" id="MathJax-Span-4314" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-4315"><span style="display: inline-block; position: relative; width: 1.578em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1001.07em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-4316" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.968em;"><span class="mi" id="MathJax-Span-4317" style="font-size: 70.7%; font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-4318" style="font-family: MathJax_Main; padding-left: 0.206em;">∗</span><span class="msubsup" id="MathJax-Span-4319" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 1.73em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.46em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-4320" style="font-family: MathJax_Math-italic;">o</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.511em;"><span class="texatom" id="MathJax-Span-4321"><span class="mrow" id="MathJax-Span-4322"><span class="mi" id="MathJax-Span-4323" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-4324" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-4325" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mi" id="MathJax-Span-4326" style="font-family: MathJax_Math-italic;">t</span><span class="mi" id="MathJax-Span-4327" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-4328" style="font-family: MathJax_Math-italic;">n</span><span class="msubsup" id="MathJax-Span-4329"><span style="display: inline-block; position: relative; width: 0.866em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-4330" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -4.418em; left: 0.561em;"><span class="texatom" id="MathJax-Span-4331"><span class="mrow" id="MathJax-Span-4332"><span class="mi" id="MathJax-Span-4333" style="font-size: 70.7%; font-family: MathJax_Main;">′</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-4334" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-4335"><span style="display: inline-block; position: relative; width: 1.933em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.76em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-4336" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.714em;"><span class="texatom" id="MathJax-Span-4337"><span class="mrow" id="MathJax-Span-4338"><span class="mi" id="MathJax-Span-4339" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-4340" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-4341" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-4342" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1002.03em, 4.372em, -999.997em); top: -1.217em; left: 0em;"><span class="mtd" id="MathJax-Span-4345"><span class="mrow" id="MathJax-Span-4346"><span class="mi" id="MathJax-Span-4347"></span><span class="mo" id="MathJax-Span-4348" style="font-family: MathJax_Main; padding-left: 0.206em;">+</span><span class="msubsup" id="MathJax-Span-4349" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 0.816em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-4350" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.511em;"><span class="mi" id="MathJax-Span-4351" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span><span style="display: inline-block; width: 0px; height: 6.862em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -3.747em; border-left: 0px solid; width: 0px; height: 8.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left" rowspacing="3pt" columnspacing="0em" displaystyle="true"><mtr><mtd><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>C</mi><mi>t</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow></mfrac></mtd><mtd><mi></mi><mo>=</mo><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><msup><mi>σ</mi><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-variant" mathvariant="normal">′</mi></mrow></msup><mo stretchy="false">(</mo><mo>⋅</mo><mo stretchy="false">)</mo><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi><mi>f</mi></mrow></msub><mo>∗</mo><msub><mi>o</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mi>t</mi><mi>a</mi><mi>n</mi><msup><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-variant" mathvariant="normal">′</mi></mrow></msup><mo stretchy="false">(</mo><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>+</mo><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>C</mi><mo>~</mo></mover></mrow><mi>t</mi></msub><msup><mi>σ</mi><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-variant" mathvariant="normal">′</mi></mrow></msup><mo stretchy="false">(</mo><mo>⋅</mo><mo stretchy="false">)</mo><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi><mi>i</mi></mrow></msub><mo>∗</mo><msub><mi>o</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mi>t</mi><mi>a</mi><mi>n</mi><msup><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-variant" mathvariant="normal">′</mi></mrow></msup><mo stretchy="false">(</mo><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>+</mo><msub><mi>i</mi><mi>t</mi></msub><msup><mi>tanh</mi><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-variant" mathvariant="normal">′</mi></mrow></msup><mo>⁡</mo><mo stretchy="false">(</mo><mo>⋅</mo><mo stretchy="false">)</mo><msub><mi>W</mi><mi>C</mi></msub><mo>∗</mo><msub><mi>o</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mi>t</mi><mi>a</mi><mi>n</mi><msup><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-variant" mathvariant="normal">′</mi></mrow></msup><mo stretchy="false">(</mo><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>+</mo><msub><mi>f</mi><mi>t</mi></msub></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-170">\begin{split}
\frac{\partial C_t}{\partial C_{t-1}} &= C_{t-1}\sigma^{\prime}(\cdot)W_{hf}*o_{t-1}tanh^{\prime}(C_{t-1}) \\
&+ \widetilde{C}_t\sigma^{\prime}(\cdot)W_{hi}*o_{t-1}tanh^{\prime}(C_{t-1}) \\
&+ i_t\tanh^{\prime}(\cdot)W_C*o_{t-1}tanh^{\prime}(C_{t-1}) \\
&+ f_t
\end{split}</script>

<p>Now if we want to backpropagate back <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-171-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4352" style="width: 0.663em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.511em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.374em, 1000.51em, 2.391em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-4353"><span class="mi" id="MathJax-Span-4354" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-171">k</script> time steps, all we need to do is to multiple the equation above <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-172-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4355" style="width: 0.663em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.511em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.374em, 1000.51em, 2.391em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-4356"><span class="mi" id="MathJax-Span-4357" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-172">k</script> times.</p>

<p>In vanilla RNNs, the terms <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-173-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4358" style="width: 2.442em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.984em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.019em, 1001.98em, 2.899em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-4359"><span class="mfrac" id="MathJax-Span-4360"><span style="display: inline-block; position: relative; width: 1.781em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.356em, 1001.68em, 4.322em, -999.997em); top: -4.571em; left: 50%; margin-left: -0.861em;"><span class="mrow" id="MathJax-Span-4361"><span class="mi" id="MathJax-Span-4362" style="font-size: 70.7%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-4363"><span style="display: inline-block; position: relative; width: 1.273em; height: 0px;"><span style="position: absolute; clip: rect(3.356em, 1000.41em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-4364" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.91em; left: 0.409em;"><span class="texatom" id="MathJax-Span-4365"><span class="mrow" id="MathJax-Span-4366"><span class="mi" id="MathJax-Span-4367" style="font-size: 50%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-4368" style="font-size: 50%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-4369" style="font-size: 50%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.356em, 1001.02em, 4.271em, -999.997em); top: -3.605em; left: 50%; margin-left: -0.506em;"><span class="mrow" id="MathJax-Span-4370"><span class="mi" id="MathJax-Span-4371" style="font-size: 70.7%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-4372"><span style="display: inline-block; position: relative; width: 0.663em; height: 0px;"><span style="position: absolute; clip: rect(3.356em, 1000.41em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-4373" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.91em; left: 0.409em;"><span class="texatom" id="MathJax-Span-4374"><span class="mrow" id="MathJax-Span-4375"><span class="mi" id="MathJax-Span-4376" style="font-size: 50%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1001.78em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.781em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.684em; border-left: 0px solid; width: 0px; height: 2.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-173">\frac{\partial h_{t+1}}{\partial h_{t}}</script> will eventually take on a values that are either always above <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-174-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4377" style="width: 0.663em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.511em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.425em, 1000.46em, 2.391em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-4378"><span class="mn" id="MathJax-Span-4379" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-174">1</script> or always in the range <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-175-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4380" style="width: 2.442em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.984em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.324em, 1001.88em, 2.645em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-4381"><span class="mo" id="MathJax-Span-4382" style="font-family: MathJax_Main;">[</span><span class="mn" id="MathJax-Span-4383" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-4384" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-4385" style="font-family: MathJax_Main; padding-left: 0.155em;">1</span><span class="mo" id="MathJax-Span-4386" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-175">[0, 1]</script>, this is essentially what leads to the vanishing/exploding gradient problem. The terms here, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-176-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4387" style="width: 2.594em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.086em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.07em, 1002.09em, 2.95em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-4388"><span class="mfrac" id="MathJax-Span-4389"><span style="display: inline-block; position: relative; width: 1.883em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.356em, 1001.12em, 4.271em, -999.997em); top: -4.52em; left: 50%; margin-left: -0.556em;"><span class="mrow" id="MathJax-Span-4390"><span class="mi" id="MathJax-Span-4391" style="font-size: 70.7%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-4392"><span style="display: inline-block; position: relative; width: 0.765em; height: 0px;"><span style="position: absolute; clip: rect(3.356em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-4393" style="font-size: 70.7%; font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.91em; left: 0.511em;"><span class="texatom" id="MathJax-Span-4394"><span class="mrow" id="MathJax-Span-4395"><span class="mi" id="MathJax-Span-4396" style="font-size: 50%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.356em, 1001.78em, 4.322em, -999.997em); top: -3.605em; left: 50%; margin-left: -0.861em;"><span class="mrow" id="MathJax-Span-4397"><span class="mi" id="MathJax-Span-4398" style="font-size: 70.7%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-4399"><span style="display: inline-block; position: relative; width: 1.374em; height: 0px;"><span style="position: absolute; clip: rect(3.356em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-4400" style="font-size: 70.7%; font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.91em; left: 0.511em;"><span class="texatom" id="MathJax-Span-4401"><span class="mrow" id="MathJax-Span-4402"><span class="mi" id="MathJax-Span-4403" style="font-size: 50%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-4404" style="font-size: 50%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-4405" style="font-size: 50%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1001.88em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.883em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.747em; border-left: 0px solid; width: 0px; height: 2.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-176">\frac{\partial C_{t}}{\partial C_{t-1}}</script>, at any time step can take on either values that are greater than 1 or values in the range <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-177-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4406" style="width: 2.442em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.984em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.324em, 1001.88em, 2.645em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-4407"><span class="mo" id="MathJax-Span-4408" style="font-family: MathJax_Main;">[</span><span class="mn" id="MathJax-Span-4409" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-4410" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-4411" style="font-family: MathJax_Main; padding-left: 0.155em;">1</span><span class="mo" id="MathJax-Span-4412" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-177">[0, 1]</script>. Thus if we extend to an infinite amount of time steps, it is not guarenteed that we will end up converging to 0 or infinity (unlike in vanilla RNNs). If we start to converge to zero, we can always set the values of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-178-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4413" style="width: 1.019em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.816em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.374em, 1000.82em, 2.594em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-4414"><span class="msubsup" id="MathJax-Span-4415"><span style="display: inline-block; position: relative; width: 0.816em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-4416" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.511em;"><span class="texatom" id="MathJax-Span-4417"><span class="mrow" id="MathJax-Span-4418"><span class="mi" id="MathJax-Span-4419" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>f</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-178">f_{t}</script> (and other gate values) to be higher in order to bring the value of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-179-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4420" style="width: 2.594em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.086em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.07em, 1002.09em, 2.95em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-4421"><span class="mfrac" id="MathJax-Span-4422"><span style="display: inline-block; position: relative; width: 1.883em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.356em, 1001.12em, 4.271em, -999.997em); top: -4.52em; left: 50%; margin-left: -0.556em;"><span class="mrow" id="MathJax-Span-4423"><span class="mi" id="MathJax-Span-4424" style="font-size: 70.7%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-4425"><span style="display: inline-block; position: relative; width: 0.765em; height: 0px;"><span style="position: absolute; clip: rect(3.356em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-4426" style="font-size: 70.7%; font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.91em; left: 0.511em;"><span class="texatom" id="MathJax-Span-4427"><span class="mrow" id="MathJax-Span-4428"><span class="mi" id="MathJax-Span-4429" style="font-size: 50%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.356em, 1001.78em, 4.322em, -999.997em); top: -3.605em; left: 50%; margin-left: -0.861em;"><span class="mrow" id="MathJax-Span-4430"><span class="mi" id="MathJax-Span-4431" style="font-size: 70.7%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-4432"><span style="display: inline-block; position: relative; width: 1.374em; height: 0px;"><span style="position: absolute; clip: rect(3.356em, 1000.56em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-4433" style="font-size: 70.7%; font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.91em; left: 0.511em;"><span class="texatom" id="MathJax-Span-4434"><span class="mrow" id="MathJax-Span-4435"><span class="mi" id="MathJax-Span-4436" style="font-size: 50%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-4437" style="font-size: 50%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-4438" style="font-size: 50%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em, 1001.88em, 1.222em, -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.883em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.747em; border-left: 0px solid; width: 0px; height: 2.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-179">\frac{\partial C_{t}}{\partial C_{t-1}}</script> closer to 1, thus preventing the gradients from vanishing (or at the very least, preventing them from vanishing too quickly). One important thing to note is that the values that <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-180-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4439" style="width: 1.019em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.816em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.374em, 1000.82em, 2.594em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-4440"><span class="msubsup" id="MathJax-Span-4441"><span style="display: inline-block; position: relative; width: 0.816em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.56em, 4.372em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-4442" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.511em;"><span class="texatom" id="MathJax-Span-4443"><span class="mrow" id="MathJax-Span-4444"><span class="mi" id="MathJax-Span-4445" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>f</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-180">f_{t}</script> (the forget gate), <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-181-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4446" style="width: 0.816em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.663em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.425em, 1000.66em, 2.543em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-4447"><span class="msubsup" id="MathJax-Span-4448"><span style="display: inline-block; position: relative; width: 0.663em; height: 0px;"><span style="position: absolute; clip: rect(3.204em, 1000.31em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-4449" style="font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.358em;"><span class="texatom" id="MathJax-Span-4450"><span class="mrow" id="MathJax-Span-4451"><span class="mi" id="MathJax-Span-4452" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>i</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-181">i_{t}</script> (input gate), <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-182-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4453" style="width: 1.019em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.816em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.629em, 1000.82em, 2.543em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-4454"><span class="msubsup" id="MathJax-Span-4455"><span style="display: inline-block; position: relative; width: 0.816em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.46em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-4456" style="font-family: MathJax_Math-italic;">o</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.511em;"><span class="texatom" id="MathJax-Span-4457"><span class="mrow" id="MathJax-Span-4458"><span class="mi" id="MathJax-Span-4459" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>o</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-182">o_{t}</script> (output gate) and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-183-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4460" style="width: 1.324em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.07em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.12em, 1001.07em, 2.543em, -999.997em); top: -2.233em; left: 0em;"><span class="mrow" id="MathJax-Span-4461"><span class="texatom" id="MathJax-Span-4462"><span class="mrow" id="MathJax-Span-4463"><span class="munderover" id="MathJax-Span-4464"><span style="display: inline-block; position: relative; width: 1.07em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1001.07em, 4.322em, -999.997em); top: -4.012em; left: 0em;"><span class="msubsup" id="MathJax-Span-4465"><span style="display: inline-block; position: relative; width: 1.07em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.76em, 4.169em, -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-4466" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.714em;"><span class="texatom" id="MathJax-Span-4467"><span class="mrow" id="MathJax-Span-4468"><span class="mi" id="MathJax-Span-4469" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.102em, 1001.02em, 3.559em, -999.997em); top: -4.215em; left: 0.003em;"><span class="mo" id="MathJax-Span-4470" style=""><span style="font-family: MathJax_Size2;">˜</span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.238em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.503em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mover><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub><mo>~</mo></mover></mrow></math></span></span><script type="math/tex" id="MathJax-Element-183">\widetilde{C_{t}}</script> (candidate input) take on are learned functions of the current input and hidden state by the network. Thus, in this way the network learns to decide when to let the gradient vanish, and when to preserve it, by setting the gate values accordingly, meaning that the model would regulate its forget gate value to prevent that from vanishing gradients.</p>

<p><strong>Note</strong>: LSTM does not always protect you from exploding gradients! Therefore, successful LSTM applications typically use gradient clipping.</p>

<h1 id="references">REFERENCES</h1>
<ol>
  <li><a href="http://www.wildml.com/2015/10/recurrent-neural-networks-tutorial-part-3-backpropagation-through-time-and-vanishing-gradients/" target="_blank">http://www.wildml.com/2015/10/recurrent-neural-networks-tutorial-part-3-backpropagation-through-time-and-vanishing-gradients/</a></li>
  <li><a href="https://arxiv.org/abs/1610.02583" target="_blank">https://arxiv.org/abs/1610.02583</a></li>
  <li><a href="https://github.com/go2carter/nn-learn/blob/master/grad-deriv-tex/rnn-grad-deriv.pdf" target="_blank">https://github.com/go2carter/nn-learn/blob/master/grad-deriv-tex/rnn-grad-deriv.pdf</a></li>
  <li><a href="http://willwolf.io/2016/10/18/recurrent-neural-network-gradients-and-lessons-learned-therein/" target="_blank">http://willwolf.io/2016/10/18/recurrent-neural-network-gradients-and-lessons-learned-therein/</a></li>
  <li><a href="https://weberna.github.io/blog/2017/11/15/LSTM-Vanishing-Gradients.html" target="_blank">https://weberna.github.io/blog/2017/11/15/LSTM-Vanishing-Gradients.html</a></li>
  <li><a href="https://medium.com/datadriveninvestor/how-do-lstm-networks-solve-the-problem-of-vanishing-gradients-a6784971a577" target="_blank">https://medium.com/datadriveninvestor/how-do-lstm-networks-solve-the-problem-of-vanishing-gradients-a6784971a577</a></li>
  <li><a href="https://arxiv.org/abs/1211.5063" target="_blank">https://arxiv.org/abs/1211.5063</a></li>
  <li><a href="https://www.jefkine.com/general/2018/05/21/2018-05-21-vanishing-and-exploding-gradient-problems/" target="_blank">https://www.jefkine.com/general/2018/05/21/2018-05-21-vanishing-and-exploding-gradient-problems/</a></li>
  <li><a href="ftp://ftp.idsia.ch/pub/juergen/nn_2005.pdf" target="_blank">ftp://ftp.idsia.ch/pub/juergen/nn_2005.pdf</a></li>
</ol>


</div>


  

  <div id="disqus_thread"><iframe id="dsq-app3415" name="dsq-app3415" allowtransparency="true" frameborder="0" scrolling="no" tabindex="0" title="Disqus" width="100%" src="./Backpropagation Through Time for Recurrent Neural Network _ Mustafa Murat ARAT_files/saved_resource(1).html" style="width: 1px !important; min-width: 100% !important; border: none !important; overflow: hidden !important; height: 394px !important;" horizontalscrolling="no" verticalscrolling="no"></iframe></div>
  <script>
    var disqus_config = function () {
      this.page.url = 'https://mmuratarat.github.io//2019-02-07/bptt-of-rnn';
      this.page.identifier = 'https://mmuratarat.github.io//2019-02-07/bptt-of-rnn';
    };
    (function() {
      var d = document, s = d.createElement('script');
      s.src = 'https://https-mmuratarat-github-io.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>




<div class="pagination">
  
    <a href="https://mmuratarat.github.io/2019-02-10/derivative-of-softmax-loss" class="left arrow">←</a>
  
  
    <a href="https://mmuratarat.github.io/2019-02-04/randoms-sums-of-random-variables" class="right arrow">→</a>
  

  <a href="https://mmuratarat.github.io/2019-02-07/bptt-of-rnn#" class="top">Top</a>
</div>

<!-- Hover anchor links -->
<!-- Credit: Adapted from https://milanaryal.com/adding-hover-anchor-links-to-header-on-github-pages-using-jekyll/ -->

<!-- make sure you include the latest version -->
<script src="./Backpropagation Through Time for Recurrent Neural Network _ Mustafa Murat ARAT_files/anchor.min.js.download"></script>
<!-- Add anchors before the closing body tag. -->
<script>
  anchors.options.placement = 'right';
  anchors.add('.post > h2, .post > h3, .post > h4, .post > h5, .post > h6');
</script>

<style>
/**
 * Link placement and hover behavior.
 */

.anchorjs-link {
  color: inherit !important;
  text-decoration: none !important; /* do not underline */
}

@media (max-width: 768px) {
  /* Do not display AnchorJS icon on less than 768px view point */
  .anchorjs-link {
    display: none;
  }
}

*:hover > .anchorjs-link {
  opacity: .75;
  /* To fade links as they appear, change transition-property from 'color' to 'all' */
  -webkit-transition: color .16s linear;
  transition: color .16s linear;
}

*:hover > .anchorjs-link:hover,
.anchorjs-link:focus {
  text-decoration: none !important; /* do not underline */
  opacity: 1;
}
</style>


    </main>

    <footer>
  <span>
    © <time datetime="2021-03-28 12:01:13 +0000">2021</time> Mustafa Murat ARAT. Made with Jekyll using the <a href="https://github.com/chesterhow/tale/">Tale</a> theme.
  </span>
  

</footer>

  

<iframe style="display: none;" src="./Backpropagation Through Time for Recurrent Neural Network _ Mustafa Murat ARAT_files/saved_resource(2).html"></iframe><div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-family: MathJax_Size1, sans-serif;"></div></div></body></html>