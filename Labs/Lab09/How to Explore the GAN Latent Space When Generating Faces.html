<!DOCTYPE html>
<!-- saved from url=(0134)https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/ -->
<html lang="en-US" class=" js csstransforms3d csstransitions" style="min-height: 100%;"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script type="text/javascript" src="./How to Explore the GAN Latent Space When Generating Faces_files/form"></script><script type="text/javascript" src="./How to Explore the GAN Latent Space When Generating Faces_files/form(1)"></script><script id="twitter-wjs" src="./How to Explore the GAN Latent Space When Generating Faces_files/widgets.js.download"></script><script id="twitcount_plugins" src="./How to Explore the GAN Latent Space When Generating Faces_files/twitcount.js.download"></script><script type="text/javascript" src="./How to Explore the GAN Latent Space When Generating Faces_files/visit"></script>



<link rel="pingback" href="https://machinelearningmastery.com/xmlrpc.php">

<!--  Mobile viewport scale -->
<meta content="initial-scale=1.0, maximum-scale=1.0, user-scalable=yes" name="viewport">

	<!-- This site is optimized with the Yoast SEO plugin v15.9.1 - https://yoast.com/wordpress/plugins/seo/ -->
	<title>How to Explore the GAN Latent Space When Generating Faces</title><link rel="stylesheet" href="./How to Explore the GAN Latent Space When Generating Faces_files/90c8e151f7a73f64eb67dc631568d25d.css" media="all" data-minify="1">
	<meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
	<link rel="canonical" href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/">
	<meta property="og:locale" content="en_US">
	<meta property="og:type" content="article">
	<meta property="og:title" content="How to Explore the GAN Latent Space When Generating Faces">
	<meta property="og:description" content="How to Use Interpolation and Vector Arithmetic to Explore the GAN Latent Space. Generative Adversarial Networks, or GANs, are an architecture for training generative models, such as deep convolutional neural networks for generating images. The generative model in the GAN architecture learns to map points in the latent space to generated images. The latent space […]">
	<meta property="og:url" content="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/">
	<meta property="og:site_name" content="Machine Learning Mastery">
	<meta property="article:publisher" content="https://www.facebook.com/MachineLearningMastery/">
	<meta property="article:author" content="https://www.facebook.com/MachineLearningMastery/">
	<meta property="article:published_time" content="2019-07-02T19:00:59+00:00">
	<meta property="article:modified_time" content="2020-09-01T00:33:13+00:00">
	<meta property="og:image" content="https://machinelearningmastery.com/wp-content/uploads/2019/05/Plot-of-Randomly-Generated-Faces-Using-the-Loaded-GAN-Model.png">
	<meta property="og:image:width" content="1280">
	<meta property="og:image:height" content="960">
	<meta name="twitter:label1" content="Written by">
	<meta name="twitter:data1" content="Jason Brownlee">
	<meta name="twitter:label2" content="Est. reading time">
	<meta name="twitter:data2" content="45 minutes">
	<script type="text/javascript" async="" src="./How to Explore the GAN Latent Space When Generating Faces_files/client.js.download"></script><script type="text/javascript" async="" src="./How to Explore the GAN Latent Space When Generating Faces_files/9556588.js.download"></script><script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"Organization","@id":"https://machinelearningmastery.com/#organization","name":"Machine Learning Mastery","url":"https://machinelearningmastery.com/","sameAs":["https://www.facebook.com/MachineLearningMastery/","https://www.linkedin.com/company/machine-learning-mastery","https://twitter.com/TeachTheMachine"],"logo":{"@type":"ImageObject","@id":"https://machinelearningmastery.com/#logo","inLanguage":"en-US","url":"https://machinelearningmastery.com/wp-content/uploads/2016/09/cropped-icon.png","width":512,"height":512,"caption":"Machine Learning Mastery"},"image":{"@id":"https://machinelearningmastery.com/#logo"}},{"@type":"WebSite","@id":"https://machinelearningmastery.com/#website","url":"https://machinelearningmastery.com/","name":"Machine Learning Mastery","description":"Making developers awesome at machine learning","publisher":{"@id":"https://machinelearningmastery.com/#organization"},"potentialAction":[{"@type":"SearchAction","target":"https://machinelearningmastery.com/?s={search_term_string}","query-input":"required name=search_term_string"}],"inLanguage":"en-US"},{"@type":"ImageObject","@id":"https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#primaryimage","inLanguage":"en-US","url":"https://machinelearningmastery.com/wp-content/uploads/2019/05/Plot-of-Randomly-Generated-Faces-Using-the-Loaded-GAN-Model.png","width":1280,"height":960,"caption":"Plot of Randomly Generated Faces Using the Loaded GAN Model"},{"@type":"WebPage","@id":"https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#webpage","url":"https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/","name":"How to Explore the GAN Latent Space When Generating Faces","isPartOf":{"@id":"https://machinelearningmastery.com/#website"},"primaryImageOfPage":{"@id":"https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#primaryimage"},"datePublished":"2019-07-02T19:00:59+00:00","dateModified":"2020-09-01T00:33:13+00:00","breadcrumb":{"@id":"https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#breadcrumb"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/"]}]},{"@type":"BreadcrumbList","@id":"https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"item":{"@type":"WebPage","@id":"https://machinelearningmastery.com/","url":"https://machinelearningmastery.com/","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@type":"WebPage","@id":"https://machinelearningmastery.com/blog/","url":"https://machinelearningmastery.com/blog/","name":"Blog"}},{"@type":"ListItem","position":3,"item":{"@type":"WebPage","@id":"https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/","url":"https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/","name":"How to Explore the GAN Latent Space When Generating Faces"}}]},{"@type":"Article","@id":"https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#article","isPartOf":{"@id":"https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#webpage"},"author":{"@id":"https://machinelearningmastery.com/#/schema/person/e2d0ff4828d406a3b47e5a3c9a0591e8"},"headline":"How to Explore the GAN Latent Space When Generating Faces","datePublished":"2019-07-02T19:00:59+00:00","dateModified":"2020-09-01T00:33:13+00:00","mainEntityOfPage":{"@id":"https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#webpage"},"commentCount":63,"publisher":{"@id":"https://machinelearningmastery.com/#organization"},"image":{"@id":"https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#primaryimage"},"articleSection":"Generative Adversarial Networks","inLanguage":"en-US","potentialAction":[{"@type":"CommentAction","name":"Comment","target":["https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#respond"]}]},{"@type":"Person","@id":"https://machinelearningmastery.com/#/schema/person/e2d0ff4828d406a3b47e5a3c9a0591e8","name":"Jason Brownlee","image":{"@type":"ImageObject","@id":"https://machinelearningmastery.com/#personlogo","inLanguage":"en-US","url":"https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=96&d=mm&r=g","caption":"Jason Brownlee"},"description":"Jason Brownlee, PhD is a machine learning specialist who teaches developers how to get results with modern machine learning methods via hands-on tutorials.","sameAs":["http://MachineLearningMastery.com","https://www.facebook.com/MachineLearningMastery/","https://www.linkedin.com/company/machine-learning-mastery","https://twitter.com/teachthemachine"]}]}</script>
	<!-- / Yoast SEO plugin. -->


<link rel="dns-prefetch" href="https://ads.adthrive.com/">
<link rel="dns-prefetch" href="https://www.google-analytics.com/">
<link rel="dns-prefetch" href="https://loadeu.exelator.com/">
<link rel="dns-prefetch" href="https://sync.crwdcntrl.net/">
<link rel="dns-prefetch" href="https://gdpr-wrapper.privacymanager.io/">
<link rel="dns-prefetch" href="https://securepubads.g.doubleclick.net/">
<link rel="dns-prefetch" href="https://gdpr.privacymanager.io/">
<link rel="dns-prefetch" href="https://sb.scorecardresearch.com/">
<link rel="dns-prefetch" href="https://confiant-integrations.global.ssl.fastly.net/">
<link href="https://fonts.gstatic.com/" crossorigin="" rel="preconnect">
<link rel="alternate" type="application/rss+xml" title="Machine Learning Mastery » Feed" href="https://feeds.feedburner.com/MachineLearningMastery">
<link rel="alternate" type="application/rss+xml" title="Machine Learning Mastery » Comments Feed" href="https://machinelearningmastery.com/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="Machine Learning Mastery » How to Explore the GAN Latent Space When Generating Faces Comments Feed" href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/feed/">
<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	









<!--[if lt IE 9]>
<link href="https://machinelearningmastery.com/wp-content/themes/canvas-new/css/non-responsive.css" rel="stylesheet" type="text/css" />
<style type="text/css">.col-full, #wrapper { width: 960px; max-width: 960px; } #inner-wrapper { padding: 0; } body.full-width #header, #nav-container, body.full-width #content, body.full-width #footer-widgets, body.full-width #footer { padding-left: 0; padding-right: 0; } body.fixed-mobile #top, body.fixed-mobile #header-container, body.fixed-mobile #footer-container, body.fixed-mobile #nav-container, body.fixed-mobile #footer-widgets-container { min-width: 960px; padding: 0 1em; } body.full-width #content { width: auto; padding: 0 1em;}</style>
<![endif]-->
<script type="text/javascript" src="./How to Explore the GAN Latent Space When Generating Faces_files/jquery.min.js.download" id="jquery-core-js" defer=""></script>



<script type="text/javascript" id="ssb-front-js-js-extra">
/* <![CDATA[ */
var SSB = {"ajax_url":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","fb_share_nonce":"e491a7b2be"};
/* ]]> */
</script>




<link rel="https://api.w.org/" href="https://machinelearningmastery.com/wp-json/"><link rel="alternate" type="application/json" href="https://machinelearningmastery.com/wp-json/wp/v2/posts/8135"><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://machinelearningmastery.com/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://machinelearningmastery.com/wp-includes/wlwmanifest.xml"> 
<link rel="shortlink" href="https://machinelearningmastery.com/?p=8135">
 <style media="screen">

		.simplesocialbuttons.simplesocialbuttons_inline .ssb-fb-like {
	  margin: ;
	}
		 /*inline margin*/
	
	
	
	
	
	
			 .simplesocialbuttons.simplesocialbuttons_inline.simplesocial-simple-icons button{
		 margin: ;
	 }

			 /*margin-digbar*/

	
	
	
	
	
	
	
</style>

<!-- Open Graph Meta Tags generated by Simple Social Buttons 3.2.1 -->
<meta property="og:title" content="How to Explore the GAN Latent Space When Generating Faces - Machine Learning Mastery">
<meta property="og:description" content="How to Use Interpolation and Vector Arithmetic to Explore the GAN Latent Space.
Generative Adversarial Networks, or GANs, are an architecture for training generative models, such as deep convolutional neural networks for generating images.

The generative model in the GAN architecture learns to map points in the latent space to generated images. The latent space has no meaning other than the meaning">
<meta property="og:url" content="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/">
<meta property="og:site_name" content="Machine Learning Mastery">
<meta property="og:image" content="https://machinelearningmastery.com/wp-content/uploads/2019/05/Plot-of-Randomly-Generated-Faces-Using-the-Loaded-GAN-Model.png">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:description" content="How to Use Interpolation and Vector Arithmetic to Explore the GAN Latent Space.
Generative Adversarial Networks, or GANs, are an architecture for training generative models, such as deep convolutional neural networks for generating images.

The generative model in the GAN architecture learns to map points in the latent space to generated images. The latent space has no meaning other than the meaning">
<meta name="twitter:title" content="How to Explore the GAN Latent Space When Generating Faces - Machine Learning Mastery">
<meta property="twitter:image" content="https://machinelearningmastery.com/wp-content/uploads/2019/05/Plot-of-Randomly-Generated-Faces-Using-the-Loaded-GAN-Model.png">
    
<style id="wplmi-inline-css" type="text/css"> span.wplmi-user-avatar { width: 16px;display: inline-block !important;flex-shrink: 0; } img.wplmi-elementor-avatar { border-radius: 100%;margin-right: 3px; } 

</style>

<link rel="preload" as="font" href="https://machinelearningmastery.com/wp-content/themes/canvas-new/includes/fonts/fontawesome-webfont.woff2?v=4.5.0" crossorigin="">
<!-- Custom CSS Styling -->
<style type="text/css">
#logo .site-title, #logo .site-description { display:none; }
body {background-repeat:no-repeat;background-position:top left;background-attachment:scroll;border-top:0px solid #000000;}
#header {background-repeat:no-repeat;background-position:left top;margin-top:0px;margin-bottom:0px;padding-top:10px;padding-bottom:10px;border:0px solid ;}
#logo .site-title a {font:bold 40px/1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
#logo .site-description {font:normal 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#999999;}
body, p { font:normal 14px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
h1 { font:bold 28px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h2 { font:bold 24px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h3 { font:bold 20px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h4 { font:bold 16px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h5 { font:bold 14px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h6 { font:bold 12px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }
.page-title, .post .title, .page .title {font:bold 28px/1.1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
.post .title a:link, .post .title a:visited, .page .title a:link, .page .title a:visited {color:#222222}
.post-meta { font:normal 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
.entry, .entry p{ font:normal 15px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.post-more {font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:;border-top:0px solid #e6e6e6;border-bottom:0px solid #e6e6e6;}
#post-author, #connect {border-top:1px solid #e6e6e6;border-bottom:1px solid #e6e6e6;border-left:1px solid #e6e6e6;border-right:1px solid #e6e6e6;border-radius:5px;-moz-border-radius:5px;-webkit-border-radius:5px;background-color:#fafafa}
.nav-entries a, .woo-pagination { font:normal 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#888; }
.woo-pagination a, .woo-pagination a:hover {color:#888!important}
.widget h3 {font:bold 14px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#555555;border-bottom:1px solid #e6e6e6;}
.widget_recent_comments li, #twitter li { border-color: #e6e6e6;}
.widget p, .widget .textwidget { font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.widget {font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555;border-radius:0px;-moz-border-radius:0px;-webkit-border-radius:0px;}
#tabs .inside li a, .widget_woodojo_tabs .tabbable .tab-pane li a { font:bold 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
#tabs .inside li span.meta, .widget_woodojo_tabs .tabbable .tab-pane li span.meta { font:300 11px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
#tabs ul.wooTabs li a, .widget_woodojo_tabs .tabbable .nav-tabs li a { font:300 11px/2em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
@media only screen and (min-width:768px) {
ul.nav li a, #navigation ul.rss a, #navigation ul.cart a.cart-contents, #navigation .cart-contents #navigation ul.rss, #navigation ul.nav-search, #navigation ul.nav-search a { font:bold 15px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#ffffff; } #navigation ul.rss li a:before, #navigation ul.nav-search a.search-contents:before { color:#ffffff;}
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover a, #navigation ul.nav li ul li a, #navigation ul.cart > li:hover > a, #navigation ul.cart > li > ul > div, #navigation ul.cart > li > ul > div p, #navigation ul.cart > li > ul span, #navigation ul.cart .cart_list a, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a { color:#eeeeee!important; }
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover, #navigation ul.nav li ul, #navigation ul.cart li:hover a.cart-contents, #navigation ul.nav-search li:hover a.search-contents, #navigation ul.nav-search a.search-contents + ul, #navigation ul.cart a.cart-contents + ul, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a{background-color:#84abc7!important}
#navigation ul.nav li ul, #navigation ul.cart > li > ul > div  { border: 0px solid #dbdbdb; }
#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation ul.nav > li  { border-right: 0px solid #dbdbdb; }#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation { box-shadow: none; -moz-box-shadow: none; -webkit-box-shadow: none; }#navigation ul li:first-child, #navigation ul li:first-child a { border-radius:0px 0 0 0px; -moz-border-radius:0px 0 0 0px; -webkit-border-radius:0px 0 0 0px; }
#navigation {background:#84abc7;border-top:0px solid #dbdbdb;border-bottom:0px solid #dbdbdb;border-left:0px solid #dbdbdb;border-right:0px solid #dbdbdb;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
#top ul.nav li a { font:normal 12px/1.6em "Helvetica Neue", Helvetica, sans-serif;color:#ddd; }
}
#footer, #footer p { font:normal 13px/1.4em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
#footer {border-top:1px solid #dbdbdb;border-bottom:0px solid ;border-left:0px solid ;border-right:0px solid ;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
.magazine #loopedSlider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-magazine .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.magazine #loopedSlider .content .excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-magazine .slide-content p, .wooslider-theme-magazine .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.magazine .block .post .title a {font:bold 18px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }
#loopedSlider.business-slider .content h2 { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#loopedSlider.business-slider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#wrapper #loopedSlider.business-slider .content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.archive_header { font:bold 18px/1em Arial, sans-serif;color:#222222; }
.archive_header {border-bottom:1px solid #e6e6e6;}
.archive_header .catrss { display:none; }
</style>

<!-- Custom Favicon -->
<link rel="shortcut icon" href="https://machinelearningmastery.com/wp-content/uploads/2019/09/icon-16x16.png">
<!-- Options Panel Custom CSS -->
<style type="text/css">
#logo img {
   max-width: 100%;
   height: auto;
}
</style>


<!-- Woo Shortcodes CSS -->


<!-- Custom Stylesheet -->


<!-- Theme version -->
<meta name="generator" content="Canvas 5.9.21">
<meta name="generator" content="WooFramework 6.2.9">

<link rel="icon" href="https://machinelearningmastery.com/wp-content/uploads/2016/09/cropped-icon-32x32.png" sizes="32x32">
<link rel="icon" href="https://machinelearningmastery.com/wp-content/uploads/2016/09/cropped-icon-192x192.png" sizes="192x192">
<link rel="apple-touch-icon" href="https://machinelearningmastery.com/wp-content/uploads/2016/09/cropped-icon-180x180.png">
<meta name="msapplication-TileImage" content="https://machinelearningmastery.com/wp-content/uploads/2016/09/cropped-icon-270x270.png">
		<style type="text/css" id="wp-custom-css">
			.display-posts-listing.image-left .listing-item {
	overflow: hidden; 
	margin-bottom: 30px;
	width: 100%;
}

.display-posts-listing.image-left .image {
	float: left;
	margin: 0 10px 0 0;
}

.display-posts-listing.image-left .attachment-thumbnail {
	height: auto; 
	width: auto; 
	max-width: 50px; 
	max-height: 50px;
	border-radius: 50%;
}

.display-posts-listing.image-left .title {
	display: block;
}

.display-posts-listing.image-left .excerpt-dash { 
	display: none; 
}

.display-posts-listing.image-left {
	margin: 0 0 40px 0;
}		</style>
		<noscript><style id="rocket-lazyload-nojs-css">.rll-youtube-player, [data-lazy-src]{display:none !important;}</style></noscript><style type="text/css">
  /* === Form-Specific Styles === */
  /* stylelint-disable */

  #drip-2211 .drip-content,
  #drip-2211 .drip-header {
    background: rgb(116,174,203) !important;
    background: rgba(116,174,203,0.90) !important;
  }

  #drip-2211 .drip-content h3 {
    color: #333333 !important;
    font-size: 21px !important;
  }

  #drip-2211 .drip-submit-button {
    background-color: #333333 !important;
    font-size: 12px !important;
  }

  #drip-2211 .drip-submit-button:hover {
    background-color: #191919 !important;
  }

  #drip-2211 .drip-submit-button:active {
    background-color: #000000 !important;
  }

  #drip-2211 .drip-submit-button:disabled {
    background-color: #808080 !important;
  }

  #drip-2211 dl dt,
  #drip-2211 .drip-content .drip-description,
  #drip-2211 .drip-content .classic--checkbox,
  #drip-2211 .drip-errors {
    font-size: 13px !important;
  }

  #drip-2211 .drip-text-field,
  #drip-2211 .drip-radio-buttons,
  #drip-2211 .drip-dropdown-select {
    font-size: 14px !important;
  }

  /* === Reset styles === */

  .drip-tab h1,
  .drip-tab h2,
  .drip-tab h3,
  .drip-tab dl,
  .drip-tab dt,
  .drip-tab dd,
  .drip-tab p,
  .drip-tab a,
  .drip-tab .drip-text-field,
  .drip-tab .drip-radio-buttons,
  .drip-tab .drip-text-field:focus,
  .drip-tab .drip-submit-button {
    margin: 0;
    padding: 0;
    border: 0;
    font-size: 100%;
    font: inherit;
    vertical-align: baseline;
    float: none;
    width: auto;
    background-image: none;
    letter-spacing: 0;
    -webkit-box-shadow: none;
       -moz-box-shadow: none;
            box-shadow: none;
    -webkit-text-shadow: none !important;
       -moz-text-shadow: none !important;
            text-shadow: none !important;
  }

  .drip-tab a {
    text-decoration: none;
  }

  .drip-tab :focus {
    outline: 0;
  }

  /* === Clearfix === */

  .drip-clearfix:after {
    visibility: hidden;
    display: block;
    font-size: 0;
    content: " ";
    clear: both;
    height: 0;
  }
  * html .drip-clearfix             { zoom: 1; } /* IE6 */
  *:first-child+html .drip-clearfix { zoom: 1; } /* IE7 */

  /* === Main Container === */

  .drip-tab-container * {
    box-sizing: content-box;
  }

  /* === Content === */

  .drip-tab .drip-content {
    margin: 0;
    padding: 5px;
    width: 330px;
    position: fixed;
    font-size: 100%;
    font: inherit;
    z-index: 10000;
    color: #333;
    vertical-align: baseline;
    text-align: left;
    box-sizing: border-box;
    -webkit-box-shadow: 0px 0px 20px rgba(0,0,0,0.25);
       -moz-box-shadow: 0px 0px 20px rgba(0,0,0,0.25);
            box-shadow: 0px 0px 20px rgba(0,0,0,0.25);
  }

  .drip-tab.bottom .drip-content {
    bottom: -800px;
    -webkit-border-radius: 8px 8px 0 0;
       -moz-border-radius: 8px 8px 0 0;
            border-radius: 8px 8px 0 0;
    -webkit-transition: bottom 200ms ease-in;
       -moz-transition: bottom 200ms ease-in;
         -o-transition: bottom 200ms ease-in;
            transition: bottom 200ms ease-in;
  }

  .drip-tab.bottom.left .drip-content {
    left: 40px;
  }

  .drip-tab.bottom.right .drip-content {
    right: 40px;
  }

  .drip-tab.image-left .drip-content,
  .drip-tab.image-right .drip-content {
    width: 510px;
  }

  .drip-tab.side .drip-content {
    top: 10%;
  }

  .drip-tab.side.right .drip-content {
    right: -550px;
    -webkit-border-radius: 8px 0 0 8px;
       -moz-border-radius: 8px 0 0 8px;
            border-radius: 8px 0 0 8px;
    -webkit-transition: right 200ms ease-in;
       -moz-transition: right 200ms ease-in;
         -o-transition: right 200ms ease-in;
            transition: right 200ms ease-in;
  }

  .drip-tab.side.left .drip-content {
    left: -550px;
    -webkit-border-radius: 0 8px 8px 0;
       -moz-border-radius: 0 8px 8px 0;
            border-radius: 0 8px 8px 0;
    -webkit-transition: left 200ms ease-in;
       -moz-transition: left 200ms ease-in;
         -o-transition: left 200ms ease-in;
            transition: left 200ms ease-in;
  }

  .drip-tab.mobile .drip-content {
    width: 100% !important;
    bottom: -800px;
    left: 0;
    -webkit-border-radius: 0;
       -moz-border-radius: 0;
            border-radius: 0;
    -webkit-transition: bottom 200ms ease-in;
       -moz-transition: bottom 200ms ease-in;
         -o-transition: bottom 200ms ease-in;
            transition: bottom 200ms ease-in;
  }

  .drip-tab.drip-scrollable .drip-content {
    overflow-y: scroll;
  }

  /* === Header === */

  .drip-tab .drip-header {
    margin: 0;
    padding: 0;
    position: fixed;
    font-size: 100%;
    font: inherit;
    z-index: 10000;
    color: #333;
    vertical-align: baseline;
    text-align: left;
    -webkit-border-radius: 8px 8px 0 0;
       -moz-border-radius: 8px 8px 0 0;
            border-radius: 8px 8px 0 0;
    -webkit-box-shadow: 0px 10px 28px rgba(0,0,0,0.36);
       -moz-box-shadow: 0px 10px 28px rgba(0,0,0,0.36);
            box-shadow: 0px 10px 28px rgba(0,0,0,0.36);
  }

  .drip-tab.bottom .drip-header {
    width: 330px;
    bottom: 0;
    -webkit-transition: bottom 200ms ease-in;
       -moz-transition: bottom 200ms ease-in;
         -o-transition: bottom 200ms ease-in;
            transition: bottom 200ms ease-in;
  }

  .drip-tab.bottom .drip-header.drip-hidden {
    bottom: -800px;
  }

  .drip-tab.bottom.left .drip-header {
    left: 40px;
  }

  .drip-tab.bottom.right .drip-header {
    right: 40px;
  }

  .drip-tab.bottom.image-left .drip-header,
  .drip-tab.bottom.image-right .drip-header {
    width: 510px;
  }

  .drip-tab.side .drip-header {
    width: 330px;
    top: 10%;
  }

  .drip-tab.side.right .drip-header {
    right: -100px;
    -webkit-transition: right 400ms ease-in;
       -moz-transition: right 400ms ease-in;
         -o-transition: right 400ms ease-in;
            transition: right 400ms ease-in;
    -webkit-transform: rotate(-90deg) !important;
       -moz-transform: rotate(-90deg) !important;
        -ms-transform: rotate(-90deg) !important;
         -o-transform: rotate(-90deg) !important;
            transform: rotate(-90deg) !important;
    -webkit-transform-origin: right center;
       -moz-transform-origin: right center;
         -o-transform-origin: right center;
            transform-origin: right center;
  }

  .drip-tab.side.right .drip-header.drip-hidden {
    right: -100px;
  }

  .drip-tab.side.left .drip-header {
    left: -100px;
    -webkit-transition: left 400ms ease-in;
       -moz-transition: left 400ms ease-in;
         -o-transition: left 400ms ease-in;
            transition: left 400ms ease-in;
    -webkit-transform: rotate(90deg) !important;
       -moz-transform: rotate(90deg) !important;
        -ms-transform: rotate(90deg) !important;
         -o-transform: rotate(90deg) !important;
            transform: rotate(90deg) !important;
    -webkit-transform-origin: left center;
       -moz-transform-origin: left center;
         -o-transform-origin: left center;
            transform-origin: left center;
  }

  .drip-tab.side.left .drip-header.drip-hidden {
    left: -100px;
  }

  .drip-tab.mobile .drip-header {
    width: 100% !important;
    bottom: 0;
    left: 0;
    -webkit-border-radius: 0;
       -moz-border-radius: 0;
            border-radius: 0;
    -webkit-transition: bottom 200ms ease-in;
       -moz-transition: bottom 200ms ease-in;
         -o-transition: bottom 200ms ease-in;
            transition: bottom 200ms ease-in;
  }

  .drip-tab.mobile .drip-header.drip-hidden {
    bottom: -300px;
  }

  /* === Header Toggle === */

  .drip-tab .drip-toggle {
    display: block;
    text-decoration: none;
    padding: 10px 50px 10px 20px; /* extra padding for the arrow */
  }

  /* === Teaser === */

  .drip-tab .drip-header h2 {
    display: block;
    margin: 0 !important;
    padding: 0 !important;
    border: 0 !important;
    font-size: 14px !important;
    line-height: 1.5 !important;
    font-weight: bold !important;
    text-align: left !important;
    color: #fff !important;
    clear: none !important;
    letter-spacing: 0 !important;
    width: auto !important;
  }

  /* === Arrows === */

  .drip-tab .drip-header span.drip-arrow {
    display: block;
    position: absolute;
    margin: 0;
    padding: 0;
    width: 0;
    height: 0;
    line-height: 0;
    top: 17px;
    right: 32px;
  }

  /* === Panel === */

  .drip-tab .drip-content > div.drip-panel {
    padding: 15px 15px 12px;
    background-color: #fff;
    -webkit-border-radius: 6px;
       -moz-border-radius: 6px;
            border-radius: 6px;
  }

  /* === Content Headings & Paragraphs === */

  .drip-tab .drip-content h3 {
    display: block;
    margin: 0 20px 0 0 !important;
    padding: 0 0 15px 0 !important;
    line-height: 1.4 !important;
    font-weight: bold !important;
    text-align: left !important;
    color: #4477bd !important;
    clear: none !important;
  }

  .drip-tab .drip-content .drip-description {
    margin: 0;
    padding: 0 0 20px 0;
    line-height: 1.6;
    text-align: left;
  }

  .drip-tab.image-left .drip-content .drip-description {
    margin-left: 170px;
  }

  .drip-tab.image-right .drip-content .drip-description {
    margin-right: 170px;
  }

  @media screen and (max-width: 510px) {
    .drip-tab.image-left .drip-content .drip-description {
      margin-left: 0; /* 120px; */
    }

    .drip-tab.image-right .drip-content .drip-description {
      margin-right: 0; /* 120px; */
    }
  }

  .drip-tab .drip-content .drip-description a {
    text-decoration: underline;
  }

  .drip-tab .drip-content .drip-description em {
    font-style: italic;
  }

  .drip-tab .drip-content .drip-description ul,
  .drip-tab .drip-content .drip-description ol {
    list-style-position: outside;
    margin: 8px 0 8px 30px;
  }

  .drip-tab .drip-content .drip-description ul li
  .drip-tab .drip-content .drip-description ol li {
    padding: 0;
  }

  .drip-tab .drip-content img.drip-image {
    margin-bottom: 20px;
  }

  .drip-tab.image-left .drip-content img.drip-image {
    float: left;
    width: 150px;
  }

  .drip-tab.image-right .drip-content img.drip-image {
    float: right;
    width: 150px;
  }

  @media screen and (max-width: 510px) {
    .drip-tab.image-left .drip-content img.drip-image {
      margin-right: 20px;
      width: 100px;
    }

    .drip-tab.image-right .drip-content img.drip-image {
      margin-left: 20px;
      width: 100px;
    }
  }

  .drip-tab .drip-content a.drip-close {
    font-family: Arial, Helvetica, sans-serif;
    margin: -1px 0 0 0;
    float: right;
    font-size: 28px;
    line-height: 15px;
    font-weight: normal;
    color: #333;
    opacity: 0.4;
  }

  .drip-tab .drip-content a.drip-close:hover {
    text-decoration: none;
    cursor: pointer;
    opacity: 0.6;
  }

  /* === Content Subscribe Form === */

  .drip-tab form {
    margin: 0 !important;
    padding: 0 !important;
  }

  .drip-tab dl {
    display: block;
    margin: 0;
    padding: 0;
  }

  .drip-tab dl dt {
    display: block;
    padding: 0 0 5px 0;
    font-weight: bold;
  }

  .drip-tab dl.no-labels dt.label-for-type-text,
  .drip-tab dl.no-labels dt.label-for-type-dropdown,
  .drip-tab dl.no-labels dt.label-for-type-email {
    display: none;
  }

  .drip-tab dl dd {
    display: block;
    padding: 0 0 10px 0;
  }

  .drip-lightbox input {
    box-sizing: border-box;
  }

  .drip-tab .drip-date-field,
  .drip-tab .drip-text-field {
    margin: 0 !important;
    height: 34px !important;
    width: 100% !important;
    color: #333 !important;
    background-color: #fff !important;
    border: 1px solid #c4c4c4 !important;
    -webkit-box-shadow: inset 0 0 3px rgba(0,0,0,0.18) !important;
       -moz-box-shadow: inset 0 0 3px rgba(0,0,0,0.18) !important;
            box-shadow: inset 0 0 3px rgba(0,0,0,0.18) !important;
    -webkit-border-radius: 4px !important;
       -moz-border-radius: 4px !important;
            border-radius: 4px !important;
    -webkit-box-sizing: border-box !important;
       -moz-box-sizing: border-box !important;
        -ms-box-sizing: border-box !important;
            box-sizing: border-box !important;
    background-image: none !important;
    min-width: 0 !important;
    min-height: 0 !important;
  }

  .drip-tab .drip-text-field,
  .drip-tab .drip-dropdown-select select {
    padding: 6px !important;
  }

  .drip-tab .drip-text-field::-webkit-input-placeholder { /* WebKit browsers */
    color: #999999 !important;
  }
  .drip-tab .drip-text-field:-moz-placeholder { /* Mozilla Firefox 4 to 18 */
    color: #999999 !important;
  }
  .drip-tab .drip-text-field::-moz-placeholder { /* Mozilla Firefox 19+ */
    color: #999999 !important;
  }
  .drip-tab .drip-text-field:-ms-input-placeholder { /* Internet Explorer 10+ */
    color: #999999 !important;
  }

  .drip-tab .drip-text-field:focus {
    border-color: #a4a4a4 !important;
    outline: 0;
    background-image: none;
    background-color: #fff !important;
  }

  .drip-tab.mobile .drip-text-field {
    font-size: 16px;
  }

  .drip-tab .drip-errors:not(:empty) {
    padding: 5px 0 0 0;
    font-weight: normal;
    color: red;
  }

  /* RADIOS */

  .drip-tab .drip-radio-buttons,
  .drip-tab .drip-radio-buttons * {
    box-sizing: border-box;
  }
  .drip-tab .drip-radio-buttons h4 {
    font-family: inherit;
    font-weight: bold;
    font-size: 15px;
    margin: 0 0 3px;
    padding: 0;
  }

  .drip-tab .drip-radio-button {
    width: 100%;
    display: block;
    position: relative;
    margin-bottom: 6px;
  }

  .drip-tab .drip-radio-button input[type="radio"] {
    height: 0;
    width: 0;
    opacity: 0;
    position: absolute;
    top: 0;
    left: 0;
    display: inline-block;
    border: none;
    padding: 0;
    margin: 0;
  }

  .drip-tab .drip-radio-button label {
    font-size: 15px;
    padding-left: 30px;
    color: #262626;
    white-space: normal;
    word-break: normal;
    cursor: pointer;
  }

  .drip-tab .drip-radio-button label:before {
    content: "";
    display: block;
    background: #f5f5f5;
    width: 18px;
    height: 18px;
    position: absolute;
    top: 50%;
    left: 0;
    transform: translateY(-50%);
    border-radius: 9px;
    border: 1px solid #cccccc;
    box-sizing: border-box;
    padding: 1px;
    transition: background 300ms ease-out, border-color 300ms, border-width 300ms ease-in;
  }
  .drip-tab .drip-radio-button label:hover:before {
    border-color: #000000;
  }

  .drip-tab .drip-radio-button input[type="radio"]:checked ~ label:before {
    background-color: #ffffff;
    border: 5px solid #000000;
  }

  /* DROPDOWNS */

  /* stylelint-disable */

.drip-tab .drip-dropdown-select h4 {
  font-family: inherit;
  font-weight: bold;
  font-size: 15px;
  margin: 0 0 3px;
  padding: 0;
}

.drip-tab .drip-dropdown-select select {
  display: block;
  box-shadow: none;
  position: relative;
  border: 1px solid #A8ACB9;
  outline: none;
  border-radius: 3px;
  line-height: inherit;
  font-family: inherit;
  color: #262626;
  transition: border-color 300ms;
  width: 100%;
  max-width: 100%; /* useful when width is set to anything other than 100% */
  box-sizing: border-box;

  -moz-appearance: none;
  -webkit-appearance: none;
  appearance: none;
  background-color: #fff;
  /* note: bg image below uses 2 urls. The first is an svg data uri for the arrow
    icon, and the second is the gradient. for the icon, if you want to change the
    color, be sure to use `%23` instead of `#`, since it's a url. You can also
    swap in a different svg icon or an external image reference
  */
  background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%23262626%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E'),
    linear-gradient(to bottom, #ffffff 0%, #ffffff 100%);
  background-repeat: no-repeat, repeat;
  /* arrow icon position (1em from the right, 50% vertical) , then gradient position*/
  background-position: right 12px top 50%, 0 0;
  /* icon size, then gradient */
  background-size: 12px auto, 100%;
}

/* Hide arrow icon in IE browsers */
.drip-tab .drip-dropdown-select select::-ms-expand {
  display: none;
}

/* Hover style */
.drip-tab .drip-dropdown-select select:hover {
  border-color: #888;
}

/* Focus style */
.drip-tab .drip-dropdown-select select:focus {
  border-color: #A8ACB9;
  /* It'd be nice to use -webkit-focus-ring-color here but it doesn't work on box-shadow */
  /* box-shadow: 0 0 1px 3px rgba(59, 153, 252, .7);
  box-shadow: 0 0 0 3px -moz-mac-focusring;
  color: #222; */
  outline: none;
}

/* Set options to normal weight */
.drip-tab .drip-dropdown-select select option {
  font-weight:normal;
}

/* Support for rtl text, explicit support for Arabic and Hebrew */
*[dir="rtl"] .drip-tab .drip-dropdown-select select,
:root:lang(ar) .drip-tab .drip-dropdown-select select,
:root:lang(iw) .drip-tab .drip-dropdown-select select {
  background-position: left 12px top 50%, 0 0;
  padding: .6em .8em .5em 1.4em;
}

/* Disabled styles */
.drip-tab .drip-dropdown-select select:disabled,
.drip-tab .drip-dropdown-select select[aria-disabled=true] {
  color: graytext;
  background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22graytext%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E'),
    linear-gradient(to bottom, #ffffff 0%,#e5e5e5 100%);
}
.drip-tab .drip-dropdown-select select:disabled:hover,
.drip-tab .drip-dropdown-select select[aria-disabled=true] {
  border-color: #aaa;
}

/* stylelint-enable */


  /* SUBMIT BUTTON */

  .drip-tab .drip-submit-button {
    font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif !important;
    padding: 3px 12px !important;
    color: #ffffff !important;
    font-weight: bold !important;
    line-height: 1.6 !important;
    border: 0 !important;
    -webkit-border-radius: 15px !important;
       -moz-border-radius: 15px !important;
            border-radius: 15px !important;
    cursor: pointer !important;
    background-image: none !important;
    min-width: 0 !important;
    min-height: 0 !important;
    height: auto;
  }

  .drip-tab .drip-submit-button:hover {
    background-image: none !important;
  }

  .drip-tab .drip-submit-button:active {
    background-image: none !important;
  }

  /* checkbox */
  .drip-tab .classic--checkbox.hidden {
    margin-bottom: -8px;
    display: none;
  }

  .drip-tab .classic--checkbox input[type="checkbox"] {
    display: inline-block;
    width: auto;
  }

  /* telephone input */
  /* stylelint-disable */

.drip-tab .iti + .zenput--checkbox {
  margin-top: 10px;
}

.drip-tab .iti {
  position: relative;
  display: block;
}

.drip-tab .iti * {
  box-sizing: border-box;
  -moz-box-sizing: border-box;
}

.drip-tab .iti__hide {
  display: none;
}

.drip-tab .iti__v-hide {
  visibility: hidden;
}

.drip-tab .iti input,
.drip-tab .iti input[type=text],
.drip-tab .iti input[type=tel] {
  position: relative;
  z-index: 0;
  width: 100%;
  padding: 0 0 0 36px;
  margin: 0 !important;
}

  .drip-tab .iti input,
  .drip-tab .iti input[type=text],
  .drip-tab .iti input[type=tel] {
    height: 34px;
    border: 1px solid #c4c4c4 !important;
    border-radius: 4px !important;
    box-shadow: inset 0 0 3px rgba(0, 0, 0, 0.18) !important;
  }

.drip-tab .iti__flag-container {
  position: absolute;
  top: 0;
  bottom: 0;
  right: 0;
  padding: 1px;
}

.drip-tab .iti__selected-flag {
  z-index: 1;
  position: relative;
  display: flex;
  align-items: center;
  height: 100%;
  padding: 0 6px 0 8px;
}

.drip-tab .iti__arrow {
  margin-left: 6px;
  width: 0;
  height: 0;
  border-left: 3px solid transparent;
  border-right: 3px solid transparent;
  border-top: 4px solid #555;
}

.drip-tab .iti__arrow--up {
  border-top: none;
  border-bottom: 4px solid #555;
}

.drip-tab .iti__country-list {
  position: absolute;
  z-index: 2;
  list-style: none;
  text-align: left;
  padding: 0;
  margin: 0 0 0 -1px;
  box-shadow: 1px 1px 4px rgba(0, 0, 0, 0.2);
  background-color: white;
  border: 1px solid #CCC;
  white-space: nowrap;
  max-height: 200px;
  width: 320px;
  overflow-y: scroll;
  overflow-x: hidden;
  -webkit-overflow-scrolling: touch;
}

.drip-tab .iti__country-list--dropup {
  bottom: 100%;
  margin-bottom: -1px;
}

@media (max-width: 500px) {
  .drip-tab .iti__country-list {
    white-space: normal;
  }
}

.drip-tab .iti__flag-box {
  display: inline-block;
  width: 20px;
}

.drip-tab .iti__divider {
  padding-bottom: 5px;
  margin-bottom: 5px;
  border-bottom: 1px solid #CCC;
}

.drip-tab .iti__country {
  padding: 5px 10px;
  outline: none;
}

.drip-tab .iti__dial-code {
  color: #999;
}

.drip-tab .iti__country.iti__highlight {
  background-color: rgba(0, 0, 0, 0.05);
}

.drip-tab .iti__flag-box,
.drip-tab .iti__country-name,
.drip-tab .iti__dial-code {
  vertical-align: middle;
}

.drip-tab .iti__flag-box,
.drip-tab .iti__country-name {
  margin-right: 6px;
}

.drip-tab .iti--allow-dropdown input,
.drip-tab .iti--allow-dropdown input[type=text],
.drip-tab .iti--allow-dropdown input[type=tel],
.drip-tab .iti--separate-dial-code input,
.drip-tab .iti--separate-dial-code input[type=text],
.drip-tab .iti--separate-dial-code input[type=tel] {
  padding-right: 6px;
  padding-left: 52px;
  margin-left: 0;
}

.drip-tab .iti--allow-dropdown .iti__flag-container,
.drip-tab .iti--separate-dial-code .iti__flag-container {
  right: auto;
  left: 0;
}

.drip-tab .iti--allow-dropdown .iti__flag-container:hover {
  cursor: pointer;
}

.drip-tab .iti--allow-dropdown .iti__flag-container:hover .iti__selected-flag {
  background-color: rgba(0, 0, 0, 0.05);
}

.drip-tab .iti--allow-dropdown input[disabled]+.iti__flag-container:hover,
.drip-tab .iti--allow-dropdown input[readonly]+.iti__flag-container:hover {
  cursor: default;
}

.drip-tab .iti--allow-dropdown input[disabled]+.iti__flag-container:hover .iti__selected-flag,
.drip-tab .iti--allow-dropdown input[readonly]+.iti__flag-container:hover .iti__selected-flag {
  background-color: transparent;
}

.drip-tab .iti--separate-dial-code .iti__selected-flag {
  background-color: rgba(0, 0, 0, 0.05);
}

.drip-tab .iti--separate-dial-code .iti__selected-dial-code {
  margin-left: 6px;
}

.drip-tab .iti--container {
  position: absolute;
  top: -1000px;
  left: -1000px;
  z-index: 1060;
  padding: 1px;
}

.drip-tab .iti--container:hover {
  cursor: pointer;
}

.iti-mobile .drip-tab  .iti--container {
  top: 30px;
  bottom: 30px;
  left: 30px;
  right: 30px;
  position: fixed;
}

.iti-mobile .drip-tab .iti__country-list {
  max-height: 100%;
  width: 100%;
}

.iti-mobile .drip-tab .iti__country {
  padding: 10px 10px;
  line-height: 1.5em;
}

.drip-tab .sms-subtext {
  margin-top: .75em;
  font-size: .75em;
  line-height: 1.4;
  display: inline-block;
}

.drip-tab .sms-subtext a {
  text-decoration: underline;
  cursor: pointer;
}

.drip-tab .iti__flag {
  width: 20px;
}

.drip-tab .iti__flag.iti__be {
  width: 18px;
}

.drip-tab .iti__flag.iti__ch {
  width: 15px;
}

.drip-tab .iti__flag.iti__mc {
  width: 19px;
}

.drip-tab .iti__flag.iti__ne {
  width: 18px;
}

.drip-tab .iti__flag.iti__np {
  width: 13px;
}

.drip-tab .iti__flag.iti__va {
  width: 15px;
}

@media (-webkit-min-device-pixel-ratio: 2),
(min-resolution: 192dpi) {
  .drip-tab .iti__flag {
    background-size: 5652px 15px;
  }
}

.drip-tab .iti__flag.iti__ac {
    height: 10px;
    background-position: 0px 0px;
  }

.drip-tab .iti__flag.iti__ad {
    height: 14px;
    background-position: -22px 0px;
  }

.drip-tab .iti__flag.iti__ae {
    height: 10px;
    background-position: -44px 0px;
  }

.drip-tab .iti__flag.iti__af {
    height: 14px;
    background-position: -66px 0px;
  }

.drip-tab .iti__flag.iti__ag {
    height: 14px;
    background-position: -88px 0px;
  }

.drip-tab .iti__flag.iti__ai {
    height: 10px;
    background-position: -110px 0px;
  }

.drip-tab .iti__flag.iti__al {
    height: 15px;
    background-position: -132px 0px;
  }

.drip-tab .iti__flag.iti__am {
    height: 10px;
    background-position: -154px 0px;
  }

.drip-tab .iti__flag.iti__ao {
    height: 14px;
    background-position: -176px 0px;
  }

.drip-tab .iti__flag.iti__aq {
    height: 14px;
    background-position: -198px 0px;
  }

.drip-tab .iti__flag.iti__ar {
    height: 13px;
    background-position: -220px 0px;
  }

.drip-tab .iti__flag.iti__as {
    height: 10px;
    background-position: -242px 0px;
  }

.drip-tab .iti__flag.iti__at {
    height: 14px;
    background-position: -264px 0px;
  }

.drip-tab .iti__flag.iti__au {
    height: 10px;
    background-position: -286px 0px;
  }

.drip-tab .iti__flag.iti__aw {
    height: 14px;
    background-position: -308px 0px;
  }

.drip-tab .iti__flag.iti__ax {
    height: 13px;
    background-position: -330px 0px;
  }

.drip-tab .iti__flag.iti__az {
    height: 10px;
    background-position: -352px 0px;
  }

.drip-tab .iti__flag.iti__ba {
    height: 10px;
    background-position: -374px 0px;
  }

.drip-tab .iti__flag.iti__bb {
    height: 14px;
    background-position: -396px 0px;
  }

.drip-tab .iti__flag.iti__bd {
    height: 12px;
    background-position: -418px 0px;
  }

.drip-tab .iti__flag.iti__be {
    height: 15px;
    background-position: -440px 0px;
  }

.drip-tab .iti__flag.iti__bf {
    height: 14px;
    background-position: -460px 0px;
  }

.drip-tab .iti__flag.iti__bg {
    height: 12px;
    background-position: -482px 0px;
  }

.drip-tab .iti__flag.iti__bh {
    height: 12px;
    background-position: -504px 0px;
  }

.drip-tab .iti__flag.iti__bi {
    height: 12px;
    background-position: -526px 0px;
  }

.drip-tab .iti__flag.iti__bj {
    height: 14px;
    background-position: -548px 0px;
  }

.drip-tab .iti__flag.iti__bl {
    height: 14px;
    background-position: -570px 0px;
  }

.drip-tab .iti__flag.iti__bm {
    height: 10px;
    background-position: -592px 0px;
  }

.drip-tab .iti__flag.iti__bn {
    height: 10px;
    background-position: -614px 0px;
  }

.drip-tab .iti__flag.iti__bo {
    height: 14px;
    background-position: -636px 0px;
  }

.drip-tab .iti__flag.iti__bq {
    height: 14px;
    background-position: -658px 0px;
  }

.drip-tab .iti__flag.iti__br {
    height: 14px;
    background-position: -680px 0px;
  }

.drip-tab .iti__flag.iti__bs {
    height: 10px;
    background-position: -702px 0px;
  }

.drip-tab .iti__flag.iti__bt {
    height: 14px;
    background-position: -724px 0px;
  }

.drip-tab .iti__flag.iti__bv {
    height: 15px;
    background-position: -746px 0px;
  }

.drip-tab .iti__flag.iti__bw {
    height: 14px;
    background-position: -768px 0px;
  }

.drip-tab .iti__flag.iti__by {
    height: 10px;
    background-position: -790px 0px;
  }

.drip-tab .iti__flag.iti__bz {
    height: 14px;
    background-position: -812px 0px;
  }

.drip-tab .iti__flag.iti__ca {
    height: 10px;
    background-position: -834px 0px;
  }

.drip-tab .iti__flag.iti__cc {
    height: 10px;
    background-position: -856px 0px;
  }

.drip-tab .iti__flag.iti__cd {
    height: 15px;
    background-position: -878px 0px;
  }

.drip-tab .iti__flag.iti__cf {
    height: 14px;
    background-position: -900px 0px;
  }

.drip-tab .iti__flag.iti__cg {
    height: 14px;
    background-position: -922px 0px;
  }

.drip-tab .iti__flag.iti__ch {
    height: 15px;
    background-position: -944px 0px;
  }

.drip-tab .iti__flag.iti__ci {
    height: 14px;
    background-position: -961px 0px;
  }

.drip-tab .iti__flag.iti__ck {
    height: 10px;
    background-position: -983px 0px;
  }

.drip-tab .iti__flag.iti__cl {
    height: 14px;
    background-position: -1005px 0px;
  }

.drip-tab .iti__flag.iti__cm {
    height: 14px;
    background-position: -1027px 0px;
  }

.drip-tab .iti__flag.iti__cn {
    height: 14px;
    background-position: -1049px 0px;
  }

.drip-tab .iti__flag.iti__co {
    height: 14px;
    background-position: -1071px 0px;
  }

.drip-tab .iti__flag.iti__cp {
    height: 14px;
    background-position: -1093px 0px;
  }

.drip-tab .iti__flag.iti__cr {
    height: 12px;
    background-position: -1115px 0px;
  }

.drip-tab .iti__flag.iti__cu {
    height: 10px;
    background-position: -1137px 0px;
  }

.drip-tab .iti__flag.iti__cv {
    height: 12px;
    background-position: -1159px 0px;
  }

.drip-tab .iti__flag.iti__cw {
    height: 14px;
    background-position: -1181px 0px;
  }

.drip-tab .iti__flag.iti__cx {
    height: 10px;
    background-position: -1203px 0px;
  }

.drip-tab .iti__flag.iti__cy {
    height: 14px;
    background-position: -1225px 0px;
  }

.drip-tab .iti__flag.iti__cz {
    height: 14px;
    background-position: -1247px 0px;
  }

.drip-tab .iti__flag.iti__de {
    height: 12px;
    background-position: -1269px 0px;
  }

.drip-tab .iti__flag.iti__dg {
    height: 10px;
    background-position: -1291px 0px;
  }

.drip-tab .iti__flag.iti__dj {
    height: 14px;
    background-position: -1313px 0px;
  }

.drip-tab .iti__flag.iti__dk {
    height: 15px;
    background-position: -1335px 0px;
  }

.drip-tab .iti__flag.iti__dm {
    height: 10px;
    background-position: -1357px 0px;
  }

.drip-tab .iti__flag.iti__do {
    height: 14px;
    background-position: -1379px 0px;
  }

.drip-tab .iti__flag.iti__dz {
    height: 14px;
    background-position: -1401px 0px;
  }

.drip-tab .iti__flag.iti__ea {
    height: 14px;
    background-position: -1423px 0px;
  }

.drip-tab .iti__flag.iti__ec {
    height: 14px;
    background-position: -1445px 0px;
  }

.drip-tab .iti__flag.iti__ee {
    height: 13px;
    background-position: -1467px 0px;
  }

.drip-tab .iti__flag.iti__eg {
    height: 14px;
    background-position: -1489px 0px;
  }

.drip-tab .iti__flag.iti__eh {
    height: 10px;
    background-position: -1511px 0px;
  }

.drip-tab .iti__flag.iti__er {
    height: 10px;
    background-position: -1533px 0px;
  }

.drip-tab .iti__flag.iti__es {
    height: 14px;
    background-position: -1555px 0px;
  }

.drip-tab .iti__flag.iti__et {
    height: 10px;
    background-position: -1577px 0px;
  }

.drip-tab .iti__flag.iti__eu {
    height: 14px;
    background-position: -1599px 0px;
  }

.drip-tab .iti__flag.iti__fi {
    height: 12px;
    background-position: -1621px 0px;
  }

.drip-tab .iti__flag.iti__fj {
    height: 10px;
    background-position: -1643px 0px;
  }

.drip-tab .iti__flag.iti__fk {
    height: 10px;
    background-position: -1665px 0px;
  }

.drip-tab .iti__flag.iti__fm {
    height: 11px;
    background-position: -1687px 0px;
  }

.drip-tab .iti__flag.iti__fo {
    height: 15px;
    background-position: -1709px 0px;
  }

.drip-tab .iti__flag.iti__fr {
    height: 14px;
    background-position: -1731px 0px;
  }

.drip-tab .iti__flag.iti__ga {
    height: 15px;
    background-position: -1753px 0px;
  }

.drip-tab .iti__flag.iti__gb {
    height: 10px;
    background-position: -1775px 0px;
  }

.drip-tab .iti__flag.iti__gd {
    height: 12px;
    background-position: -1797px 0px;
  }

.drip-tab .iti__flag.iti__ge {
    height: 14px;
    background-position: -1819px 0px;
  }

.drip-tab .iti__flag.iti__gf {
    height: 14px;
    background-position: -1841px 0px;
  }

.drip-tab .iti__flag.iti__gg {
    height: 14px;
    background-position: -1863px 0px;
  }

.drip-tab .iti__flag.iti__gh {
    height: 14px;
    background-position: -1885px 0px;
  }

.drip-tab .iti__flag.iti__gi {
    height: 10px;
    background-position: -1907px 0px;
  }

.drip-tab .iti__flag.iti__gl {
    height: 14px;
    background-position: -1929px 0px;
  }

.drip-tab .iti__flag.iti__gm {
    height: 14px;
    background-position: -1951px 0px;
  }

.drip-tab .iti__flag.iti__gn {
    height: 14px;
    background-position: -1973px 0px;
  }

.drip-tab .iti__flag.iti__gp {
    height: 14px;
    background-position: -1995px 0px;
  }

.drip-tab .iti__flag.iti__gq {
    height: 14px;
    background-position: -2017px 0px;
  }

.drip-tab .iti__flag.iti__gr {
    height: 14px;
    background-position: -2039px 0px;
  }

.drip-tab .iti__flag.iti__gs {
    height: 10px;
    background-position: -2061px 0px;
  }

.drip-tab .iti__flag.iti__gt {
    height: 13px;
    background-position: -2083px 0px;
  }

.drip-tab .iti__flag.iti__gu {
    height: 11px;
    background-position: -2105px 0px;
  }

.drip-tab .iti__flag.iti__gw {
    height: 10px;
    background-position: -2127px 0px;
  }

.drip-tab .iti__flag.iti__gy {
    height: 12px;
    background-position: -2149px 0px;
  }

.drip-tab .iti__flag.iti__hk {
    height: 14px;
    background-position: -2171px 0px;
  }

.drip-tab .iti__flag.iti__hm {
    height: 10px;
    background-position: -2193px 0px;
  }

.drip-tab .iti__flag.iti__hn {
    height: 10px;
    background-position: -2215px 0px;
  }

.drip-tab .iti__flag.iti__hr {
    height: 10px;
    background-position: -2237px 0px;
  }

.drip-tab .iti__flag.iti__ht {
    height: 12px;
    background-position: -2259px 0px;
  }

.drip-tab .iti__flag.iti__hu {
    height: 10px;
    background-position: -2281px 0px;
  }

.drip-tab .iti__flag.iti__ic {
    height: 14px;
    background-position: -2303px 0px;
  }

.drip-tab .iti__flag.iti__id {
    height: 14px;
    background-position: -2325px 0px;
  }

.drip-tab .iti__flag.iti__ie {
    height: 10px;
    background-position: -2347px 0px;
  }

.drip-tab .iti__flag.iti__il {
    height: 15px;
    background-position: -2369px 0px;
  }

.drip-tab .iti__flag.iti__im {
    height: 10px;
    background-position: -2391px 0px;
  }

.drip-tab .iti__flag.iti__in {
    height: 14px;
    background-position: -2413px 0px;
  }

.drip-tab .iti__flag.iti__io {
    height: 10px;
    background-position: -2435px 0px;
  }

.drip-tab .iti__flag.iti__iq {
    height: 14px;
    background-position: -2457px 0px;
  }

.drip-tab .iti__flag.iti__ir {
    height: 12px;
    background-position: -2479px 0px;
  }

.drip-tab .iti__flag.iti__is {
    height: 15px;
    background-position: -2501px 0px;
  }

.drip-tab .iti__flag.iti__it {
    height: 14px;
    background-position: -2523px 0px;
  }

.drip-tab .iti__flag.iti__je {
    height: 12px;
    background-position: -2545px 0px;
  }

.drip-tab .iti__flag.iti__jm {
    height: 10px;
    background-position: -2567px 0px;
  }

.drip-tab .iti__flag.iti__jo {
    height: 10px;
    background-position: -2589px 0px;
  }

.drip-tab .iti__flag.iti__jp {
    height: 14px;
    background-position: -2611px 0px;
  }

.drip-tab .iti__flag.iti__ke {
    height: 14px;
    background-position: -2633px 0px;
  }

.drip-tab .iti__flag.iti__kg {
    height: 12px;
    background-position: -2655px 0px;
  }

.drip-tab .iti__flag.iti__kh {
    height: 13px;
    background-position: -2677px 0px;
  }

.drip-tab .iti__flag.iti__ki {
    height: 10px;
    background-position: -2699px 0px;
  }

.drip-tab .iti__flag.iti__km {
    height: 12px;
    background-position: -2721px 0px;
  }

.drip-tab .iti__flag.iti__kn {
    height: 14px;
    background-position: -2743px 0px;
  }

.drip-tab .iti__flag.iti__kp {
    height: 10px;
    background-position: -2765px 0px;
  }

.drip-tab .iti__flag.iti__kr {
    height: 14px;
    background-position: -2787px 0px;
  }

.drip-tab .iti__flag.iti__kw {
    height: 10px;
    background-position: -2809px 0px;
  }

.drip-tab .iti__flag.iti__ky {
    height: 10px;
    background-position: -2831px 0px;
  }

.drip-tab .iti__flag.iti__kz {
    height: 10px;
    background-position: -2853px 0px;
  }

.drip-tab .iti__flag.iti__la {
    height: 14px;
    background-position: -2875px 0px;
  }

.drip-tab .iti__flag.iti__lb {
    height: 14px;
    background-position: -2897px 0px;
  }

.drip-tab .iti__flag.iti__lc {
    height: 10px;
    background-position: -2919px 0px;
  }

.drip-tab .iti__flag.iti__li {
    height: 12px;
    background-position: -2941px 0px;
  }

.drip-tab .iti__flag.iti__lk {
    height: 10px;
    background-position: -2963px 0px;
  }

.drip-tab .iti__flag.iti__lr {
    height: 11px;
    background-position: -2985px 0px;
  }

.drip-tab .iti__flag.iti__ls {
    height: 14px;
    background-position: -3007px 0px;
  }

.drip-tab .iti__flag.iti__lt {
    height: 12px;
    background-position: -3029px 0px;
  }

.drip-tab .iti__flag.iti__lu {
    height: 12px;
    background-position: -3051px 0px;
  }

.drip-tab .iti__flag.iti__lv {
    height: 10px;
    background-position: -3073px 0px;
  }

.drip-tab .iti__flag.iti__ly {
    height: 10px;
    background-position: -3095px 0px;
  }

.drip-tab .iti__flag.iti__ma {
    height: 14px;
    background-position: -3117px 0px;
  }

.drip-tab .iti__flag.iti__mc {
    height: 15px;
    background-position: -3139px 0px;
  }

.drip-tab .iti__flag.iti__md {
    height: 10px;
    background-position: -3160px 0px;
  }

.drip-tab .iti__flag.iti__me {
    height: 10px;
    background-position: -3182px 0px;
  }

.drip-tab .iti__flag.iti__mf {
    height: 14px;
    background-position: -3204px 0px;
  }

.drip-tab .iti__flag.iti__mg {
    height: 14px;
    background-position: -3226px 0px;
  }

.drip-tab .iti__flag.iti__mh {
    height: 11px;
    background-position: -3248px 0px;
  }

.drip-tab .iti__flag.iti__mk {
    height: 10px;
    background-position: -3270px 0px;
  }

.drip-tab .iti__flag.iti__ml {
    height: 14px;
    background-position: -3292px 0px;
  }

.drip-tab .iti__flag.iti__mm {
    height: 14px;
    background-position: -3314px 0px;
  }

.drip-tab .iti__flag.iti__mn {
    height: 10px;
    background-position: -3336px 0px;
  }

.drip-tab .iti__flag.iti__mo {
    height: 14px;
    background-position: -3358px 0px;
  }

.drip-tab .iti__flag.iti__mp {
    height: 10px;
    background-position: -3380px 0px;
  }

.drip-tab .iti__flag.iti__mq {
    height: 14px;
    background-position: -3402px 0px;
  }

.drip-tab .iti__flag.iti__mr {
    height: 14px;
    background-position: -3424px 0px;
  }

.drip-tab .iti__flag.iti__ms {
    height: 10px;
    background-position: -3446px 0px;
  }

.drip-tab .iti__flag.iti__mt {
    height: 14px;
    background-position: -3468px 0px;
  }

.drip-tab .iti__flag.iti__mu {
    height: 14px;
    background-position: -3490px 0px;
  }

.drip-tab .iti__flag.iti__mv {
    height: 14px;
    background-position: -3512px 0px;
  }

.drip-tab .iti__flag.iti__mw {
    height: 14px;
    background-position: -3534px 0px;
  }

.drip-tab .iti__flag.iti__mx {
    height: 12px;
    background-position: -3556px 0px;
  }

.drip-tab .iti__flag.iti__my {
    height: 10px;
    background-position: -3578px 0px;
  }

.drip-tab .iti__flag.iti__mz {
    height: 14px;
    background-position: -3600px 0px;
  }

.drip-tab .iti__flag.iti__na {
    height: 14px;
    background-position: -3622px 0px;
  }

.drip-tab .iti__flag.iti__nc {
    height: 10px;
    background-position: -3644px 0px;
  }

.drip-tab .iti__flag.iti__ne {
    height: 15px;
    background-position: -3666px 0px;
  }

.drip-tab .iti__flag.iti__nf {
    height: 10px;
    background-position: -3686px 0px;
  }

.drip-tab .iti__flag.iti__ng {
    height: 10px;
    background-position: -3708px 0px;
  }

.drip-tab .iti__flag.iti__ni {
    height: 12px;
    background-position: -3730px 0px;
  }

.drip-tab .iti__flag.iti__nl {
    height: 14px;
    background-position: -3752px 0px;
  }

.drip-tab .iti__flag.iti__no {
    height: 15px;
    background-position: -3774px 0px;
  }

.drip-tab .iti__flag.iti__np {
    height: 15px;
    background-position: -3796px 0px;
  }

.drip-tab .iti__flag.iti__nr {
    height: 10px;
    background-position: -3811px 0px;
  }

.drip-tab .iti__flag.iti__nu {
    height: 10px;
    background-position: -3833px 0px;
  }

.drip-tab .iti__flag.iti__nz {
    height: 10px;
    background-position: -3855px 0px;
  }

.drip-tab .iti__flag.iti__om {
    height: 10px;
    background-position: -3877px 0px;
  }

.drip-tab .iti__flag.iti__pa {
    height: 14px;
    background-position: -3899px 0px;
  }

.drip-tab .iti__flag.iti__pe {
    height: 14px;
    background-position: -3921px 0px;
  }

.drip-tab .iti__flag.iti__pf {
    height: 14px;
    background-position: -3943px 0px;
  }

.drip-tab .iti__flag.iti__pg {
    height: 15px;
    background-position: -3965px 0px;
  }

.drip-tab .iti__flag.iti__ph {
    height: 10px;
    background-position: -3987px 0px;
  }

.drip-tab .iti__flag.iti__pk {
    height: 14px;
    background-position: -4009px 0px;
  }

.drip-tab .iti__flag.iti__pl {
    height: 13px;
    background-position: -4031px 0px;
  }

.drip-tab .iti__flag.iti__pm {
    height: 14px;
    background-position: -4053px 0px;
  }

.drip-tab .iti__flag.iti__pn {
    height: 10px;
    background-position: -4075px 0px;
  }

.drip-tab .iti__flag.iti__pr {
    height: 14px;
    background-position: -4097px 0px;
  }

.drip-tab .iti__flag.iti__ps {
    height: 10px;
    background-position: -4119px 0px;
  }

.drip-tab .iti__flag.iti__pt {
    height: 14px;
    background-position: -4141px 0px;
  }

.drip-tab .iti__flag.iti__pw {
    height: 13px;
    background-position: -4163px 0px;
  }

.drip-tab .iti__flag.iti__py {
    height: 11px;
    background-position: -4185px 0px;
  }

.drip-tab .iti__flag.iti__qa {
    height: 8px;
    background-position: -4207px 0px;
  }

.drip-tab .iti__flag.iti__re {
    height: 14px;
    background-position: -4229px 0px;
  }

.drip-tab .iti__flag.iti__ro {
    height: 14px;
    background-position: -4251px 0px;
  }

.drip-tab .iti__flag.iti__rs {
    height: 14px;
    background-position: -4273px 0px;
  }

.drip-tab .iti__flag.iti__ru {
    height: 14px;
    background-position: -4295px 0px;
  }

.drip-tab .iti__flag.iti__rw {
    height: 14px;
    background-position: -4317px 0px;
  }

.drip-tab .iti__flag.iti__sa {
    height: 14px;
    background-position: -4339px 0px;
  }

.drip-tab .iti__flag.iti__sb {
    height: 10px;
    background-position: -4361px 0px;
  }

.drip-tab .iti__flag.iti__sc {
    height: 10px;
    background-position: -4383px 0px;
  }

.drip-tab .iti__flag.iti__sd {
    height: 10px;
    background-position: -4405px 0px;
  }

.drip-tab .iti__flag.iti__se {
    height: 13px;
    background-position: -4427px 0px;
  }

.drip-tab .iti__flag.iti__sg {
    height: 14px;
    background-position: -4449px 0px;
  }

.drip-tab .iti__flag.iti__sh {
    height: 10px;
    background-position: -4471px 0px;
  }

.drip-tab .iti__flag.iti__si {
    height: 10px;
    background-position: -4493px 0px;
  }

.drip-tab .iti__flag.iti__sj {
    height: 15px;
    background-position: -4515px 0px;
  }

.drip-tab .iti__flag.iti__sk {
    height: 14px;
    background-position: -4537px 0px;
  }

.drip-tab .iti__flag.iti__sl {
    height: 14px;
    background-position: -4559px 0px;
  }

.drip-tab .iti__flag.iti__sm {
    height: 15px;
    background-position: -4581px 0px;
  }

.drip-tab .iti__flag.iti__sn {
    height: 14px;
    background-position: -4603px 0px;
  }

.drip-tab .iti__flag.iti__so {
    height: 14px;
    background-position: -4625px 0px;
  }

.drip-tab .iti__flag.iti__sr {
    height: 14px;
    background-position: -4647px 0px;
  }

.drip-tab .iti__flag.iti__ss {
    height: 10px;
    background-position: -4669px 0px;
  }

.drip-tab .iti__flag.iti__st {
    height: 10px;
    background-position: -4691px 0px;
  }

.drip-tab .iti__flag.iti__sv {
    height: 12px;
    background-position: -4713px 0px;
  }

.drip-tab .iti__flag.iti__sx {
    height: 14px;
    background-position: -4735px 0px;
  }

.drip-tab .iti__flag.iti__sy {
    height: 14px;
    background-position: -4757px 0px;
  }

.drip-tab .iti__flag.iti__sz {
    height: 14px;
    background-position: -4779px 0px;
  }

.drip-tab .iti__flag.iti__ta {
    height: 10px;
    background-position: -4801px 0px;
  }

.drip-tab .iti__flag.iti__tc {
    height: 10px;
    background-position: -4823px 0px;
  }

.drip-tab .iti__flag.iti__td {
    height: 14px;
    background-position: -4845px 0px;
  }

.drip-tab .iti__flag.iti__tf {
    height: 14px;
    background-position: -4867px 0px;
  }

.drip-tab .iti__flag.iti__tg {
    height: 13px;
    background-position: -4889px 0px;
  }

.drip-tab .iti__flag.iti__th {
    height: 14px;
    background-position: -4911px 0px;
  }

.drip-tab .iti__flag.iti__tj {
    height: 10px;
    background-position: -4933px 0px;
  }

.drip-tab .iti__flag.iti__tk {
    height: 10px;
    background-position: -4955px 0px;
  }

.drip-tab .iti__flag.iti__tl {
    height: 10px;
    background-position: -4977px 0px;
  }

.drip-tab .iti__flag.iti__tm {
    height: 14px;
    background-position: -4999px 0px;
  }

.drip-tab .iti__flag.iti__tn {
    height: 14px;
    background-position: -5021px 0px;
  }

.drip-tab .iti__flag.iti__to {
    height: 10px;
    background-position: -5043px 0px;
  }

.drip-tab .iti__flag.iti__tr {
    height: 14px;
    background-position: -5065px 0px;
  }

.drip-tab .iti__flag.iti__tt {
    height: 12px;
    background-position: -5087px 0px;
  }

.drip-tab .iti__flag.iti__tv {
    height: 10px;
    background-position: -5109px 0px;
  }

.drip-tab .iti__flag.iti__tw {
    height: 14px;
    background-position: -5131px 0px;
  }

.drip-tab .iti__flag.iti__tz {
    height: 14px;
    background-position: -5153px 0px;
  }

.drip-tab .iti__flag.iti__ua {
    height: 14px;
    background-position: -5175px 0px;
  }

.drip-tab .iti__flag.iti__ug {
    height: 14px;
    background-position: -5197px 0px;
  }

.drip-tab .iti__flag.iti__um {
    height: 11px;
    background-position: -5219px 0px;
  }

.drip-tab .iti__flag.iti__un {
    height: 14px;
    background-position: -5241px 0px;
  }

.drip-tab .iti__flag.iti__us {
    height: 11px;
    background-position: -5263px 0px;
  }

.drip-tab .iti__flag.iti__uy {
    height: 14px;
    background-position: -5285px 0px;
  }

.drip-tab .iti__flag.iti__uz {
    height: 10px;
    background-position: -5307px 0px;
  }

.drip-tab .iti__flag.iti__va {
    height: 15px;
    background-position: -5329px 0px;
  }

.drip-tab .iti__flag.iti__vc {
    height: 14px;
    background-position: -5346px 0px;
  }

.drip-tab .iti__flag.iti__ve {
    height: 14px;
    background-position: -5368px 0px;
  }

.drip-tab .iti__flag.iti__vg {
    height: 10px;
    background-position: -5390px 0px;
  }

.drip-tab .iti__flag.iti__vi {
    height: 14px;
    background-position: -5412px 0px;
  }

.drip-tab .iti__flag.iti__vn {
    height: 14px;
    background-position: -5434px 0px;
  }

.drip-tab .iti__flag.iti__vu {
    height: 12px;
    background-position: -5456px 0px;
  }

.drip-tab .iti__flag.iti__wf {
    height: 14px;
    background-position: -5478px 0px;
  }

.drip-tab .iti__flag.iti__ws {
    height: 10px;
    background-position: -5500px 0px;
  }

.drip-tab .iti__flag.iti__xk {
    height: 15px;
    background-position: -5522px 0px;
  }

.drip-tab .iti__flag.iti__ye {
    height: 14px;
    background-position: -5544px 0px;
  }

.drip-tab .iti__flag.iti__yt {
    height: 14px;
    background-position: -5566px 0px;
  }

.drip-tab .iti__flag.iti__za {
    height: 14px;
    background-position: -5588px 0px;
  }

.drip-tab .iti__flag.iti__zm {
    height: 14px;
    background-position: -5610px 0px;
  }

.drip-tab .iti__flag.iti__zw {
    height: 10px;
    background-position: -5632px 0px;
  }

.drip-tab .iti__flag {
    height: 15px;
    box-shadow: 0px 0px 1px 0px #888;
    background-image: url("flags.png");
    background-repeat: no-repeat;
    background-position: 20px 0;
  }

.drip-tab .iti__flag.iti__np {
  background-color: transparent;
}

.drip-tab .iti__flag {
  background-image: url("https://d14jnfavjicsbe.cloudfront.net/images/client/flags.png");
};

@media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
  .drip-tab .iti__flag {
    background-image: url("https://d14jnfavjicsbe.cloudfront.net/images/client/flags@2x.png");
  }
}

/* stylelint-enable */


  /* preview settings */
  body.after-submit-preview .drip-panel:not(.drip-success) {
    display: none !important;
  }
  body.after-submit-preview .drip-success {
    display: block !important;
  }

  /* stylelint-enable */

</style><script src="./How to Explore the GAN Latent Space When Generating Faces_files/can-i-show.js.download"></script><style id="fit-vids-style">.fluid-width-video-wrapper{width:100%;position:relative;padding:0;}.fluid-width-video-wrapper iframe,.fluid-width-video-wrapper object,.fluid-width-video-wrapper embed {position:absolute;top:0;left:0;width:100%;height:100%;}</style><link rel="stylesheet" type="text/css" href="./How to Explore the GAN Latent Space When Generating Faces_files/twitcount.css" media="all"></head>
<body class="post-template-default single single-post postid-8135 single-format-standard chrome alt-style-default two-col-left width-960 two-col-left-960">
<div id="wrapper">

	<div id="inner-wrapper">

	<h3 class="nav-toggle icon"><a href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#navigation">Navigation</a></h3>

	<header id="header" class="col-full">

		<div id="logo">
<a href="https://machinelearningmastery.com/" title="Making developers awesome at machine learning"><img width="480" height="80" src="./How to Explore the GAN Latent Space When Generating Faces_files/Header_smaller_text_better-1.webp" alt="Machine Learning Mastery"></a>
<span class="site-title"><a href="https://machinelearningmastery.com/">Machine Learning Mastery</a></span>
<span class="site-description">Making developers awesome at machine learning</span>
</div>
	    <div class="header-widget">
	        <div id="custom_html-32" class="widget_text widget widget_custom_html"><div class="textwidget custom-html-widget"><div style="text-align: right;">
	<a href="https://machinelearningmastery.lpages.co/ganwp-mini-course/">Click to Take the FREE GANs Crash-Course</a>
</div></div></div><div id="search-4" class="widget widget_search"><div class="search_main">
    <form method="get" class="searchform" action="https://machinelearningmastery.com/">
        <input type="text" class="field s" name="s" value="Search..." onfocus="if (!window.__cfRLUnblockHandlers) return false; if (this.value == &#39;Search...&#39;) {this.value = &#39;&#39;;}" onblur="if (!window.__cfRLUnblockHandlers) return false; if (this.value == &#39;&#39;) {this.value = &#39;Search...&#39;;}">
		<input type="hidden" name="post_type" value="post">
        <button type="submit" class="fa fa-search submit" name="submit" value="Search"></button>
    </form>
    <div class="fix"></div>
</div></div>	    </div>
	
	</header>
	<nav id="navigation" class="col-full" role="navigation">

	
	<section class="menus">

		<a href="https://machinelearningmastery.com/" class="nav-home"><span>Home</span></a>

	<h3>Main Menu</h3><ul id="main-nav" class="nav fl"><li id="menu-item-6503" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6503"><a href="https://machinelearningmastery.com/start-here/">Get Started</a></li>
<li id="menu-item-6501" class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-6501"><a href="https://machinelearningmastery.com/blog/">Blog</a></li>
<li id="menu-item-6506" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-6506 parent"><a href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#">Topics</a>
<ul class="sub-menu">
	<li id="menu-item-6508" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6508"><a href="https://machinelearningmastery.com/category/deep-learning/">Deep Learning (keras)</a></li>
	<li id="menu-item-7921" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-7921"><a href="https://machinelearningmastery.com/category/deep-learning-for-computer-vision/">Computer Vision</a></li>
	<li id="menu-item-6509" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6509"><a href="https://machinelearningmastery.com/category/deep-learning-time-series/">Neural Net Time Series</a></li>
	<li id="menu-item-6515" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6515"><a href="https://machinelearningmastery.com/category/natural-language-processing/">NLP (Text)</a></li>
	<li id="menu-item-8576" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-8576"><a href="https://machinelearningmastery.com/category/generative-adversarial-networks/">GANs</a></li>
	<li id="menu-item-6511" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6511"><a href="https://machinelearningmastery.com/category/lstm/">LSTMs</a></li>
	<li id="menu-item-7106" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-7106"><a href="https://machinelearningmastery.com/category/better-deep-learning/">Better Deep Learning</a></li>
	<li id="menu-item-6512" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6512"><a href="https://machinelearningmastery.com/category/machine-learning-algorithms/">Intro to Algorithms</a></li>
	<li id="menu-item-6507" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6507"><a href="https://machinelearningmastery.com/category/algorithms-from-scratch/">Code Algorithms</a></li>
	<li id="menu-item-6520" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6520"><a href="https://machinelearningmastery.com/category/time-series/">Intro to Time Series</a></li>
	<li id="menu-item-6516" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6516"><a href="https://machinelearningmastery.com/category/python-machine-learning/">Python (scikit-learn)</a></li>
	<li id="menu-item-11055" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-11055"><a href="https://machinelearningmastery.com/category/ensemble-learning/">Ensemble Learning</a></li>
	<li id="menu-item-9966" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-9966"><a href="https://machinelearningmastery.com/category/imbalanced-classification/">Imbalanced Learning</a></li>
	<li id="menu-item-10674" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-10674"><a href="https://machinelearningmastery.com/category/data-preparation/">Data Preparation</a></li>
	<li id="menu-item-6517" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6517"><a href="https://machinelearningmastery.com/category/r-machine-learning/">R (caret)</a></li>
	<li id="menu-item-6522" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6522"><a href="https://machinelearningmastery.com/category/weka-machine-learning/">Weka (no code)</a></li>
	<li id="menu-item-6510" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6510"><a href="https://machinelearningmastery.com/category/linear-algebra/">Linear Algebra</a></li>
	<li id="menu-item-6519" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6519"><a href="https://machinelearningmastery.com/category/statistical-methods/">Statistics</a></li>
	<li id="menu-item-8989" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-8989"><a href="https://machinelearningmastery.com/category/probability/">Probability</a></li>
	<li id="menu-item-6523" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6523"><a href="https://machinelearningmastery.com/category/xgboost/">XGBoost</a></li>
</ul>
</li>
<li id="menu-item-6502" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6502"><a href="https://machinelearningmastery.com/products/">EBooks</a></li>
<li id="menu-item-6500" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6500"><a href="https://machinelearningmastery.com/faq/">FAQ</a></li>
<li id="menu-item-6504" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6504"><a href="https://machinelearningmastery.com/about/">About</a></li>
<li id="menu-item-6505" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6505"><a href="https://machinelearningmastery.com/contact/">Contact</a></li>
</ul>	<div class="side-nav">
		</div><!-- /#side-nav -->

	</section><!-- /.menus -->

	<a href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#top" class="nav-close"><span>Return to Content</span></a>

</nav>
       
    <!-- #content Starts -->
	    <div id="content" class="col-full">
    
    	<div id="main-sidebar-container">    

            <!-- #main Starts -->
                        <section id="main">                       
<article class="post-8135 post type-post status-publish format-standard has-post-thumbnail hentry category-generative-adversarial-networks">
	<header>
	<h1 class="title entry-title">How to Explore the GAN Latent Space When Generating Faces</h1>	</header>
<div class="post-meta"><span class="small">By</span> <span class="author vcard"><span class="fn"><a href="https://machinelearningmastery.com/author/jasonb/" title="Posts by Jason Brownlee" rel="author">Jason Brownlee</a></span></span> <span class="small">on</span> <abbr class="date time published updated" title="2019-07-03T05:00:59+1000">July 3, 2019</abbr>  <span class="small">in</span> <span class="categories"><a href="https://machinelearningmastery.com/category/generative-adversarial-networks/" title="View all items in Generative Adversarial Networks">Generative Adversarial Networks</a></span>  </div>
	<section class="entry">
<div class="simplesocialbuttons simplesocial-simple-icons simplesocialbuttons_inline simplesocialbuttons-align-left post-8135 post simplesocialbuttons-inline-no-animation simplesocialbuttons-inline-in">
<button class="ssb_tweet-icon" data-href="https://twitter.com/share?text=How+to+Explore+the+GAN+Latent+Space+When+Generating+Faces&amp;url=https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/" rel="nofollow" onclick="if (!window.__cfRLUnblockHandlers) return false; javascript:window.open(this.dataset.href, &#39;&#39;, &#39;menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600&#39;);return false;">
						<span class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 72 72"><path fill="none" d="M0 0h72v72H0z"></path><path class="icon" fill="#fff" d="M68.812 15.14c-2.348 1.04-4.87 1.744-7.52 2.06 2.704-1.62 4.78-4.186 5.757-7.243-2.53 1.5-5.33 2.592-8.314 3.176C56.35 10.59 52.948 9 49.182 9c-7.23 0-13.092 5.86-13.092 13.093 0 1.026.118 2.02.338 2.98C25.543 24.527 15.9 19.318 9.44 11.396c-1.125 1.936-1.77 4.184-1.77 6.58 0 4.543 2.312 8.552 5.824 10.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163 0 6.345 4.513 11.638 10.504 12.84-1.1.298-2.256.457-3.45.457-.845 0-1.666-.078-2.464-.23 1.667 5.2 6.5 8.985 12.23 9.09-4.482 3.51-10.13 5.605-16.26 5.605-1.055 0-2.096-.06-3.122-.184 5.794 3.717 12.676 5.882 20.067 5.882 24.083 0 37.25-19.95 37.25-37.25 0-.565-.013-1.133-.038-1.693 2.558-1.847 4.778-4.15 6.532-6.774z"></path></svg></span><i class="simplesocialtxt">Tweet </i></button>
		<button class="ssb_fbshare-icon" target="_blank" data-href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/" onclick="if (!window.__cfRLUnblockHandlers) return false; javascript:window.open(this.dataset.href, &#39;&#39;, &#39;menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600&#39;);return false;">
						<span class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" class="_1pbq" color="#ffffff"><path fill="#ffffff" fill-rule="evenodd" class="icon" d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z"></path></svg></span>
						<span class="simplesocialtxt">Share </span> </button>
<button class="ssb_linkedin-icon" data-href="https://www.linkedin.com/cws/share?url=https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/" onclick="if (!window.__cfRLUnblockHandlers) return false; javascript:window.open(this.dataset.href, &#39;&#39;, &#39;menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600&#39;);return false;">
						<span class="icon"> <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="15px" height="14.1px" viewBox="-301.4 387.5 15 14.1" enable-background="new -301.4 387.5 15 14.1" xml:space="preserve"> <g id="XMLID_398_"> <path id="XMLID_399_" fill="#FFFFFF" d="M-296.2,401.6c0-3.2,0-6.3,0-9.5h0.1c1,0,2,0,2.9,0c0.1,0,0.1,0,0.1,0.1c0,0.4,0,0.8,0,1.2 c0.1-0.1,0.2-0.3,0.3-0.4c0.5-0.7,1.2-1,2.1-1.1c0.8-0.1,1.5,0,2.2,0.3c0.7,0.4,1.2,0.8,1.5,1.4c0.4,0.8,0.6,1.7,0.6,2.5 c0,1.8,0,3.6,0,5.4v0.1c-1.1,0-2.1,0-3.2,0c0-0.1,0-0.1,0-0.2c0-1.6,0-3.2,0-4.8c0-0.4,0-0.8-0.2-1.2c-0.2-0.7-0.8-1-1.6-1 c-0.8,0.1-1.3,0.5-1.6,1.2c-0.1,0.2-0.1,0.5-0.1,0.8c0,1.7,0,3.4,0,5.1c0,0.2,0,0.2-0.2,0.2c-1,0-1.9,0-2.9,0 C-296.1,401.6-296.2,401.6-296.2,401.6z"></path> <path id="XMLID_400_" fill="#FFFFFF" d="M-298,401.6L-298,401.6c-1.1,0-2.1,0-3,0c-0.1,0-0.1,0-0.1-0.1c0-3.1,0-6.1,0-9.2 c0-0.1,0-0.1,0.1-0.1c1,0,2,0,2.9,0h0.1C-298,395.3-298,398.5-298,401.6z"></path> <path id="XMLID_401_" fill="#FFFFFF" d="M-299.6,390.9c-0.7-0.1-1.2-0.3-1.6-0.8c-0.5-0.8-0.2-2.1,1-2.4c0.6-0.2,1.2-0.1,1.8,0.2 c0.5,0.4,0.7,0.9,0.6,1.5c-0.1,0.7-0.5,1.1-1.1,1.3C-299.1,390.8-299.4,390.8-299.6,390.9L-299.6,390.9z"></path> </g> </svg> </span>
						<span class="simplesocialtxt">Share</span> </button>
</div>
<p id="last-modified-info">Last Updated on September 1, 2020</p>
<h4 style="text-align: center;">How to Use Interpolation and Vector Arithmetic to Explore the GAN Latent Space.</h4>
<p>Generative Adversarial Networks, or GANs, are an architecture for training generative models, such as deep convolutional neural networks for generating images.</p>
<p>The generative model in the GAN architecture learns to map points in the latent space to generated images. The latent space has no meaning other than the meaning applied to it via the generative model. Yet, the latent space has structure that can be explored, such as by interpolating between points and performing vector arithmetic between points in latent space which have meaningful and targeted effects on the generated images.</p>
<p>In this tutorial, you will discover how to develop a generative adversarial network for face generation and explore the structure of latent space and the effect on generated faces.</p>
<p>After completing this tutorial, you will know:</p>
<ul>
<li>How to develop a generative adversarial network for generating faces.</li>
<li>How to interpolate between points in latent space and generate images that morph from one face to another.</li>
<li>How to perform vector arithmetic in latent space and achieve targeted results in the resulting generated faces.</li>
</ul>
<p><strong>Kick-start your project</strong> with my new book <a href="https://machinelearningmastery.com/generative_adversarial_networks/">Generative Adversarial Networks with Python</a>, including <em>step-by-step tutorials</em> and the <em>Python source code</em> files for all examples.</p>
<p>Let’s get started.</p>
<ul>
<li><b>Update Nov/2019:&nbsp;</b>Updated for TensorFlow v2.0 and MTCNN v0.1.0.</li>
</ul>
<div id="attachment_8152" style="width: 650px" class="wp-caption aligncenter"><img aria-describedby="caption-attachment-8152" loading="lazy" class="size-full wp-image-8152" src="./How to Explore the GAN Latent Space When Generating Faces_files/How-to-Interpolate-and-Perform-Vector-Arithmetic-With-Faces-Using-a-Generative-Adversarial-Networ.jpg" alt="How to Interpolate and Perform Vector Arithmetic With Faces Using a Generative Adversarial Network" width="640" height="480" srcset="https://machinelearningmastery.com/wp-content/uploads/2019/07/How-to-Interpolate-and-Perform-Vector-Arithmetic-With-Faces-Using-a-Generative-Adversarial-Network.jpg 640w, https://machinelearningmastery.com/wp-content/uploads/2019/07/How-to-Interpolate-and-Perform-Vector-Arithmetic-With-Faces-Using-a-Generative-Adversarial-Network-300x225.jpg 300w" sizes="(max-width: 640px) 100vw, 640px"><p id="caption-attachment-8152" class="wp-caption-text">How to Interpolate and Perform Vector Arithmetic With Faces Using a Generative Adversarial Network.<br>Photo by <a href="https://www.flickr.com/photos/107640324@N05/45701362542">Intermountain Forest Service</a>, some rights reserved.</p></div>
<h2>Tutorial Overview</h2>
<p>This tutorial is divided into five parts; they are:</p>
<ol>
<li>Vector Arithmetic in Latent Space</li>
<li>Large-Scale CelebFaces Dataset (CelebA)</li>
<li>How to Prepare CelebA Faces Dataset</li>
<li>How to Develop a Generative Adversarial Network</li>
<li>How to Explore the Latent Space for Generated Faces</li>
</ol>
<h2>Vector Arithmetic in Latent Space</h2>
<p>The generator model in the GAN architecture takes a point from the latent space as input and generates a new image.</p>
<p>The latent space itself has no meaning. Typically it is a 100-dimensional hypersphere with each variable drawn from a <a href="https://machinelearningmastery.com/statistical-data-distributions/">Gaussian distribution</a> with a mean of zero and a standard deviation of one. Through training, the generator learns to map points into the latent space with specific output images and this mapping will be different each time the model is trained.</p>
<p>The latent space has structure when interpreted by the generator model, and this structure can be queried and navigated for a given model.</p>
<p>Typically, new images are generated using random points in the latent space. Taken a step further, points in the latent space can be constructed (e.g. all 0s, all 0.5s, or all 1s) and used as input or a query to generate a specific image.</p>
<p>A series of points can be created on a linear path between two points in the latent space, such as two generated images. These points can be used to generate a series of images that show a transition between the two generated images.</p>
<p>Finally, the points in the latent space can be kept and used in simple vector arithmetic to create new points in the latent space that, in turn, can be used to generate images. This is an interesting idea, as it allows for the intuitive and targeted generation of images.</p>
<p>The important 2015 paper by Alec Radford, et al. titled “<a href="https://arxiv.org/abs/1511.06434">Unsupervised Representation Learning with Deep Convolutional Generative Adversarial Networks</a>” introduced a stable model configuration for training deep convolutional neural network models as part of the GAN architecture.</p>
<p>In the paper, the authors explored the latent space for GANs fit on a number of different training datasets, most notably a dataset of celebrity faces. They demonstrated two interesting aspects.</p>
<p>The first was the vector arithmetic with faces. For example, a face of a smiling woman minus the face of a neutral woman plus the face of a neutral man resulted in the face of a smiling man.</p>
		<div id="urvanov-syntax-highlighter-60654e779776f860597014" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0;">smiling woman - neutral woman + neutral man = smiling man</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779776f860597014-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779776f860597014-1">smiling woman - neutral woman + neutral man = smiling man</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Specifically, the arithmetic was performed on the points in the latent space for the resulting faces. Actually on the average of multiple faces with a given characteristic, to provide a more robust result.</p>
<div id="attachment_8141" style="width: 1034px" class="wp-caption aligncenter"><img aria-describedby="caption-attachment-8141" loading="lazy" class="size-large wp-image-8141" src="./How to Explore the GAN Latent Space When Generating Faces_files/Example-of-Vector-Arithmetic-on-Points-in-the-Latent-Space-for-Generating-Faces-with-a-GAN-1024x5.png" alt="Example of Vector Arithmetic on Points in the Latent Space for Generating Faces with a GAN" width="1024" height="531" srcset="https://machinelearningmastery.com/wp-content/uploads/2019/05/Example-of-Vector-Arithmetic-on-Points-in-the-Latent-Space-for-Generating-Faces-with-a-GAN-1024x531.png 1024w, https://machinelearningmastery.com/wp-content/uploads/2019/05/Example-of-Vector-Arithmetic-on-Points-in-the-Latent-Space-for-Generating-Faces-with-a-GAN-300x155.png 300w, https://machinelearningmastery.com/wp-content/uploads/2019/05/Example-of-Vector-Arithmetic-on-Points-in-the-Latent-Space-for-Generating-Faces-with-a-GAN-768x398.png 768w, https://machinelearningmastery.com/wp-content/uploads/2019/05/Example-of-Vector-Arithmetic-on-Points-in-the-Latent-Space-for-Generating-Faces-with-a-GAN.png 1104w" sizes="(max-width: 1024px) 100vw, 1024px"><p id="caption-attachment-8141" class="wp-caption-text">Example of Vector Arithmetic on Points in the Latent Space for Generating Faces With a GAN.<br>Taken from Unsupervised Representation Learning with Deep Convolutional Generative Adversarial Networks.</p></div>
<p>The second demonstration was the transition between two generated faces, specifically by creating a linear path through the latent dimension between the points that generated two faces and then generating all of the faces for the points along the path.</p>
<div id="attachment_8142" style="width: 1034px" class="wp-caption aligncenter"><img aria-describedby="caption-attachment-8142" loading="lazy" class="size-large wp-image-8142" src="./How to Explore the GAN Latent Space When Generating Faces_files/Example-of-Faces-on-a-Path-Between-Two-GAN-Generated-Faces-1024x606.png" alt="Example of Faces on a Path Between Two GAN Generated Faces" width="1024" height="606" srcset="https://machinelearningmastery.com/wp-content/uploads/2019/05/Example-of-Faces-on-a-Path-Between-Two-GAN-Generated-Faces-1024x606.png 1024w, https://machinelearningmastery.com/wp-content/uploads/2019/05/Example-of-Faces-on-a-Path-Between-Two-GAN-Generated-Faces-300x178.png 300w, https://machinelearningmastery.com/wp-content/uploads/2019/05/Example-of-Faces-on-a-Path-Between-Two-GAN-Generated-Faces-768x455.png 768w, https://machinelearningmastery.com/wp-content/uploads/2019/05/Example-of-Faces-on-a-Path-Between-Two-GAN-Generated-Faces.png 1088w" sizes="(max-width: 1024px) 100vw, 1024px"><p id="caption-attachment-8142" class="wp-caption-text">Example of Faces on a Path Between Two GAN Generated Faces.<br>Taken from Unsupervised Representation Learning with Deep Convolutional Generative Adversarial Networks.</p></div>
<p>Exploring the structure of the latent space for a GAN model is both interesting for the problem domain and helps to develop an intuition for what has been learned by the generator model.</p>
<p>In this tutorial, we will develop a GAN for generating photos of faces, then explore the latent space for the model with vector arithmetic.</p>
<div class="woo-sc-hr"></div>
<center>
<h3>Want to Develop GANs from Scratch?</h3>
<p>Take my free 7-day email crash course now (with sample code).</p>
<p>Click to sign-up and also get a free PDF Ebook version of the course.</p>
<p><a href="https://machinelearningmastery.lpages.co/leadbox/162526e1b172a2%3A164f8be4f346dc/5926953912500224/" target="_blank" style="background: rgb(255, 206, 10); color: rgb(255, 255, 255); text-decoration: none; font-family: Helvetica, Arial, sans-serif; font-weight: bold; font-size: 16px; line-height: 20px; padding: 10px; display: inline-block; max-width: 300px; border-radius: 5px; text-shadow: rgba(0, 0, 0, 0.25) 0px -1px 1px; box-shadow: rgba(255, 255, 255, 0.5) 0px 1px 3px inset, rgba(0, 0, 0, 0.5) 0px 1px 3px;" rel="noopener noreferrer" data-leadbox="https://machinelearningmastery.lpages.co/leadbox/162526e1b172a2%3A164f8be4f346dc/5926953912500224/" data-leadbox-id="162526e1b172a2:164f8be4f346dc">Download Your FREE Mini-Course</a></p>
</center>
<div class="woo-sc-hr"></div>
<h2>Large-Scale CelebFaces Dataset (CelebA)</h2>
<p>The first step is to select a dataset of faces.</p>
<p>In this tutorial, we will use the <a href="http://mmlab.ie.cuhk.edu.hk/projects/CelebA.html">Large-scale CelebFaces Attributes Dataset</a>, referred to as CelebA. This dataset was developed and published by Ziwei Liu, et al. for their 2015 paper titled “<a href="https://arxiv.org/abs/1509.06451">From Facial Parts Responses to Face Detection: A Deep Learning Approach</a>.”</p>
<p>The dataset provides about 200,000 photographs of celebrity faces along with annotations for what appears in given photos, such as glasses, face shape, hats, hair type, etc. As part of the dataset, the authors provide a version of each photo centered on the face and cropped to the portrait with varying sizes around 150 pixels wide and 200 pixels tall. We will use this as the basis for developing our GAN model.</p>
<p>The dataset can be easily downloaded from the Kaggle webpage. Note: this may require an account with Kaggle.</p>
<ul>
<li><a href="https://www.kaggle.com/jessicali9530/celeba-dataset">CelebFaces Attributes (CelebA) Dataset</a></li>
</ul>
<p>Specifically, download the file “<em>img_align_celeba.zip</em>” which is about 1.3 gigabytes. To do this, click on the filename on the Kaggle website and then click the download icon.</p>
<p>The download might take a while depending on the speed of your internet connection.</p>
<p>After downloading, unzip the archive.</p>
<p>This will create a new directory named “<em>img_align_celeba</em>” that contains all of the images with filenames like <em>202599.jpg</em> and <em>202598.jpg</em>.</p>
<p>Next, we can look at preparing the raw images for modeling.</p>
<h2>How to Prepare CelebA Faces Dataset</h2>
<p>The first step is to develop code to load the images.</p>
<p>We can use the <a href="https://machinelearningmastery.com/how-to-load-and-manipulate-images-for-deep-learning-in-python-with-pil-pillow/">Pillow library</a> to load a given image file, convert it to RGB format (if needed) and return an array of pixel data. The load_image() function below implements this.</p>
		<div id="urvanov-syntax-highlighter-60654e7797773049262147" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0;"># load an image as an rgb numpy array
def load_image(filename):
	# load image from file
	image = Image.open(filename)
	# convert to RGB, if needed
	image = image.convert('RGB')
	# convert to array
	pixels = asarray(image)
	return pixels</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797773049262147-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797773049262147-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797773049262147-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797773049262147-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797773049262147-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797773049262147-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797773049262147-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797773049262147-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797773049262147-9">9</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797773049262147-1"><span class="crayon-p"># load an image as an rgb numpy array</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797773049262147-2"><span class="crayon-e">def </span><span class="crayon-e">load_image</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797773049262147-3"><span class="crayon-h">	</span><span class="crayon-p"># load image from file</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797773049262147-4"><span class="crayon-h">	</span><span class="crayon-v">image</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">Image</span><span class="crayon-sy">.</span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797773049262147-5"><span class="crayon-h">	</span><span class="crayon-p"># convert to RGB, if needed</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797773049262147-6"><span class="crayon-h">	</span><span class="crayon-v">image</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">image</span><span class="crayon-sy">.</span><span class="crayon-e">convert</span><span class="crayon-sy">(</span><span class="crayon-s">'RGB'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797773049262147-7"><span class="crayon-h">	</span><span class="crayon-p"># convert to array</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797773049262147-8"><span class="crayon-h">	</span><span class="crayon-v">pixels</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">asarray</span><span class="crayon-sy">(</span><span class="crayon-v">image</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797773049262147-9"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">pixels</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Next, we can enumerate the directory of images, load each as an array of pixels in turn, and return an array with all of the images.</p>
<p>There are 200K images in the dataset, which is probably more than we need so we can also limit the number of images to load with an argument. The <em>load_faces()</em> function below implements this.</p>
		<div id="urvanov-syntax-highlighter-60654e7797775457411659" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0;"># load images and extract faces for all images in a directory
def load_faces(directory, n_faces):
	faces = list()
	# enumerate files
	for filename in listdir(directory):
		# load the image
		pixels = load_image(directory + filename)
		# store
		faces.append(pixels)
		# stop once we have enough
		if len(faces) &gt;= n_faces:
			break
	return asarray(faces)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797775457411659-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797775457411659-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797775457411659-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797775457411659-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797775457411659-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797775457411659-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797775457411659-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797775457411659-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797775457411659-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797775457411659-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797775457411659-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797775457411659-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797775457411659-13">13</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797775457411659-1"><span class="crayon-p"># load images and extract faces for all images in a directory</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797775457411659-2"><span class="crayon-e">def </span><span class="crayon-e">load_faces</span><span class="crayon-sy">(</span><span class="crayon-v">directory</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_faces</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797775457411659-3"><span class="crayon-h">	</span><span class="crayon-v">faces</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797775457411659-4"><span class="crayon-h">	</span><span class="crayon-p"># enumerate files</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797775457411659-5"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">filename </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">listdir</span><span class="crayon-sy">(</span><span class="crayon-v">directory</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797775457411659-6"><span class="crayon-h">		</span><span class="crayon-p"># load the image</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797775457411659-7"><span class="crayon-h">		</span><span class="crayon-v">pixels</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_image</span><span class="crayon-sy">(</span><span class="crayon-v">directory</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">filename</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797775457411659-8"><span class="crayon-h">		</span><span class="crayon-p"># store</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797775457411659-9"><span class="crayon-h">		</span><span class="crayon-v">faces</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">pixels</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797775457411659-10"><span class="crayon-h">		</span><span class="crayon-p"># stop once we have enough</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797775457411659-11"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">faces</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&gt;=</span><span class="crayon-h"> </span><span class="crayon-v">n_faces</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797775457411659-12"><span class="crayon-h">			</span><span class="crayon-st">break</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797775457411659-13"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">asarray</span><span class="crayon-sy">(</span><span class="crayon-v">faces</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Finally, once the images are loaded, we can plot them using the <em>imshow()</em> function from the matplotlib library.</p>
<p>The <em>plot_faces()</em> function below does this, plotting images arranged into in a square.</p>
		<div id="urvanov-syntax-highlighter-60654e7797776219743576" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0;"># plot a list of loaded faces
def plot_faces(faces, n):
	for i in range(n * n):
		# define subplot
		pyplot.subplot(n, n, 1 + i)
		# turn off axis
		pyplot.axis('off')
		# plot raw pixel data
		pyplot.imshow(faces[i])
	pyplot.show()</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797776219743576-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797776219743576-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797776219743576-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797776219743576-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797776219743576-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797776219743576-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797776219743576-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797776219743576-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797776219743576-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797776219743576-10">10</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797776219743576-1"><span class="crayon-p"># plot a list of loaded faces</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797776219743576-2"><span class="crayon-e">def </span><span class="crayon-e">plot_faces</span><span class="crayon-sy">(</span><span class="crayon-v">faces</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797776219743576-3"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e ">n *</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797776219743576-4"><span class="crayon-h">		</span><span class="crayon-p"># define subplot</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797776219743576-5"><span class="crayon-h">		</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-v">n</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797776219743576-6"><span class="crayon-h">		</span><span class="crayon-p"># turn off axis</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797776219743576-7"><span class="crayon-h">		</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">axis</span><span class="crayon-sy">(</span><span class="crayon-s">'off'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797776219743576-8"><span class="crayon-h">		</span><span class="crayon-p"># plot raw pixel data</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797776219743576-9"><span class="crayon-h">		</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">imshow</span><span class="crayon-sy">(</span><span class="crayon-v">faces</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797776219743576-10"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Tying this together, the complete example is listed below.</p>
		<div id="urvanov-syntax-highlighter-60654e7797777156959566" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0;"># load and plot faces
from os import listdir
from numpy import asarray
from PIL import Image
from matplotlib import pyplot

# load an image as an rgb numpy array
def load_image(filename):
	# load image from file
	image = Image.open(filename)
	# convert to RGB, if needed
	image = image.convert('RGB')
	# convert to array
	pixels = asarray(image)
	return pixels

# load images and extract faces for all images in a directory
def load_faces(directory, n_faces):
	faces = list()
	# enumerate files
	for filename in listdir(directory):
		# load the image
		pixels = load_image(directory + filename)
		# store
		faces.append(pixels)
		# stop once we have enough
		if len(faces) &gt;= n_faces:
			break
	return asarray(faces)

# plot a list of loaded faces
def plot_faces(faces, n):
	for i in range(n * n):
		# define subplot
		pyplot.subplot(n, n, 1 + i)
		# turn off axis
		pyplot.axis('off')
		# plot raw pixel data
		pyplot.imshow(faces[i])
	pyplot.show()

# directory that contains all images
directory = 'img_align_celeba/'
# load and extract all faces
faces = load_faces(directory, 25)
print('Loaded: ', faces.shape)
# plot faces
plot_faces(faces, 5)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797777156959566-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797777156959566-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797777156959566-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797777156959566-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797777156959566-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797777156959566-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797777156959566-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797777156959566-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797777156959566-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797777156959566-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797777156959566-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797777156959566-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797777156959566-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797777156959566-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797777156959566-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797777156959566-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797777156959566-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797777156959566-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797777156959566-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797777156959566-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797777156959566-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797777156959566-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797777156959566-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797777156959566-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797777156959566-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797777156959566-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797777156959566-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797777156959566-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797777156959566-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797777156959566-30">30</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797777156959566-31">31</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797777156959566-32">32</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797777156959566-33">33</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797777156959566-34">34</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797777156959566-35">35</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797777156959566-36">36</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797777156959566-37">37</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797777156959566-38">38</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797777156959566-39">39</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797777156959566-40">40</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797777156959566-41">41</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797777156959566-42">42</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797777156959566-43">43</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797777156959566-44">44</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797777156959566-45">45</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797777156959566-46">46</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797777156959566-47">47</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797777156959566-48">48</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797777156959566-1"><span class="crayon-p"># load and plot faces</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797777156959566-2"><span class="crayon-e">from </span><span class="crayon-e">os </span><span class="crayon-e">import </span><span class="crayon-e">listdir</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797777156959566-3"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">asarray</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797777156959566-4"><span class="crayon-e">from </span><span class="crayon-e">PIL </span><span class="crayon-e">import </span><span class="crayon-e">Image</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797777156959566-5"><span class="crayon-e">from </span><span class="crayon-e">matplotlib </span><span class="crayon-e">import </span><span class="crayon-i">pyplot</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797777156959566-6">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797777156959566-7"><span class="crayon-p"># load an image as an rgb numpy array</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797777156959566-8"><span class="crayon-e">def </span><span class="crayon-e">load_image</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797777156959566-9"><span class="crayon-h">	</span><span class="crayon-p"># load image from file</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797777156959566-10"><span class="crayon-h">	</span><span class="crayon-v">image</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">Image</span><span class="crayon-sy">.</span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797777156959566-11"><span class="crayon-h">	</span><span class="crayon-p"># convert to RGB, if needed</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797777156959566-12"><span class="crayon-h">	</span><span class="crayon-v">image</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">image</span><span class="crayon-sy">.</span><span class="crayon-e">convert</span><span class="crayon-sy">(</span><span class="crayon-s">'RGB'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797777156959566-13"><span class="crayon-h">	</span><span class="crayon-p"># convert to array</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797777156959566-14"><span class="crayon-h">	</span><span class="crayon-v">pixels</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">asarray</span><span class="crayon-sy">(</span><span class="crayon-v">image</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797777156959566-15"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">pixels</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797777156959566-16">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797777156959566-17"><span class="crayon-p"># load images and extract faces for all images in a directory</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797777156959566-18"><span class="crayon-e">def </span><span class="crayon-e">load_faces</span><span class="crayon-sy">(</span><span class="crayon-v">directory</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_faces</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797777156959566-19"><span class="crayon-h">	</span><span class="crayon-v">faces</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797777156959566-20"><span class="crayon-h">	</span><span class="crayon-p"># enumerate files</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797777156959566-21"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">filename </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">listdir</span><span class="crayon-sy">(</span><span class="crayon-v">directory</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797777156959566-22"><span class="crayon-h">		</span><span class="crayon-p"># load the image</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797777156959566-23"><span class="crayon-h">		</span><span class="crayon-v">pixels</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_image</span><span class="crayon-sy">(</span><span class="crayon-v">directory</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">filename</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797777156959566-24"><span class="crayon-h">		</span><span class="crayon-p"># store</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797777156959566-25"><span class="crayon-h">		</span><span class="crayon-v">faces</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">pixels</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797777156959566-26"><span class="crayon-h">		</span><span class="crayon-p"># stop once we have enough</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797777156959566-27"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">faces</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&gt;=</span><span class="crayon-h"> </span><span class="crayon-v">n_faces</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797777156959566-28"><span class="crayon-h">			</span><span class="crayon-st">break</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797777156959566-29"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">asarray</span><span class="crayon-sy">(</span><span class="crayon-v">faces</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797777156959566-30">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797777156959566-31"><span class="crayon-p"># plot a list of loaded faces</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797777156959566-32"><span class="crayon-e">def </span><span class="crayon-e">plot_faces</span><span class="crayon-sy">(</span><span class="crayon-v">faces</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797777156959566-33"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e ">n *</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797777156959566-34"><span class="crayon-h">		</span><span class="crayon-p"># define subplot</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797777156959566-35"><span class="crayon-h">		</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-v">n</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797777156959566-36"><span class="crayon-h">		</span><span class="crayon-p"># turn off axis</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797777156959566-37"><span class="crayon-h">		</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">axis</span><span class="crayon-sy">(</span><span class="crayon-s">'off'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797777156959566-38"><span class="crayon-h">		</span><span class="crayon-p"># plot raw pixel data</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797777156959566-39"><span class="crayon-h">		</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">imshow</span><span class="crayon-sy">(</span><span class="crayon-v">faces</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797777156959566-40"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797777156959566-41">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797777156959566-42"><span class="crayon-p"># directory that contains all images</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797777156959566-43"><span class="crayon-v">directory</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'img_align_celeba/'</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797777156959566-44"><span class="crayon-p"># load and extract all faces</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797777156959566-45"><span class="crayon-v">faces</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_faces</span><span class="crayon-sy">(</span><span class="crayon-v">directory</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">25</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797777156959566-46"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Loaded: '</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">faces</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797777156959566-47"><span class="crayon-p"># plot faces</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797777156959566-48"><span class="crayon-e">plot_faces</span><span class="crayon-sy">(</span><span class="crayon-v">faces</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Running the example loads a total of 25 images from the directory, then summarizes the size of the returned array.</p>
		<div id="urvanov-syntax-highlighter-60654e7797778619555743" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0;">Loaded: (25, 218, 178, 3)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797778619555743-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797778619555743-1">Loaded: (25, 218, 178, 3)</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Finally, the 25 images are plotted in a 5×5 square.</p>
<div id="attachment_8143" style="width: 1034px" class="wp-caption aligncenter"><img aria-describedby="caption-attachment-8143" loading="lazy" class="size-large wp-image-8143" src="./How to Explore the GAN Latent Space When Generating Faces_files/Plot-of-a-Sample-of-25-Faces-from-the-Celebrity-Faces-Dataset-1024x768.png" alt="Plot of a Sample of 25 Faces from the Celebrity Faces Dataset" width="1024" height="768" srcset="https://machinelearningmastery.com/wp-content/uploads/2019/05/Plot-of-a-Sample-of-25-Faces-from-the-Celebrity-Faces-Dataset-1024x768.png 1024w, https://machinelearningmastery.com/wp-content/uploads/2019/05/Plot-of-a-Sample-of-25-Faces-from-the-Celebrity-Faces-Dataset-300x225.png 300w, https://machinelearningmastery.com/wp-content/uploads/2019/05/Plot-of-a-Sample-of-25-Faces-from-the-Celebrity-Faces-Dataset-768x576.png 768w, https://machinelearningmastery.com/wp-content/uploads/2019/05/Plot-of-a-Sample-of-25-Faces-from-the-Celebrity-Faces-Dataset.png 1280w" sizes="(max-width: 1024px) 100vw, 1024px"><p id="caption-attachment-8143" class="wp-caption-text">Plot of a Sample of 25 Faces from the Celebrity Faces Dataset</p></div>
<p>When working with a GAN, it is easier to model a dataset if all of the images are small and square in shape.</p>
<p>Further, as we are only interested in the face in each photo, and not the background, we can perform face detection and extract only the face before resizing the result to a fixed size.</p>
<p>There are many ways to perform face detection. In this case, we will use a pre-trained Multi-Task Cascaded Convolutional Neural Network, or MTCNN. This is a state-of-the-art deep learning model for face detection, described in the 2016 paper titled “<a href="https://arxiv.org/abs/1604.02878">Joint Face Detection and Alignment Using Multitask Cascaded Convolutional Networks</a>.”</p>
<p>We will use the implementation provided by Iván de Paz Centeno in the <a href="https://github.com/ipazc/mtcnn">ipazc/mtcnn project</a>. This library can be installed via pip as follows:</p>
		<div id="urvanov-syntax-highlighter-60654e7797779100158804" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0;">sudo pip install mtcnn</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797779100158804-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797779100158804-1">sudo pip install mtcnn</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>We can confirm that the library was installed correctly by importing the library and printing the version; for example:</p>
		<div id="urvanov-syntax-highlighter-60654e779777a314867173" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0;"># confirm mtcnn was installed correctly
import mtcnn
# print version
print(mtcnn.__version__)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779777a314867173-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779777a314867173-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779777a314867173-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779777a314867173-4">4</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779777a314867173-1"><span class="crayon-p"># confirm mtcnn was installed correctly</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779777a314867173-2"><span class="crayon-e">import </span><span class="crayon-i">mtcnn</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779777a314867173-3"><span class="crayon-p"># print version</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779777a314867173-4"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">mtcnn</span><span class="crayon-sy">.</span><span class="crayon-v">__version__</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Running the example prints the current version of the library.</p>
		<div id="urvanov-syntax-highlighter-60654e779777b358950733" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0;">0.1.0</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779777b358950733-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779777b358950733-1">0.1.0</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>The MTCNN model is very easy to use.</p>
<p>First, an instance of the MTCNN model is created, then the <em>detect_faces()</em> function can be called passing in the pixel data for one image. The result is a list of detected faces, with a bounding box defined in pixel offset values.</p>
		<div id="urvanov-syntax-highlighter-60654e779777c687337315" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0;">...
# prepare model
model = MTCNN()
# detect face in the image
faces = model.detect_faces(pixels)
# extract details of the face
x1, y1, width, height = faces[0]['box']</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779777c687337315-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779777c687337315-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779777c687337315-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779777c687337315-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779777c687337315-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779777c687337315-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779777c687337315-7">7</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779777c687337315-1"><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779777c687337315-2"><span class="crayon-p"># prepare model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779777c687337315-3"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">MTCNN</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779777c687337315-4"><span class="crayon-p"># detect face in the image</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779777c687337315-5"><span class="crayon-v">faces</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">detect_faces</span><span class="crayon-sy">(</span><span class="crayon-v">pixels</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779777c687337315-6"><span class="crayon-p"># extract details of the face</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779777c687337315-7"><span class="crayon-v">x1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">width</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">height</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">faces</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-s">'box'</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>We can update our example to extract the face from each loaded photo and resize the extracted face pixels to a fixed size. In this case, we will use the square shape of 80×80 pixels.</p>
<p>The <em>extract_face()</em> function below implements this, taking the MTCNN model and pixel values for a single photograph as arguments and returning an 80x80x3 array of pixel values with just the face, or None if no face was detected (which can happen rarely).</p>
		<div id="urvanov-syntax-highlighter-60654e779777d829219584" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0;"># extract the face from a loaded image and resize
def extract_face(model, pixels, required_size=(80, 80)):
	# detect face in the image
	faces = model.detect_faces(pixels)
	# skip cases where we could not detect a face
	if len(faces) == 0:
		return None
	# extract details of the face
	x1, y1, width, height = faces[0]['box']
	# force detected pixel values to be positive (bug fix)
	x1, y1 = abs(x1), abs(y1)
	# convert into coordinates
	x2, y2 = x1 + width, y1 + height
	# retrieve face pixels
	face_pixels = pixels[y1:y2, x1:x2]
	# resize pixels to the model size
	image = Image.fromarray(face_pixels)
	image = image.resize(required_size)
	face_array = asarray(image)
	return face_array</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779777d829219584-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779777d829219584-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779777d829219584-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779777d829219584-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779777d829219584-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779777d829219584-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779777d829219584-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779777d829219584-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779777d829219584-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779777d829219584-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779777d829219584-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779777d829219584-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779777d829219584-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779777d829219584-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779777d829219584-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779777d829219584-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779777d829219584-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779777d829219584-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779777d829219584-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779777d829219584-20">20</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779777d829219584-1"><span class="crayon-p"># extract the face from a loaded image and resize</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779777d829219584-2"><span class="crayon-e">def </span><span class="crayon-e">extract_face</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">pixels</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">required_size</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">80</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">80</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779777d829219584-3"><span class="crayon-h">	</span><span class="crayon-p"># detect face in the image</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779777d829219584-4"><span class="crayon-h">	</span><span class="crayon-v">faces</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">detect_faces</span><span class="crayon-sy">(</span><span class="crayon-v">pixels</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779777d829219584-5"><span class="crayon-h">	</span><span class="crayon-p"># skip cases where we could not detect a face</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779777d829219584-6"><span class="crayon-h">	</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">faces</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779777d829219584-7"><span class="crayon-h">		</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">None</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779777d829219584-8"><span class="crayon-h">	</span><span class="crayon-p"># extract details of the face</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779777d829219584-9"><span class="crayon-h">	</span><span class="crayon-v">x1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">width</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">height</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">faces</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-s">'box'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779777d829219584-10"><span class="crayon-h">	</span><span class="crayon-p"># force detected pixel values to be positive (bug fix)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779777d829219584-11"><span class="crayon-h">	</span><span class="crayon-v">x1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">abs</span><span class="crayon-sy">(</span><span class="crayon-v">x1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">abs</span><span class="crayon-sy">(</span><span class="crayon-v">y1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779777d829219584-12"><span class="crayon-h">	</span><span class="crayon-p"># convert into coordinates</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779777d829219584-13"><span class="crayon-h">	</span><span class="crayon-v">x2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">x1</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">width</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y1</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-i">height</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779777d829219584-14"><span class="crayon-h">	</span><span class="crayon-p"># retrieve face pixels</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779777d829219584-15"><span class="crayon-h">	</span><span class="crayon-v">face_pixels</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pixels</span><span class="crayon-sy">[</span><span class="crayon-v">y1</span><span class="crayon-o">:</span><span class="crayon-v">y2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x1</span><span class="crayon-o">:</span><span class="crayon-v">x2</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779777d829219584-16"><span class="crayon-h">	</span><span class="crayon-p"># resize pixels to the model size</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779777d829219584-17"><span class="crayon-h">	</span><span class="crayon-v">image</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">Image</span><span class="crayon-sy">.</span><span class="crayon-e">fromarray</span><span class="crayon-sy">(</span><span class="crayon-v">face_pixels</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779777d829219584-18"><span class="crayon-h">	</span><span class="crayon-v">image</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">image</span><span class="crayon-sy">.</span><span class="crayon-e">resize</span><span class="crayon-sy">(</span><span class="crayon-v">required_size</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779777d829219584-19"><span class="crayon-h">	</span><span class="crayon-v">face_array</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">asarray</span><span class="crayon-sy">(</span><span class="crayon-v">image</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779777d829219584-20"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">face_array</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>We can now update the <em>load_faces()</em> function to extract the face from the loaded photo and store that in the list of faces returned.</p>
		<div id="urvanov-syntax-highlighter-60654e779777e884741535" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0;"># load images and extract faces for all images in a directory
def load_faces(directory, n_faces):
	# prepare model
	model = MTCNN()
	faces = list()
	# enumerate files
	for filename in listdir(directory):
		# load the image
		pixels = load_image(directory + filename)
		# get face
		face = extract_face(model, pixels)
		if face is None:
			continue
		# store
		faces.append(face)
		print(len(faces), face.shape)
		# stop once we have enough
		if len(faces) &gt;= n_faces:
			break
	return asarray(faces)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779777e884741535-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779777e884741535-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779777e884741535-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779777e884741535-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779777e884741535-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779777e884741535-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779777e884741535-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779777e884741535-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779777e884741535-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779777e884741535-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779777e884741535-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779777e884741535-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779777e884741535-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779777e884741535-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779777e884741535-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779777e884741535-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779777e884741535-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779777e884741535-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779777e884741535-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779777e884741535-20">20</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779777e884741535-1"><span class="crayon-p"># load images and extract faces for all images in a directory</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779777e884741535-2"><span class="crayon-e">def </span><span class="crayon-e">load_faces</span><span class="crayon-sy">(</span><span class="crayon-v">directory</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_faces</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779777e884741535-3"><span class="crayon-h">	</span><span class="crayon-p"># prepare model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779777e884741535-4"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">MTCNN</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779777e884741535-5"><span class="crayon-h">	</span><span class="crayon-v">faces</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779777e884741535-6"><span class="crayon-h">	</span><span class="crayon-p"># enumerate files</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779777e884741535-7"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">filename </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">listdir</span><span class="crayon-sy">(</span><span class="crayon-v">directory</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779777e884741535-8"><span class="crayon-h">		</span><span class="crayon-p"># load the image</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779777e884741535-9"><span class="crayon-h">		</span><span class="crayon-v">pixels</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_image</span><span class="crayon-sy">(</span><span class="crayon-v">directory</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">filename</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779777e884741535-10"><span class="crayon-h">		</span><span class="crayon-p"># get face</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779777e884741535-11"><span class="crayon-h">		</span><span class="crayon-v">face</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">extract_face</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">pixels</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779777e884741535-12"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">face </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-v">None</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779777e884741535-13"><span class="crayon-h">			</span><span class="crayon-st">continue</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779777e884741535-14"><span class="crayon-h">		</span><span class="crayon-p"># store</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779777e884741535-15"><span class="crayon-h">		</span><span class="crayon-v">faces</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">face</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779777e884741535-16"><span class="crayon-h">		</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">faces</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">face</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779777e884741535-17"><span class="crayon-h">		</span><span class="crayon-p"># stop once we have enough</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779777e884741535-18"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">faces</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&gt;=</span><span class="crayon-h"> </span><span class="crayon-v">n_faces</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779777e884741535-19"><span class="crayon-h">			</span><span class="crayon-st">break</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779777e884741535-20"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">asarray</span><span class="crayon-sy">(</span><span class="crayon-v">faces</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Tying this together, the complete example is listed below.</p>
<p>In this case, we increase the total number of loaded faces to 50,000 to provide a good training dataset for our GAN model.</p>
		<div id="urvanov-syntax-highlighter-60654e779777f088001670" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0;"># example of extracting and resizing faces into a new dataset
from os import listdir
from numpy import asarray
from numpy import savez_compressed
from PIL import Image
from mtcnn.mtcnn import MTCNN
from matplotlib import pyplot

# load an image as an rgb numpy array
def load_image(filename):
	# load image from file
	image = Image.open(filename)
	# convert to RGB, if needed
	image = image.convert('RGB')
	# convert to array
	pixels = asarray(image)
	return pixels

# extract the face from a loaded image and resize
def extract_face(model, pixels, required_size=(80, 80)):
	# detect face in the image
	faces = model.detect_faces(pixels)
	# skip cases where we could not detect a face
	if len(faces) == 0:
		return None
	# extract details of the face
	x1, y1, width, height = faces[0]['box']
	# force detected pixel values to be positive (bug fix)
	x1, y1 = abs(x1), abs(y1)
	# convert into coordinates
	x2, y2 = x1 + width, y1 + height
	# retrieve face pixels
	face_pixels = pixels[y1:y2, x1:x2]
	# resize pixels to the model size
	image = Image.fromarray(face_pixels)
	image = image.resize(required_size)
	face_array = asarray(image)
	return face_array

# load images and extract faces for all images in a directory
def load_faces(directory, n_faces):
	# prepare model
	model = MTCNN()
	faces = list()
	# enumerate files
	for filename in listdir(directory):
		# load the image
		pixels = load_image(directory + filename)
		# get face
		face = extract_face(model, pixels)
		if face is None:
			continue
		# store
		faces.append(face)
		print(len(faces), face.shape)
		# stop once we have enough
		if len(faces) &gt;= n_faces:
			break
	return asarray(faces)

# directory that contains all images
directory = 'img_align_celeba/'
# load and extract all faces
all_faces = load_faces(directory, 50000)
print('Loaded: ', all_faces.shape)
# save in compressed format
savez_compressed('img_align_celeba.npz', all_faces)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779777f088001670-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779777f088001670-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779777f088001670-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779777f088001670-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779777f088001670-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779777f088001670-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779777f088001670-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779777f088001670-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779777f088001670-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779777f088001670-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779777f088001670-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779777f088001670-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779777f088001670-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779777f088001670-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779777f088001670-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779777f088001670-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779777f088001670-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779777f088001670-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779777f088001670-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779777f088001670-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779777f088001670-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779777f088001670-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779777f088001670-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779777f088001670-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779777f088001670-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779777f088001670-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779777f088001670-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779777f088001670-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779777f088001670-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779777f088001670-30">30</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779777f088001670-31">31</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779777f088001670-32">32</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779777f088001670-33">33</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779777f088001670-34">34</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779777f088001670-35">35</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779777f088001670-36">36</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779777f088001670-37">37</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779777f088001670-38">38</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779777f088001670-39">39</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779777f088001670-40">40</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779777f088001670-41">41</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779777f088001670-42">42</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779777f088001670-43">43</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779777f088001670-44">44</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779777f088001670-45">45</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779777f088001670-46">46</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779777f088001670-47">47</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779777f088001670-48">48</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779777f088001670-49">49</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779777f088001670-50">50</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779777f088001670-51">51</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779777f088001670-52">52</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779777f088001670-53">53</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779777f088001670-54">54</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779777f088001670-55">55</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779777f088001670-56">56</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779777f088001670-57">57</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779777f088001670-58">58</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779777f088001670-59">59</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779777f088001670-60">60</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779777f088001670-61">61</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779777f088001670-62">62</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779777f088001670-63">63</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779777f088001670-64">64</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779777f088001670-65">65</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779777f088001670-66">66</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779777f088001670-67">67</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779777f088001670-1"><span class="crayon-p"># example of extracting and resizing faces into a new dataset</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779777f088001670-2"><span class="crayon-e">from </span><span class="crayon-e">os </span><span class="crayon-e">import </span><span class="crayon-e">listdir</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779777f088001670-3"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">asarray</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779777f088001670-4"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">savez_compressed</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779777f088001670-5"><span class="crayon-e">from </span><span class="crayon-e">PIL </span><span class="crayon-e">import </span><span class="crayon-e">Image</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779777f088001670-6"><span class="crayon-e">from </span><span class="crayon-v">mtcnn</span><span class="crayon-sy">.</span><span class="crayon-e">mtcnn </span><span class="crayon-e">import </span><span class="crayon-e">MTCNN</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779777f088001670-7"><span class="crayon-e">from </span><span class="crayon-e">matplotlib </span><span class="crayon-e">import </span><span class="crayon-i">pyplot</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779777f088001670-8">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779777f088001670-9"><span class="crayon-p"># load an image as an rgb numpy array</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779777f088001670-10"><span class="crayon-e">def </span><span class="crayon-e">load_image</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779777f088001670-11"><span class="crayon-h">	</span><span class="crayon-p"># load image from file</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779777f088001670-12"><span class="crayon-h">	</span><span class="crayon-v">image</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">Image</span><span class="crayon-sy">.</span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779777f088001670-13"><span class="crayon-h">	</span><span class="crayon-p"># convert to RGB, if needed</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779777f088001670-14"><span class="crayon-h">	</span><span class="crayon-v">image</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">image</span><span class="crayon-sy">.</span><span class="crayon-e">convert</span><span class="crayon-sy">(</span><span class="crayon-s">'RGB'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779777f088001670-15"><span class="crayon-h">	</span><span class="crayon-p"># convert to array</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779777f088001670-16"><span class="crayon-h">	</span><span class="crayon-v">pixels</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">asarray</span><span class="crayon-sy">(</span><span class="crayon-v">image</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779777f088001670-17"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">pixels</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779777f088001670-18">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779777f088001670-19"><span class="crayon-p"># extract the face from a loaded image and resize</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779777f088001670-20"><span class="crayon-e">def </span><span class="crayon-e">extract_face</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">pixels</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">required_size</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">80</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">80</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779777f088001670-21"><span class="crayon-h">	</span><span class="crayon-p"># detect face in the image</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779777f088001670-22"><span class="crayon-h">	</span><span class="crayon-v">faces</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">detect_faces</span><span class="crayon-sy">(</span><span class="crayon-v">pixels</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779777f088001670-23"><span class="crayon-h">	</span><span class="crayon-p"># skip cases where we could not detect a face</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779777f088001670-24"><span class="crayon-h">	</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">faces</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779777f088001670-25"><span class="crayon-h">		</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">None</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779777f088001670-26"><span class="crayon-h">	</span><span class="crayon-p"># extract details of the face</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779777f088001670-27"><span class="crayon-h">	</span><span class="crayon-v">x1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">width</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">height</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">faces</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-s">'box'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779777f088001670-28"><span class="crayon-h">	</span><span class="crayon-p"># force detected pixel values to be positive (bug fix)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779777f088001670-29"><span class="crayon-h">	</span><span class="crayon-v">x1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">abs</span><span class="crayon-sy">(</span><span class="crayon-v">x1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">abs</span><span class="crayon-sy">(</span><span class="crayon-v">y1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779777f088001670-30"><span class="crayon-h">	</span><span class="crayon-p"># convert into coordinates</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779777f088001670-31"><span class="crayon-h">	</span><span class="crayon-v">x2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">x1</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">width</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y1</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-i">height</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779777f088001670-32"><span class="crayon-h">	</span><span class="crayon-p"># retrieve face pixels</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779777f088001670-33"><span class="crayon-h">	</span><span class="crayon-v">face_pixels</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pixels</span><span class="crayon-sy">[</span><span class="crayon-v">y1</span><span class="crayon-o">:</span><span class="crayon-v">y2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x1</span><span class="crayon-o">:</span><span class="crayon-v">x2</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779777f088001670-34"><span class="crayon-h">	</span><span class="crayon-p"># resize pixels to the model size</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779777f088001670-35"><span class="crayon-h">	</span><span class="crayon-v">image</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">Image</span><span class="crayon-sy">.</span><span class="crayon-e">fromarray</span><span class="crayon-sy">(</span><span class="crayon-v">face_pixels</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779777f088001670-36"><span class="crayon-h">	</span><span class="crayon-v">image</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">image</span><span class="crayon-sy">.</span><span class="crayon-e">resize</span><span class="crayon-sy">(</span><span class="crayon-v">required_size</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779777f088001670-37"><span class="crayon-h">	</span><span class="crayon-v">face_array</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">asarray</span><span class="crayon-sy">(</span><span class="crayon-v">image</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779777f088001670-38"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">face</span><span class="crayon-sy">_</span>array</div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779777f088001670-39">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779777f088001670-40"><span class="crayon-p"># load images and extract faces for all images in a directory</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779777f088001670-41"><span class="crayon-e">def </span><span class="crayon-e">load_faces</span><span class="crayon-sy">(</span><span class="crayon-v">directory</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_faces</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779777f088001670-42"><span class="crayon-h">	</span><span class="crayon-p"># prepare model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779777f088001670-43"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">MTCNN</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779777f088001670-44"><span class="crayon-h">	</span><span class="crayon-v">faces</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779777f088001670-45"><span class="crayon-h">	</span><span class="crayon-p"># enumerate files</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779777f088001670-46"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">filename </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">listdir</span><span class="crayon-sy">(</span><span class="crayon-v">directory</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779777f088001670-47"><span class="crayon-h">		</span><span class="crayon-p"># load the image</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779777f088001670-48"><span class="crayon-h">		</span><span class="crayon-v">pixels</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_image</span><span class="crayon-sy">(</span><span class="crayon-v">directory</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">filename</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779777f088001670-49"><span class="crayon-h">		</span><span class="crayon-p"># get face</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779777f088001670-50"><span class="crayon-h">		</span><span class="crayon-v">face</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">extract_face</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">pixels</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779777f088001670-51"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">face </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-v">None</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779777f088001670-52"><span class="crayon-h">			</span><span class="crayon-st">continue</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779777f088001670-53"><span class="crayon-h">		</span><span class="crayon-p"># store</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779777f088001670-54"><span class="crayon-h">		</span><span class="crayon-v">faces</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">face</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779777f088001670-55"><span class="crayon-h">		</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">faces</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">face</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779777f088001670-56"><span class="crayon-h">		</span><span class="crayon-p"># stop once we have enough</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779777f088001670-57"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">faces</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&gt;=</span><span class="crayon-h"> </span><span class="crayon-v">n_faces</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779777f088001670-58"><span class="crayon-h">			</span><span class="crayon-st">break</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779777f088001670-59"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">asarray</span><span class="crayon-sy">(</span><span class="crayon-v">faces</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779777f088001670-60">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779777f088001670-61"><span class="crayon-p"># directory that contains all images</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779777f088001670-62"><span class="crayon-v">directory</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'img_align_celeba/'</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779777f088001670-63"><span class="crayon-p"># load and extract all faces</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779777f088001670-64"><span class="crayon-v">all_faces</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_faces</span><span class="crayon-sy">(</span><span class="crayon-v">directory</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">50000</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779777f088001670-65"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Loaded: '</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">all_faces</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779777f088001670-66"><span class="crayon-p"># save in compressed format</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779777f088001670-67"><span class="crayon-e">savez_compressed</span><span class="crayon-sy">(</span><span class="crayon-s">'img_align_celeba.npz'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">all_faces</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Running the example may take a few minutes given the larger number of faces to be loaded.</p>
<p>At the end of the run, the array of extracted and resized faces is saved as a compressed NumPy array with the filename ‘<em>img_align_celeba.npz</em>‘.</p>
<p>The prepared dataset can then be loaded any time, as follows.</p>
		<div id="urvanov-syntax-highlighter-60654e7797780026244520" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0;"># load the prepared dataset
from numpy import load
# load the face dataset
data = load('img_align_celeba.npz')
faces = data['arr_0']
print('Loaded: ', faces.shape)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797780026244520-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797780026244520-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797780026244520-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797780026244520-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797780026244520-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797780026244520-6">6</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797780026244520-1"><span class="crayon-p"># load the prepared dataset</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797780026244520-2"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-i">load</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797780026244520-3"><span class="crayon-p"># load the face dataset</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797780026244520-4"><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load</span><span class="crayon-sy">(</span><span class="crayon-s">'img_align_celeba.npz'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797780026244520-5"><span class="crayon-v">faces</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-s">'arr_0'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797780026244520-6"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Loaded: '</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">faces</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Loading the dataset summarizes the shape of the array, showing 50K images with the size of 80×80 pixels and three color channels.</p>
		<div id="urvanov-syntax-highlighter-60654e7797781665186178" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0;">Loaded: (50000, 80, 80, 3)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797781665186178-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797781665186178-1">Loaded: (50000, 80, 80, 3)</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>We are now ready to develop a GAN model to generate faces using this dataset.</p>
<h2>How to Develop a Generative Adversarial Network</h2>
<p>In this section, we will develop a GAN for the faces dataset that we have prepared.</p>
<p>The first step is to define the models.</p>
<p>The discriminator model takes as input one 80×80 color image an outputs a binary prediction as to whether the image is real (<em>class=1</em>) or fake (<em>class=0</em>). It is implemented as a modest convolutional neural network using best practices for GAN design such as using the <a href="https://machinelearningmastery.com/rectified-linear-activation-function-for-deep-learning-neural-networks/">LeakyReLU activation function</a> with a slope of 0.2, using a <a href="https://machinelearningmastery.com/padding-and-stride-for-convolutional-neural-networks/">2×2 stride to downsample</a>, and the <a href="https://machinelearningmastery.com/adam-optimization-algorithm-for-deep-learning/">adam version of stochastic gradient descent</a> with a learning rate of 0.0002 and a momentum of 0.5</p>
<p>The <em>define_discriminator()</em> function below implements this, defining and compiling the discriminator model and returning it. The input shape of the image is parameterized as a default function argument in case you want to re-use the function for your own image data later.</p>
		<div id="urvanov-syntax-highlighter-60654e7797782914032847" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0;"># define the standalone discriminator model
def define_discriminator(in_shape=(80,80,3)):
	model = Sequential()
	# normal
	model.add(Conv2D(128, (5,5), padding='same', input_shape=in_shape))
	model.add(LeakyReLU(alpha=0.2))
	# downsample to 40x40
	model.add(Conv2D(128, (5,5), strides=(2,2), padding='same'))
	model.add(LeakyReLU(alpha=0.2))
	# downsample to 20x30
	model.add(Conv2D(128, (5,5), strides=(2,2), padding='same'))
	model.add(LeakyReLU(alpha=0.2))
	# downsample to 10x10
	model.add(Conv2D(128, (5,5), strides=(2,2), padding='same'))
	model.add(LeakyReLU(alpha=0.2))
	# downsample to 5x5
	model.add(Conv2D(128, (5,5), strides=(2,2), padding='same'))
	model.add(LeakyReLU(alpha=0.2))
	# classifier
	model.add(Flatten())
	model.add(Dropout(0.4))
	model.add(Dense(1, activation='sigmoid'))
	# compile model
	opt = Adam(lr=0.0002, beta_1=0.5)
	model.compile(loss='binary_crossentropy', optimizer=opt, metrics=['accuracy'])
	return model</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797782914032847-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797782914032847-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797782914032847-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797782914032847-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797782914032847-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797782914032847-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797782914032847-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797782914032847-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797782914032847-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797782914032847-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797782914032847-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797782914032847-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797782914032847-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797782914032847-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797782914032847-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797782914032847-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797782914032847-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797782914032847-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797782914032847-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797782914032847-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797782914032847-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797782914032847-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797782914032847-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797782914032847-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797782914032847-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797782914032847-26">26</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797782914032847-1"><span class="crayon-p"># define the standalone discriminator model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797782914032847-2"><span class="crayon-e">def </span><span class="crayon-e">define_discriminator</span><span class="crayon-sy">(</span><span class="crayon-v">in_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">80</span><span class="crayon-sy">,</span><span class="crayon-cn">80</span><span class="crayon-sy">,</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797782914032847-3"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797782914032847-4"><span class="crayon-h">	</span><span class="crayon-p"># normal</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797782914032847-5"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">128</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-cn">5</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'same'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_shape</span><span class="crayon-o">=</span><span class="crayon-v">in_shape</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797782914032847-6"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LeakyReLU</span><span class="crayon-sy">(</span><span class="crayon-v">alpha</span><span class="crayon-o">=</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797782914032847-7"><span class="crayon-h">	</span><span class="crayon-p"># downsample to 40x40</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797782914032847-8"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">128</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-cn">5</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">strides</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'same'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797782914032847-9"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LeakyReLU</span><span class="crayon-sy">(</span><span class="crayon-v">alpha</span><span class="crayon-o">=</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797782914032847-10"><span class="crayon-h">	</span><span class="crayon-p"># downsample to 20x30</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797782914032847-11"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">128</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-cn">5</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">strides</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'same'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797782914032847-12"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LeakyReLU</span><span class="crayon-sy">(</span><span class="crayon-v">alpha</span><span class="crayon-o">=</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797782914032847-13"><span class="crayon-h">	</span><span class="crayon-p"># downsample to 10x10</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797782914032847-14"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">128</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-cn">5</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">strides</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'same'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797782914032847-15"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LeakyReLU</span><span class="crayon-sy">(</span><span class="crayon-v">alpha</span><span class="crayon-o">=</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797782914032847-16"><span class="crayon-h">	</span><span class="crayon-p"># downsample to 5x5</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797782914032847-17"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">128</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-cn">5</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">strides</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'same'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797782914032847-18"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LeakyReLU</span><span class="crayon-sy">(</span><span class="crayon-v">alpha</span><span class="crayon-o">=</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797782914032847-19"><span class="crayon-h">	</span><span class="crayon-p"># classifier</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797782914032847-20"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Flatten</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797782914032847-21"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dropout</span><span class="crayon-sy">(</span><span class="crayon-cn">0.4</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797782914032847-22"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797782914032847-23"><span class="crayon-h">	</span><span class="crayon-p"># compile model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797782914032847-24"><span class="crayon-h">	</span><span class="crayon-v">opt</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Adam</span><span class="crayon-sy">(</span><span class="crayon-v">lr</span><span class="crayon-o">=</span><span class="crayon-cn">0.0002</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">beta_1</span><span class="crayon-o">=</span><span class="crayon-cn">0.5</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797782914032847-25"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'binary_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-v">opt</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797782914032847-26"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">model</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>The generator model takes as input a point in the latent space and outputs a single 80×80 color image.</p>
<p>This is achieved by using a fully connected layer to interpret the point in the latent space and provide sufficient activations that can be reshaped into many copies (in this case 128) of a low-resolution version of the output image (e.g. 5×5). This is then upsampled four times, doubling the size and quadrupling the area of the activations each time using transpose convolutional layers. The model uses best practices such as the LeakyReLU activation, a kernel size that is a factor of the stride size, and a hyperbolic tangent (tanh) activation function in the output layer.</p>
<p>The <em>define_generator()</em> function below defines the generator model but intentionally does not compile it as it is not trained directly, then returns the model. The size of the latent space is parameterized as a function argument.</p>
		<div id="urvanov-syntax-highlighter-60654e7797783898340506" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0;"># define the standalone generator model
def define_generator(latent_dim):
	model = Sequential()
	# foundation for 5x5 feature maps
	n_nodes = 128 * 5 * 5
	model.add(Dense(n_nodes, input_dim=latent_dim))
	model.add(LeakyReLU(alpha=0.2))
	model.add(Reshape((5, 5, 128)))
	# upsample to 10x10
	model.add(Conv2DTranspose(128, (4,4), strides=(2,2), padding='same'))
	model.add(LeakyReLU(alpha=0.2))
	# upsample to 20x20
	model.add(Conv2DTranspose(128, (4,4), strides=(2,2), padding='same'))
	model.add(LeakyReLU(alpha=0.2))
	# upsample to 40x40
	model.add(Conv2DTranspose(128, (4,4), strides=(2,2), padding='same'))
	model.add(LeakyReLU(alpha=0.2))
	# upsample to 80x80
	model.add(Conv2DTranspose(128, (4,4), strides=(2,2), padding='same'))
	model.add(LeakyReLU(alpha=0.2))
	# output layer 80x80x3
	model.add(Conv2D(3, (5,5), activation='tanh', padding='same'))
	return model</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797783898340506-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797783898340506-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797783898340506-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797783898340506-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797783898340506-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797783898340506-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797783898340506-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797783898340506-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797783898340506-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797783898340506-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797783898340506-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797783898340506-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797783898340506-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797783898340506-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797783898340506-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797783898340506-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797783898340506-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797783898340506-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797783898340506-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797783898340506-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797783898340506-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797783898340506-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797783898340506-23">23</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797783898340506-1"><span class="crayon-p"># define the standalone generator model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797783898340506-2"><span class="crayon-e">def </span><span class="crayon-e">define_generator</span><span class="crayon-sy">(</span><span class="crayon-v">latent_dim</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797783898340506-3"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797783898340506-4"><span class="crayon-h">	</span><span class="crayon-p"># foundation for 5x5 feature maps</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797783898340506-5"><span class="crayon-h">	</span><span class="crayon-v">n_nodes</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">128</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">5</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797783898340506-6"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-v">n_nodes</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_dim</span><span class="crayon-o">=</span><span class="crayon-v">latent_dim</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797783898340506-7"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LeakyReLU</span><span class="crayon-sy">(</span><span class="crayon-v">alpha</span><span class="crayon-o">=</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797783898340506-8"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">128</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797783898340506-9"><span class="crayon-h">	</span><span class="crayon-p"># upsample to 10x10</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797783898340506-10"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2DTranspose</span><span class="crayon-sy">(</span><span class="crayon-cn">128</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-cn">4</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">strides</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'same'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797783898340506-11"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LeakyReLU</span><span class="crayon-sy">(</span><span class="crayon-v">alpha</span><span class="crayon-o">=</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797783898340506-12"><span class="crayon-h">	</span><span class="crayon-p"># upsample to 20x20</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797783898340506-13"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2DTranspose</span><span class="crayon-sy">(</span><span class="crayon-cn">128</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-cn">4</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">strides</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'same'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797783898340506-14"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LeakyReLU</span><span class="crayon-sy">(</span><span class="crayon-v">alpha</span><span class="crayon-o">=</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797783898340506-15"><span class="crayon-h">	</span><span class="crayon-p"># upsample to 40x40</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797783898340506-16"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2DTranspose</span><span class="crayon-sy">(</span><span class="crayon-cn">128</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-cn">4</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">strides</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'same'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797783898340506-17"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LeakyReLU</span><span class="crayon-sy">(</span><span class="crayon-v">alpha</span><span class="crayon-o">=</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797783898340506-18"><span class="crayon-h">	</span><span class="crayon-p"># upsample to 80x80</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797783898340506-19"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2DTranspose</span><span class="crayon-sy">(</span><span class="crayon-cn">128</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-cn">4</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">strides</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'same'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797783898340506-20"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LeakyReLU</span><span class="crayon-sy">(</span><span class="crayon-v">alpha</span><span class="crayon-o">=</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797783898340506-21"><span class="crayon-h">	</span><span class="crayon-p"># output layer 80x80x3</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797783898340506-22"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-cn">5</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'tanh'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'same'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797783898340506-23"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">model</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Next, a GAN model can be defined that combines both the generator model and the discriminator model into one larger model. This larger model will be used to train the model weights in the generator, using the output and error calculated by the discriminator model. The discriminator model is trained separately, and as such, the model weights are marked as not trainable in this larger GAN model to ensure that only the weights of the generator model are updated. This change to the trainability of the discriminator weights only has an effect when training the combined GAN model, not when training the discriminator standalone.</p>
<p>This larger GAN model takes as input a point in the latent space, uses the generator model to generate an image, which is fed as input to the discriminator model, then output or classified as real or fake.</p>
<p>The <em>define_gan()</em> function below implements this, taking the already-defined generator and discriminator models as input.</p>
		<div id="urvanov-syntax-highlighter-60654e7797784711791518" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0;"># define the combined generator and discriminator model, for updating the generator
def define_gan(g_model, d_model):
	# make weights in the discriminator not trainable
	d_model.trainable = False
	# connect them
	model = Sequential()
	# add generator
	model.add(g_model)
	# add the discriminator
	model.add(d_model)
	# compile model
	opt = Adam(lr=0.0002, beta_1=0.5)
	model.compile(loss='binary_crossentropy', optimizer=opt)
	return model</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797784711791518-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797784711791518-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797784711791518-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797784711791518-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797784711791518-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797784711791518-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797784711791518-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797784711791518-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797784711791518-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797784711791518-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797784711791518-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797784711791518-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797784711791518-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797784711791518-14">14</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797784711791518-1"><span class="crayon-p"># define the combined generator and discriminator model, for updating the generator</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797784711791518-2"><span class="crayon-e">def </span><span class="crayon-e">define_gan</span><span class="crayon-sy">(</span><span class="crayon-v">g_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">d_model</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797784711791518-3"><span class="crayon-h">	</span><span class="crayon-p"># make weights in the discriminator not trainable</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797784711791518-4"><span class="crayon-h">	</span><span class="crayon-v">d_model</span><span class="crayon-sy">.</span><span class="crayon-v">trainable</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">False</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797784711791518-5"><span class="crayon-h">	</span><span class="crayon-p"># connect them</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797784711791518-6"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797784711791518-7"><span class="crayon-h">	</span><span class="crayon-p"># add generator</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797784711791518-8"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-v">g_model</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797784711791518-9"><span class="crayon-h">	</span><span class="crayon-p"># add the discriminator</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797784711791518-10"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-v">d_model</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797784711791518-11"><span class="crayon-h">	</span><span class="crayon-p"># compile model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797784711791518-12"><span class="crayon-h">	</span><span class="crayon-v">opt</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Adam</span><span class="crayon-sy">(</span><span class="crayon-v">lr</span><span class="crayon-o">=</span><span class="crayon-cn">0.0002</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">beta_1</span><span class="crayon-o">=</span><span class="crayon-cn">0.5</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797784711791518-13"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'binary_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-v">opt</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797784711791518-14"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">model</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Now that we have defined the GAN model, we need to train it. But, before we can train the model, we require input data.</p>
<p>The first step is to load and scale the pre-processed faces dataset. The saved NumPy array can be loaded, as we did in the previous section, then the <a href="https://machinelearningmastery.com/how-to-manually-scale-image-pixel-data-for-deep-learning/">pixel values must be scaled</a> to the range [-1,1] to match the output of the generator model.</p>
<p>The <em>load_real_samples()</em> function below implements this, returning the loaded and scaled image data ready for modeling.</p>
		<div id="urvanov-syntax-highlighter-60654e7797785797999297" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0;"># load and prepare training images
def load_real_samples():
	# load the face dataset
	data = load('img_align_celeba.npz')
	X = data['arr_0']
	# convert from unsigned ints to floats
	X = X.astype('float32')
	# scale from [0,255] to [-1,1]
	X = (X - 127.5) / 127.5
	return X</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797785797999297-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797785797999297-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797785797999297-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797785797999297-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797785797999297-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797785797999297-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797785797999297-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797785797999297-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797785797999297-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797785797999297-10">10</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797785797999297-1"><span class="crayon-p"># load and prepare training images</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797785797999297-2"><span class="crayon-e">def </span><span class="crayon-e">load_real_samples</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797785797999297-3"><span class="crayon-h">	</span><span class="crayon-p"># load the face dataset</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797785797999297-4"><span class="crayon-h">	</span><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load</span><span class="crayon-sy">(</span><span class="crayon-s">'img_align_celeba.npz'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797785797999297-5"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-s">'arr_0'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797785797999297-6"><span class="crayon-h">	</span><span class="crayon-p"># convert from unsigned ints to floats</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797785797999297-7"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797785797999297-8"><span class="crayon-h">	</span><span class="crayon-p"># scale from [0,255] to [-1,1]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797785797999297-9"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">127.5</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">127.5</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797785797999297-10"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">X</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>We will require one batch (or a half) batch of real images from the dataset each update to the GAN model. A simple way to achieve this is to select a random sample of images from the dataset each time.</p>
<p>The <em>generate_real_samples()</em> function below implements this, taking the prepared dataset as an argument, selecting and returning a random sample of face images and their corresponding class label for the discriminator, specifically <em>class=1</em>, indicating that they are real images.</p>
		<div id="urvanov-syntax-highlighter-60654e7797786787263311" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0;"># select real samples
def generate_real_samples(dataset, n_samples):
	# choose random instances
	ix = randint(0, dataset.shape[0], n_samples)
	# retrieve selected images
	X = dataset[ix]
	# generate 'real' class labels (1)
	y = ones((n_samples, 1))
	return X, y</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797786787263311-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797786787263311-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797786787263311-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797786787263311-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797786787263311-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797786787263311-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797786787263311-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797786787263311-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797786787263311-9">9</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797786787263311-1"><span class="crayon-p"># select real samples</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797786787263311-2"><span class="crayon-e">def </span><span class="crayon-e">generate_real_samples</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_samples</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797786787263311-3"><span class="crayon-h">	</span><span class="crayon-p"># choose random instances</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797786787263311-4"><span class="crayon-h">	</span><span class="crayon-v">ix</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">randint</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_samples</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797786787263311-5"><span class="crayon-h">	</span><span class="crayon-p"># retrieve selected images</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797786787263311-6"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-v">ix</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797786787263311-7"><span class="crayon-h">	</span><span class="crayon-p"># generate 'real' class labels (1)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797786787263311-8"><span class="crayon-h">	</span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">ones</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">n_samples</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797786787263311-9"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Next, we need inputs for the generator model. These are random points from the latent space, specifically <a href="https://machinelearningmastery.com/how-to-generate-random-numbers-in-python/">Gaussian distributed random variables</a>.</p>
<p>The <em>generate_latent_points()</em> function implements this, taking the size of the latent space as an argument and the number of points required and returning them as a batch of input samples for the generator model.</p>
		<div id="urvanov-syntax-highlighter-60654e7797787202757695" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0;"># generate points in latent space as input for the generator
def generate_latent_points(latent_dim, n_samples):
	# generate points in the latent space
	x_input = randn(latent_dim * n_samples)
	# reshape into a batch of inputs for the network
	x_input = x_input.reshape(n_samples, latent_dim)
	return x_input</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797787202757695-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797787202757695-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797787202757695-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797787202757695-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797787202757695-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797787202757695-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797787202757695-7">7</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797787202757695-1"><span class="crayon-p"># generate points in latent space as input for the generator</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797787202757695-2"><span class="crayon-e">def </span><span class="crayon-e">generate_latent_points</span><span class="crayon-sy">(</span><span class="crayon-v">latent_dim</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_samples</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797787202757695-3"><span class="crayon-h">	</span><span class="crayon-p"># generate points in the latent space</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797787202757695-4"><span class="crayon-h">	</span><span class="crayon-v">x_input</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">randn</span><span class="crayon-sy">(</span><span class="crayon-e ">latent_dim *</span><span class="crayon-h"> </span><span class="crayon-v">n_samples</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797787202757695-5"><span class="crayon-h">	</span><span class="crayon-p"># reshape into a batch of inputs for the network</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797787202757695-6"><span class="crayon-h">	</span><span class="crayon-v">x_input</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">x_input</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-v">n_samples</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">latent_dim</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797787202757695-7"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">x_input</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Next, we need to use the points in the latent space as input to the generator in order to generate new images.</p>
<p>The <em>generate_fake_samples()</em> function below implements this, taking the generator model and size of the latent space as arguments, then generating points in the latent space and using them as input to the generator model. The function returns the generated images and their corresponding class label for the discriminator model, specifically class=0 to indicate they are fake or generated.</p>
		<div id="urvanov-syntax-highlighter-60654e7797788253161136" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0;"># use the generator to generate n fake examples, with class labels
def generate_fake_samples(g_model, latent_dim, n_samples):
	# generate points in latent space
	x_input = generate_latent_points(latent_dim, n_samples)
	# predict outputs
	X = g_model.predict(x_input)
	# create 'fake' class labels (0)
	y = zeros((n_samples, 1))
	return X, y</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797788253161136-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797788253161136-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797788253161136-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797788253161136-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797788253161136-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797788253161136-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797788253161136-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797788253161136-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797788253161136-9">9</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797788253161136-1"><span class="crayon-p"># use the generator to generate n fake examples, with class labels</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797788253161136-2"><span class="crayon-e">def </span><span class="crayon-e">generate_fake_samples</span><span class="crayon-sy">(</span><span class="crayon-v">g_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">latent_dim</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_samples</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797788253161136-3"><span class="crayon-h">	</span><span class="crayon-p"># generate points in latent space</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797788253161136-4"><span class="crayon-h">	</span><span class="crayon-v">x_input</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">generate_latent_points</span><span class="crayon-sy">(</span><span class="crayon-v">latent_dim</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_samples</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797788253161136-5"><span class="crayon-h">	</span><span class="crayon-p"># predict outputs</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797788253161136-6"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">g_model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">x_input</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797788253161136-7"><span class="crayon-h">	</span><span class="crayon-p"># create 'fake' class labels (0)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797788253161136-8"><span class="crayon-h">	</span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">zeros</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">n_samples</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797788253161136-9"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>We are now ready to fit the GAN models.</p>
<p>The model is fit for 100 training epochs, which is arbitrary, as the model begins generating plausible faces after perhaps the first few epochs. A batch size of 128 samples is used, and each training epoch involves 50,000/128 or about 390 batches of real and fake samples and updates to the model.</p>
<p>First, the discriminator model is updated for a half batch of real samples, then a half batch of fake samples, together forming one batch of weight updates. The generator is then updated via the combined GAN model. Importantly, the class label is set to 1 or real for the fake samples. This has the effect of updating the generator toward getting better at generating real samples on the next batch.</p>
<p>The <em>train()</em> function below implements this, taking the defined models, dataset, and size of the latent dimension as arguments and parameterizing the number of epochs and batch size with default arguments.</p>
		<div id="urvanov-syntax-highlighter-60654e7797789802877123" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0;"># train the generator and discriminator
def train(g_model, d_model, gan_model, dataset, latent_dim, n_epochs=100, n_batch=128):
	bat_per_epo = int(dataset.shape[0] / n_batch)
	half_batch = int(n_batch / 2)
	# manually enumerate epochs
	for i in range(n_epochs):
		# enumerate batches over the training set
		for j in range(bat_per_epo):
			# get randomly selected 'real' samples
			X_real, y_real = generate_real_samples(dataset, half_batch)
			# update discriminator model weights
			d_loss1, _ = d_model.train_on_batch(X_real, y_real)
			# generate 'fake' examples
			X_fake, y_fake = generate_fake_samples(g_model, latent_dim, half_batch)
			# update discriminator model weights
			d_loss2, _ = d_model.train_on_batch(X_fake, y_fake)
			# prepare points in latent space as input for the generator
			X_gan = generate_latent_points(latent_dim, n_batch)
			# create inverted labels for the fake samples
			y_gan = ones((n_batch, 1))
			# update the generator via the discriminator's error
			g_loss = gan_model.train_on_batch(X_gan, y_gan)
			# summarize loss on this batch
			print('&gt;%d, %d/%d, d1=%.3f, d2=%.3f g=%.3f' %
				(i+1, j+1, bat_per_epo, d_loss1, d_loss2, g_loss))
		# evaluate the model performance, sometimes
		if (i+1) % 10 == 0:
			summarize_performance(i, g_model, d_model, dataset, latent_dim)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797789802877123-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797789802877123-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797789802877123-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797789802877123-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797789802877123-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797789802877123-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797789802877123-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797789802877123-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797789802877123-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797789802877123-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797789802877123-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797789802877123-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797789802877123-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797789802877123-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797789802877123-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797789802877123-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797789802877123-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797789802877123-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797789802877123-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797789802877123-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797789802877123-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797789802877123-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797789802877123-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797789802877123-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797789802877123-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797789802877123-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797789802877123-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797789802877123-28">28</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797789802877123-1"><span class="crayon-p"># train the generator and discriminator</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797789802877123-2"><span class="crayon-e">def </span><span class="crayon-e">train</span><span class="crayon-sy">(</span><span class="crayon-v">g_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">d_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">gan_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">latent_dim</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_epochs</span><span class="crayon-o">=</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_batch</span><span class="crayon-o">=</span><span class="crayon-cn">128</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797789802877123-3"><span class="crayon-h">	</span><span class="crayon-v">bat_per_epo</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-v">n_batch</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797789802877123-4"><span class="crayon-h">	</span><span class="crayon-v">half_batch</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-v">n_batch</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797789802877123-5"><span class="crayon-h">	</span><span class="crayon-p"># manually enumerate epochs</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797789802877123-6"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_epochs</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797789802877123-7"><span class="crayon-h">		</span><span class="crayon-p"># enumerate batches over the training set</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797789802877123-8"><span class="crayon-h">		</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">bat_per_epo</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797789802877123-9"><span class="crayon-h">			</span><span class="crayon-p"># get randomly selected 'real' samples</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797789802877123-10"><span class="crayon-h">			</span><span class="crayon-v">X_real</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_real</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">generate_real_samples</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">half_batch</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797789802877123-11"><span class="crayon-h">			</span><span class="crayon-p"># update discriminator model weights</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797789802877123-12"><span class="crayon-h">			</span><span class="crayon-v">d_loss1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">_</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">d_model</span><span class="crayon-sy">.</span><span class="crayon-e">train_on_batch</span><span class="crayon-sy">(</span><span class="crayon-v">X_real</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_real</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797789802877123-13"><span class="crayon-h">			</span><span class="crayon-p"># generate 'fake' examples</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797789802877123-14"><span class="crayon-h">			</span><span class="crayon-v">X_fake</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_fake</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">generate_fake_samples</span><span class="crayon-sy">(</span><span class="crayon-v">g_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">latent_dim</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">half_batch</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797789802877123-15"><span class="crayon-h">			</span><span class="crayon-p"># update discriminator model weights</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797789802877123-16"><span class="crayon-h">			</span><span class="crayon-v">d_loss2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">_</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">d_model</span><span class="crayon-sy">.</span><span class="crayon-e">train_on_batch</span><span class="crayon-sy">(</span><span class="crayon-v">X_fake</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_fake</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797789802877123-17"><span class="crayon-h">			</span><span class="crayon-p"># prepare points in latent space as input for the generator</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797789802877123-18"><span class="crayon-h">			</span><span class="crayon-v">X_gan</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">generate_latent_points</span><span class="crayon-sy">(</span><span class="crayon-v">latent_dim</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_batch</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797789802877123-19"><span class="crayon-h">			</span><span class="crayon-p"># create inverted labels for the fake samples</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797789802877123-20"><span class="crayon-h">			</span><span class="crayon-v">y_gan</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">ones</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">n_batch</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797789802877123-21"><span class="crayon-h">			</span><span class="crayon-p"># update the generator via the discriminator's error</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797789802877123-22"><span class="crayon-h">			</span><span class="crayon-v">g_loss</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">gan_model</span><span class="crayon-sy">.</span><span class="crayon-e">train_on_batch</span><span class="crayon-sy">(</span><span class="crayon-v">X_gan</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_gan</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797789802877123-23"><span class="crayon-h">			</span><span class="crayon-p"># summarize loss on this batch</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797789802877123-24"><span class="crayon-h">			</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'&gt;%d, %d/%d, d1=%.3f, d2=%.3f g=%.3f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797789802877123-25"><span class="crayon-h">				</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">j</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">bat_per_epo</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">d_loss1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">d_loss2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">g_loss</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797789802877123-26"><span class="crayon-h">		</span><span class="crayon-p"># evaluate the model performance, sometimes</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797789802877123-27"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797789802877123-28"><span class="crayon-h">			</span><span class="crayon-e">summarize_performance</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">g_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">d_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">latent_dim</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>You will note that every 10 training epochs, the <em>summarize_performance()</em> function is called.</p>
<p>There is currently no reliable way to automatically evaluate the quality of generated images. Therefore, we must generate images periodically during training and save the model at these times. This both provides a check-point that we can later load and use to generate images, and a way to safeguard against the training process failing, which can happen.</p>
<p>Below defines the <em>summarize_performance()</em> and <em>save_plot()</em> functions.</p>
<p>The <em>summarize_performance()</em> function generates samples and evaluates the performance of the discriminator on real and fake samples. The classification accuracy is reported and might provide insight into model performance. The <em>save_plot()</em> is called to create and save a plot of the generated images, and then the model is saved to a file.</p>
		<div id="urvanov-syntax-highlighter-60654e779778a877488519" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0;"># create and save a plot of generated images
def save_plot(examples, epoch, n=10):
	# scale from [-1,1] to [0,1]
	examples = (examples + 1) / 2.0
	# plot images
	for i in range(n * n):
		# define subplot
		pyplot.subplot(n, n, 1 + i)
		# turn off axis
		pyplot.axis('off')
		# plot raw pixel data
		pyplot.imshow(examples[i])
	# save plot to file
	filename = 'generated_plot_e%03d.png' % (epoch+1)
	pyplot.savefig(filename)
	pyplot.close()

# evaluate the discriminator, plot generated images, save generator model
def summarize_performance(epoch, g_model, d_model, dataset, latent_dim, n_samples=100):
	# prepare real samples
	X_real, y_real = generate_real_samples(dataset, n_samples)
	# evaluate discriminator on real examples
	_, acc_real = d_model.evaluate(X_real, y_real, verbose=0)
	# prepare fake examples
	x_fake, y_fake = generate_fake_samples(g_model, latent_dim, n_samples)
	# evaluate discriminator on fake examples
	_, acc_fake = d_model.evaluate(x_fake, y_fake, verbose=0)
	# summarize discriminator performance
	print('&gt;Accuracy real: %.0f%%, fake: %.0f%%' % (acc_real*100, acc_fake*100))
	# save plot
	save_plot(x_fake, epoch)
	# save the generator model tile file
	filename = 'generator_model_%03d.h5' % (epoch+1)
	g_model.save(filename)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778a877488519-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778a877488519-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778a877488519-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778a877488519-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778a877488519-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778a877488519-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778a877488519-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778a877488519-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778a877488519-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778a877488519-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778a877488519-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778a877488519-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778a877488519-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778a877488519-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778a877488519-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778a877488519-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778a877488519-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778a877488519-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778a877488519-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778a877488519-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778a877488519-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778a877488519-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778a877488519-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778a877488519-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778a877488519-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778a877488519-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778a877488519-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778a877488519-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778a877488519-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778a877488519-30">30</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778a877488519-31">31</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778a877488519-32">32</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778a877488519-33">33</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778a877488519-34">34</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778a877488519-1"><span class="crayon-p"># create and save a plot of generated images</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778a877488519-2"><span class="crayon-e">def </span><span class="crayon-e">save_plot</span><span class="crayon-sy">(</span><span class="crayon-v">examples</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epoch</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778a877488519-3"><span class="crayon-h">	</span><span class="crayon-p"># scale from [-1,1] to [0,1]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778a877488519-4"><span class="crayon-h">	</span><span class="crayon-v">examples</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">examples</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">2.0</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778a877488519-5"><span class="crayon-h">	</span><span class="crayon-p"># plot images</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778a877488519-6"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e ">n *</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778a877488519-7"><span class="crayon-h">		</span><span class="crayon-p"># define subplot</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778a877488519-8"><span class="crayon-h">		</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-v">n</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778a877488519-9"><span class="crayon-h">		</span><span class="crayon-p"># turn off axis</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778a877488519-10"><span class="crayon-h">		</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">axis</span><span class="crayon-sy">(</span><span class="crayon-s">'off'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778a877488519-11"><span class="crayon-h">		</span><span class="crayon-p"># plot raw pixel data</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778a877488519-12"><span class="crayon-h">		</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">imshow</span><span class="crayon-sy">(</span><span class="crayon-v">examples</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778a877488519-13"><span class="crayon-h">	</span><span class="crayon-p"># save plot to file</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778a877488519-14"><span class="crayon-h">	</span><span class="crayon-v">filename</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'generated_plot_e%03d.png'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">epoch</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778a877488519-15"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">savefig</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778a877488519-16"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">close</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778a877488519-17">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778a877488519-18"><span class="crayon-p"># evaluate the discriminator, plot generated images, save generator model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778a877488519-19"><span class="crayon-e">def </span><span class="crayon-e">summarize_performance</span><span class="crayon-sy">(</span><span class="crayon-v">epoch</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">g_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">d_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">latent_dim</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_samples</span><span class="crayon-o">=</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778a877488519-20"><span class="crayon-h">	</span><span class="crayon-p"># prepare real samples</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778a877488519-21"><span class="crayon-h">	</span><span class="crayon-v">X_real</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_real</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">generate_real_samples</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_samples</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778a877488519-22"><span class="crayon-h">	</span><span class="crayon-p"># evaluate discriminator on real examples</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778a877488519-23"><span class="crayon-h">	</span><span class="crayon-v">_</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">acc_real</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">d_model</span><span class="crayon-sy">.</span><span class="crayon-e">evaluate</span><span class="crayon-sy">(</span><span class="crayon-v">X_real</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_real</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778a877488519-24"><span class="crayon-h">	</span><span class="crayon-p"># prepare fake examples</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778a877488519-25"><span class="crayon-h">	</span><span class="crayon-v">x_fake</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_fake</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">generate_fake_samples</span><span class="crayon-sy">(</span><span class="crayon-v">g_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">latent_dim</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_samples</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778a877488519-26"><span class="crayon-h">	</span><span class="crayon-p"># evaluate discriminator on fake examples</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778a877488519-27"><span class="crayon-h">	</span><span class="crayon-v">_</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">acc_fake</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">d_model</span><span class="crayon-sy">.</span><span class="crayon-e">evaluate</span><span class="crayon-sy">(</span><span class="crayon-v">x_fake</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_fake</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778a877488519-28"><span class="crayon-h">	</span><span class="crayon-p"># summarize discriminator performance</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778a877488519-29"><span class="crayon-h">	</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'&gt;Accuracy real: %.0f%%, fake: %.0f%%'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e ">acc_real*</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e ">acc_fake*</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778a877488519-30"><span class="crayon-h">	</span><span class="crayon-p"># save plot</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778a877488519-31"><span class="crayon-h">	</span><span class="crayon-e">save_plot</span><span class="crayon-sy">(</span><span class="crayon-v">x_fake</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epoch</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778a877488519-32"><span class="crayon-h">	</span><span class="crayon-p"># save the generator model tile file</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778a877488519-33"><span class="crayon-h">	</span><span class="crayon-v">filename</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'generator_model_%03d.h5'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">epoch</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778a877488519-34"><span class="crayon-h">	</span><span class="crayon-v">g_model</span><span class="crayon-sy">.</span><span class="crayon-e">save</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>We can then define the size of the latent space, define all three models, and train them on the loaded face dataset.</p>
		<div id="urvanov-syntax-highlighter-60654e779778b215128386" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0;"># size of the latent space
latent_dim = 100
# create the discriminator
d_model = define_discriminator()
# create the generator
g_model = define_generator(latent_dim)
# create the gan
gan_model = define_gan(g_model, d_model)
# load image data
dataset = load_real_samples()
# train model
train(g_model, d_model, gan_model, dataset, latent_dim)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778b215128386-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778b215128386-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778b215128386-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778b215128386-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778b215128386-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778b215128386-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778b215128386-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778b215128386-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778b215128386-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778b215128386-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778b215128386-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778b215128386-12">12</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778b215128386-1"><span class="crayon-p"># size of the latent space</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778b215128386-2"><span class="crayon-v">latent_dim</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">100</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778b215128386-3"><span class="crayon-p"># create the discriminator</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778b215128386-4"><span class="crayon-v">d_model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">define_discriminator</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778b215128386-5"><span class="crayon-p"># create the generator</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778b215128386-6"><span class="crayon-v">g_model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">define_generator</span><span class="crayon-sy">(</span><span class="crayon-v">latent_dim</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778b215128386-7"><span class="crayon-p"># create the gan</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778b215128386-8"><span class="crayon-v">gan_model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">define_gan</span><span class="crayon-sy">(</span><span class="crayon-v">g_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">d_model</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778b215128386-9"><span class="crayon-p"># load image data</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778b215128386-10"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_real_samples</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778b215128386-11"><span class="crayon-p"># train model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778b215128386-12"><span class="crayon-e">train</span><span class="crayon-sy">(</span><span class="crayon-v">g_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">d_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">gan_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">latent_dim</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Tying all of this together, the complete example is listed below.</p>
		<div id="urvanov-syntax-highlighter-60654e779778c804353094" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0;"># example of a gan for generating faces
from numpy import load
from numpy import zeros
from numpy import ones
from numpy.random import randn
from numpy.random import randint
from keras.optimizers import Adam
from keras.models import Sequential
from keras.layers import Dense
from keras.layers import Reshape
from keras.layers import Flatten
from keras.layers import Conv2D
from keras.layers import Conv2DTranspose
from keras.layers import LeakyReLU
from keras.layers import Dropout
from matplotlib import pyplot

# define the standalone discriminator model
def define_discriminator(in_shape=(80,80,3)):
	model = Sequential()
	# normal
	model.add(Conv2D(128, (5,5), padding='same', input_shape=in_shape))
	model.add(LeakyReLU(alpha=0.2))
	# downsample to 40x40
	model.add(Conv2D(128, (5,5), strides=(2,2), padding='same'))
	model.add(LeakyReLU(alpha=0.2))
	# downsample to 20x30
	model.add(Conv2D(128, (5,5), strides=(2,2), padding='same'))
	model.add(LeakyReLU(alpha=0.2))
	# downsample to 10x10
	model.add(Conv2D(128, (5,5), strides=(2,2), padding='same'))
	model.add(LeakyReLU(alpha=0.2))
	# downsample to 5x5
	model.add(Conv2D(128, (5,5), strides=(2,2), padding='same'))
	model.add(LeakyReLU(alpha=0.2))
	# classifier
	model.add(Flatten())
	model.add(Dropout(0.4))
	model.add(Dense(1, activation='sigmoid'))
	# compile model
	opt = Adam(lr=0.0002, beta_1=0.5)
	model.compile(loss='binary_crossentropy', optimizer=opt, metrics=['accuracy'])
	return model

# define the standalone generator model
def define_generator(latent_dim):
	model = Sequential()
	# foundation for 5x5 feature maps
	n_nodes = 128 * 5 * 5
	model.add(Dense(n_nodes, input_dim=latent_dim))
	model.add(LeakyReLU(alpha=0.2))
	model.add(Reshape((5, 5, 128)))
	# upsample to 10x10
	model.add(Conv2DTranspose(128, (4,4), strides=(2,2), padding='same'))
	model.add(LeakyReLU(alpha=0.2))
	# upsample to 20x20
	model.add(Conv2DTranspose(128, (4,4), strides=(2,2), padding='same'))
	model.add(LeakyReLU(alpha=0.2))
	# upsample to 40x40
	model.add(Conv2DTranspose(128, (4,4), strides=(2,2), padding='same'))
	model.add(LeakyReLU(alpha=0.2))
	# upsample to 80x80
	model.add(Conv2DTranspose(128, (4,4), strides=(2,2), padding='same'))
	model.add(LeakyReLU(alpha=0.2))
	# output layer 80x80x3
	model.add(Conv2D(3, (5,5), activation='tanh', padding='same'))
	return model

# define the combined generator and discriminator model, for updating the generator
def define_gan(g_model, d_model):
	# make weights in the discriminator not trainable
	d_model.trainable = False
	# connect them
	model = Sequential()
	# add generator
	model.add(g_model)
	# add the discriminator
	model.add(d_model)
	# compile model
	opt = Adam(lr=0.0002, beta_1=0.5)
	model.compile(loss='binary_crossentropy', optimizer=opt)
	return model

# load and prepare training images
def load_real_samples():
	# load the face dataset
	data = load('img_align_celeba.npz')
	X = data['arr_0']
	# convert from unsigned ints to floats
	X = X.astype('float32')
	# scale from [0,255] to [-1,1]
	X = (X - 127.5) / 127.5
	return X

# select real samples
def generate_real_samples(dataset, n_samples):
	# choose random instances
	ix = randint(0, dataset.shape[0], n_samples)
	# retrieve selected images
	X = dataset[ix]
	# generate 'real' class labels (1)
	y = ones((n_samples, 1))
	return X, y

# generate points in latent space as input for the generator
def generate_latent_points(latent_dim, n_samples):
	# generate points in the latent space
	x_input = randn(latent_dim * n_samples)
	# reshape into a batch of inputs for the network
	x_input = x_input.reshape(n_samples, latent_dim)
	return x_input

# use the generator to generate n fake examples, with class labels
def generate_fake_samples(g_model, latent_dim, n_samples):
	# generate points in latent space
	x_input = generate_latent_points(latent_dim, n_samples)
	# predict outputs
	X = g_model.predict(x_input)
	# create 'fake' class labels (0)
	y = zeros((n_samples, 1))
	return X, y

# create and save a plot of generated images
def save_plot(examples, epoch, n=10):
	# scale from [-1,1] to [0,1]
	examples = (examples + 1) / 2.0
	# plot images
	for i in range(n * n):
		# define subplot
		pyplot.subplot(n, n, 1 + i)
		# turn off axis
		pyplot.axis('off')
		# plot raw pixel data
		pyplot.imshow(examples[i])
	# save plot to file
	filename = 'generated_plot_e%03d.png' % (epoch+1)
	pyplot.savefig(filename)
	pyplot.close()

# evaluate the discriminator, plot generated images, save generator model
def summarize_performance(epoch, g_model, d_model, dataset, latent_dim, n_samples=100):
	# prepare real samples
	X_real, y_real = generate_real_samples(dataset, n_samples)
	# evaluate discriminator on real examples
	_, acc_real = d_model.evaluate(X_real, y_real, verbose=0)
	# prepare fake examples
	x_fake, y_fake = generate_fake_samples(g_model, latent_dim, n_samples)
	# evaluate discriminator on fake examples
	_, acc_fake = d_model.evaluate(x_fake, y_fake, verbose=0)
	# summarize discriminator performance
	print('&gt;Accuracy real: %.0f%%, fake: %.0f%%' % (acc_real*100, acc_fake*100))
	# save plot
	save_plot(x_fake, epoch)
	# save the generator model tile file
	filename = 'generator_model_%03d.h5' % (epoch+1)
	g_model.save(filename)

# train the generator and discriminator
def train(g_model, d_model, gan_model, dataset, latent_dim, n_epochs=100, n_batch=128):
	bat_per_epo = int(dataset.shape[0] / n_batch)
	half_batch = int(n_batch / 2)
	# manually enumerate epochs
	for i in range(n_epochs):
		# enumerate batches over the training set
		for j in range(bat_per_epo):
			# get randomly selected 'real' samples
			X_real, y_real = generate_real_samples(dataset, half_batch)
			# update discriminator model weights
			d_loss1, _ = d_model.train_on_batch(X_real, y_real)
			# generate 'fake' examples
			X_fake, y_fake = generate_fake_samples(g_model, latent_dim, half_batch)
			# update discriminator model weights
			d_loss2, _ = d_model.train_on_batch(X_fake, y_fake)
			# prepare points in latent space as input for the generator
			X_gan = generate_latent_points(latent_dim, n_batch)
			# create inverted labels for the fake samples
			y_gan = ones((n_batch, 1))
			# update the generator via the discriminator's error
			g_loss = gan_model.train_on_batch(X_gan, y_gan)
			# summarize loss on this batch
			print('&gt;%d, %d/%d, d1=%.3f, d2=%.3f g=%.3f' %
				(i+1, j+1, bat_per_epo, d_loss1, d_loss2, g_loss))
		# evaluate the model performance, sometimes
		if (i+1) % 10 == 0:
			summarize_performance(i, g_model, d_model, dataset, latent_dim)

# size of the latent space
latent_dim = 100
# create the discriminator
d_model = define_discriminator()
# create the generator
g_model = define_generator(latent_dim)
# create the gan
gan_model = define_gan(g_model, d_model)
# load image data
dataset = load_real_samples()
# train model
train(g_model, d_model, gan_model, dataset, latent_dim)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-30">30</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-31">31</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-32">32</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-33">33</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-34">34</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-35">35</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-36">36</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-37">37</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-38">38</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-39">39</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-40">40</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-41">41</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-42">42</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-43">43</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-44">44</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-45">45</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-46">46</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-47">47</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-48">48</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-49">49</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-50">50</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-51">51</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-52">52</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-53">53</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-54">54</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-55">55</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-56">56</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-57">57</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-58">58</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-59">59</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-60">60</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-61">61</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-62">62</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-63">63</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-64">64</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-65">65</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-66">66</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-67">67</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-68">68</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-69">69</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-70">70</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-71">71</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-72">72</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-73">73</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-74">74</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-75">75</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-76">76</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-77">77</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-78">78</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-79">79</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-80">80</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-81">81</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-82">82</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-83">83</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-84">84</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-85">85</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-86">86</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-87">87</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-88">88</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-89">89</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-90">90</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-91">91</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-92">92</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-93">93</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-94">94</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-95">95</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-96">96</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-97">97</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-98">98</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-99">99</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-100">100</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-101">101</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-102">102</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-103">103</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-104">104</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-105">105</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-106">106</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-107">107</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-108">108</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-109">109</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-110">110</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-111">111</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-112">112</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-113">113</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-114">114</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-115">115</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-116">116</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-117">117</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-118">118</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-119">119</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-120">120</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-121">121</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-122">122</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-123">123</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-124">124</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-125">125</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-126">126</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-127">127</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-128">128</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-129">129</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-130">130</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-131">131</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-132">132</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-133">133</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-134">134</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-135">135</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-136">136</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-137">137</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-138">138</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-139">139</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-140">140</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-141">141</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-142">142</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-143">143</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-144">144</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-145">145</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-146">146</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-147">147</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-148">148</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-149">149</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-150">150</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-151">151</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-152">152</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-153">153</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-154">154</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-155">155</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-156">156</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-157">157</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-158">158</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-159">159</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-160">160</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-161">161</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-162">162</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-163">163</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-164">164</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-165">165</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-166">166</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-167">167</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-168">168</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-169">169</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-170">170</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-171">171</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-172">172</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-173">173</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-174">174</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-175">175</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-176">176</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-177">177</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-178">178</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-179">179</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-180">180</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-181">181</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-182">182</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-183">183</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-184">184</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-185">185</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-186">186</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-187">187</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-188">188</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-189">189</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-190">190</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-191">191</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-192">192</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-193">193</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-194">194</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-195">195</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-196">196</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-197">197</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778c804353094-198">198</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-1"><span class="crayon-p"># example of a gan for generating faces</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-2"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">load</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-3"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">zeros</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-4"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">ones</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-5"><span class="crayon-e">from </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">random </span><span class="crayon-e">import </span><span class="crayon-e">randn</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-6"><span class="crayon-e">from </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">random </span><span class="crayon-e">import </span><span class="crayon-e">randint</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-7"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">optimizers </span><span class="crayon-e">import </span><span class="crayon-e">Adam</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-8"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-9"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-10"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Reshape</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-11"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Flatten</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-12"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Conv2D</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-13"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Conv2DTranspose</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-14"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">LeakyReLU</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-15"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dropout</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-16"><span class="crayon-e">from </span><span class="crayon-e">matplotlib </span><span class="crayon-e">import </span><span class="crayon-i">pyplot</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-17">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-18"><span class="crayon-p"># define the standalone discriminator model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-19"><span class="crayon-e">def </span><span class="crayon-e">define_discriminator</span><span class="crayon-sy">(</span><span class="crayon-v">in_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">80</span><span class="crayon-sy">,</span><span class="crayon-cn">80</span><span class="crayon-sy">,</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-20"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-21"><span class="crayon-h">	</span><span class="crayon-p"># normal</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-22"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">128</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-cn">5</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'same'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_shape</span><span class="crayon-o">=</span><span class="crayon-v">in_shape</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-23"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LeakyReLU</span><span class="crayon-sy">(</span><span class="crayon-v">alpha</span><span class="crayon-o">=</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-24"><span class="crayon-h">	</span><span class="crayon-p"># downsample to 40x40</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-25"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">128</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-cn">5</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">strides</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'same'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-26"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LeakyReLU</span><span class="crayon-sy">(</span><span class="crayon-v">alpha</span><span class="crayon-o">=</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-27"><span class="crayon-h">	</span><span class="crayon-p"># downsample to 20x30</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-28"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">128</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-cn">5</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">strides</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'same'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-29"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LeakyReLU</span><span class="crayon-sy">(</span><span class="crayon-v">alpha</span><span class="crayon-o">=</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-30"><span class="crayon-h">	</span><span class="crayon-p"># downsample to 10x10</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-31"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">128</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-cn">5</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">strides</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'same'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-32"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LeakyReLU</span><span class="crayon-sy">(</span><span class="crayon-v">alpha</span><span class="crayon-o">=</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-33"><span class="crayon-h">	</span><span class="crayon-p"># downsample to 5x5</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-34"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">128</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-cn">5</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">strides</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'same'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-35"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LeakyReLU</span><span class="crayon-sy">(</span><span class="crayon-v">alpha</span><span class="crayon-o">=</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-36"><span class="crayon-h">	</span><span class="crayon-p"># classifier</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-37"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Flatten</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-38"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dropout</span><span class="crayon-sy">(</span><span class="crayon-cn">0.4</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-39"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-40"><span class="crayon-h">	</span><span class="crayon-p"># compile model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-41"><span class="crayon-h">	</span><span class="crayon-v">opt</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Adam</span><span class="crayon-sy">(</span><span class="crayon-v">lr</span><span class="crayon-o">=</span><span class="crayon-cn">0.0002</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">beta_1</span><span class="crayon-o">=</span><span class="crayon-cn">0.5</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-42"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'binary_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-v">opt</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-43"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-44">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-45"><span class="crayon-p"># define the standalone generator model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-46"><span class="crayon-e">def </span><span class="crayon-e">define_generator</span><span class="crayon-sy">(</span><span class="crayon-v">latent_dim</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-47"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-48"><span class="crayon-h">	</span><span class="crayon-p"># foundation for 5x5 feature maps</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-49"><span class="crayon-h">	</span><span class="crayon-v">n_nodes</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">128</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">5</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-50"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-v">n_nodes</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_dim</span><span class="crayon-o">=</span><span class="crayon-v">latent_dim</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-51"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LeakyReLU</span><span class="crayon-sy">(</span><span class="crayon-v">alpha</span><span class="crayon-o">=</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-52"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">128</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-53"><span class="crayon-h">	</span><span class="crayon-p"># upsample to 10x10</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-54"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2DTranspose</span><span class="crayon-sy">(</span><span class="crayon-cn">128</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-cn">4</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">strides</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'same'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-55"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LeakyReLU</span><span class="crayon-sy">(</span><span class="crayon-v">alpha</span><span class="crayon-o">=</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-56"><span class="crayon-h">	</span><span class="crayon-p"># upsample to 20x20</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-57"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2DTranspose</span><span class="crayon-sy">(</span><span class="crayon-cn">128</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-cn">4</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">strides</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'same'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-58"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LeakyReLU</span><span class="crayon-sy">(</span><span class="crayon-v">alpha</span><span class="crayon-o">=</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-59"><span class="crayon-h">	</span><span class="crayon-p"># upsample to 40x40</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-60"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2DTranspose</span><span class="crayon-sy">(</span><span class="crayon-cn">128</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-cn">4</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">strides</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'same'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-61"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LeakyReLU</span><span class="crayon-sy">(</span><span class="crayon-v">alpha</span><span class="crayon-o">=</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-62"><span class="crayon-h">	</span><span class="crayon-p"># upsample to 80x80</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-63"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2DTranspose</span><span class="crayon-sy">(</span><span class="crayon-cn">128</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-cn">4</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">strides</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'same'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-64"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LeakyReLU</span><span class="crayon-sy">(</span><span class="crayon-v">alpha</span><span class="crayon-o">=</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-65"><span class="crayon-h">	</span><span class="crayon-p"># output layer 80x80x3</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-66"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-cn">5</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'tanh'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'same'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-67"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-68">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-69"><span class="crayon-p"># define the combined generator and discriminator model, for updating the generator</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-70"><span class="crayon-e">def </span><span class="crayon-e">define_gan</span><span class="crayon-sy">(</span><span class="crayon-v">g_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">d_model</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-71"><span class="crayon-h">	</span><span class="crayon-p"># make weights in the discriminator not trainable</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-72"><span class="crayon-h">	</span><span class="crayon-v">d_model</span><span class="crayon-sy">.</span><span class="crayon-v">trainable</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">False</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-73"><span class="crayon-h">	</span><span class="crayon-p"># connect them</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-74"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-75"><span class="crayon-h">	</span><span class="crayon-p"># add generator</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-76"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-v">g_model</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-77"><span class="crayon-h">	</span><span class="crayon-p"># add the discriminator</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-78"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-v">d_model</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-79"><span class="crayon-h">	</span><span class="crayon-p"># compile model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-80"><span class="crayon-h">	</span><span class="crayon-v">opt</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Adam</span><span class="crayon-sy">(</span><span class="crayon-v">lr</span><span class="crayon-o">=</span><span class="crayon-cn">0.0002</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">beta_1</span><span class="crayon-o">=</span><span class="crayon-cn">0.5</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-81"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'binary_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-v">opt</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-82"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-83">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-84"><span class="crayon-p"># load and prepare training images</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-85"><span class="crayon-e">def </span><span class="crayon-e">load_real_samples</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-86"><span class="crayon-h">	</span><span class="crayon-p"># load the face dataset</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-87"><span class="crayon-h">	</span><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load</span><span class="crayon-sy">(</span><span class="crayon-s">'img_align_celeba.npz'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-88"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-s">'arr_0'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-89"><span class="crayon-h">	</span><span class="crayon-p"># convert from unsigned ints to floats</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-90"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-91"><span class="crayon-h">	</span><span class="crayon-p"># scale from [0,255] to [-1,1]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-92"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">127.5</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">127.5</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-93"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">X</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-94">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-95"><span class="crayon-p"># select real samples</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-96"><span class="crayon-e">def </span><span class="crayon-e">generate_real_samples</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_samples</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-97"><span class="crayon-h">	</span><span class="crayon-p"># choose random instances</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-98"><span class="crayon-h">	</span><span class="crayon-v">ix</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">randint</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_samples</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-99"><span class="crayon-h">	</span><span class="crayon-p"># retrieve selected images</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-100"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-v">ix</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-101"><span class="crayon-h">	</span><span class="crayon-p"># generate 'real' class labels (1)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-102"><span class="crayon-h">	</span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">ones</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">n_samples</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-103"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">y</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-104">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-105"><span class="crayon-p"># generate points in latent space as input for the generator</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-106"><span class="crayon-e">def </span><span class="crayon-e">generate_latent_points</span><span class="crayon-sy">(</span><span class="crayon-v">latent_dim</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_samples</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-107"><span class="crayon-h">	</span><span class="crayon-p"># generate points in the latent space</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-108"><span class="crayon-h">	</span><span class="crayon-v">x_input</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">randn</span><span class="crayon-sy">(</span><span class="crayon-e ">latent_dim *</span><span class="crayon-h"> </span><span class="crayon-v">n_samples</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-109"><span class="crayon-h">	</span><span class="crayon-p"># reshape into a batch of inputs for the network</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-110"><span class="crayon-h">	</span><span class="crayon-v">x_input</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">x_input</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-v">n_samples</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">latent_dim</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-111"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">_</span>input</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-112">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-113"><span class="crayon-p"># use the generator to generate n fake examples, with class labels</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-114"><span class="crayon-e">def </span><span class="crayon-e">generate_fake_samples</span><span class="crayon-sy">(</span><span class="crayon-v">g_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">latent_dim</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_samples</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-115"><span class="crayon-h">	</span><span class="crayon-p"># generate points in latent space</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-116"><span class="crayon-h">	</span><span class="crayon-v">x_input</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">generate_latent_points</span><span class="crayon-sy">(</span><span class="crayon-v">latent_dim</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_samples</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-117"><span class="crayon-h">	</span><span class="crayon-p"># predict outputs</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-118"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">g_model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">x_input</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-119"><span class="crayon-h">	</span><span class="crayon-p"># create 'fake' class labels (0)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-120"><span class="crayon-h">	</span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">zeros</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">n_samples</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-121"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">y</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-122">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-123"><span class="crayon-p"># create and save a plot of generated images</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-124"><span class="crayon-e">def </span><span class="crayon-e">save_plot</span><span class="crayon-sy">(</span><span class="crayon-v">examples</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epoch</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-125"><span class="crayon-h">	</span><span class="crayon-p"># scale from [-1,1] to [0,1]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-126"><span class="crayon-h">	</span><span class="crayon-v">examples</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">examples</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">2.0</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-127"><span class="crayon-h">	</span><span class="crayon-p"># plot images</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-128"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e ">n *</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-129"><span class="crayon-h">		</span><span class="crayon-p"># define subplot</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-130"><span class="crayon-h">		</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-v">n</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-131"><span class="crayon-h">		</span><span class="crayon-p"># turn off axis</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-132"><span class="crayon-h">		</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">axis</span><span class="crayon-sy">(</span><span class="crayon-s">'off'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-133"><span class="crayon-h">		</span><span class="crayon-p"># plot raw pixel data</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-134"><span class="crayon-h">		</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">imshow</span><span class="crayon-sy">(</span><span class="crayon-v">examples</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-135"><span class="crayon-h">	</span><span class="crayon-p"># save plot to file</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-136"><span class="crayon-h">	</span><span class="crayon-v">filename</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'generated_plot_e%03d.png'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">epoch</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-137"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">savefig</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-138"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">close</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-139">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-140"><span class="crayon-p"># evaluate the discriminator, plot generated images, save generator model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-141"><span class="crayon-e">def </span><span class="crayon-e">summarize_performance</span><span class="crayon-sy">(</span><span class="crayon-v">epoch</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">g_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">d_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">latent_dim</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_samples</span><span class="crayon-o">=</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-142"><span class="crayon-h">	</span><span class="crayon-p"># prepare real samples</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-143"><span class="crayon-h">	</span><span class="crayon-v">X_real</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_real</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">generate_real_samples</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_samples</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-144"><span class="crayon-h">	</span><span class="crayon-p"># evaluate discriminator on real examples</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-145"><span class="crayon-h">	</span><span class="crayon-v">_</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">acc_real</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">d_model</span><span class="crayon-sy">.</span><span class="crayon-e">evaluate</span><span class="crayon-sy">(</span><span class="crayon-v">X_real</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_real</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-146"><span class="crayon-h">	</span><span class="crayon-p"># prepare fake examples</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-147"><span class="crayon-h">	</span><span class="crayon-v">x_fake</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_fake</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">generate_fake_samples</span><span class="crayon-sy">(</span><span class="crayon-v">g_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">latent_dim</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_samples</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-148"><span class="crayon-h">	</span><span class="crayon-p"># evaluate discriminator on fake examples</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-149"><span class="crayon-h">	</span><span class="crayon-v">_</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">acc_fake</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">d_model</span><span class="crayon-sy">.</span><span class="crayon-e">evaluate</span><span class="crayon-sy">(</span><span class="crayon-v">x_fake</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_fake</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-150"><span class="crayon-h">	</span><span class="crayon-p"># summarize discriminator performance</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-151"><span class="crayon-h">	</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'&gt;Accuracy real: %.0f%%, fake: %.0f%%'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e ">acc_real*</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e ">acc_fake*</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-152"><span class="crayon-h">	</span><span class="crayon-p"># save plot</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-153"><span class="crayon-h">	</span><span class="crayon-e">save_plot</span><span class="crayon-sy">(</span><span class="crayon-v">x_fake</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epoch</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-154"><span class="crayon-h">	</span><span class="crayon-p"># save the generator model tile file</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-155"><span class="crayon-h">	</span><span class="crayon-v">filename</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'generator_model_%03d.h5'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">epoch</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-156"><span class="crayon-h">	</span><span class="crayon-v">g_model</span><span class="crayon-sy">.</span><span class="crayon-e">save</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-157">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-158"><span class="crayon-p"># train the generator and discriminator</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-159"><span class="crayon-e">def </span><span class="crayon-e">train</span><span class="crayon-sy">(</span><span class="crayon-v">g_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">d_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">gan_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">latent_dim</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_epochs</span><span class="crayon-o">=</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_batch</span><span class="crayon-o">=</span><span class="crayon-cn">128</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-160"><span class="crayon-h">	</span><span class="crayon-v">bat_per_epo</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-v">n_batch</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-161"><span class="crayon-h">	</span><span class="crayon-v">half_batch</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-v">n_batch</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-162"><span class="crayon-h">	</span><span class="crayon-p"># manually enumerate epochs</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-163"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_epochs</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-164"><span class="crayon-h">		</span><span class="crayon-p"># enumerate batches over the training set</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-165"><span class="crayon-h">		</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">bat_per_epo</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-166"><span class="crayon-h">			</span><span class="crayon-p"># get randomly selected 'real' samples</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-167"><span class="crayon-h">			</span><span class="crayon-v">X_real</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_real</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">generate_real_samples</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">half_batch</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-168"><span class="crayon-h">			</span><span class="crayon-p"># update discriminator model weights</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-169"><span class="crayon-h">			</span><span class="crayon-v">d_loss1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">_</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">d_model</span><span class="crayon-sy">.</span><span class="crayon-e">train_on_batch</span><span class="crayon-sy">(</span><span class="crayon-v">X_real</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_real</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-170"><span class="crayon-h">			</span><span class="crayon-p"># generate 'fake' examples</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-171"><span class="crayon-h">			</span><span class="crayon-v">X_fake</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_fake</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">generate_fake_samples</span><span class="crayon-sy">(</span><span class="crayon-v">g_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">latent_dim</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">half_batch</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-172"><span class="crayon-h">			</span><span class="crayon-p"># update discriminator model weights</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-173"><span class="crayon-h">			</span><span class="crayon-v">d_loss2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">_</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">d_model</span><span class="crayon-sy">.</span><span class="crayon-e">train_on_batch</span><span class="crayon-sy">(</span><span class="crayon-v">X_fake</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_fake</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-174"><span class="crayon-h">			</span><span class="crayon-p"># prepare points in latent space as input for the generator</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-175"><span class="crayon-h">			</span><span class="crayon-v">X_gan</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">generate_latent_points</span><span class="crayon-sy">(</span><span class="crayon-v">latent_dim</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_batch</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-176"><span class="crayon-h">			</span><span class="crayon-p"># create inverted labels for the fake samples</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-177"><span class="crayon-h">			</span><span class="crayon-v">y_gan</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">ones</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">n_batch</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-178"><span class="crayon-h">			</span><span class="crayon-p"># update the generator via the discriminator's error</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-179"><span class="crayon-h">			</span><span class="crayon-v">g_loss</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">gan_model</span><span class="crayon-sy">.</span><span class="crayon-e">train_on_batch</span><span class="crayon-sy">(</span><span class="crayon-v">X_gan</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_gan</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-180"><span class="crayon-h">			</span><span class="crayon-p"># summarize loss on this batch</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-181"><span class="crayon-h">			</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'&gt;%d, %d/%d, d1=%.3f, d2=%.3f g=%.3f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-182"><span class="crayon-h">				</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">j</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">bat_per_epo</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">d_loss1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">d_loss2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">g_loss</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-183"><span class="crayon-h">		</span><span class="crayon-p"># evaluate the model performance, sometimes</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-184"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-185"><span class="crayon-h">			</span><span class="crayon-e">summarize_performance</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">g_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">d_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">latent_dim</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-186">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-187"><span class="crayon-p"># size of the latent space</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-188"><span class="crayon-v">latent_dim</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">100</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-189"><span class="crayon-p"># create the discriminator</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-190"><span class="crayon-v">d_model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">define_discriminator</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-191"><span class="crayon-p"># create the generator</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-192"><span class="crayon-v">g_model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">define_generator</span><span class="crayon-sy">(</span><span class="crayon-v">latent_dim</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-193"><span class="crayon-p"># create the gan</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-194"><span class="crayon-v">gan_model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">define_gan</span><span class="crayon-sy">(</span><span class="crayon-v">g_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">d_model</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-195"><span class="crayon-p"># load image data</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-196"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_real_samples</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778c804353094-197"><span class="crayon-p"># train model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778c804353094-198"><span class="crayon-e">train</span><span class="crayon-sy">(</span><span class="crayon-v">g_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">d_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">gan_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">latent_dim</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Running the example may take a long time on modest hardware.</p>
<p>I recommend running the example on GPU hardware. If you need help, you can get started quickly by using an AWS EC2 instance to train the model. See the tutorial:</p>
<ul>
<li><a href="https://machinelearningmastery.com/develop-evaluate-large-deep-learning-models-keras-amazon-web-services/">How to Setup Amazon AWS EC2 GPUs to Train Keras Deep Learning Models (step-by-step)</a></li>
</ul>
<p><strong>Note</strong>: Your <a href="https://machinelearningmastery.com/different-results-each-time-in-machine-learning/">results may vary</a> given the stochastic nature of the algorithm or evaluation procedure, or differences in numerical precision. Consider running the example a few times and compare the average outcome.</p>

<p>The loss for the discriminator on real and fake samples, as well as the loss for the generator, is reported after each batch.</p>
		<div id="urvanov-syntax-highlighter-60654e779778d246307256" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0;">&gt;1, 1/390, d1=0.699, d2=0.696 g=0.692
&gt;1, 2/390, d1=0.541, d2=0.702 g=0.686
&gt;1, 3/390, d1=0.213, d2=0.742 g=0.656
&gt;1, 4/390, d1=0.013, d2=0.806 g=0.656
&gt;1, 5/390, d1=0.012, d2=0.772 g=0.682
...</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778d246307256-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778d246307256-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778d246307256-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778d246307256-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778d246307256-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778d246307256-6">6</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778d246307256-1">&gt;1, 1/390, d1=0.699, d2=0.696 g=0.692</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778d246307256-2">&gt;1, 2/390, d1=0.541, d2=0.702 g=0.686</div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778d246307256-3">&gt;1, 3/390, d1=0.213, d2=0.742 g=0.656</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778d246307256-4">&gt;1, 4/390, d1=0.013, d2=0.806 g=0.656</div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778d246307256-5">&gt;1, 5/390, d1=0.012, d2=0.772 g=0.682</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778d246307256-6">...</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>The discriminator loss may crash down to values of 0.0 for real and generated samples.</p>
<p>If this happens, it is an example of a training failure from which the model is likely to not recover and you should restart the training process.</p>
		<div id="urvanov-syntax-highlighter-60654e779778e504006336" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0;">...
&gt;34, 130/390, d1=0.844, d2=8.434 g=3.450
&gt;34, 131/390, d1=1.233, d2=12.021 g=3.541
&gt;34, 132/390, d1=1.183, d2=15.759 g=0.000
&gt;34, 133/390, d1=0.000, d2=15.942 g=0.006
&gt;34, 134/390, d1=0.081, d2=15.942 g=0.000
&gt;34, 135/390, d1=0.000, d2=15.942 g=0.000
...</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778e504006336-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778e504006336-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778e504006336-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778e504006336-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778e504006336-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778e504006336-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778e504006336-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778e504006336-8">8</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778e504006336-1">...</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778e504006336-2">&gt;34, 130/390, d1=0.844, d2=8.434 g=3.450</div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778e504006336-3">&gt;34, 131/390, d1=1.233, d2=12.021 g=3.541</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778e504006336-4">&gt;34, 132/390, d1=1.183, d2=15.759 g=0.000</div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778e504006336-5">&gt;34, 133/390, d1=0.000, d2=15.942 g=0.006</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778e504006336-6">&gt;34, 134/390, d1=0.081, d2=15.942 g=0.000</div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778e504006336-7">&gt;34, 135/390, d1=0.000, d2=15.942 g=0.000</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778e504006336-8">...</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Review the generated plots and select a model based on the best quality images.</p>
<p>The model should begin to generate faces after about 30 training epochs.</p>
<p>The faces are not completely clear, but it is obvious that they are faces, with all the right things (hair, eyes, nose, mouth) in roughly the right places.</p>
<div id="attachment_8144" style="width: 650px" class="wp-caption aligncenter"><img aria-describedby="caption-attachment-8144" loading="lazy" class="size-full wp-image-8144" src="./How to Explore the GAN Latent Space When Generating Faces_files/Example-of-Celebrity-Faces-Generated-by-a-Generative-Adversarial-Network.webp" alt="Example of Celebrity Faces Generated by a Generative Adversarial Network" width="640" height="480" srcset="https://machinelearningmastery.com/wp-content/uploads/2019/05/Example-of-Celebrity-Faces-Generated-by-a-Generative-Adversarial-Network.png 640w, https://machinelearningmastery.com/wp-content/uploads/2019/05/Example-of-Celebrity-Faces-Generated-by-a-Generative-Adversarial-Network-300x225.png 300w" sizes="(max-width: 640px) 100vw, 640px"><p id="caption-attachment-8144" class="wp-caption-text">Example of Celebrity Faces Generated by a Generative Adversarial Network</p></div>
<h2>How to Explore the Latent Space for Generated Faces</h2>
<p>In this section, we will use our trained GAN model as the basis for exploring the latent space.</p>
<h3>How to Load Model and Generate Faces</h3>
<p>The first step is to load the saved model and confirm that it can generate plausible faces.</p>
<p>The model can be loaded using the <em>load_model()</em> function in the Keras API. We can then generate a number of random points in the latent space and use them as input to the loaded model to generate new faces. The faces can then be plotted.</p>
<p>The complete example is listed below.</p>
		<div id="urvanov-syntax-highlighter-60654e779778f776196962" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0;"># example of loading the generator model and generating images
from numpy import asarray
from numpy.random import randn
from numpy.random import randint
from keras.models import load_model
from matplotlib import pyplot

# generate points in latent space as input for the generator
def generate_latent_points(latent_dim, n_samples, n_classes=10):
	# generate points in the latent space
	x_input = randn(latent_dim * n_samples)
	# reshape into a batch of inputs for the network
	z_input = x_input.reshape(n_samples, latent_dim)
	return z_input

# create a plot of generated images
def plot_generated(examples, n):
	# plot images
	for i in range(n * n):
		# define subplot
		pyplot.subplot(n, n, 1 + i)
		# turn off axis
		pyplot.axis('off')
		# plot raw pixel data
		pyplot.imshow(examples[i, :, :])
	pyplot.show()

# load model
model = load_model('generator_model_030.h5')
# generate images
latent_points = generate_latent_points(100, 25)
# generate images
X  = model.predict(latent_points)
# scale from [-1,1] to [0,1]
X = (X + 1) / 2.0
# plot the result
plot_generated(X, 5)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778f776196962-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778f776196962-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778f776196962-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778f776196962-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778f776196962-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778f776196962-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778f776196962-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778f776196962-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778f776196962-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778f776196962-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778f776196962-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778f776196962-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778f776196962-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778f776196962-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778f776196962-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778f776196962-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778f776196962-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778f776196962-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778f776196962-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778f776196962-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778f776196962-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778f776196962-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778f776196962-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778f776196962-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778f776196962-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778f776196962-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778f776196962-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778f776196962-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778f776196962-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778f776196962-30">30</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778f776196962-31">31</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778f776196962-32">32</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778f776196962-33">33</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778f776196962-34">34</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778f776196962-35">35</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779778f776196962-36">36</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779778f776196962-37">37</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778f776196962-1"><span class="crayon-p"># example of loading the generator model and generating images</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778f776196962-2"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">asarray</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778f776196962-3"><span class="crayon-e">from </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">random </span><span class="crayon-e">import </span><span class="crayon-e">randn</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778f776196962-4"><span class="crayon-e">from </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">random </span><span class="crayon-e">import </span><span class="crayon-e">randint</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778f776196962-5"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">load_model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778f776196962-6"><span class="crayon-e">from </span><span class="crayon-e">matplotlib </span><span class="crayon-e">import </span><span class="crayon-i">pyplot</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778f776196962-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778f776196962-8"><span class="crayon-p"># generate points in latent space as input for the generator</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778f776196962-9"><span class="crayon-e">def </span><span class="crayon-e">generate_latent_points</span><span class="crayon-sy">(</span><span class="crayon-v">latent_dim</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_samples</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_classes</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778f776196962-10"><span class="crayon-h">	</span><span class="crayon-p"># generate points in the latent space</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778f776196962-11"><span class="crayon-h">	</span><span class="crayon-v">x_input</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">randn</span><span class="crayon-sy">(</span><span class="crayon-e ">latent_dim *</span><span class="crayon-h"> </span><span class="crayon-v">n_samples</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778f776196962-12"><span class="crayon-h">	</span><span class="crayon-p"># reshape into a batch of inputs for the network</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778f776196962-13"><span class="crayon-h">	</span><span class="crayon-v">z_input</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">x_input</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-v">n_samples</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">latent_dim</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778f776196962-14"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">z</span><span class="crayon-sy">_</span>input</div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778f776196962-15">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778f776196962-16"><span class="crayon-p"># create a plot of generated images</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778f776196962-17"><span class="crayon-e">def </span><span class="crayon-e">plot_generated</span><span class="crayon-sy">(</span><span class="crayon-v">examples</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778f776196962-18"><span class="crayon-h">	</span><span class="crayon-p"># plot images</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778f776196962-19"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e ">n *</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778f776196962-20"><span class="crayon-h">		</span><span class="crayon-p"># define subplot</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778f776196962-21"><span class="crayon-h">		</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-v">n</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778f776196962-22"><span class="crayon-h">		</span><span class="crayon-p"># turn off axis</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778f776196962-23"><span class="crayon-h">		</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">axis</span><span class="crayon-sy">(</span><span class="crayon-s">'off'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778f776196962-24"><span class="crayon-h">		</span><span class="crayon-p"># plot raw pixel data</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778f776196962-25"><span class="crayon-h">		</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">imshow</span><span class="crayon-sy">(</span><span class="crayon-v">examples</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778f776196962-26"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778f776196962-27">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778f776196962-28"><span class="crayon-p"># load model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778f776196962-29"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_model</span><span class="crayon-sy">(</span><span class="crayon-s">'generator_model_030.h5'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778f776196962-30"><span class="crayon-p"># generate images</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778f776196962-31"><span class="crayon-v">latent_points</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">generate_latent_points</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">25</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778f776196962-32"><span class="crayon-p"># generate images</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778f776196962-33"><span class="crayon-v">X</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">latent_points</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778f776196962-34"><span class="crayon-p"># scale from [-1,1] to [0,1]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778f776196962-35"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">2.0</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779778f776196962-36"><span class="crayon-p"># plot the result</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779778f776196962-37"><span class="crayon-e">plot_generated</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Running the example first loads the saved model.</p>
<p><strong>Note</strong>: Your <a href="https://machinelearningmastery.com/different-results-each-time-in-machine-learning/">results may vary</a> given the stochastic nature of the algorithm or evaluation procedure, or differences in numerical precision. Consider running the example a few times and compare the average outcome.</p>

<p>Then, 25 random points in the 100-dimensional latent space are created, provided to the generator model to create 25 images of faces, which are then plotted in a 5×5 grid.</p>
<div id="attachment_8145" style="width: 1034px" class="wp-caption aligncenter"><img aria-describedby="caption-attachment-8145" loading="lazy" class="size-large wp-image-8145" src="./How to Explore the GAN Latent Space When Generating Faces_files/Plot-of-Randomly-Generated-Faces-Using-the-Loaded-GAN-Model-1024x768.png" alt="Plot of Randomly Generated Faces Using the Loaded GAN Model" width="1024" height="768" srcset="https://machinelearningmastery.com/wp-content/uploads/2019/05/Plot-of-Randomly-Generated-Faces-Using-the-Loaded-GAN-Model-1024x768.png 1024w, https://machinelearningmastery.com/wp-content/uploads/2019/05/Plot-of-Randomly-Generated-Faces-Using-the-Loaded-GAN-Model-300x225.png 300w, https://machinelearningmastery.com/wp-content/uploads/2019/05/Plot-of-Randomly-Generated-Faces-Using-the-Loaded-GAN-Model-768x576.png 768w, https://machinelearningmastery.com/wp-content/uploads/2019/05/Plot-of-Randomly-Generated-Faces-Using-the-Loaded-GAN-Model.png 1280w" sizes="(max-width: 1024px) 100vw, 1024px"><p id="caption-attachment-8145" class="wp-caption-text">Plot of Randomly Generated Faces Using the Loaded GAN Model</p></div>
<h3>How to Interpolate Between Generated Faces</h3>
<p>Next, we can create an interpolation path between two points in the latent space and generate faces along this path.</p>
<p>The simplest interpolation we can use is a linear or uniform interpolation between two points in the latent space. We can achieve this using the <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.linspace.html">linspace() NumPy function</a> to calculate ratios of the contribution from two points, then enumerate these ratios and construct a vector for each ratio.</p>
<p>The <em>interpolate_points()</em> function below implements this and returns a series of linearly interpolated vectors between two points in latent space, including the first and last point.</p>
		<div id="urvanov-syntax-highlighter-60654e7797790999152300" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0;"># uniform interpolation between two points in latent space
def interpolate_points(p1, p2, n_steps=10):
	# interpolate ratios between the points
	ratios = linspace(0, 1, num=n_steps)
	# linear interpolate vectors
	vectors = list()
	for ratio in ratios:
		v = (1.0 - ratio) * p1 + ratio * p2
		vectors.append(v)
	return asarray(vectors)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797790999152300-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797790999152300-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797790999152300-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797790999152300-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797790999152300-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797790999152300-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797790999152300-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797790999152300-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797790999152300-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797790999152300-10">10</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797790999152300-1"><span class="crayon-p"># uniform interpolation between two points in latent space</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797790999152300-2"><span class="crayon-e">def </span><span class="crayon-e">interpolate_points</span><span class="crayon-sy">(</span><span class="crayon-v">p1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">p2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797790999152300-3"><span class="crayon-h">	</span><span class="crayon-p"># interpolate ratios between the points</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797790999152300-4"><span class="crayon-h">	</span><span class="crayon-v">ratios</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">linspace</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">num</span><span class="crayon-o">=</span><span class="crayon-v">n_steps</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797790999152300-5"><span class="crayon-h">	</span><span class="crayon-p"># linear interpolate vectors</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797790999152300-6"><span class="crayon-h">	</span><span class="crayon-v">vectors</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797790999152300-7"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">ratio </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">ratios</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797790999152300-8"><span class="crayon-h">		</span><span class="crayon-v">v</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1.0</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">ratio</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">p1</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e ">ratio *</span><span class="crayon-h"> </span><span class="crayon-e">p2</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797790999152300-9"><span class="crayon-e">		</span><span class="crayon-v">vectors</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">v</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797790999152300-10"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">asarray</span><span class="crayon-sy">(</span><span class="crayon-v">vectors</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>We can then generate two points in the latent space, perform the interpolation, then generate an image for each interpolated vector.</p>
<p>The result will be a series of images that transition between the two original images. The example below demonstrates this for two faces.</p>
		<div id="urvanov-syntax-highlighter-60654e7797791830977165" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0;"># example of interpolating between generated faces
from numpy import asarray
from numpy.random import randn
from numpy.random import randint
from numpy import linspace
from keras.models import load_model
from matplotlib import pyplot

# generate points in latent space as input for the generator
def generate_latent_points(latent_dim, n_samples, n_classes=10):
	# generate points in the latent space
	x_input = randn(latent_dim * n_samples)
	# reshape into a batch of inputs for the network
	z_input = x_input.reshape(n_samples, latent_dim)
	return z_input

# uniform interpolation between two points in latent space
def interpolate_points(p1, p2, n_steps=10):
	# interpolate ratios between the points
	ratios = linspace(0, 1, num=n_steps)
	# linear interpolate vectors
	vectors = list()
	for ratio in ratios:
		v = (1.0 - ratio) * p1 + ratio * p2
		vectors.append(v)
	return asarray(vectors)

# create a plot of generated images
def plot_generated(examples, n):
	# plot images
	for i in range(n):
		# define subplot
		pyplot.subplot(1, n, 1 + i)
		# turn off axis
		pyplot.axis('off')
		# plot raw pixel data
		pyplot.imshow(examples[i, :, :])
	pyplot.show()

# load model
model = load_model('generator_model_030.h5')
# generate points in latent space
pts = generate_latent_points(100, 2)
# interpolate points in latent space
interpolated = interpolate_points(pts[0], pts[1])
# generate images
X = model.predict(interpolated)
# scale from [-1,1] to [0,1]
X = (X + 1) / 2.0
# plot the result
plot_generated(X, len(interpolated))</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797791830977165-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797791830977165-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797791830977165-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797791830977165-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797791830977165-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797791830977165-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797791830977165-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797791830977165-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797791830977165-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797791830977165-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797791830977165-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797791830977165-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797791830977165-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797791830977165-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797791830977165-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797791830977165-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797791830977165-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797791830977165-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797791830977165-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797791830977165-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797791830977165-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797791830977165-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797791830977165-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797791830977165-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797791830977165-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797791830977165-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797791830977165-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797791830977165-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797791830977165-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797791830977165-30">30</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797791830977165-31">31</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797791830977165-32">32</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797791830977165-33">33</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797791830977165-34">34</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797791830977165-35">35</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797791830977165-36">36</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797791830977165-37">37</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797791830977165-38">38</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797791830977165-39">39</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797791830977165-40">40</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797791830977165-41">41</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797791830977165-42">42</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797791830977165-43">43</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797791830977165-44">44</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797791830977165-45">45</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797791830977165-46">46</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797791830977165-47">47</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797791830977165-48">48</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797791830977165-49">49</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797791830977165-50">50</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797791830977165-51">51</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797791830977165-1"><span class="crayon-p"># example of interpolating between generated faces</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797791830977165-2"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">asarray</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797791830977165-3"><span class="crayon-e">from </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">random </span><span class="crayon-e">import </span><span class="crayon-e">randn</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797791830977165-4"><span class="crayon-e">from </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">random </span><span class="crayon-e">import </span><span class="crayon-e">randint</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797791830977165-5"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">linspace</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797791830977165-6"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">load_model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797791830977165-7"><span class="crayon-e">from </span><span class="crayon-e">matplotlib </span><span class="crayon-e">import </span><span class="crayon-i">pyplot</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797791830977165-8">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797791830977165-9"><span class="crayon-p"># generate points in latent space as input for the generator</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797791830977165-10"><span class="crayon-e">def </span><span class="crayon-e">generate_latent_points</span><span class="crayon-sy">(</span><span class="crayon-v">latent_dim</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_samples</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_classes</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797791830977165-11"><span class="crayon-h">	</span><span class="crayon-p"># generate points in the latent space</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797791830977165-12"><span class="crayon-h">	</span><span class="crayon-v">x_input</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">randn</span><span class="crayon-sy">(</span><span class="crayon-e ">latent_dim *</span><span class="crayon-h"> </span><span class="crayon-v">n_samples</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797791830977165-13"><span class="crayon-h">	</span><span class="crayon-p"># reshape into a batch of inputs for the network</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797791830977165-14"><span class="crayon-h">	</span><span class="crayon-v">z_input</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">x_input</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-v">n_samples</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">latent_dim</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797791830977165-15"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">z</span><span class="crayon-sy">_</span>input</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797791830977165-16">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797791830977165-17"><span class="crayon-p"># uniform interpolation between two points in latent space</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797791830977165-18"><span class="crayon-e">def </span><span class="crayon-e">interpolate_points</span><span class="crayon-sy">(</span><span class="crayon-v">p1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">p2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797791830977165-19"><span class="crayon-h">	</span><span class="crayon-p"># interpolate ratios between the points</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797791830977165-20"><span class="crayon-h">	</span><span class="crayon-v">ratios</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">linspace</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">num</span><span class="crayon-o">=</span><span class="crayon-v">n_steps</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797791830977165-21"><span class="crayon-h">	</span><span class="crayon-p"># linear interpolate vectors</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797791830977165-22"><span class="crayon-h">	</span><span class="crayon-v">vectors</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797791830977165-23"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">ratio </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">ratios</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797791830977165-24"><span class="crayon-h">		</span><span class="crayon-v">v</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1.0</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">ratio</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">p1</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e ">ratio *</span><span class="crayon-h"> </span><span class="crayon-e">p2</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797791830977165-25"><span class="crayon-e">		</span><span class="crayon-v">vectors</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">v</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797791830977165-26"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">asarray</span><span class="crayon-sy">(</span><span class="crayon-v">vectors</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797791830977165-27">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797791830977165-28"><span class="crayon-p"># create a plot of generated images</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797791830977165-29"><span class="crayon-e">def </span><span class="crayon-e">plot_generated</span><span class="crayon-sy">(</span><span class="crayon-v">examples</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797791830977165-30"><span class="crayon-h">	</span><span class="crayon-p"># plot images</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797791830977165-31"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797791830977165-32"><span class="crayon-h">		</span><span class="crayon-p"># define subplot</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797791830977165-33"><span class="crayon-h">		</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797791830977165-34"><span class="crayon-h">		</span><span class="crayon-p"># turn off axis</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797791830977165-35"><span class="crayon-h">		</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">axis</span><span class="crayon-sy">(</span><span class="crayon-s">'off'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797791830977165-36"><span class="crayon-h">		</span><span class="crayon-p"># plot raw pixel data</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797791830977165-37"><span class="crayon-h">		</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">imshow</span><span class="crayon-sy">(</span><span class="crayon-v">examples</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797791830977165-38"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797791830977165-39">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797791830977165-40"><span class="crayon-p"># load model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797791830977165-41"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_model</span><span class="crayon-sy">(</span><span class="crayon-s">'generator_model_030.h5'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797791830977165-42"><span class="crayon-p"># generate points in latent space</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797791830977165-43"><span class="crayon-v">pts</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">generate_latent_points</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797791830977165-44"><span class="crayon-p"># interpolate points in latent space</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797791830977165-45"><span class="crayon-v">interpolated</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">interpolate_points</span><span class="crayon-sy">(</span><span class="crayon-v">pts</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">pts</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797791830977165-46"><span class="crayon-p"># generate images</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797791830977165-47"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">interpolated</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797791830977165-48"><span class="crayon-p"># scale from [-1,1] to [0,1]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797791830977165-49"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">2.0</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797791830977165-50"><span class="crayon-p"># plot the result</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797791830977165-51"><span class="crayon-e">plot_generated</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">interpolated</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Running the example calculates the interpolation path between the two points in latent space, generates images for each, and plots the result.</p>
<p>You can see the clear linear progression in ten steps from the first face on the left to the final face on the right.</p>
<div id="attachment_8146" style="width: 1034px" class="wp-caption aligncenter"><img aria-describedby="caption-attachment-8146" loading="lazy" class="size-large wp-image-8146" src="./How to Explore the GAN Latent Space When Generating Faces_files/Plot-Showing-the-Linear-Interpolation-Between-Two-GAN-Generated-Faces-1024x768.png" alt="Plot Showing the Linear Interpolation Between Two GAN Generated Faces" width="1024" height="768" srcset="https://machinelearningmastery.com/wp-content/uploads/2019/05/Plot-Showing-the-Linear-Interpolation-Between-Two-GAN-Generated-Faces-1024x768.png 1024w, https://machinelearningmastery.com/wp-content/uploads/2019/05/Plot-Showing-the-Linear-Interpolation-Between-Two-GAN-Generated-Faces-300x225.png 300w, https://machinelearningmastery.com/wp-content/uploads/2019/05/Plot-Showing-the-Linear-Interpolation-Between-Two-GAN-Generated-Faces-768x576.png 768w, https://machinelearningmastery.com/wp-content/uploads/2019/05/Plot-Showing-the-Linear-Interpolation-Between-Two-GAN-Generated-Faces.png 1280w" sizes="(max-width: 1024px) 100vw, 1024px"><p id="caption-attachment-8146" class="wp-caption-text">Plot Showing the Linear Interpolation Between Two GAN Generated Faces</p></div>
<p>We can update the example to repeat this process multiple times so we can see the transition between multiple generated faces on a single plot.</p>
<p>The complete example is listed below.</p>
		<div id="urvanov-syntax-highlighter-60654e7797792573975615" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0;"># example of interpolating between generated faces
from numpy import asarray
from numpy import vstack
from numpy.random import randn
from numpy.random import randint
from numpy import linspace
from keras.models import load_model
from matplotlib import pyplot

# generate points in latent space as input for the generator
def generate_latent_points(latent_dim, n_samples, n_classes=10):
	# generate points in the latent space
	x_input = randn(latent_dim * n_samples)
	# reshape into a batch of inputs for the network
	z_input = x_input.reshape(n_samples, latent_dim)
	return z_input

# uniform interpolation between two points in latent space
def interpolate_points(p1, p2, n_steps=10):
	# interpolate ratios between the points
	ratios = linspace(0, 1, num=n_steps)
	# linear interpolate vectors
	vectors = list()
	for ratio in ratios:
		v = (1.0 - ratio) * p1 + ratio * p2
		vectors.append(v)
	return asarray(vectors)

# create a plot of generated images
def plot_generated(examples, n):
	# plot images
	for i in range(n * n):
		# define subplot
		pyplot.subplot(n, n, 1 + i)
		# turn off axis
		pyplot.axis('off')
		# plot raw pixel data
		pyplot.imshow(examples[i, :, :])
	pyplot.show()

# load model
model = load_model('generator_model_030.h5')
# generate points in latent space
n = 20
pts = generate_latent_points(100, n)
# interpolate pairs
results = None
for i in range(0, n, 2):
	# interpolate points in latent space
	interpolated = interpolate_points(pts[i], pts[i+1])
	# generate images
	X = model.predict(interpolated)
	# scale from [-1,1] to [0,1]
	X = (X + 1) / 2.0
	if results is None:
		results = X
	else:
		results = vstack((results, X))
# plot the result
plot_generated(results, 10)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797792573975615-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797792573975615-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797792573975615-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797792573975615-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797792573975615-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797792573975615-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797792573975615-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797792573975615-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797792573975615-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797792573975615-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797792573975615-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797792573975615-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797792573975615-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797792573975615-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797792573975615-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797792573975615-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797792573975615-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797792573975615-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797792573975615-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797792573975615-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797792573975615-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797792573975615-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797792573975615-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797792573975615-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797792573975615-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797792573975615-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797792573975615-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797792573975615-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797792573975615-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797792573975615-30">30</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797792573975615-31">31</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797792573975615-32">32</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797792573975615-33">33</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797792573975615-34">34</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797792573975615-35">35</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797792573975615-36">36</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797792573975615-37">37</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797792573975615-38">38</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797792573975615-39">39</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797792573975615-40">40</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797792573975615-41">41</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797792573975615-42">42</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797792573975615-43">43</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797792573975615-44">44</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797792573975615-45">45</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797792573975615-46">46</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797792573975615-47">47</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797792573975615-48">48</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797792573975615-49">49</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797792573975615-50">50</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797792573975615-51">51</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797792573975615-52">52</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797792573975615-53">53</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797792573975615-54">54</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797792573975615-55">55</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797792573975615-56">56</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797792573975615-57">57</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797792573975615-58">58</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797792573975615-59">59</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797792573975615-60">60</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797792573975615-1"><span class="crayon-p"># example of interpolating between generated faces</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797792573975615-2"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">asarray</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797792573975615-3"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">vstack</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797792573975615-4"><span class="crayon-e">from </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">random </span><span class="crayon-e">import </span><span class="crayon-e">randn</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797792573975615-5"><span class="crayon-e">from </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">random </span><span class="crayon-e">import </span><span class="crayon-e">randint</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797792573975615-6"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">linspace</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797792573975615-7"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">load_model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797792573975615-8"><span class="crayon-e">from </span><span class="crayon-e">matplotlib </span><span class="crayon-e">import </span><span class="crayon-i">pyplot</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797792573975615-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797792573975615-10"><span class="crayon-p"># generate points in latent space as input for the generator</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797792573975615-11"><span class="crayon-e">def </span><span class="crayon-e">generate_latent_points</span><span class="crayon-sy">(</span><span class="crayon-v">latent_dim</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_samples</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_classes</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797792573975615-12"><span class="crayon-h">	</span><span class="crayon-p"># generate points in the latent space</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797792573975615-13"><span class="crayon-h">	</span><span class="crayon-v">x_input</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">randn</span><span class="crayon-sy">(</span><span class="crayon-e ">latent_dim *</span><span class="crayon-h"> </span><span class="crayon-v">n_samples</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797792573975615-14"><span class="crayon-h">	</span><span class="crayon-p"># reshape into a batch of inputs for the network</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797792573975615-15"><span class="crayon-h">	</span><span class="crayon-v">z_input</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">x_input</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-v">n_samples</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">latent_dim</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797792573975615-16"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">z</span><span class="crayon-sy">_</span>input</div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797792573975615-17">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797792573975615-18"><span class="crayon-p"># uniform interpolation between two points in latent space</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797792573975615-19"><span class="crayon-e">def </span><span class="crayon-e">interpolate_points</span><span class="crayon-sy">(</span><span class="crayon-v">p1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">p2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797792573975615-20"><span class="crayon-h">	</span><span class="crayon-p"># interpolate ratios between the points</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797792573975615-21"><span class="crayon-h">	</span><span class="crayon-v">ratios</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">linspace</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">num</span><span class="crayon-o">=</span><span class="crayon-v">n_steps</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797792573975615-22"><span class="crayon-h">	</span><span class="crayon-p"># linear interpolate vectors</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797792573975615-23"><span class="crayon-h">	</span><span class="crayon-v">vectors</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797792573975615-24"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">ratio </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">ratios</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797792573975615-25"><span class="crayon-h">		</span><span class="crayon-v">v</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1.0</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">ratio</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">p1</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e ">ratio *</span><span class="crayon-h"> </span><span class="crayon-e">p2</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797792573975615-26"><span class="crayon-e">		</span><span class="crayon-v">vectors</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">v</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797792573975615-27"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">asarray</span><span class="crayon-sy">(</span><span class="crayon-v">vectors</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797792573975615-28">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797792573975615-29"><span class="crayon-p"># create a plot of generated images</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797792573975615-30"><span class="crayon-e">def </span><span class="crayon-e">plot_generated</span><span class="crayon-sy">(</span><span class="crayon-v">examples</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797792573975615-31"><span class="crayon-h">	</span><span class="crayon-p"># plot images</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797792573975615-32"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e ">n *</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797792573975615-33"><span class="crayon-h">		</span><span class="crayon-p"># define subplot</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797792573975615-34"><span class="crayon-h">		</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-v">n</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797792573975615-35"><span class="crayon-h">		</span><span class="crayon-p"># turn off axis</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797792573975615-36"><span class="crayon-h">		</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">axis</span><span class="crayon-sy">(</span><span class="crayon-s">'off'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797792573975615-37"><span class="crayon-h">		</span><span class="crayon-p"># plot raw pixel data</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797792573975615-38"><span class="crayon-h">		</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">imshow</span><span class="crayon-sy">(</span><span class="crayon-v">examples</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797792573975615-39"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797792573975615-40">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797792573975615-41"><span class="crayon-p"># load model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797792573975615-42"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_model</span><span class="crayon-sy">(</span><span class="crayon-s">'generator_model_030.h5'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797792573975615-43"><span class="crayon-p"># generate points in latent space</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797792573975615-44"><span class="crayon-v">n</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">20</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797792573975615-45"><span class="crayon-v">pts</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">generate_latent_points</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797792573975615-46"><span class="crayon-p"># interpolate pairs</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797792573975615-47"><span class="crayon-v">results</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">None</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797792573975615-48"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797792573975615-49"><span class="crayon-h">	</span><span class="crayon-p"># interpolate points in latent space</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797792573975615-50"><span class="crayon-h">	</span><span class="crayon-v">interpolated</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">interpolate_points</span><span class="crayon-sy">(</span><span class="crayon-v">pts</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">pts</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797792573975615-51"><span class="crayon-h">	</span><span class="crayon-p"># generate images</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797792573975615-52"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">interpolated</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797792573975615-53"><span class="crayon-h">	</span><span class="crayon-p"># scale from [-1,1] to [0,1]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797792573975615-54"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">2.0</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797792573975615-55"><span class="crayon-h">	</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">results </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-v">None</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797792573975615-56"><span class="crayon-h">		</span><span class="crayon-v">results</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-i">X</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797792573975615-57"><span class="crayon-h">	</span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797792573975615-58"><span class="crayon-h">		</span><span class="crayon-v">results</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">vstack</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">results</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797792573975615-59"><span class="crayon-p"># plot the result</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797792573975615-60"><span class="crayon-e">plot_generated</span><span class="crayon-sy">(</span><span class="crayon-v">results</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Running the example creates 10 different face starting points and 10 matching face endpoints, and the linear interpolation between each.</p>
<p><strong>Note</strong>: Your <a href="https://machinelearningmastery.com/different-results-each-time-in-machine-learning/">results may vary</a> given the stochastic nature of the algorithm or evaluation procedure, or differences in numerical precision. Consider running the example a few times and compare the average outcome.</p>

<div id="attachment_8147" style="width: 1034px" class="wp-caption aligncenter"><img aria-describedby="caption-attachment-8147" loading="lazy" class="size-large wp-image-8147" src="./How to Explore the GAN Latent Space When Generating Faces_files/Plot-Showing-Multiple-Linear-Interpolation-Between-Two-GAN-Generated-Faces-1024x768.png" alt="Plot Showing Multiple Linear Interpolations Between Two GAN Generated Faces" width="1024" height="768" srcset="https://machinelearningmastery.com/wp-content/uploads/2019/05/Plot-Showing-Multiple-Linear-Interpolation-Between-Two-GAN-Generated-Faces-1024x768.png 1024w, https://machinelearningmastery.com/wp-content/uploads/2019/05/Plot-Showing-Multiple-Linear-Interpolation-Between-Two-GAN-Generated-Faces-300x225.png 300w, https://machinelearningmastery.com/wp-content/uploads/2019/05/Plot-Showing-Multiple-Linear-Interpolation-Between-Two-GAN-Generated-Faces-768x576.png 768w, https://machinelearningmastery.com/wp-content/uploads/2019/05/Plot-Showing-Multiple-Linear-Interpolation-Between-Two-GAN-Generated-Faces.png 1280w" sizes="(max-width: 1024px) 100vw, 1024px"><p id="caption-attachment-8147" class="wp-caption-text">Plot Showing Multiple Linear Interpolations Between Two GAN Generated Faces</p></div>
<p>In these cases, we have performed a linear interpolation which assumes that the latent space is uniformly distributed hypercube. Technically, our chosen latent space is a 100-dimension hypersphere or multimodal Gaussian distribution.</p>
<p>There is a mathematical function called the spherical linear interpolation function, or ‘<a href="https://en.wikipedia.org/wiki/Slerp">Slerp</a>,’ that should be used when interpolating this space to ensure the curving of the space is taken into account. For more details, I recommend reading the <a href="https://github.com/soumith/dcgan.torch/issues/14">Issue on Linear Interpolation in Soumith Chintala’s dcgan.torch project</a>. In that project, an implementation of the Slerp function for Python is provided that we can use as the basis for our own Slerp function, provided below:</p>
		<div id="urvanov-syntax-highlighter-60654e7797794220988088" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0;"># spherical linear interpolation (slerp)
def slerp(val, low, high):
	omega = arccos(clip(dot(low/norm(low), high/norm(high)), -1, 1))
	so = sin(omega)
	if so == 0:
		# L'Hopital's rule/LERP
		return (1.0-val) * low + val * high
	return sin((1.0-val)*omega) / so * low + sin(val*omega) / so * high</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797794220988088-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797794220988088-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797794220988088-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797794220988088-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797794220988088-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797794220988088-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797794220988088-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797794220988088-8">8</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797794220988088-1"><span class="crayon-p"># spherical linear interpolation (slerp)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797794220988088-2"><span class="crayon-e">def </span><span class="crayon-e">slerp</span><span class="crayon-sy">(</span><span class="crayon-v">val</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">low</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">high</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797794220988088-3"><span class="crayon-h">	</span><span class="crayon-v">omega</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">arccos</span><span class="crayon-sy">(</span><span class="crayon-e">clip</span><span class="crayon-sy">(</span><span class="crayon-e">dot</span><span class="crayon-sy">(</span><span class="crayon-v">low</span><span class="crayon-o">/</span><span class="crayon-e">norm</span><span class="crayon-sy">(</span><span class="crayon-v">low</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">high</span><span class="crayon-o">/</span><span class="crayon-e">norm</span><span class="crayon-sy">(</span><span class="crayon-v">high</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797794220988088-4"><span class="crayon-h">	</span><span class="crayon-v">so</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">sin</span><span class="crayon-sy">(</span><span class="crayon-v">omega</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797794220988088-5"><span class="crayon-h">	</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">so</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797794220988088-6"><span class="crayon-h">		</span><span class="crayon-p"># L'Hopital's rule/LERP</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797794220988088-7"><span class="crayon-h">		</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1.0</span><span class="crayon-o">-</span><span class="crayon-v">val</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">low</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e ">val *</span><span class="crayon-h"> </span><span class="crayon-e">high</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797794220988088-8"><span class="crayon-e">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">sin</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-cn">1.0</span><span class="crayon-o">-</span><span class="crayon-v">val</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-v">omega</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-e ">so *</span><span class="crayon-h"> </span><span class="crayon-v">low</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">sin</span><span class="crayon-sy">(</span><span class="crayon-e ">val*</span><span class="crayon-v">omega</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-e ">so *</span><span class="crayon-h"> </span><span class="crayon-v">high</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>This function can be called from our <em>interpolate_points()</em> function instead of performing the manual linear interpolation.</p>
<p>The complete example with this change is listed below.</p>
		<div id="urvanov-syntax-highlighter-60654e7797795111162789" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0;"># example of interpolating between generated faces
from numpy import asarray
from numpy import vstack
from numpy.random import randn
from numpy.random import randint
from numpy import arccos
from numpy import clip
from numpy import dot
from numpy import sin
from numpy import linspace
from numpy.linalg import norm
from keras.models import load_model
from matplotlib import pyplot

# generate points in latent space as input for the generator
def generate_latent_points(latent_dim, n_samples, n_classes=10):
	# generate points in the latent space
	x_input = randn(latent_dim * n_samples)
	# reshape into a batch of inputs for the network
	z_input = x_input.reshape(n_samples, latent_dim)
	return z_input

# spherical linear interpolation (slerp)
def slerp(val, low, high):
	omega = arccos(clip(dot(low/norm(low), high/norm(high)), -1, 1))
	so = sin(omega)
	if so == 0:
		# L'Hopital's rule/LERP
		return (1.0-val) * low + val * high
	return sin((1.0-val)*omega) / so * low + sin(val*omega) / so * high

# uniform interpolation between two points in latent space
def interpolate_points(p1, p2, n_steps=10):
	# interpolate ratios between the points
	ratios = linspace(0, 1, num=n_steps)
	# linear interpolate vectors
	vectors = list()
	for ratio in ratios:
		v = slerp(ratio, p1, p2)
		vectors.append(v)
	return asarray(vectors)

# create a plot of generated images
def plot_generated(examples, n):
	# plot images
	for i in range(n * n):
		# define subplot
		pyplot.subplot(n, n, 1 + i)
		# turn off axis
		pyplot.axis('off')
		# plot raw pixel data
		pyplot.imshow(examples[i, :, :])
	pyplot.show()

# load model
model = load_model('generator_model_030.h5')
# generate points in latent space
n = 20
pts = generate_latent_points(100, n)
# interpolate pairs
results = None
for i in range(0, n, 2):
	# interpolate points in latent space
	interpolated = interpolate_points(pts[i], pts[i+1])
	# generate images
	X = model.predict(interpolated)
	# scale from [-1,1] to [0,1]
	X = (X + 1) / 2.0
	if results is None:
		results = X
	else:
		results = vstack((results, X))
# plot the result
plot_generated(results, 10)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-30">30</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-31">31</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-32">32</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-33">33</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-34">34</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-35">35</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-36">36</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-37">37</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-38">38</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-39">39</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-40">40</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-41">41</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-42">42</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-43">43</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-44">44</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-45">45</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-46">46</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-47">47</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-48">48</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-49">49</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-50">50</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-51">51</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-52">52</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-53">53</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-54">54</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-55">55</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-56">56</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-57">57</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-58">58</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-59">59</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-60">60</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-61">61</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-62">62</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-63">63</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-64">64</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-65">65</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-66">66</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-67">67</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-68">68</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-69">69</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-70">70</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-71">71</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-72">72</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-73">73</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797795111162789-74">74</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797795111162789-1"><span class="crayon-p"># example of interpolating between generated faces</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797795111162789-2"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">asarray</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797795111162789-3"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">vstack</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797795111162789-4"><span class="crayon-e">from </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">random </span><span class="crayon-e">import </span><span class="crayon-e">randn</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797795111162789-5"><span class="crayon-e">from </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">random </span><span class="crayon-e">import </span><span class="crayon-e">randint</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797795111162789-6"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">arccos</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797795111162789-7"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">clip</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797795111162789-8"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">dot</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797795111162789-9"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">sin</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797795111162789-10"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">linspace</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797795111162789-11"><span class="crayon-e">from </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">linalg </span><span class="crayon-e">import </span><span class="crayon-e">norm</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797795111162789-12"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">load_model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797795111162789-13"><span class="crayon-e">from </span><span class="crayon-e">matplotlib </span><span class="crayon-e">import </span><span class="crayon-i">pyplot</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797795111162789-14">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797795111162789-15"><span class="crayon-p"># generate points in latent space as input for the generator</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797795111162789-16"><span class="crayon-e">def </span><span class="crayon-e">generate_latent_points</span><span class="crayon-sy">(</span><span class="crayon-v">latent_dim</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_samples</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_classes</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797795111162789-17"><span class="crayon-h">	</span><span class="crayon-p"># generate points in the latent space</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797795111162789-18"><span class="crayon-h">	</span><span class="crayon-v">x_input</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">randn</span><span class="crayon-sy">(</span><span class="crayon-e ">latent_dim *</span><span class="crayon-h"> </span><span class="crayon-v">n_samples</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797795111162789-19"><span class="crayon-h">	</span><span class="crayon-p"># reshape into a batch of inputs for the network</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797795111162789-20"><span class="crayon-h">	</span><span class="crayon-v">z_input</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">x_input</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-v">n_samples</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">latent_dim</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797795111162789-21"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">z</span><span class="crayon-sy">_</span>input</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797795111162789-22">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797795111162789-23"><span class="crayon-p"># spherical linear interpolation (slerp)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797795111162789-24"><span class="crayon-e">def </span><span class="crayon-e">slerp</span><span class="crayon-sy">(</span><span class="crayon-v">val</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">low</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">high</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797795111162789-25"><span class="crayon-h">	</span><span class="crayon-v">omega</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">arccos</span><span class="crayon-sy">(</span><span class="crayon-e">clip</span><span class="crayon-sy">(</span><span class="crayon-e">dot</span><span class="crayon-sy">(</span><span class="crayon-v">low</span><span class="crayon-o">/</span><span class="crayon-e">norm</span><span class="crayon-sy">(</span><span class="crayon-v">low</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">high</span><span class="crayon-o">/</span><span class="crayon-e">norm</span><span class="crayon-sy">(</span><span class="crayon-v">high</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797795111162789-26"><span class="crayon-h">	</span><span class="crayon-v">so</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">sin</span><span class="crayon-sy">(</span><span class="crayon-v">omega</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797795111162789-27"><span class="crayon-h">	</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">so</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797795111162789-28"><span class="crayon-h">		</span><span class="crayon-p"># L'Hopital's rule/LERP</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797795111162789-29"><span class="crayon-h">		</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1.0</span><span class="crayon-o">-</span><span class="crayon-v">val</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">low</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e ">val *</span><span class="crayon-h"> </span><span class="crayon-e">high</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797795111162789-30"><span class="crayon-e">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">sin</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-cn">1.0</span><span class="crayon-o">-</span><span class="crayon-v">val</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-v">omega</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-e ">so *</span><span class="crayon-h"> </span><span class="crayon-v">low</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">sin</span><span class="crayon-sy">(</span><span class="crayon-e ">val*</span><span class="crayon-v">omega</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-e ">so *</span><span class="crayon-h"> </span><span class="crayon-i">high</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797795111162789-31">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797795111162789-32"><span class="crayon-p"># uniform interpolation between two points in latent space</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797795111162789-33"><span class="crayon-e">def </span><span class="crayon-e">interpolate_points</span><span class="crayon-sy">(</span><span class="crayon-v">p1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">p2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797795111162789-34"><span class="crayon-h">	</span><span class="crayon-p"># interpolate ratios between the points</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797795111162789-35"><span class="crayon-h">	</span><span class="crayon-v">ratios</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">linspace</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">num</span><span class="crayon-o">=</span><span class="crayon-v">n_steps</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797795111162789-36"><span class="crayon-h">	</span><span class="crayon-p"># linear interpolate vectors</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797795111162789-37"><span class="crayon-h">	</span><span class="crayon-v">vectors</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797795111162789-38"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">ratio </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">ratios</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797795111162789-39"><span class="crayon-h">		</span><span class="crayon-v">v</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">slerp</span><span class="crayon-sy">(</span><span class="crayon-v">ratio</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">p1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">p2</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797795111162789-40"><span class="crayon-h">		</span><span class="crayon-v">vectors</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">v</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797795111162789-41"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">asarray</span><span class="crayon-sy">(</span><span class="crayon-v">vectors</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797795111162789-42">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797795111162789-43"><span class="crayon-p"># create a plot of generated images</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797795111162789-44"><span class="crayon-e">def </span><span class="crayon-e">plot_generated</span><span class="crayon-sy">(</span><span class="crayon-v">examples</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797795111162789-45"><span class="crayon-h">	</span><span class="crayon-p"># plot images</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797795111162789-46"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e ">n *</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797795111162789-47"><span class="crayon-h">		</span><span class="crayon-p"># define subplot</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797795111162789-48"><span class="crayon-h">		</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-v">n</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797795111162789-49"><span class="crayon-h">		</span><span class="crayon-p"># turn off axis</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797795111162789-50"><span class="crayon-h">		</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">axis</span><span class="crayon-sy">(</span><span class="crayon-s">'off'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797795111162789-51"><span class="crayon-h">		</span><span class="crayon-p"># plot raw pixel data</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797795111162789-52"><span class="crayon-h">		</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">imshow</span><span class="crayon-sy">(</span><span class="crayon-v">examples</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797795111162789-53"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797795111162789-54">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797795111162789-55"><span class="crayon-p"># load model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797795111162789-56"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_model</span><span class="crayon-sy">(</span><span class="crayon-s">'generator_model_030.h5'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797795111162789-57"><span class="crayon-p"># generate points in latent space</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797795111162789-58"><span class="crayon-v">n</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">20</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797795111162789-59"><span class="crayon-v">pts</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">generate_latent_points</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797795111162789-60"><span class="crayon-p"># interpolate pairs</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797795111162789-61"><span class="crayon-v">results</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">None</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797795111162789-62"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797795111162789-63"><span class="crayon-h">	</span><span class="crayon-p"># interpolate points in latent space</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797795111162789-64"><span class="crayon-h">	</span><span class="crayon-v">interpolated</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">interpolate_points</span><span class="crayon-sy">(</span><span class="crayon-v">pts</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">pts</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797795111162789-65"><span class="crayon-h">	</span><span class="crayon-p"># generate images</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797795111162789-66"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">interpolated</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797795111162789-67"><span class="crayon-h">	</span><span class="crayon-p"># scale from [-1,1] to [0,1]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797795111162789-68"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">2.0</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797795111162789-69"><span class="crayon-h">	</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">results </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-v">None</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797795111162789-70"><span class="crayon-h">		</span><span class="crayon-v">results</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-i">X</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797795111162789-71"><span class="crayon-h">	</span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797795111162789-72"><span class="crayon-h">		</span><span class="crayon-v">results</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">vstack</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">results</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797795111162789-73"><span class="crayon-p"># plot the result</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797795111162789-74"><span class="crayon-e">plot_generated</span><span class="crayon-sy">(</span><span class="crayon-v">results</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>The result is 10 more transitions between generated faces, this time using the correct Slerp interpolation method.</p>
<p><strong>Note</strong>: Your <a href="https://machinelearningmastery.com/different-results-each-time-in-machine-learning/">results may vary</a> given the stochastic nature of the algorithm or evaluation procedure, or differences in numerical precision. Consider running the example a few times and compare the average outcome.</p>

<p>The difference is subtle but somehow visually more correct.</p>
<div id="attachment_8148" style="width: 1034px" class="wp-caption aligncenter"><img aria-describedby="caption-attachment-8148" loading="lazy" class="size-large wp-image-8148" src="./How to Explore the GAN Latent Space When Generating Faces_files/Plot-Showing-Multiple-Seraphically-Linear-Interpolation-Between-Two-GAN-Generated-Faces-1024x768.png" alt="Plot Showing Multiple Seraphically Linear Interpolation Between Two GAN Generated Faces" width="1024" height="768" srcset="https://machinelearningmastery.com/wp-content/uploads/2019/05/Plot-Showing-Multiple-Seraphically-Linear-Interpolation-Between-Two-GAN-Generated-Faces-1024x768.png 1024w, https://machinelearningmastery.com/wp-content/uploads/2019/05/Plot-Showing-Multiple-Seraphically-Linear-Interpolation-Between-Two-GAN-Generated-Faces-300x225.png 300w, https://machinelearningmastery.com/wp-content/uploads/2019/05/Plot-Showing-Multiple-Seraphically-Linear-Interpolation-Between-Two-GAN-Generated-Faces-768x576.png 768w, https://machinelearningmastery.com/wp-content/uploads/2019/05/Plot-Showing-Multiple-Seraphically-Linear-Interpolation-Between-Two-GAN-Generated-Faces.png 1280w" sizes="(max-width: 1024px) 100vw, 1024px"><p id="caption-attachment-8148" class="wp-caption-text">Plot Showing Multiple Seraphically Linear Interpolation Between Two GAN Generated Faces</p></div>
<h3>How to Perform Vector Arithmetic With Faces</h3>
<p>Finally, we can explore the latent space by performing vector arithmetic with the generated faces</p>
<p>First, we must generate a large number of faces and save both the faces and their corresponding latent vectors. We can then review the plot of generated faces and select faces with features we’re interested in, note their index (number), and retrieve their latent space vectors for manipulation.</p>
<p>The example below will load the GAN model and use it to generate 100 random faces.</p>
		<div id="urvanov-syntax-highlighter-60654e7797796376499845" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0;"># example of loading the generator model and generating images
from numpy import asarray
from numpy.random import randn
from numpy.random import randint
from keras.models import load_model
from matplotlib import pyplot
from numpy import savez_compressed

# generate points in latent space as input for the generator
def generate_latent_points(latent_dim, n_samples, n_classes=10):
	# generate points in the latent space
	x_input = randn(latent_dim * n_samples)
	# reshape into a batch of inputs for the network
	z_input = x_input.reshape(n_samples, latent_dim)
	return z_input

# create a plot of generated images
def plot_generated(examples, n):
	# plot images
	for i in range(n * n):
		# define subplot
		pyplot.subplot(n, n, 1 + i)
		# turn off axis
		pyplot.axis('off')
		# plot raw pixel data
		pyplot.imshow(examples[i, :, :])
	pyplot.savefig('generated_faces.png')
	pyplot.close()

# load model
model = load_model('generator_model_030.h5')
# generate points in latent space
latent_points = generate_latent_points(100, 100)
# save points
savez_compressed('latent_points.npz', latent_points)
# generate images
X  = model.predict(latent_points)
# scale from [-1,1] to [0,1]
X = (X + 1) / 2.0
# save plot
plot_generated(X, 10)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797796376499845-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797796376499845-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797796376499845-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797796376499845-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797796376499845-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797796376499845-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797796376499845-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797796376499845-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797796376499845-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797796376499845-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797796376499845-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797796376499845-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797796376499845-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797796376499845-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797796376499845-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797796376499845-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797796376499845-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797796376499845-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797796376499845-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797796376499845-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797796376499845-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797796376499845-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797796376499845-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797796376499845-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797796376499845-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797796376499845-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797796376499845-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797796376499845-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797796376499845-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797796376499845-30">30</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797796376499845-31">31</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797796376499845-32">32</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797796376499845-33">33</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797796376499845-34">34</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797796376499845-35">35</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797796376499845-36">36</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797796376499845-37">37</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797796376499845-38">38</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797796376499845-39">39</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797796376499845-40">40</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797796376499845-41">41</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797796376499845-1"><span class="crayon-p"># example of loading the generator model and generating images</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797796376499845-2"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">asarray</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797796376499845-3"><span class="crayon-e">from </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">random </span><span class="crayon-e">import </span><span class="crayon-e">randn</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797796376499845-4"><span class="crayon-e">from </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">random </span><span class="crayon-e">import </span><span class="crayon-e">randint</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797796376499845-5"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">load_model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797796376499845-6"><span class="crayon-e">from </span><span class="crayon-e">matplotlib </span><span class="crayon-e">import </span><span class="crayon-e">pyplot</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797796376499845-7"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-v">savez</span><span class="crayon-sy">_</span>compressed</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797796376499845-8">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797796376499845-9"><span class="crayon-p"># generate points in latent space as input for the generator</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797796376499845-10"><span class="crayon-e">def </span><span class="crayon-e">generate_latent_points</span><span class="crayon-sy">(</span><span class="crayon-v">latent_dim</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_samples</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_classes</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797796376499845-11"><span class="crayon-h">	</span><span class="crayon-p"># generate points in the latent space</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797796376499845-12"><span class="crayon-h">	</span><span class="crayon-v">x_input</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">randn</span><span class="crayon-sy">(</span><span class="crayon-e ">latent_dim *</span><span class="crayon-h"> </span><span class="crayon-v">n_samples</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797796376499845-13"><span class="crayon-h">	</span><span class="crayon-p"># reshape into a batch of inputs for the network</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797796376499845-14"><span class="crayon-h">	</span><span class="crayon-v">z_input</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">x_input</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-v">n_samples</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">latent_dim</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797796376499845-15"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">z</span><span class="crayon-sy">_</span>input</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797796376499845-16">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797796376499845-17"><span class="crayon-p"># create a plot of generated images</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797796376499845-18"><span class="crayon-e">def </span><span class="crayon-e">plot_generated</span><span class="crayon-sy">(</span><span class="crayon-v">examples</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797796376499845-19"><span class="crayon-h">	</span><span class="crayon-p"># plot images</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797796376499845-20"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e ">n *</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797796376499845-21"><span class="crayon-h">		</span><span class="crayon-p"># define subplot</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797796376499845-22"><span class="crayon-h">		</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-v">n</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797796376499845-23"><span class="crayon-h">		</span><span class="crayon-p"># turn off axis</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797796376499845-24"><span class="crayon-h">		</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">axis</span><span class="crayon-sy">(</span><span class="crayon-s">'off'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797796376499845-25"><span class="crayon-h">		</span><span class="crayon-p"># plot raw pixel data</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797796376499845-26"><span class="crayon-h">		</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">imshow</span><span class="crayon-sy">(</span><span class="crayon-v">examples</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797796376499845-27"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">savefig</span><span class="crayon-sy">(</span><span class="crayon-s">'generated_faces.png'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797796376499845-28"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">close</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797796376499845-29">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797796376499845-30"><span class="crayon-p"># load model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797796376499845-31"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_model</span><span class="crayon-sy">(</span><span class="crayon-s">'generator_model_030.h5'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797796376499845-32"><span class="crayon-p"># generate points in latent space</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797796376499845-33"><span class="crayon-v">latent_points</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">generate_latent_points</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797796376499845-34"><span class="crayon-p"># save points</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797796376499845-35"><span class="crayon-e">savez_compressed</span><span class="crayon-sy">(</span><span class="crayon-s">'latent_points.npz'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">latent_points</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797796376499845-36"><span class="crayon-p"># generate images</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797796376499845-37"><span class="crayon-v">X</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">latent_points</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797796376499845-38"><span class="crayon-p"># scale from [-1,1] to [0,1]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797796376499845-39"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">2.0</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797796376499845-40"><span class="crayon-p"># save plot</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797796376499845-41"><span class="crayon-e">plot_generated</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Running the example loads the model, generates faces, and saves the latent vectors and generated faces.</p>
<p>The latent vectors are saved to a compressed NumPy array with the filename ‘<em>latent_points.npz</em>‘. The 100 generated faces are plotted in a 10×10 grid and saved in a file named ‘<em>generated_faces.png</em>‘.</p>
<p>In this case, we have a good collection of faces to work with. Each face has an index that we can use to retrieve the latent vector. For example, the first face is 1, which corresponds to the first vector in the saved array (index 0).</p>
<p>We will perform the operation:</p>
		<div id="urvanov-syntax-highlighter-60654e7797797180559587" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0;">smiling woman - neutral woman + neutral man = smiling man</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797797180559587-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797797180559587-1">smiling woman - neutral woman + neutral man = smiling man</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Therefore, we need three faces for each of smiling woman, neutral woman, and neutral man.</p>
<p>In this case, we will use the following indexes in the image:</p>
<ul>
<li>Smiling Woman: 92, 98, 99</li>
<li>Neutral Woman: 9, 21, 79</li>
<li>Neutral Man: 10, 30, 45</li>
</ul>
<div id="attachment_8149" style="width: 650px" class="wp-caption aligncenter"><img aria-describedby="caption-attachment-8149" loading="lazy" class="size-full wp-image-8149" src="./How to Explore the GAN Latent Space When Generating Faces_files/Plot-of-100-Generated-Faces-Used-as-the-Basis-for-Vector-Arithmetic-with-Faces.png" alt="Plot of 100 Generated Faces Used as the Basis for Vector Arithmetic with Faces" width="640" height="480" srcset="https://machinelearningmastery.com/wp-content/uploads/2019/05/Plot-of-100-Generated-Faces-Used-as-the-Basis-for-Vector-Arithmetic-with-Faces.png 640w, https://machinelearningmastery.com/wp-content/uploads/2019/05/Plot-of-100-Generated-Faces-Used-as-the-Basis-for-Vector-Arithmetic-with-Faces-300x225.png 300w" sizes="(max-width: 640px) 100vw, 640px"><p id="caption-attachment-8149" class="wp-caption-text">Plot of 100 Generated Faces Used as the Basis for Vector Arithmetic with Faces</p></div>
<p>Now that we have latent vectors to work with and a target arithmetic, we can get started.</p>
<p>First, we can specify our preferred images and load the saved NumPy array of latent points.</p>
		<div id="urvanov-syntax-highlighter-60654e7797798198889547" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0;"># retrieve specific points
smiling_woman_ix = [92, 98, 99]
neutral_woman_ix = [9, 21, 79]
neutral_man_ix = [10, 30, 45]
# load the saved latent points
data = load('latent_points.npz')
points = data['arr_0']</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797798198889547-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797798198889547-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797798198889547-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797798198889547-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797798198889547-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797798198889547-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797798198889547-7">7</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797798198889547-1"><span class="crayon-p"># retrieve specific points</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797798198889547-2"><span class="crayon-v">smiling_woman_ix</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">92</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">98</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">99</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797798198889547-3"><span class="crayon-v">neutral_woman_ix</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">9</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">21</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">79</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797798198889547-4"><span class="crayon-v">neutral_man_ix</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">30</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">45</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797798198889547-5"><span class="crayon-p"># load the saved latent points</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797798198889547-6"><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load</span><span class="crayon-sy">(</span><span class="crayon-s">'latent_points.npz'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797798198889547-7"><span class="crayon-v">points</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-s">'arr_0'</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Next, we can retrieve each vector and calculate the average for each vector type (e.g. smiling woman). We could perform vector arithmetic with single images directly, but we will get a more robust result if we work with an average of a few faces with the desired property.</p>
<p>The <em>average_points()</em> function below takes the loaded array of latent space points, retrieves each, calculates the average, and returns all of the vectors.</p>
		<div id="urvanov-syntax-highlighter-60654e7797799987970960" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0;"># average list of latent space vectors
def average_points(points, ix):
	# convert to zero offset points
	zero_ix = [i-1 for i in ix]
	# retrieve required points
	vectors = points[zero_ix]
	# average the vectors
	avg_vector = mean(vectors, axis=0)
	# combine original and avg vectors
	all_vectors = vstack((vectors, avg_vector))
	return all_vectors</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797799987970960-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797799987970960-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797799987970960-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797799987970960-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797799987970960-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797799987970960-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797799987970960-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797799987970960-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797799987970960-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e7797799987970960-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e7797799987970960-11">11</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797799987970960-1"><span class="crayon-p"># average list of latent space vectors</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797799987970960-2"><span class="crayon-e">def </span><span class="crayon-e">average_points</span><span class="crayon-sy">(</span><span class="crayon-v">points</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ix</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797799987970960-3"><span class="crayon-h">	</span><span class="crayon-p"># convert to zero offset points</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797799987970960-4"><span class="crayon-h">	</span><span class="crayon-v">zero_ix</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">ix</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797799987970960-5"><span class="crayon-h">	</span><span class="crayon-p"># retrieve required points</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797799987970960-6"><span class="crayon-h">	</span><span class="crayon-v">vectors</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">points</span><span class="crayon-sy">[</span><span class="crayon-v">zero_ix</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797799987970960-7"><span class="crayon-h">	</span><span class="crayon-p"># average the vectors</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797799987970960-8"><span class="crayon-h">	</span><span class="crayon-v">avg_vector</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-v">vectors</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797799987970960-9"><span class="crayon-h">	</span><span class="crayon-p"># combine original and avg vectors</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e7797799987970960-10"><span class="crayon-h">	</span><span class="crayon-v">all_vectors</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">vstack</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">vectors</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">avg_vector</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e7797799987970960-11"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">all_vectors</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>We can now use this function to retrieve all of the required points in latent space and generate images.</p>
		<div id="urvanov-syntax-highlighter-60654e779779a702713049" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0;"># average vectors
smiling_woman = average_points(points, smiling_woman_ix)
neutral_woman = average_points(points, neutral_woman_ix)
neutral_man = average_points(points, neutral_man_ix)
# combine all vectors
all_vectors = vstack((smiling_woman, neutral_woman, neutral_man))
# generate images
images = model.predict(all_vectors)
# scale pixel values
images = (images + 1) / 2.0
plot_generated(images, 3, 4)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779779a702713049-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779779a702713049-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779779a702713049-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779779a702713049-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779779a702713049-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779779a702713049-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779779a702713049-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779779a702713049-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779779a702713049-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779779a702713049-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779779a702713049-11">11</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779779a702713049-1"><span class="crayon-p"># average vectors</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779779a702713049-2"><span class="crayon-v">smiling_woman</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">average_points</span><span class="crayon-sy">(</span><span class="crayon-v">points</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">smiling_woman_ix</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779779a702713049-3"><span class="crayon-v">neutral_woman</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">average_points</span><span class="crayon-sy">(</span><span class="crayon-v">points</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">neutral_woman_ix</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779779a702713049-4"><span class="crayon-v">neutral_man</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">average_points</span><span class="crayon-sy">(</span><span class="crayon-v">points</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">neutral_man_ix</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779779a702713049-5"><span class="crayon-p"># combine all vectors</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779779a702713049-6"><span class="crayon-v">all_vectors</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">vstack</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">smiling_woman</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">neutral_woman</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">neutral_man</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779779a702713049-7"><span class="crayon-p"># generate images</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779779a702713049-8"><span class="crayon-v">images</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">all_vectors</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779779a702713049-9"><span class="crayon-p"># scale pixel values</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779779a702713049-10"><span class="crayon-v">images</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">images</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">2.0</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779779a702713049-11"><span class="crayon-e">plot_generated</span><span class="crayon-sy">(</span><span class="crayon-v">images</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Finally, we can use the average vectors to perform vector arithmetic in latent space and plot the result.</p>
		<div id="urvanov-syntax-highlighter-60654e779779b670459220" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0;"># smiling woman - neutral woman + neutral man = smiling man
result_vector = smiling_woman[-1] - neutral_woman[-1] + neutral_man[-1]
# generate image
result_vector = expand_dims(result_vector, 0)
result_image = model.predict(result_vector)
# scale pixel values
result_image = (result_image + 1) / 2.0
pyplot.imshow(result_image[0])
pyplot.show()</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779779b670459220-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779779b670459220-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779779b670459220-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779779b670459220-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779779b670459220-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779779b670459220-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779779b670459220-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779779b670459220-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779779b670459220-9">9</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779779b670459220-1"><span class="crayon-p"># smiling woman - neutral woman + neutral man = smiling man</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779779b670459220-2"><span class="crayon-v">result_vector</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">smiling_woman</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">neutral_woman</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">neutral_man</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779779b670459220-3"><span class="crayon-p"># generate image</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779779b670459220-4"><span class="crayon-v">result_vector</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">expand_dims</span><span class="crayon-sy">(</span><span class="crayon-v">result_vector</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779779b670459220-5"><span class="crayon-v">result_image</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">result_vector</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779779b670459220-6"><span class="crayon-p"># scale pixel values</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779779b670459220-7"><span class="crayon-v">result_image</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">result_image</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">2.0</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779779b670459220-8"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">imshow</span><span class="crayon-sy">(</span><span class="crayon-v">result_image</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779779b670459220-9"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Tying this together, the complete example is listed below.</p>
		<div id="urvanov-syntax-highlighter-60654e779779c609972116" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0;"># example of loading the generator model and generating images
from numpy import asarray
from numpy.random import randn
from numpy.random import randint
from keras.models import load_model
from matplotlib import pyplot
from numpy import load
from numpy import mean
from numpy import vstack
from numpy import expand_dims

# average list of latent space vectors
def average_points(points, ix):
	# convert to zero offset points
	zero_ix = [i-1 for i in ix]
	# retrieve required points
	vectors = points[zero_ix]
	# average the vectors
	avg_vector = mean(vectors, axis=0)
	# combine original and avg vectors
	all_vectors = vstack((vectors, avg_vector))
	return all_vectors

# create a plot of generated images
def plot_generated(examples, rows, cols):
	# plot images
	for i in range(rows * cols):
		# define subplot
		pyplot.subplot(rows, cols, 1 + i)
		# turn off axis
		pyplot.axis('off')
		# plot raw pixel data
		pyplot.imshow(examples[i, :, :])
	pyplot.show()

# load model
model = load_model('generator_model_030.h5')
# retrieve specific points
smiling_woman_ix = [92, 98, 99]
neutral_woman_ix = [9, 21, 79]
neutral_man_ix = [10, 30, 45]
# load the saved latent points
data = load('latent_points.npz')
points = data['arr_0']
# average vectors
smiling_woman = average_points(points, smiling_woman_ix)
neutral_woman = average_points(points, neutral_woman_ix)
neutral_man = average_points(points, neutral_man_ix)
# combine all vectors
all_vectors = vstack((smiling_woman, neutral_woman, neutral_man))
# generate images
images = model.predict(all_vectors)
# scale pixel values
images = (images + 1) / 2.0
plot_generated(images, 3, 4)
# smiling woman - neutral woman + neutral man = smiling man
result_vector = smiling_woman[-1] - neutral_woman[-1] + neutral_man[-1]
# generate image
result_vector = expand_dims(result_vector, 0)
result_image = model.predict(result_vector)
# scale pixel values
result_image = (result_image + 1) / 2.0
pyplot.imshow(result_image[0])
pyplot.show()</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779779c609972116-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779779c609972116-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779779c609972116-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779779c609972116-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779779c609972116-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779779c609972116-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779779c609972116-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779779c609972116-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779779c609972116-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779779c609972116-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779779c609972116-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779779c609972116-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779779c609972116-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779779c609972116-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779779c609972116-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779779c609972116-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779779c609972116-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779779c609972116-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779779c609972116-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779779c609972116-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779779c609972116-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779779c609972116-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779779c609972116-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779779c609972116-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779779c609972116-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779779c609972116-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779779c609972116-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779779c609972116-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779779c609972116-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779779c609972116-30">30</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779779c609972116-31">31</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779779c609972116-32">32</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779779c609972116-33">33</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779779c609972116-34">34</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779779c609972116-35">35</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779779c609972116-36">36</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779779c609972116-37">37</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779779c609972116-38">38</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779779c609972116-39">39</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779779c609972116-40">40</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779779c609972116-41">41</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779779c609972116-42">42</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779779c609972116-43">43</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779779c609972116-44">44</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779779c609972116-45">45</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779779c609972116-46">46</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779779c609972116-47">47</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779779c609972116-48">48</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779779c609972116-49">49</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779779c609972116-50">50</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779779c609972116-51">51</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779779c609972116-52">52</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779779c609972116-53">53</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779779c609972116-54">54</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779779c609972116-55">55</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779779c609972116-56">56</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779779c609972116-57">57</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779779c609972116-58">58</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779779c609972116-59">59</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779779c609972116-60">60</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779779c609972116-61">61</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779779c609972116-62">62</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-60654e779779c609972116-63">63</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-60654e779779c609972116-64">64</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779779c609972116-1"><span class="crayon-p"># example of loading the generator model and generating images</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779779c609972116-2"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">asarray</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779779c609972116-3"><span class="crayon-e">from </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">random </span><span class="crayon-e">import </span><span class="crayon-e">randn</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779779c609972116-4"><span class="crayon-e">from </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">random </span><span class="crayon-e">import </span><span class="crayon-e">randint</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779779c609972116-5"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">load_model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779779c609972116-6"><span class="crayon-e">from </span><span class="crayon-e">matplotlib </span><span class="crayon-e">import </span><span class="crayon-e">pyplot</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779779c609972116-7"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">load</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779779c609972116-8"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">mean</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779779c609972116-9"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">vstack</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779779c609972116-10"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-v">expand</span><span class="crayon-sy">_</span>dims</div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779779c609972116-11">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779779c609972116-12"><span class="crayon-p"># average list of latent space vectors</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779779c609972116-13"><span class="crayon-e">def </span><span class="crayon-e">average_points</span><span class="crayon-sy">(</span><span class="crayon-v">points</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ix</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779779c609972116-14"><span class="crayon-h">	</span><span class="crayon-p"># convert to zero offset points</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779779c609972116-15"><span class="crayon-h">	</span><span class="crayon-v">zero_ix</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">ix</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779779c609972116-16"><span class="crayon-h">	</span><span class="crayon-p"># retrieve required points</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779779c609972116-17"><span class="crayon-h">	</span><span class="crayon-v">vectors</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">points</span><span class="crayon-sy">[</span><span class="crayon-v">zero_ix</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779779c609972116-18"><span class="crayon-h">	</span><span class="crayon-p"># average the vectors</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779779c609972116-19"><span class="crayon-h">	</span><span class="crayon-v">avg_vector</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-v">vectors</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779779c609972116-20"><span class="crayon-h">	</span><span class="crayon-p"># combine original and avg vectors</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779779c609972116-21"><span class="crayon-h">	</span><span class="crayon-v">all_vectors</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">vstack</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">vectors</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">avg_vector</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779779c609972116-22"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">all</span><span class="crayon-sy">_</span>vectors</div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779779c609972116-23">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779779c609972116-24"><span class="crayon-p"># create a plot of generated images</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779779c609972116-25"><span class="crayon-e">def </span><span class="crayon-e">plot_generated</span><span class="crayon-sy">(</span><span class="crayon-v">examples</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">rows</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cols</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779779c609972116-26"><span class="crayon-h">	</span><span class="crayon-p"># plot images</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779779c609972116-27"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e ">rows *</span><span class="crayon-h"> </span><span class="crayon-v">cols</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779779c609972116-28"><span class="crayon-h">		</span><span class="crayon-p"># define subplot</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779779c609972116-29"><span class="crayon-h">		</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-v">rows</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cols</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779779c609972116-30"><span class="crayon-h">		</span><span class="crayon-p"># turn off axis</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779779c609972116-31"><span class="crayon-h">		</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">axis</span><span class="crayon-sy">(</span><span class="crayon-s">'off'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779779c609972116-32"><span class="crayon-h">		</span><span class="crayon-p"># plot raw pixel data</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779779c609972116-33"><span class="crayon-h">		</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">imshow</span><span class="crayon-sy">(</span><span class="crayon-v">examples</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779779c609972116-34"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779779c609972116-35">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779779c609972116-36"><span class="crayon-p"># load model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779779c609972116-37"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_model</span><span class="crayon-sy">(</span><span class="crayon-s">'generator_model_030.h5'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779779c609972116-38"><span class="crayon-p"># retrieve specific points</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779779c609972116-39"><span class="crayon-v">smiling_woman_ix</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">92</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">98</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">99</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779779c609972116-40"><span class="crayon-v">neutral_woman_ix</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">9</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">21</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">79</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779779c609972116-41"><span class="crayon-v">neutral_man_ix</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">30</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">45</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779779c609972116-42"><span class="crayon-p"># load the saved latent points</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779779c609972116-43"><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load</span><span class="crayon-sy">(</span><span class="crayon-s">'latent_points.npz'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779779c609972116-44"><span class="crayon-v">points</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-s">'arr_0'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779779c609972116-45"><span class="crayon-p"># average vectors</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779779c609972116-46"><span class="crayon-v">smiling_woman</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">average_points</span><span class="crayon-sy">(</span><span class="crayon-v">points</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">smiling_woman_ix</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779779c609972116-47"><span class="crayon-v">neutral_woman</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">average_points</span><span class="crayon-sy">(</span><span class="crayon-v">points</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">neutral_woman_ix</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779779c609972116-48"><span class="crayon-v">neutral_man</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">average_points</span><span class="crayon-sy">(</span><span class="crayon-v">points</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">neutral_man_ix</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779779c609972116-49"><span class="crayon-p"># combine all vectors</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779779c609972116-50"><span class="crayon-v">all_vectors</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">vstack</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">smiling_woman</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">neutral_woman</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">neutral_man</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779779c609972116-51"><span class="crayon-p"># generate images</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779779c609972116-52"><span class="crayon-v">images</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">all_vectors</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779779c609972116-53"><span class="crayon-p"># scale pixel values</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779779c609972116-54"><span class="crayon-v">images</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">images</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">2.0</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779779c609972116-55"><span class="crayon-e">plot_generated</span><span class="crayon-sy">(</span><span class="crayon-v">images</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779779c609972116-56"><span class="crayon-p"># smiling woman - neutral woman + neutral man = smiling man</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779779c609972116-57"><span class="crayon-v">result_vector</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">smiling_woman</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">neutral_woman</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">neutral_man</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779779c609972116-58"><span class="crayon-p"># generate image</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779779c609972116-59"><span class="crayon-v">result_vector</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">expand_dims</span><span class="crayon-sy">(</span><span class="crayon-v">result_vector</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779779c609972116-60"><span class="crayon-v">result_image</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">result_vector</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779779c609972116-61"><span class="crayon-p"># scale pixel values</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779779c609972116-62"><span class="crayon-v">result_image</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">result_image</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">2.0</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-60654e779779c609972116-63"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">imshow</span><span class="crayon-sy">(</span><span class="crayon-v">result_image</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-60654e779779c609972116-64"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Running the example first loads the points in latent space for our specific images, calculates the average of the points, and generates the faces for the points.</p>
<p><strong>Note</strong>: Your <a href="https://machinelearningmastery.com/different-results-each-time-in-machine-learning/">results may vary</a> given the stochastic nature of the algorithm or evaluation procedure, or differences in numerical precision. Consider running the example a few times and compare the average outcome.</p>

<p>We can see that, indeed, our selected faces were retrieved correctly and that the average of the points in the vector space captures the salient feature we are going for on each line (e.g. smiling woman, neutral woman, etc.).</p>
<div id="attachment_8150" style="width: 1034px" class="wp-caption aligncenter"><img aria-describedby="caption-attachment-8150" loading="lazy" class="size-large wp-image-8150" src="./How to Explore the GAN Latent Space When Generating Faces_files/Plot-of-Selected-Generated-Faces-and-the-Average-Generated-Face-for-Each-Row-1024x768.png" alt="Plot of Selected Generated Faces and the Average Generated Face for Each Row" width="1024" height="768" srcset="https://machinelearningmastery.com/wp-content/uploads/2019/05/Plot-of-Selected-Generated-Faces-and-the-Average-Generated-Face-for-Each-Row-1024x768.png 1024w, https://machinelearningmastery.com/wp-content/uploads/2019/05/Plot-of-Selected-Generated-Faces-and-the-Average-Generated-Face-for-Each-Row-300x225.png 300w, https://machinelearningmastery.com/wp-content/uploads/2019/05/Plot-of-Selected-Generated-Faces-and-the-Average-Generated-Face-for-Each-Row-768x576.png 768w, https://machinelearningmastery.com/wp-content/uploads/2019/05/Plot-of-Selected-Generated-Faces-and-the-Average-Generated-Face-for-Each-Row.png 1280w" sizes="(max-width: 1024px) 100vw, 1024px"><p id="caption-attachment-8150" class="wp-caption-text">Plot of Selected Generated Faces and the Average Generated Face for Each Row</p></div>
<p>Next, vector arithmetic is performed and the result is a smiling man, as we would expect.</p>
<div id="attachment_8151" style="width: 310px" class="wp-caption aligncenter"><img aria-describedby="caption-attachment-8151" loading="lazy" class="wp-image-8151 size-medium" src="./How to Explore the GAN Latent Space When Generating Faces_files/Plot-of-the-Resulting-Generated-Face-Based-on-Vector-Arithmetic-in-Latent-Space-300x225.png" alt="Plot of the Resulting Generated Face Based on Vector Arithmetic in Latent Space" width="300" height="225" srcset="https://machinelearningmastery.com/wp-content/uploads/2019/05/Plot-of-the-Resulting-Generated-Face-Based-on-Vector-Arithmetic-in-Latent-Space-300x225.png 300w, https://machinelearningmastery.com/wp-content/uploads/2019/05/Plot-of-the-Resulting-Generated-Face-Based-on-Vector-Arithmetic-in-Latent-Space-768x576.png 768w, https://machinelearningmastery.com/wp-content/uploads/2019/05/Plot-of-the-Resulting-Generated-Face-Based-on-Vector-Arithmetic-in-Latent-Space-1024x768.png 1024w, https://machinelearningmastery.com/wp-content/uploads/2019/05/Plot-of-the-Resulting-Generated-Face-Based-on-Vector-Arithmetic-in-Latent-Space.png 1280w" sizes="(max-width: 300px) 100vw, 300px"><p id="caption-attachment-8151" class="wp-caption-text">Plot of the Resulting Generated Face Based on Vector Arithmetic in Latent Space</p></div>
<h2>Extensions</h2>
<p>This section lists some ideas for extending the tutorial that you may wish to explore.</p>
<ul>
<li><strong>Additional Arithmetic</strong>. Try arithmetic with different image features or different arithmetic and review the results of the generated faces.</li>
<li><strong>Additional Interpolation</strong>. Try interpolating between three or more points in latent space and review the results of the generated faces.</li>
<li><strong>Tune Model</strong>. Update the GAN model configuration so that training is more stable and better quality faces can be generated.</li>
</ul>
<p>If you explore any of these extensions, I’d love to know.<br>
Post your findings in the comments below.</p>
<h2>Further Reading</h2>
<p>This section provides more resources on the topic if you are looking to go deeper.</p>
<h3>Books</h3>
<ul>
<li>Chapter 20. Deep Generative Models, <a href="https://amzn.to/2YuwVjL">Deep Learning</a>, 2016.</li>
<li>Chapter 8. Generative Deep Learning, <a href="https://amzn.to/2U2bHuP">Deep Learning with Python</a>, 2017.</li>
</ul>
<h3>Papers</h3>
<ul>
<li><a href="https://arxiv.org/abs/1406.2661">Generative Adversarial Networks</a>, 2014.</li>
<li><a href="https://arxiv.org/abs/1511.06434">Unsupervised Representation Learning with Deep Convolutional Generative Adversarial Networks</a>, 2015</li>
<li><a href="https://arxiv.org/abs/1701.00160">Tutorial: Generative Adversarial Networks, NIPS</a>, 2016.</li>
<li><a href="https://arxiv.org/abs/1604.02878">Joint Face Detection and Alignment Using Multitask Cascaded Convolutional Networks</a>, 2016.</li>
</ul>
<h3>API</h3>
<ul>
<li><a href="https://keras.io/datasets/">Keras Datasets API</a>.</li>
<li><a href="https://keras.io/models/sequential/">Keras Sequential Model API</a></li>
<li><a href="https://keras.io/layers/convolutional/">Keras Convolutional Layers API</a></li>
<li><a href="https://keras.io/getting-started/faq/#how-can-i-freeze-keras-layers">How can I “freeze” Keras layers?</a></li>
<li><a href="https://matplotlib.org/api/">MatplotLib API</a></li>
<li><a href="https://docs.scipy.org/doc/numpy/reference/routines.random.html">NumPy Random sampling (numpy.random) API</a></li>
<li><a href="https://docs.scipy.org/doc/numpy/reference/routines.array-manipulation.html">NumPy Array manipulation routines</a></li>
</ul>
<h3>Articles</h3>
<ul>
<li><a href="http://mmlab.ie.cuhk.edu.hk/projects/CelebA.html">Large-scale CelebFaces Attributes (CelebA) Dataset.</a></li>
<li><a href="https://www.kaggle.com/jessicali9530/celeba-dataset">CelebFaces Attributes (CelebA) Dataset, Kaggle</a>.</li>
<li><a href="https://medium.com/coinmonks/celebrity-face-generation-using-gans-tensorflow-implementation-eaa2001eef86">Celebrity Face Generation using GANs (Tensorflow Implementation), 2018</a>.</li>
<li><a href="https://github.com/ipazc/mtcnn">MTCNN Face Detection Project, GitHub</a>.</li>
<li><a href="https://github.com/soumith/dcgan.torch/issues/14">linear interpolation?, dcgan.torch Project, GitHub</a>.</li>
</ul>
<h2>Summary</h2>
<p>In this tutorial, you discovered how to develop a generative adversarial network for face generation and explore the structure of latent space and the effect on generated faces.</p>
<p>Specifically, you learned:</p>
<ul>
<li>How to develop a generative adversarial network for generating faces.</li>
<li>How to interpolate between points in latent space and generate images that morph from one face to another.</li>
<li>How to perform vector arithmetic in latent space and achieve targeted results in the resulting generated faces.</li>
</ul>
<p>Do you have any questions?<br>
Ask your questions in the comments below and I will do my best to answer.</p>
<div class="widget_text awac-wrapper" id="custom_html-6"><div class="widget_text awac widget custom_html-6"><div class="textwidget custom-html-widget"><div style="text-align: center;">
<div class="woo-sc-hr"></div>
<h2>Develop Generative Adversarial Networks Today!</h2>
<a href="https://machinelearningmastery.com/generative_adversarial_networks/" rel="nofollow"><img width="220" height="311" style="border: 0;" src="./How to Explore the GAN Latent Space When Generating Faces_files/Generative-Adversarial-Networks-with-Python-220.png" alt="Generative Adversarial Networks with Python" align="left"></a>
	
<p></p><h4>Develop Your GAN Models in Minutes</h4>
...with just a few lines of python code<p></p>

<p>Discover how in my new Ebook:<br>
	<a href="https://machinelearningmastery.com/generative_adversarial_networks/" rel="nofollow">Generative Adversarial Networks with Python</a></p>

<p>It provides <strong>self-study tutorials</strong> and <strong>end-to-end projects</strong> on:<br> 
	<em>DCGAN</em>, <em>conditional GANs</em>, <em>image translation</em>, <em>Pix2Pix</em>, <em>CycleGAN</em><br>
	and much more...</p>

<p></p><h4>Finally Bring GAN Models to your Vision Projects</h4>
Skip the Academics. Just Results.<p></p>

<a href="https://machinelearningmastery.com/generative_adversarial_networks/" class="woo-sc-button  red"><span class="woo-">See What's Inside</span></a>
<div class="woo-sc-hr"></div>
</div></div></div></div><div class="simplesocialbuttons simplesocial-simple-icons simplesocialbuttons_inline simplesocialbuttons-align-left post-8135 post  simplesocialbuttons-inline-no-animation">
<button class="ssb_tweet-icon" data-href="https://twitter.com/share?text=How+to+Explore+the+GAN+Latent+Space+When+Generating+Faces&amp;url=https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/" rel="nofollow" onclick="if (!window.__cfRLUnblockHandlers) return false; javascript:window.open(this.dataset.href, &#39;&#39;, &#39;menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600&#39;);return false;">
						<span class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 72 72"><path fill="none" d="M0 0h72v72H0z"></path><path class="icon" fill="#fff" d="M68.812 15.14c-2.348 1.04-4.87 1.744-7.52 2.06 2.704-1.62 4.78-4.186 5.757-7.243-2.53 1.5-5.33 2.592-8.314 3.176C56.35 10.59 52.948 9 49.182 9c-7.23 0-13.092 5.86-13.092 13.093 0 1.026.118 2.02.338 2.98C25.543 24.527 15.9 19.318 9.44 11.396c-1.125 1.936-1.77 4.184-1.77 6.58 0 4.543 2.312 8.552 5.824 10.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163 0 6.345 4.513 11.638 10.504 12.84-1.1.298-2.256.457-3.45.457-.845 0-1.666-.078-2.464-.23 1.667 5.2 6.5 8.985 12.23 9.09-4.482 3.51-10.13 5.605-16.26 5.605-1.055 0-2.096-.06-3.122-.184 5.794 3.717 12.676 5.882 20.067 5.882 24.083 0 37.25-19.95 37.25-37.25 0-.565-.013-1.133-.038-1.693 2.558-1.847 4.778-4.15 6.532-6.774z"></path></svg></span><i class="simplesocialtxt">Tweet </i></button>
		<button class="ssb_fbshare-icon" target="_blank" data-href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/" onclick="if (!window.__cfRLUnblockHandlers) return false; javascript:window.open(this.dataset.href, &#39;&#39;, &#39;menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600&#39;);return false;">
						<span class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" class="_1pbq" color="#ffffff"><path fill="#ffffff" fill-rule="evenodd" class="icon" d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z"></path></svg></span>
						<span class="simplesocialtxt">Share </span> </button>
<button class="ssb_linkedin-icon" data-href="https://www.linkedin.com/cws/share?url=https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/" onclick="if (!window.__cfRLUnblockHandlers) return false; javascript:window.open(this.dataset.href, &#39;&#39;, &#39;menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600&#39;);return false;">
						<span class="icon"> <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="15px" height="14.1px" viewBox="-301.4 387.5 15 14.1" enable-background="new -301.4 387.5 15 14.1" xml:space="preserve"> <g id="XMLID_398_"> <path id="XMLID_399_" fill="#FFFFFF" d="M-296.2,401.6c0-3.2,0-6.3,0-9.5h0.1c1,0,2,0,2.9,0c0.1,0,0.1,0,0.1,0.1c0,0.4,0,0.8,0,1.2 c0.1-0.1,0.2-0.3,0.3-0.4c0.5-0.7,1.2-1,2.1-1.1c0.8-0.1,1.5,0,2.2,0.3c0.7,0.4,1.2,0.8,1.5,1.4c0.4,0.8,0.6,1.7,0.6,2.5 c0,1.8,0,3.6,0,5.4v0.1c-1.1,0-2.1,0-3.2,0c0-0.1,0-0.1,0-0.2c0-1.6,0-3.2,0-4.8c0-0.4,0-0.8-0.2-1.2c-0.2-0.7-0.8-1-1.6-1 c-0.8,0.1-1.3,0.5-1.6,1.2c-0.1,0.2-0.1,0.5-0.1,0.8c0,1.7,0,3.4,0,5.1c0,0.2,0,0.2-0.2,0.2c-1,0-1.9,0-2.9,0 C-296.1,401.6-296.2,401.6-296.2,401.6z"></path> <path id="XMLID_400_" fill="#FFFFFF" d="M-298,401.6L-298,401.6c-1.1,0-2.1,0-3,0c-0.1,0-0.1,0-0.1-0.1c0-3.1,0-6.1,0-9.2 c0-0.1,0-0.1,0.1-0.1c1,0,2,0,2.9,0h0.1C-298,395.3-298,398.5-298,401.6z"></path> <path id="XMLID_401_" fill="#FFFFFF" d="M-299.6,390.9c-0.7-0.1-1.2-0.3-1.6-0.8c-0.5-0.8-0.2-2.1,1-2.4c0.6-0.2,1.2-0.1,1.8,0.2 c0.5,0.4,0.7,0.9,0.6,1.5c-0.1,0.7-0.5,1.1-1.1,1.3C-299.1,390.8-299.4,390.8-299.6,390.9L-299.6,390.9z"></path> </g> </svg> </span>
						<span class="simplesocialtxt">Share</span> </button>
</div>
	</section><!-- /.entry -->
	<div class="fix"></div>
<aside id="post-author">
	<div class="profile-image"><img alt="" src="./How to Explore the GAN Latent Space When Generating Faces_files/a0942b56b07831ac15d4a168a750e34a.png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=160&amp;d=mm&amp;r=g 2x" class="avatar avatar-80 photo" height="80" width="80" loading="lazy"></div>
	<div class="profile-content">
		<h4>About Jason Brownlee</h4>
		Jason Brownlee, PhD is a machine learning specialist who teaches developers how to get results with modern machine learning methods via hands-on tutorials.				<div class="profile-link">
			<a href="https://machinelearningmastery.com/author/jasonb/">
				View all posts by Jason Brownlee <span class="meta-nav">→</span>			</a>
		</div><!--#profile-link-->
			</div>
	<div class="fix"></div>
</aside>
<div class="post-utility"></div>
</article><!-- /.post -->
	        <div class="post-entries">
	            <div class="nav-prev fl"><a href="https://machinelearningmastery.com/how-to-develop-a-generative-adversarial-network-for-a-cifar-10-small-object-photographs-from-scratch/" rel="prev"><i class="fa fa-angle-left"></i> How to Develop a GAN to Generate CIFAR10 Small Color Photographs</a></div>
	            <div class="nav-next fr"><a href="https://machinelearningmastery.com/how-to-develop-a-conditional-generative-adversarial-network-from-scratch/" rel="next">How to Develop a Conditional GAN (cGAN) From Scratch <i class="fa fa-angle-right"></i></a></div>
	            <div class="fix"></div>
	        </div>

		<div id="comments">		 	<h3 id="comments-title">63 Responses to <em>How to Explore the GAN Latent Space When Generating Faces</em></h3>
		 	<ol class="commentlist">
				
		<li id="comment-491730" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-491730" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Explore the GAN Latent Space When Generating Faces_files/b409b6d6608e40a980f2b63ad03e7272.png" srcset="https://secure.gravatar.com/avatar/b409b6d6608e40a980f2b63ad03e7272?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Mankaran Singh</span>
	                <span class="date">July 5, 2019 at 5:15 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-491730" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Excellently detailed post ! Eagerly waiting for your book on GANs.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-491730" data-commentid="491730" data-postid="8135" data-belowelement="comment-491730" data-respondelement="respond" data-replyto="Reply to Mankaran Singh" aria-label="Reply to Mankaran Singh">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-491818" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-491818" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Explore the GAN Latent Space When Generating Faces_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">July 6, 2019 at 8:26 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-491818" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks!</p>
<p>Yes, this was a really fun tutorial to write 🙂</p>
<p>The new book should be ready in a week or two. I’m really excited about it.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-491818" data-commentid="491818" data-postid="8135" data-belowelement="comment-491818" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-493368" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-493368" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Explore the GAN Latent Space When Generating Faces_files/11fe8c12eee8439eec8d7cf30646fba7.png" srcset="https://secure.gravatar.com/avatar/11fe8c12eee8439eec8d7cf30646fba7?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://www.modyco.fr/fr/component/jsn/minel.html?Itemid=&amp;back=1" rel="external nofollow ugc" class="url">Minel</a></span>
	                <span class="date">July 19, 2019 at 1:55 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-493368" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason</p>
<p>I met some troubles using MTCNN after doing a pip install . I got the message “no module named cv2”<br>
I had to install it by typing :<br>
python -m pip install opencv-python<br>
best</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-493368" data-commentid="493368" data-postid="8135" data-belowelement="comment-493368" data-respondelement="respond" data-replyto="Reply to Minel" aria-label="Reply to Minel">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-493410" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-493410" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Explore the GAN Latent Space When Generating Faces_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">July 19, 2019 at 9:22 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-493410" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for sharing.</p>
<p>Yes, OpenCV is required.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-493410" data-commentid="493410" data-postid="8135" data-belowelement="comment-493410" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-494978" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-494978" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Explore the GAN Latent Space When Generating Faces_files/bc44af55c931a90d2a3c770f52e005a1.png" srcset="https://secure.gravatar.com/avatar/bc44af55c931a90d2a3c770f52e005a1?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Shubhesh</span>
	                <span class="date">August 1, 2019 at 12:28 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-494978" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I am getting this value<br>
Loaded: (50000, 218, 178, 3)<br>
 what might be the problem?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-494978" data-commentid="494978" data-postid="8135" data-belowelement="comment-494978" data-respondelement="respond" data-replyto="Reply to Shubhesh" aria-label="Reply to Shubhesh">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-495022" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-495022" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Explore the GAN Latent Space When Generating Faces_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">August 1, 2019 at 6:53 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-495022" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Is it possible that you skipped a step?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-495022" data-commentid="495022" data-postid="8135" data-belowelement="comment-495022" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-495131" class="comment even depth-3 parent">

	      	<div id="li-comment-495131" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Explore the GAN Latent Space When Generating Faces_files/bc44af55c931a90d2a3c770f52e005a1.png" srcset="https://secure.gravatar.com/avatar/bc44af55c931a90d2a3c770f52e005a1?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Shubhesh</span>
	                <span class="date">August 2, 2019 at 5:40 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-495131" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, it was silly mistake in one of the function. It’s fine now. Thanks.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-495131" data-commentid="495131" data-postid="8135" data-belowelement="comment-495131" data-respondelement="respond" data-replyto="Reply to Shubhesh" aria-label="Reply to Shubhesh">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-495157" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-495157" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Explore the GAN Latent Space When Generating Faces_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">August 2, 2019 at 6:56 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-495157" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Happy to hear that.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-495157" data-commentid="495157" data-postid="8135" data-belowelement="comment-495157" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-496276" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-496276" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Explore the GAN Latent Space When Generating Faces_files/d79e86ad53ec43b6c40eff008cb1d21a.png" srcset="https://secure.gravatar.com/avatar/d79e86ad53ec43b6c40eff008cb1d21a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ryan</span>
	                <span class="date">August 11, 2019 at 12:48 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-496276" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you for this amazing tutorial , I wonder how to do the same with Cycle Gans while generating faces , i.e creating angry face , smiling face, …</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-496276" data-commentid="496276" data-postid="8135" data-belowelement="comment-496276" data-respondelement="respond" data-replyto="Reply to Ryan" aria-label="Reply to Ryan">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-496306" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-496306" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Explore the GAN Latent Space When Generating Faces_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">August 11, 2019 at 6:00 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-496306" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It may not make sense with a cyclegan as it for image translation, not generating new images, like faces.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-496306" data-commentid="496306" data-postid="8135" data-belowelement="comment-496306" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-496773" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-496773" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Explore the GAN Latent Space When Generating Faces_files/25b22811d5d054627686e592ea2b11d1.png" srcset="https://secure.gravatar.com/avatar/25b22811d5d054627686e592ea2b11d1?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">D. Uys</span>
	                <span class="date">August 15, 2019 at 2:04 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-496773" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you for this.<br>
I have such a hard time wrapping my mind around what latent space is? I have gone through a few of your GAN tutorials as well as other tutorials. I feel that I have a good empirical understanding of what latent space is, and why it is used, but I have no idea how one decides on the shape. Why is it that in DCGAN the latent space is a 100D vector? WHy not 50D or 20D or 1000D?</p>
<p>This also stems from another tutorial you have where you use a GAN network for simple 1D function modeling, there you use a 5D latent space. I also read in some of the comments in your other article, that you said it becomes arbitrary to choose a different latent space shape? I hope I am asking the right question here.</p>
<p>If you could please give an ELI5 version, I would greatly appreciate it! Thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-496773" data-commentid="496773" data-postid="8135" data-belowelement="comment-496773" data-respondelement="respond" data-replyto="Reply to D. Uys" aria-label="Reply to D. Uys">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-496819" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-496819" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Explore the GAN Latent Space When Generating Faces_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">August 15, 2019 at 8:24 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-496819" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The size/shape is arbitrary. Larger may give more freedom, too large or too small may lead to an unstable model.</p>
<p>It is not a real thing, instead the model learns to apply meaning to it – to draw inspiration if you will, but in a consistent way so that it is ordered and different parts of the space map to different specific outputs – although it is a different structure/mapping each time the model is trained.</p>
<p>It is a crazy thing to understand. You’re not alone 🙂</p>
<p>I think I gave a good intro to “latent space” in this post:<br>
<a href="https://machinelearningmastery.com/what-are-generative-adversarial-networks-gans/" rel="nofollow ugc">https://machinelearningmastery.com/what-are-generative-adversarial-networks-gans/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-496819" data-commentid="496819" data-postid="8135" data-belowelement="comment-496819" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-503953" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-503953" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Explore the GAN Latent Space When Generating Faces_files/51055e4e18e894feebfee0b528661e02.png" srcset="https://secure.gravatar.com/avatar/51055e4e18e894feebfee0b528661e02?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jun</span>
	                <span class="date">October 4, 2019 at 3:58 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-503953" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello, I am quite a new to this field and your articles are being really helpful.<br>
However, since it is difficult to understand fully, May I ask a few specific questions?</p>
<p>First, I know train on batch function makes gan_model to improve its performance.<br>
But, I do not get that why generating latent_points always use randn function to make random noise.<br>
I am guessing that value of noise is not important because the gan model generates image are making better images as training process keeps going on even though the noise is always random.<br>
Is that right..? </p>
<p>Second,  Can you briefly tell me what is ‘arr_0’ in every process of loading npz files such as points = data[‘arr_0′]?</p>
<p>Third, vector arithmetic parts comes real hard to me and cannot figure out what is going on in this part.<br>
”’<br>
# average vectors<br>
smiling_woman = average_points(points, smiling_woman_ix)<br>
neutral_woman = average_points(points, neutral_woman_ix)<br>
neutral_man = average_points(points, neutral_man_ix)<br>
# combine all vectors<br>
all_vectors = vstack((smiling_woman, neutral_woman, neutral_man))</p>
<p># smiling woman – neutral woman + neutral man = smiling man<br>
result_vector = smiling_woman[-1] – neutral_woman[-1] + neutral_man[-1]<br>
”’<br>
Could you please tell us a little more details? I understand ‘average_points’ are making averages between vectors of dif images but cannot understand the inner part of average_point function and why the last element of vectors make the result_vector.</p>
<p>Thank you always for your articles.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-503953" data-commentid="503953" data-postid="8135" data-belowelement="comment-503953" data-respondelement="respond" data-replyto="Reply to Jun" aria-label="Reply to Jun">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-503988" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-503988" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Explore the GAN Latent Space When Generating Faces_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">October 4, 2019 at 5:53 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-503988" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>We generate random points in the latent space to generate new synthetic images.</p>
<p>The generator learns how to structure the latent space.</p>
<p>npz file format saves a list of arrays, we just access the first array saved.</p>
<p>Perhaps start with this much simpler example:<br>
<a href="https://machinelearningmastery.com/how-to-develop-a-generative-adversarial-network-for-a-1-dimensional-function-from-scratch-in-keras/" rel="nofollow ugc">https://machinelearningmastery.com/how-to-develop-a-generative-adversarial-network-for-a-1-dimensional-function-from-scratch-in-keras/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-503988" data-commentid="503988" data-postid="8135" data-belowelement="comment-503988" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-504221" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-504221" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Explore the GAN Latent Space When Generating Faces_files/e81c020cf359e485c3b1034a7b76ca7f.png" srcset="https://secure.gravatar.com/avatar/e81c020cf359e485c3b1034a7b76ca7f?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Dant.</span>
	                <span class="date">October 5, 2019 at 6:26 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-504221" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Why isn’t it classified as DCGAN even though it contains CNN in both discriminator and generator model?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-504221" data-commentid="504221" data-postid="8135" data-belowelement="comment-504221" data-respondelement="respond" data-replyto="Reply to Dant." aria-label="Reply to Dant.">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-504332" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-504332" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Explore the GAN Latent Space When Generating Faces_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">October 6, 2019 at 8:16 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-504332" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It is a type of DCGAN.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-504332" data-commentid="504332" data-postid="8135" data-belowelement="comment-504332" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-517438" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-517438" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Explore the GAN Latent Space When Generating Faces_files/50f37713d0dc5791c0f514fd3382f921.png" srcset="https://secure.gravatar.com/avatar/50f37713d0dc5791c0f514fd3382f921?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Silvia</span>
	                <span class="date">January 9, 2020 at 3:22 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-517438" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Have you also explored the possibility to reduce the dimension of the latent space? Here it is 100-dimensional, but it could be useful for some application to understand if there’s a lower bound that can’t be crossed. Or if there are effects on the training and which.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-517438" data-commentid="517438" data-postid="8135" data-belowelement="comment-517438" data-respondelement="respond" data-replyto="Reply to Silvia" aria-label="Reply to Silvia">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-517467" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-517467" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Explore the GAN Latent Space When Generating Faces_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">January 9, 2020 at 7:31 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-517467" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes I have experimented. Small and very small spaces results on mode collapse all the time.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-517467" data-commentid="517467" data-postid="8135" data-belowelement="comment-517467" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-523944" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-523944" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Explore the GAN Latent Space When Generating Faces_files/d4122b046375bb124004bb944bed2bc9.png" srcset="https://secure.gravatar.com/avatar/d4122b046375bb124004bb944bed2bc9?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">tvtaerum</span>
	                <span class="date">March 1, 2020 at 10:49 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-523944" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I am finally putting a description and code up on Github using what I learned from a couple of your wonderful Internet tutorials and I want to make certain I reference your work appropriately.  What I’m putting up is a cGAN with embedding using modifications of your work and Centeno’s work and I do some housekeeping such as illustrating how to restart a cGAN from where it is interrupted, automatically correcting for learning rates which aren’t too far out of line, and other housekeeping processes.  It’s the kinds of things a person might want to try to do when making “minor” modifications to what other people publish on the Internet and then discovering their “minor” modifications cause problems for convergence.  It is presently ‘private’ under   <a href="https://github.com/tvtaerum/cGans_with_embedding---housekeeping" rel="nofollow ugc">https://github.com/tvtaerum/cGans_with_embedding—housekeeping</a>   but I want to make certain I reference both you and your work appropriately.  I’ve barely begun putting stuff up but I’ve found it pays to do things correctly from the start.  If I, or other people, wish to do something like that, what is most appropriate?  Do you, by chance, even have an illustration?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-523944" data-commentid="523944" data-postid="8135" data-belowelement="comment-523944" data-respondelement="respond" data-replyto="Reply to tvtaerum" aria-label="Reply to tvtaerum">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-524026" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-524026" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Explore the GAN Latent Space When Generating Faces_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 2, 2020 at 6:13 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-524026" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Well done.</p>
<p>This can help you cite work:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/how-do-i-reference-or-cite-a-book-or-blog-post" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/how-do-i-reference-or-cite-a-book-or-blog-post</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-524026" data-commentid="524026" data-postid="8135" data-belowelement="comment-524026" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-524069" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-524069" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Explore the GAN Latent Space When Generating Faces_files/c5c86e7478615e99849712413dd16cd1.png" srcset="https://secure.gravatar.com/avatar/c5c86e7478615e99849712413dd16cd1?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Francis</span>
	                <span class="date">March 2, 2020 at 2:26 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-524069" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>0</p>
<p>I am trying to save a tensorflow kersa model, with this summary: Model: “sequential_2” etc. using the following command: model.save(‘my_model.h5’) I got the following error: ImportError:save_modelrequires h5py. So, I installed h5py, using conda install h5py After the installation, I got the version of h5py: h5py.__version__ ‘2.8.0’ Still, I got the same error. Even though, I imported h5py manually.</p>
<p>import h5py<br>
import tensorflow as tf<br>
from tensorflow import keras<br>
from tensorflow.keras import layers<br>
filename = ‘g_model.h5’<br>
model.save(filename)</p>
<p>**ImportError:** <code>save_model</code> requires h5py.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-524069" data-commentid="524069" data-postid="8135" data-belowelement="comment-524069" data-respondelement="respond" data-replyto="Reply to Francis" aria-label="Reply to Francis">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-524137" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-524137" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Explore the GAN Latent Space When Generating Faces_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 3, 2020 at 5:54 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-524137" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>See the example here:<br>
<a href="https://machinelearningmastery.com/tensorflow-tutorial-deep-learning-with-tf-keras/" rel="nofollow ugc">https://machinelearningmastery.com/tensorflow-tutorial-deep-learning-with-tf-keras/</a></p>
<p>Otherwise, perhaps post your error on stackoverflow.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-524137" data-commentid="524137" data-postid="8135" data-belowelement="comment-524137" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-528394" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-528394" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Explore the GAN Latent Space When Generating Faces_files/63ab119aed7f7fe39af6afdf7c0614d2.jpeg" srcset="https://secure.gravatar.com/avatar/63ab119aed7f7fe39af6afdf7c0614d2?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Alexander Soare</span>
	                <span class="date">April 5, 2020 at 2:19 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-528394" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi!</p>
<p>Thanks again for the awesome material. I started off with your CNN MNIST tutorial and I’ve learned so much since. I have one question about this one:<br>
In the function where you define the full gan, you set d_model.trainable = False. But I couldn’t find anywhere else in the code where you toggle it back to True before updating d_model weights in the training loop. Am I missing something here?</p>
<p>Best,<br>
Alex</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-528394" data-commentid="528394" data-postid="8135" data-belowelement="comment-528394" data-respondelement="respond" data-replyto="Reply to Alexander Soare" aria-label="Reply to Alexander Soare">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-528418" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-528418" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Explore the GAN Latent Space When Generating Faces_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 5, 2020 at 5:46 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-528418" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Well done.</p>
<p>We don’t set it back. The G is trained via the D without updating the D, learn more here:<br>
<a href="https://machinelearningmastery.com/how-to-code-the-generative-adversarial-network-training-algorithm-and-loss-functions/" rel="nofollow ugc">https://machinelearningmastery.com/how-to-code-the-generative-adversarial-network-training-algorithm-and-loss-functions/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-528418" data-commentid="528418" data-postid="8135" data-belowelement="comment-528418" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-529029" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-529029" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Explore the GAN Latent Space When Generating Faces_files/a9a63bf1f1744a4dc73c2c55db3c1551.png" srcset="https://secure.gravatar.com/avatar/a9a63bf1f1744a4dc73c2c55db3c1551?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Lloyd</span>
	                <span class="date">April 9, 2020 at 6:09 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-529029" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
I bought your book on GANs quite shortly after it came out, and have to say it (along with posts like these) are fantastic and very helpful.<br>
Throughout the book/posts, however, ive begun to notice something and was wondering:<br>
All the common applications of GANs work with square images… How would you recomend going about working with rectangular ones?<br>
While i get that reshaping and cropping is an easy way to get around this, what if you arent able to reshape the image?<br>
Ive been planning a study into the use of GANs for data augmentation applications in some datasets I handle at work, but when I begin to look at the available bibliography I notice that almost everyone works with data represented by square matrices (whether this be images or otherwise). Im working with different types of matrices at the moment for different applications, and not all matrices are related to images and above all they are NOT square. In most cases the data i obtain and work with are matrices represented by quite a few rows and only three columns. In some cases i have more columns but in general my datasets are aprox 13×3, 17×3 or 30×3, depending on the application im working with.<br>
Do you know of papers or applications of people who work with rectangular data? Or could you recomend a starting point of where i could search for some inspiration?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-529029" data-commentid="529029" data-postid="8135" data-belowelement="comment-529029" data-respondelement="respond" data-replyto="Reply to Lloyd" aria-label="Reply to Lloyd">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-529121" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-529121" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Explore the GAN Latent Space When Generating Faces_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 10, 2020 at 8:23 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-529121" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Lloyd!</p>
<p>Yes, I expect the results will hold for rectangular images, but as you say the network config will need adjustment.</p>
<p>Papers work with square images for simplicity.</p>
<p>Not off hand, sorry. I recommend experimenting.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-529121" data-commentid="529121" data-postid="8135" data-belowelement="comment-529121" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-529987" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-529987" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Explore the GAN Latent Space When Generating Faces_files/825aef46e821c5e6eae1b45378466a14.png" srcset="https://secure.gravatar.com/avatar/825aef46e821c5e6eae1b45378466a14?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jakob</span>
	                <span class="date">April 16, 2020 at 5:53 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-529987" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you for a great book, having a lot of fun with this. Since you asked for feedback, if we are explore extensions, here goes….<br>
I noticed that the quality of images in CelebA is varying. There are quite a lot of images where face is from side or very turned. Since MTCNN also provides position of nose and eyes I tried making a small change to the dataprep algorithm. Instead of picking 50K out of the 200K CelebA images by random I favor the ones where the vertical distance from nose center to center of eyes is short. This picks images where people are looking more straight ahead (and a few with crooked noses 🙂<br>
Giving the model a bit less variety and fewer outliers in poses generates more consistent results</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-529987" data-commentid="529987" data-postid="8135" data-belowelement="comment-529987" data-respondelement="respond" data-replyto="Reply to Jakob" aria-label="Reply to Jakob">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-530067" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-530067" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Explore the GAN Latent Space When Generating Faces_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 17, 2020 at 6:16 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-530067" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks.</p>
<p>Well done, thanks for sharing!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-530067" data-commentid="530067" data-postid="8135" data-belowelement="comment-530067" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-532185" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-532185" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Explore the GAN Latent Space When Generating Faces_files/2b8673cd9f41da328fc4c74711c56b8b.jpeg" srcset="https://secure.gravatar.com/avatar/2b8673cd9f41da328fc4c74711c56b8b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Junwei</span>
	                <span class="date">April 28, 2020 at 6:09 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-532185" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for your very good tutorial in detail. I have a question here, as you mentioned in the article that “The discriminator loss may crash down to values of 0.0 for real and generated samples.” I met this problem, but how does this happen? Could you explain the reason for this phenomenon?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-532185" data-commentid="532185" data-postid="8135" data-belowelement="comment-532185" data-respondelement="respond" data-replyto="Reply to Junwei" aria-label="Reply to Junwei">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-532262" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-532262" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Explore the GAN Latent Space When Generating Faces_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 29, 2020 at 6:23 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-532262" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, the model becomes unstable and fails.</p>
<p>GANs are very unstable, which makes them challenging to train:<br>
<a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/" rel="nofollow ugc">https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/</a></p>
<p>We don’t have good theories about their behaviour yet, so we focus on empirical methods – so called “gan hacks” or heuristics to stop them from failing:<br>
<a href="https://machinelearningmastery.com/how-to-train-stable-generative-adversarial-networks/" rel="nofollow ugc">https://machinelearningmastery.com/how-to-train-stable-generative-adversarial-networks/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-532262" data-commentid="532262" data-postid="8135" data-belowelement="comment-532262" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-532229" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-532229" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Explore the GAN Latent Space When Generating Faces_files/91fe85908781d99f4268a838338a81b0.png" srcset="https://secure.gravatar.com/avatar/91fe85908781d99f4268a838338a81b0?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Greg</span>
	                <span class="date">April 29, 2020 at 2:51 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-532229" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Because i spend about 3 day for discovering WHY import cv2 is not working, I’ll share my solution, for those of You, that could have this same type of problem.</p>
<p>For W10 N / pro N You need to install media feature pack.</p>
<p>Without this, any fancy method of instaling and importing cv2 will not work…</p>
<p>—</p>
<p>Thanks for this incredible blog Jason, I’m on way to use C-GAN in my mechanical PhD work, and You make many of this net secret much more clear for non direct AI/DL reserchers, as myself.<br>
I planning to buy next month Your GAN book.</p>
<p>Best regards!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-532229" data-commentid="532229" data-postid="8135" data-belowelement="comment-532229" data-respondelement="respond" data-replyto="Reply to Greg" aria-label="Reply to Greg">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-532277" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-532277" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Explore the GAN Latent Space When Generating Faces_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 29, 2020 at 6:32 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-532277" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>What is a “media feature pack”?</p>
<p>We did not even use opencv in this tutorial!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-532277" data-commentid="532277" data-postid="8135" data-belowelement="comment-532277" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-532353" class="comment even depth-3 parent">

	      	<div id="li-comment-532353" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Explore the GAN Latent Space When Generating Faces_files/91fe85908781d99f4268a838338a81b0.png" srcset="https://secure.gravatar.com/avatar/91fe85908781d99f4268a838338a81b0?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Greg</span>
	                <span class="date">April 29, 2020 at 4:34 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-532353" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes did not use it, but…MTCNN need it to work 🙂<br>
“media feature pack” is a pack with some features of OS system in W10 N series.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-532353" data-commentid="532353" data-postid="8135" data-belowelement="comment-532353" data-respondelement="respond" data-replyto="Reply to Greg" aria-label="Reply to Greg">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-532458" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-532458" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Explore the GAN Latent Space When Generating Faces_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 30, 2020 at 6:35 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-532458" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I have never heard of it.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-532458" data-commentid="532458" data-postid="8135" data-belowelement="comment-532458" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-536205" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-536205" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Explore the GAN Latent Space When Generating Faces_files/8b36dcd07928b196e1ee6d57fe2d2cda.png" srcset="https://secure.gravatar.com/avatar/8b36dcd07928b196e1ee6d57fe2d2cda?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">kiran Prakash Sawant</span>
	                <span class="date">May 24, 2020 at 9:48 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-536205" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for your very good tutorial in detail. pixel values must be scaled to the range [-1,1] to match the output of the generator model. Why we need to do this ??</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-536205" data-commentid="536205" data-postid="8135" data-belowelement="comment-536205" data-respondelement="respond" data-replyto="Reply to kiran Prakash Sawant" aria-label="Reply to kiran Prakash Sawant">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-536251" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-536251" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Explore the GAN Latent Space When Generating Faces_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">May 25, 2020 at 5:51 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-536251" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The generator performs better when generating pixels in the range -1 and 1.</p>
<p>To match the output of the generator model so both real and generated images have the same scale.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-536251" data-commentid="536251" data-postid="8135" data-belowelement="comment-536251" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-540384" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-540384" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Explore the GAN Latent Space When Generating Faces_files/fb109ca9203417e6c85a7c190b5c6720.png" srcset="https://secure.gravatar.com/avatar/fb109ca9203417e6c85a7c190b5c6720?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Aria</span>
	                <span class="date">June 21, 2020 at 1:42 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-540384" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi,</p>
<p>In this example, when updating the parameters of the generator, the discriminator variables will also be updated since the train_on_batch method is called on a sequential model containing both the generator and the discriminator. Should the generator parameters not be updated independently of that of the discriminator?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-540384" data-commentid="540384" data-postid="8135" data-belowelement="comment-540384" data-respondelement="respond" data-replyto="Reply to Aria" aria-label="Reply to Aria">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-540461" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-540461" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Explore the GAN Latent Space When Generating Faces_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">June 22, 2020 at 6:09 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-540461" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Not quite, we set the discriminator to not be trainable when it is part of the generator.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-540461" data-commentid="540461" data-postid="8135" data-belowelement="comment-540461" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-548842" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-548842" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Explore the GAN Latent Space When Generating Faces_files/258718ece13cb611be94cb99f0c2ff3c.png" srcset="https://secure.gravatar.com/avatar/258718ece13cb611be94cb99f0c2ff3c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Harry</span>
	                <span class="date">August 12, 2020 at 6:08 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-548842" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi thank you for your tutorial.<br>
I have an error. Plz help me<br>
‘tensorflow.python.framework.errors_impl.ResourceExhaustedError:<br>
OOM when allocating tensor with shape[128,128,80,80] and type float on/job:localhost/replica:0/task:0/device:GPU:0 by allocator GPU_0_bfc<br>
 [[node gradients_1/sequential_1/conv2d_2/convolution_grad/Conv2DBackpropInput (defined at \Users\HP\miniconda3\envs\Tensorflow_v2_py3\lib\site-packages\keras\backend\tensorflow_backend.py:3009) ]]’</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-548842" data-commentid="548842" data-postid="8135" data-belowelement="comment-548842" data-respondelement="respond" data-replyto="Reply to Harry" aria-label="Reply to Harry">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-548917" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-548917" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Explore the GAN Latent Space When Generating Faces_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">August 13, 2020 at 6:09 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-548917" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It looks like you ran out of memory.</p>
<p>Try running on an AWS EC2 instance with more RAM:<br>
<a href="https://machinelearningmastery.com/develop-evaluate-large-deep-learning-models-keras-amazon-web-services/" rel="nofollow ugc">https://machinelearningmastery.com/develop-evaluate-large-deep-learning-models-keras-amazon-web-services/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-548917" data-commentid="548917" data-postid="8135" data-belowelement="comment-548917" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-548976" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-548976" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Explore the GAN Latent Space When Generating Faces_files/258718ece13cb611be94cb99f0c2ff3c.png" srcset="https://secure.gravatar.com/avatar/258718ece13cb611be94cb99f0c2ff3c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Harry</span>
	                <span class="date">August 13, 2020 at 3:44 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-548976" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you. I solved this by reducing batch_size to 64(it was 128):)</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-548976" data-commentid="548976" data-postid="8135" data-belowelement="comment-548976" data-respondelement="respond" data-replyto="Reply to Harry" aria-label="Reply to Harry">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-549078" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-549078" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Explore the GAN Latent Space When Generating Faces_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">August 14, 2020 at 5:54 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-549078" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Nice work!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-549078" data-commentid="549078" data-postid="8135" data-belowelement="comment-549078" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-548977" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-548977" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Explore the GAN Latent Space When Generating Faces_files/258718ece13cb611be94cb99f0c2ff3c.png" srcset="https://secure.gravatar.com/avatar/258718ece13cb611be94cb99f0c2ff3c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Harry</span>
	                <span class="date">August 13, 2020 at 3:50 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-548977" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Your tutorial is so fantastic. I tried to use x-ray chest dataset. Because it is different from RGB containing datasets, it hasn’t worked. What could you recommend to do in this case? thank you in advance</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-548977" data-commentid="548977" data-postid="8135" data-belowelement="comment-548977" data-respondelement="respond" data-replyto="Reply to Harry" aria-label="Reply to Harry">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-549079" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-549079" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Explore the GAN Latent Space When Generating Faces_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">August 14, 2020 at 5:55 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-549079" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you!</p>
<p>Good question, I don’t have good advice off the cuff. You might have to experiment with a RGB encoding of your data.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-549079" data-commentid="549079" data-postid="8135" data-belowelement="comment-549079" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-563133" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-563133" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Explore the GAN Latent Space When Generating Faces_files/7ad7372b2ab9caed5ecf94d0a29cdfd5.jpeg" srcset="https://secure.gravatar.com/avatar/7ad7372b2ab9caed5ecf94d0a29cdfd5?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ali AOUF</span>
	                <span class="date">September 14, 2020 at 9:21 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-563133" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Greetings Sir!</p>
<p>Can I use your code for and InfoGAN human faces generation?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-563133" data-commentid="563133" data-postid="8135" data-belowelement="comment-563133" data-respondelement="respond" data-replyto="Reply to Ali AOUF" aria-label="Reply to Ali AOUF">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-563203" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-563203" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Explore the GAN Latent Space When Generating Faces_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">September 15, 2020 at 5:23 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-563203" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps try it and see?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-563203" data-commentid="563203" data-postid="8135" data-belowelement="comment-563203" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-563177" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-563177" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Explore the GAN Latent Space When Generating Faces_files/7ad7372b2ab9caed5ecf94d0a29cdfd5.jpeg" srcset="https://secure.gravatar.com/avatar/7ad7372b2ab9caed5ecf94d0a29cdfd5?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ali AOUF</span>
	                <span class="date">September 15, 2020 at 2:10 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-563177" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Sir, great tutorial.<br>
I am working on a human faces InfoGAN model for an academic research, and I was wondering if I can use your model as a base code since it is stable, and generates good figures.<br>
Thank you.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-563177" data-commentid="563177" data-postid="8135" data-belowelement="comment-563177" data-respondelement="respond" data-replyto="Reply to Ali AOUF" aria-label="Reply to Ali AOUF">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-563209" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-563209" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Explore the GAN Latent Space When Generating Faces_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">September 15, 2020 at 5:27 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-563209" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Try it and see.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-563209" data-commentid="563209" data-postid="8135" data-belowelement="comment-563209" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-563217" class="comment even depth-3 parent">

	      	<div id="li-comment-563217" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Explore the GAN Latent Space When Generating Faces_files/7ad7372b2ab9caed5ecf94d0a29cdfd5.jpeg" srcset="https://secure.gravatar.com/avatar/7ad7372b2ab9caed5ecf94d0a29cdfd5?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ali AOUF</span>
	                <span class="date">September 15, 2020 at 6:22 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-563217" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Ow, I already did. It worked perfectly. I am writing the report and I wanted to make sure that I have the permission to use your code and modify it.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-563217" data-commentid="563217" data-postid="8135" data-belowelement="comment-563217" data-respondelement="respond" data-replyto="Reply to Ali AOUF" aria-label="Reply to Ali AOUF">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-563219" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4 parent">

	      	<div id="li-comment-563219" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Explore the GAN Latent Space When Generating Faces_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">September 15, 2020 at 6:28 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-563219" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Well done!</p>
<p>Yes, as long as you clearly cite and link to the source:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/can-i-use-your-code-in-my-own-project" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/can-i-use-your-code-in-my-own-project</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-563219" data-commentid="563219" data-postid="8135" data-belowelement="comment-563219" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-563223" class="comment even depth-5">

	      	<div id="li-comment-563223" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Explore the GAN Latent Space When Generating Faces_files/7ad7372b2ab9caed5ecf94d0a29cdfd5.jpeg" srcset="https://secure.gravatar.com/avatar/7ad7372b2ab9caed5ecf94d0a29cdfd5?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ali AOUF</span>
	                <span class="date">September 15, 2020 at 7:02 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-563223" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Of course! thank you.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-564098" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-564098" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Explore the GAN Latent Space When Generating Faces_files/36d340c366e43694f102fcde6ad2d9d4.png" srcset="https://secure.gravatar.com/avatar/36d340c366e43694f102fcde6ad2d9d4?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://questioneurope.blogspot.com/" rel="external nofollow ugc" class="url">Dominique</a></span>
	                <span class="date">September 21, 2020 at 3:42 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-564098" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dear Jason,</p>
<p>thanks for your excellent books. This is the 7th book of you that I am reading and it is always a great pleasure. I almost spend all of my week end having fun with GAN. This week-end I wrote a review of Part III and Part IV of your book about GAN.<br>
<a href="https://questioneurope.blogspot.com/2020/09/generative-adversarial-network-with.html" rel="nofollow ugc">http://questioneurope.blogspot.com/2020/09/generative-adversarial-network-with.html</a></p>
<p>I also run in the same kind of network failure as people in the community when running cGAN, but after a second run it seems better.</p>
<p>Kind regards,<br>
Dominique</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-564098" data-commentid="564098" data-postid="8135" data-belowelement="comment-564098" data-respondelement="respond" data-replyto="Reply to Dominique" aria-label="Reply to Dominique">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-564120" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-564120" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Explore the GAN Latent Space When Generating Faces_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">September 21, 2020 at 8:15 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-564120" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks! Well done on your impressive progress.</p>
<p>GANs can be very tricky to run. You have to build up experience and confidence by building/training many different models – e.g. the approach taken in the book.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-564120" data-commentid="564120" data-postid="8135" data-belowelement="comment-564120" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-568573" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-568573" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Explore the GAN Latent Space When Generating Faces_files/eda5bf5e518cf430237a3ba2d38c7229.png" srcset="https://secure.gravatar.com/avatar/eda5bf5e518cf430237a3ba2d38c7229?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Lee</span>
	                <span class="date">October 18, 2020 at 8:30 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-568573" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Wonderful tutorial Jason. However, how can I interpolate between MNIST data that are used for the training?</p>
<p>I mean instead of using generated data.</p>
<p>Since the code doesn’t contain encoder and only contains generator as a decoder I guess not.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-568573" data-commentid="568573" data-postid="8135" data-belowelement="comment-568573" data-respondelement="respond" data-replyto="Reply to Lee" aria-label="Reply to Lee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-568667" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-568667" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Explore the GAN Latent Space When Generating Faces_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">October 19, 2020 at 6:39 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-568667" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I don’t understand your question. This tutorial is about a generator for generating pictures of faces, not mnist digits, and not transforms of other images.</p>
<p>Perhaps you are more interested in image translation GANs like pix2pix:<br>
<a href="https://machinelearningmastery.com/how-to-implement-pix2pix-gan-models-from-scratch-with-keras/" rel="nofollow ugc">https://machinelearningmastery.com/how-to-implement-pix2pix-gan-models-from-scratch-with-keras/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-568667" data-commentid="568667" data-postid="8135" data-belowelement="comment-568667" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-570708" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-570708" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Explore the GAN Latent Space When Generating Faces_files/eda5bf5e518cf430237a3ba2d38c7229.png" srcset="https://secure.gravatar.com/avatar/eda5bf5e518cf430237a3ba2d38c7229?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Kevin</span>
	                <span class="date">October 25, 2020 at 10:37 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-570708" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you for the explicit tutorial.<br>
Instead of interpolating generated data from latent space, how can I interpolate faces of the original celebA faces?<br>
I guess I would need some kind of encoder for that but don’t see how to map original face to the latent space!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-570708" data-commentid="570708" data-postid="8135" data-belowelement="comment-570708" data-respondelement="respond" data-replyto="Reply to Kevin" aria-label="Reply to Kevin">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-570770" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-570770" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Explore the GAN Latent Space When Generating Faces_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">October 26, 2020 at 6:49 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-570770" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>If the model is trained on the celebA dataset then interpolating the latent space will interpolate the celebA dataset.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-570770" data-commentid="570770" data-postid="8135" data-belowelement="comment-570770" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-590525" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-590525" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Explore the GAN Latent Space When Generating Faces_files/b33e16e64a40633489589f11e4db9a67.png" srcset="https://secure.gravatar.com/avatar/b33e16e64a40633489589f11e4db9a67?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ahmad</span>
	                <span class="date">January 1, 2021 at 8:32 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-590525" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dear Jason Brownlee,<br>
Thanks for sharing your good work. can you please help with the implementation of  basic face generation on 80×80 image sizes using Hinge loss function instead of Binary cross entropy loss in the same model. I tried using hinge loss by scaling data to range{-1  to 1}, but there is no progress in outputs generated(only blank grey images generated).</p>
<p>Best wishes</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-590525" data-commentid="590525" data-postid="8135" data-belowelement="comment-590525" data-respondelement="respond" data-replyto="Reply to Ahmad" aria-label="Reply to Ahmad">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-590615" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-590615" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Explore the GAN Latent Space When Generating Faces_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">January 2, 2021 at 6:23 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-590615" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps try adjusting the learning parametres of your model?<br>
Perhaps try adjusting the network architecture for your model?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-590615" data-commentid="590615" data-postid="8135" data-belowelement="comment-590615" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-592343" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-592343" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Explore the GAN Latent Space When Generating Faces_files/055ce2a4b6ac853b23a7ca5d1003cf5a.png" srcset="https://secure.gravatar.com/avatar/055ce2a4b6ac853b23a7ca5d1003cf5a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Artemiy</span>
	                <span class="date">January 9, 2021 at 12:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-592343" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi! Thank you very much for the article. I have a question: I decided to output the desriminator’s accuracy, every 5 training epochs for 10.000 images (in exactly the same way as in the article). That is, I saved the discriminator after every fifth epoch and ran its accuracy over 10,000 images. The fact is that the accuracy on real images jumps a lot: after the 5th epoch – the accuracy is 99 percent, after 15 – 75 percent, and after 20 again it is 92. The quality of the images improves after each epoch. Can you please tell me what is the reason for this spread?</p>
<p>real – is d1, fake – is d2.<br>
{<br>
	‘descriminator_model_005.h5’: {‘real’: 99.98000264167786, ‘fake’: 100.0},<br>
	‘descriminator_model_010.h5’: {‘real’: 99.40000176429749, ‘fake’: 100.0},<br>
	‘descriminator_model_015.h5’: {‘real’: 75.51000118255615, ‘fake’: 90.85999727249146},<br>
	‘descriminator_model_020.h5’: {‘real’: 92.91999936103821, ‘fake’: 97.50000238418579},<br>
	‘descriminator_model_025.h5’: {‘real’: 94.0999984741211, ‘fake’: 97.97000288963318},<br>
	‘descriminator_model_030.h5’: {‘real’: 91.86000227928162, ‘fake’: 97.61999845504761},<br>
	‘descriminator_model_035.h5’: {‘real’: 84.42999720573425, ‘fake’: 98.83000254631042},<br>
	‘descriminator_model_040.h5’: {‘real’: 78.43999862670898, ‘fake’: 97.36999869346619},<br>
	‘descriminator_model_050.h5’: {‘real’: 86.82000041007996, ‘fake’: 100.0},<br>
	‘descriminator_model_055.h5’: {‘real’: 80.95999956130981, ‘fake’: 99.55999851226807},<br>
	‘descriminator_model_060.h5’: {‘real’: 82.56000280380249, ‘fake’: 100.0}<br>
}</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-592343" data-commentid="592343" data-postid="8135" data-belowelement="comment-592343" data-respondelement="respond" data-replyto="Reply to Artemiy" aria-label="Reply to Artemiy">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-592388" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-592388" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Explore the GAN Latent Space When Generating Faces_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">January 9, 2021 at 6:43 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-592388" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Accuracy is a bad metric for gans. It is not reliable, instead see this:<br>
<a href="https://machinelearningmastery.com/how-to-evaluate-generative-adversarial-networks/" rel="nofollow ugc">https://machinelearningmastery.com/how-to-evaluate-generative-adversarial-networks/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-592388" data-commentid="592388" data-postid="8135" data-belowelement="comment-592388" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-598470" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-598470" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Explore the GAN Latent Space When Generating Faces_files/76d13016608d6325ab18bcb8656782af.png" srcset="https://secure.gravatar.com/avatar/76d13016608d6325ab18bcb8656782af?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">SudBan</span>
	                <span class="date">February 23, 2021 at 9:25 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-598470" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello, thank you very much for this informative article. I had a question regarding custom training. Instead of training on images, can I instead train and test the GAN using custom ’embedding’ that might have been generated from the images using some separate encoder network? That is, first I generate some embedding on my custom dataset using a separate network and then feed those vectors into the GAN. Do you have any suggestions? thanks!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-598470" data-commentid="598470" data-postid="8135" data-belowelement="comment-598470" data-respondelement="respond" data-replyto="Reply to SudBan" aria-label="Reply to SudBan">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-598477" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-598477" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Explore the GAN Latent Space When Generating Faces_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">February 23, 2021 at 10:15 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-598477" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You’re welcome.</p>
<p>I’m not sure off the cuff, perhaps not. You may need to think this through or even prototype it to see if it is viable.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#comment-598477" data-commentid="598477" data-postid="8135" data-belowelement="comment-598477" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
			</ol>
		 	</div>	<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#respond" style="display:none;">Click here to cancel reply.</a></small></h3><form action="https://machinelearningmastery.com/wp-comments-post.php?wpe-comment-post=mlmastery" method="post" id="commentform" class="comment-form"><p class="comment-form-comment"><label class="hide" for="comment">Comment</label> <textarea tabindex="4" id="comment" name="comment" cols="50" rows="10" maxlength="65525" required="required"></textarea></p><p class="comment-form-author"><input id="author" name="author" type="text" class="txt" tabindex="1" value="" size="30" aria-required="true"><label for="author">Name <span class="required">(required)</span></label> </p>
<p class="comment-form-email"><input id="email" name="email" type="text" class="txt" tabindex="2" value="" size="30" aria-required="true"><label for="email">Email (will not be published) <span class="required">(required)</span></label> </p>
<p class="comment-form-url"><input id="url" name="url" type="text" class="txt" tabindex="3" value="" size="30"><label for="url">Website</label></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit Comment"> <input type="hidden" name="comment_post_ID" value="8135" id="comment_post_ID">
<input type="hidden" name="comment_parent" id="comment_parent" value="0">
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="8acfbe73a2"></p><textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100" style="display: none !important;"></textarea><input type="hidden" id="ak_js" name="ak_js" value="1617306361770"></form>	</div><!-- #respond -->
	     
            </section><!-- /#main -->
                
            <aside id="sidebar">
<div id="woo_blogauthorinfo-2" class="widget widget_woo_blogauthorinfo"><span class="left"><img alt="" src="./How to Explore the GAN Latent Space When Generating Faces_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=176&amp;d=mm&amp;r=g 2x" class="avatar avatar-88 photo" height="88" width="88" loading="lazy"></span>
<p><strong>Welcome!</strong><br>
I'm <em>Jason Brownlee</em> PhD <br>
and I <strong>help developers</strong> get results with <strong>machine learning</strong>.<br>
<a href="https://machinelearningmastery.com/about">Read more</a></p>
<div class="fix"></div>
</div><div id="custom_html-89_clone" class="widget_text widget widget_custom_html q2w3-widget-clone-primary" style="top: 10px; width: 306.25px; height: 68.4px; visibility: hidden;"></div><div id="custom_html-89" class="widget_text widget widget_custom_html" style="top: 10px; width: 306.25px; position: fixed;"><div class="textwidget custom-html-widget"><h4>Never miss a tutorial:</h4>
<br>
<div style="text-align: left;">
<a href="https://www.linkedin.com/company/machine-learning-mastery/"><img width="30" height="30" src="./How to Explore the GAN Latent Space When Generating Faces_files/small_icon_blue_linkedin3.webp" alt="LinkedIn"></a>
&nbsp;&nbsp;&nbsp;
<a href="https://twitter.com/TeachTheMachine"><img width="30" height="30" src="./How to Explore the GAN Latent Space When Generating Faces_files/small_icon_blue_twitter3.webp" alt="Twitter"></a>
&nbsp;&nbsp;&nbsp;
<a href="https://www.facebook.com/MachineLearningMastery/"><img width="30" height="30" src="./How to Explore the GAN Latent Space When Generating Faces_files/small_icon_blue_facebook3.webp" alt="Facebook"></a>
&nbsp;&nbsp;&nbsp;
<a href="https://machinelearningmastery.com/newsletter/"><img width="30" height="30" src="./How to Explore the GAN Latent Space When Generating Faces_files/small_icon_blue_email3.webp" alt="Email Newsletter"></a>
&nbsp;&nbsp;&nbsp;
<a href="https://machinelearningmastery.com/rss-feed/"><img width="30" height="30" src="./How to Explore the GAN Latent Space When Generating Faces_files/small_icon_blue_rss3.webp" alt="RSS Feed"></a>
</div></div></div><div id="custom_html-27_clone" class="widget_text widget widget_custom_html q2w3-widget-clone-primary" style="top: 108.4px; width: 306.25px; height: 416px; visibility: hidden;"></div><div id="custom_html-27" class="widget_text widget widget_custom_html" style="top: 108.4px; width: 306.25px; position: fixed;"><div class="textwidget custom-html-widget"><h4>Picked for you:</h4>
<br>
<div class="display-posts-listing image-left"><div class="listing-item"><a class="image" href="https://machinelearningmastery.com/how-to-develop-a-pix2pix-gan-for-image-to-image-translation/"><img width="150" height="150" src="./How to Explore the GAN Latent Space When Generating Faces_files/Plot-of-Satellite-to-Google-Map-Translated-Images-Using-Pix2Pix-After-100-Training-Epochs-150x150.png" class="attachment-thumbnail size-thumbnail wp-post-image" alt="Plot of Satellite to Google Map Translated Images Using Pix2Pix After 100 Training Epochs" loading="lazy"></a> <a class="title" href="https://machinelearningmastery.com/how-to-develop-a-pix2pix-gan-for-image-to-image-translation/" rel="nofollow">How to Develop a Pix2Pix GAN for Image-to-Image Translation</a></div><div class="listing-item"><a class="image" href="https://machinelearningmastery.com/how-to-develop-a-generative-adversarial-network-for-a-1-dimensional-function-from-scratch-in-keras/"><img width="150" height="150" src="./How to Explore the GAN Latent Space When Generating Faces_files/Scatter-Plot-of-Real-and-Generated-Examples-for-the-Target-Function-After-10000-Iterations-150x1.webp" class="attachment-thumbnail size-thumbnail wp-post-image" alt="Scatter Plot of Real and Generated Examples for the Target Function After 10,000 Iterations." loading="lazy"></a> <a class="title" href="https://machinelearningmastery.com/how-to-develop-a-generative-adversarial-network-for-a-1-dimensional-function-from-scratch-in-keras/" rel="nofollow">How to Develop a 1D Generative Adversarial Network From Scratch in Keras</a></div><div class="listing-item"><a class="image" href="https://machinelearningmastery.com/cyclegan-tutorial-with-keras/"><img width="150" height="150" src="./How to Explore the GAN Latent Space When Generating Faces_files/Plot-of-a-Real-Photo-of-a-Horse-Translation-to-Zebra-and-Reconstructed-Photo-of-a-Horse-using-Cyc.png" class="attachment-thumbnail size-thumbnail wp-post-image" alt="Plot of a Real Photo of a Horse, Translation to Zebra, and Reconstructed Photo of a Horse Using CycleGAN." loading="lazy"></a> <a class="title" href="https://machinelearningmastery.com/cyclegan-tutorial-with-keras/" rel="nofollow">How to Develop a CycleGAN for Image-to-Image Translation with Keras</a></div><div class="listing-item"><a class="image" href="https://machinelearningmastery.com/how-to-develop-a-conditional-generative-adversarial-network-from-scratch/"><img width="150" height="150" src="./How to Explore the GAN Latent Space When Generating Faces_files/Example-of-100-Generated-items-of-Clothing-using-an-Conditional-GAN-150x150.png" class="attachment-thumbnail size-thumbnail wp-post-image" alt="Example of 100 Generated items of Clothing using a Conditional GAN." loading="lazy"></a> <a class="title" href="https://machinelearningmastery.com/how-to-develop-a-conditional-generative-adversarial-network-from-scratch/" rel="nofollow">How to Develop a Conditional GAN (cGAN) From Scratch</a></div><div class="listing-item"><a class="image" href="https://machinelearningmastery.com/how-to-train-a-progressive-growing-gan-in-keras-for-synthesizing-faces/"><img width="150" height="150" src="./How to Explore the GAN Latent Space When Generating Faces_files/Synthetic-Celebrity-Faces-at-128x128-Resolution-After-Tuning-Generated-by-the-Progressive-Growing.png" class="attachment-thumbnail size-thumbnail wp-post-image" alt="Synthetic Celebrity Faces at 128x128 Resolution After Tuning Generated by the Progressive Growing GAN" loading="lazy"></a> <a class="title" href="https://machinelearningmastery.com/how-to-train-a-progressive-growing-gan-in-keras-for-synthesizing-faces/" rel="nofollow">How to Train a Progressive Growing GAN in Keras for Synthesizing Faces</a></div></div></div></div><div id="custom_html-5_clone" class="widget_text widget widget_custom_html q2w3-widget-clone-primary" style="top: 554.4px; width: 306.25px; height: 138.4px; visibility: hidden;"></div><div id="custom_html-5" class="widget_text widget widget_custom_html" style="top: 554.4px; width: 306.25px; position: fixed;"><div class="textwidget custom-html-widget"><div style="text-align: center;">
	<p></p><h4>Loving the Tutorials?</h4><p></p>

<p>The <a href="https://machinelearningmastery.com/generative_adversarial_networks/" rel="nofollow">GANs with Python</a> EBook is<br> where you'll find the <strong><i>Really Good</i></strong> stuff.</p>

<a href="https://machinelearningmastery.com/generative_adversarial_networks/" class="woo-sc-button  red"><span class="woo-">&gt;&gt; See What's Inside</span></a>

</div></div></div></aside><!-- /#sidebar -->

		</div><!-- /#main-sidebar-container -->         

		
    </div><!-- /#content -->
	
	<footer id="footer" class="col-full">

		
		<div id="copyright" class="col-left">
			<p>© 2021 Machine Learning Mastery Pty. Ltd. All Rights Reserved.<br>
<a href="https://www.linkedin.com/company/machine-learning-mastery/">LinkedIn</a> |
<a href="https://twitter.com/TeachTheMachine">Twitter</a> |
<a href="https://www.facebook.com/MachineLearningMastery/">Facebook</a> |
<a href="https://machinelearningmastery.com/newsletter/">Newsletter</a> |
<a href="https://machinelearningmastery.com/rss-feed/">RSS</a></p>		</div>

		<div id="credit" class="col-right">
			<p><a href="https://machinelearningmastery.com/privacy/">Privacy</a> | 
<a href="https://machinelearningmastery.com/disclaimer/">Disclaimer</a> | 
<a href="https://machinelearningmastery.com/terms-of-service/">Terms</a> | 
<a href="https://machinelearningmastery.com/contact/">Contact</a> |
<a href="https://machinelearningmastery.com/sitemap/">Sitemap</a> |
<a href="https://machinelearningmastery.com/site-search/">Search</a></p>		</div>

	</footer>

	
	</div><!-- /#inner-wrapper -->

</div><!-- /#wrapper -->

<div class="fix"></div><!--/.fix-->

<!-- Drip -->
<script data-cfasync="false" type="text/javascript">
  var _dcq = _dcq || [];
  var _dcs = _dcs || {};
  _dcs.account = '9556588';

  (function() {
    var dc = document.createElement('script');
    dc.type = 'text/javascript'; dc.async = true;
    dc.src = '//tag.getdrip.com/9556588.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(dc, s);
  })();
</script>
<!-- end Drip -->
<script type="text/javascript" id="rocket-browser-checker-js-after">
"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}var RocketBrowserCompatibilityChecker=function(){function RocketBrowserCompatibilityChecker(options){_classCallCheck(this,RocketBrowserCompatibilityChecker),this.passiveSupported=!1,this._checkPassiveOption(this),this.options=!!this.passiveSupported&&options}return _createClass(RocketBrowserCompatibilityChecker,[{key:"_checkPassiveOption",value:function(self){try{var options={get passive(){return!(self.passiveSupported=!0)}};window.addEventListener("test",null,options),window.removeEventListener("test",null,options)}catch(err){self.passiveSupported=!1}}},{key:"initRequestIdleCallback",value:function(){!1 in window&&(window.requestIdleCallback=function(cb){var start=Date.now();return setTimeout(function(){cb({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(Date.now()-start))}})},1)}),!1 in window&&(window.cancelIdleCallback=function(id){return clearTimeout(id)})}},{key:"isDataSaverModeOn",value:function(){return"connection"in navigator&&!0===navigator.connection.saveData}},{key:"supportsLinkPrefetch",value:function(){var elem=document.createElement("link");return elem.relList&&elem.relList.supports&&elem.relList.supports("prefetch")&&window.IntersectionObserver&&"isIntersecting"in IntersectionObserverEntry.prototype}},{key:"isSlowConnection",value:function(){return"connection"in navigator&&"effectiveType"in navigator.connection&&("2g"===navigator.connection.effectiveType||"slow-2g"===navigator.connection.effectiveType)}}]),RocketBrowserCompatibilityChecker}();
</script>
<script type="text/javascript" id="rocket-delay-js-js-after">
(function() {
"use strict";var e=function(){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}}();function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var t=function(){function r(e,t){n(this,r),this.attrName="data-rocketlazyloadscript",this.browser=t,this.options=this.browser.options,this.triggerEvents=e,this.userEventListener=this.triggerListener.bind(this)}return e(r,[{key:"init",value:function(){this._addEventListener(this)}},{key:"reset",value:function(){this._removeEventListener(this)}},{key:"_addEventListener",value:function(t){this.triggerEvents.forEach(function(e){return window.addEventListener(e,t.userEventListener,t.options)})}},{key:"_removeEventListener",value:function(t){this.triggerEvents.forEach(function(e){return window.removeEventListener(e,t.userEventListener,t.options)})}},{key:"_loadScriptSrc",value:function(){var r=this,e=document.querySelectorAll("script["+this.attrName+"]");0!==e.length&&Array.prototype.slice.call(e).forEach(function(e){var t=e.getAttribute(r.attrName);e.setAttribute("src",t),e.removeAttribute(r.attrName)}),this.reset()}},{key:"triggerListener",value:function(){this._loadScriptSrc(),this._removeEventListener(this)}}],[{key:"run",value:function(){RocketBrowserCompatibilityChecker&&new r(["keydown","mouseover","touchmove","touchstart","wheel"],new RocketBrowserCompatibilityChecker({passive:!0})).init()}}]),r}();t.run();
}());
</script>
<script type="text/javascript" id="rocket-preload-links-js-extra">
/* <![CDATA[ */
var RocketPreloadLinksConfig = {"excludeUris":"\/(.+\/)?feed\/?.+\/?|\/(?:.+\/)?embed\/|\/(index\\.php\/)?wp\\-json(\/.*|$)|\/wp-admin\/|\/logout\/|\/wp-login.php","usesTrailingSlash":"1","imageExt":"jpg|jpeg|gif|png|tiff|bmp|webp|avif","fileExt":"jpg|jpeg|gif|png|tiff|bmp|webp|avif|php|pdf|html|htm","siteUrl":"https:\/\/machinelearningmastery.com","onHoverDelay":"100","rateThrottle":"3"};
/* ]]> */
</script>
<script type="text/javascript" id="rocket-preload-links-js-after">
(function() {
"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}();function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var t=function(){function n(e,t){i(this,n),this.browser=e,this.config=t,this.options=this.browser.options,this.prefetched=new Set,this.eventTime=null,this.threshold=1111,this.numOnHover=0}return e(n,[{key:"init",value:function(){!this.browser.supportsLinkPrefetch()||this.browser.isDataSaverModeOn()||this.browser.isSlowConnection()||(this.regex={excludeUris:RegExp(this.config.excludeUris,"i"),images:RegExp(".("+this.config.imageExt+")$","i"),fileExt:RegExp(".("+this.config.fileExt+")$","i")},this._initListeners(this))}},{key:"_initListeners",value:function(e){-1<this.config.onHoverDelay&&document.addEventListener("mouseover",e.listener.bind(e),e.listenerOptions),document.addEventListener("mousedown",e.listener.bind(e),e.listenerOptions),document.addEventListener("touchstart",e.listener.bind(e),e.listenerOptions)}},{key:"listener",value:function(e){var t=e.target.closest("a"),n=this._prepareUrl(t);if(null!==n)switch(e.type){case"mousedown":case"touchstart":this._addPrefetchLink(n);break;case"mouseover":this._earlyPrefetch(t,n,"mouseout")}}},{key:"_earlyPrefetch",value:function(t,e,n){var i=this,r=setTimeout(function(){if(r=null,0===i.numOnHover)setTimeout(function(){return i.numOnHover=0},1e3);else if(i.numOnHover>i.config.rateThrottle)return;i.numOnHover++,i._addPrefetchLink(e)},this.config.onHoverDelay);t.addEventListener(n,function e(){t.removeEventListener(n,e,{passive:!0}),null!==r&&(clearTimeout(r),r=null)},{passive:!0})}},{key:"_addPrefetchLink",value:function(i){return this.prefetched.add(i.href),new Promise(function(e,t){var n=document.createElement("link");n.rel="prefetch",n.href=i.href,n.onload=e,n.onerror=t,document.head.appendChild(n)}).catch(function(){})}},{key:"_prepareUrl",value:function(e){if(null===e||"object"!==(void 0===e?"undefined":r(e))||!1 in e||-1===["http:","https:"].indexOf(e.protocol))return null;var t=e.href.substring(0,this.config.siteUrl.length),n=this._getPathname(e.href,t),i={original:e.href,protocol:e.protocol,origin:t,pathname:n,href:t+n};return this._isLinkOk(i)?i:null}},{key:"_getPathname",value:function(e,t){var n=t?e.substring(this.config.siteUrl.length):e;return n.startsWith("/")||(n="/"+n),this._shouldAddTrailingSlash(n)?n+"/":n}},{key:"_shouldAddTrailingSlash",value:function(e){return this.config.usesTrailingSlash&&!e.endsWith("/")&&!this.regex.fileExt.test(e)}},{key:"_isLinkOk",value:function(e){return null!==e&&"object"===(void 0===e?"undefined":r(e))&&(!this.prefetched.has(e.href)&&e.origin===this.config.siteUrl&&-1===e.href.indexOf("?")&&-1===e.href.indexOf("#")&&!this.regex.excludeUris.test(e.href)&&!this.regex.images.test(e.href))}}],[{key:"run",value:function(){"undefined"!=typeof RocketPreloadLinksConfig&&new n(new RocketBrowserCompatibilityChecker({capture:!0,passive:!0}),RocketPreloadLinksConfig).init()}}]),n}();t.run();
}());
</script>



<script type="text/javascript">
		document.addEventListener("DOMContentLoaded", function() {
			var if_ssb_exist = document.getElementsByClassName( "simplesocialbuttons" ).length > 0;
			if (if_ssb_exist) {
				var ssb_admin_ajax = 'https://machinelearningmastery.com/wp-admin/admin-ajax.php';
				var ssb_post_id = 8135 ;
				var ssb_post_url = 'https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/';
				var ssb_alternate_post_url = 'http://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/';
				jQuery( document ).ready(function(){
				var is_ssb_used = jQuery('.simplesocialbuttons');
				if( is_ssb_used ) {

					var data = {
					'action': 'ssb_fetch_data',
					'postID': ssb_post_id
				};
					jQuery.post(ssb_admin_ajax, data, function(data, textStatus, xhr) {
						var array = JSON.parse(data);
						jQuery.each( array, function( index, value ){

							if( index == 'total' ){
								jQuery('.ssb_'+ index +'_counter').html(value + '<span>Shares</span>');
							}else{
								jQuery('.ssb_'+ index +'_counter').html(value);
							}
						});

					});
				}
				})

			//ssbPlugin.fetchFacebookShares();
			}
		});

		</script><script type="text/javascript">window.lazyLoadOptions={elements_selector:"iframe[data-lazy-src]",data_src:"lazy-src",data_srcset:"lazy-srcset",data_sizes:"lazy-sizes",class_loading:"lazyloading",class_loaded:"lazyloaded",threshold:300,callback_loaded:function(element){if(element.tagName==="IFRAME"&&element.dataset.rocketLazyload=="fitvidscompatible"){if(element.classList.contains("lazyloaded")){if(typeof window.jQuery!="undefined"){if(jQuery.fn.fitVids){jQuery(element).parent().fitVids()}}}}}};window.addEventListener('LazyLoad::Initialized',function(e){var lazyLoadInstance=e.detail.instance;if(window.MutationObserver){var observer=new MutationObserver(function(mutations){var image_count=0;var iframe_count=0;var rocketlazy_count=0;mutations.forEach(function(mutation){for(i=0;i<mutation.addedNodes.length;i++){if(typeof mutation.addedNodes[i].getElementsByTagName!=='function'){continue}
if(typeof mutation.addedNodes[i].getElementsByClassName!=='function'){continue}
images=mutation.addedNodes[i].getElementsByTagName('img');is_image=mutation.addedNodes[i].tagName=="IMG";iframes=mutation.addedNodes[i].getElementsByTagName('iframe');is_iframe=mutation.addedNodes[i].tagName=="IFRAME";rocket_lazy=mutation.addedNodes[i].getElementsByClassName('rocket-lazyload');image_count+=images.length;iframe_count+=iframes.length;rocketlazy_count+=rocket_lazy.length;if(is_image){image_count+=1}
if(is_iframe){iframe_count+=1}}});if(image_count>0||iframe_count>0||rocketlazy_count>0){lazyLoadInstance.update()}});var b=document.getElementsByTagName("body")[0];var config={childList:!0,subtree:!0};observer.observe(b,config)}},!1)</script><script async="" data-no-minify="1" src="./How to Explore the GAN Latent Space When Generating Faces_files/lazyload.min.js.download" type="text/javascript"></script><script src="./How to Explore the GAN Latent Space When Generating Faces_files/b473ab520a9bde0ca73433f7d50abbad.js.download" data-minify="1" defer="" type="text/javascript"></script>

<!-- This website is like a Rocket, isn't it? Performance optimized by WP Rocket. Learn more: https://wp-rocket.me --><div class="drip-tab-container">
  <div id="drip-2211" class="drip-tab bottom right no-image classic">
    <div id="drip-header-2211" class="drip-header">
      <a href="https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/#" id="drip-toggle-2211" class="drip-toggle">
        <h2 id="drip-teaser-2211">Start Machine Learning</h2>
        <span id="drip-tab-up-2211" class="drip-arrow up">
          <svg width="12px" height="8px" viewBox="1362 659 12 8" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
            <polygon id="right_angle" stroke="none" fill="#FFFFFF" fill-rule="evenodd" transform="translate(1368.000000, 662.703125) rotate(-90.000000) translate(-1368.000000, -662.703125) " points="1364.29688 667.296875 1368.89062 662.703125 1364.29688 658.109375 1365.70312 656.703125 1371.70312 662.703125 1365.70312 668.703125"></polygon>
          </svg>
        </span>
        <span id="drip-tab-down-2211" class="drip-arrow down" style="display: none"></span>
      </a>
    </div>

    <div id="drip-content-2211" class="drip-content drip-clearfix" style="height: auto; bottom: -497px;">
      <div id="drip-form-panel-2211" class="drip-panel" style="display: block;">
        <a id="drip-close-2211" class="drip-close">×</a>
        <h3 id="drip-content-header-2211">Start Machine Learning</h3>
        <div id="drip-scroll-2211" class="drip-scroll">
          <div class="drip-clearfix">
            <div class="drip-description">You can master applied Machine Learning&nbsp;<br>
<strong>without math or fancy degrees</strong>.<br>
Find out how in this <em>free</em>&nbsp;and <em>practical</em>&nbsp;course.</div>
          </div>
          <form id="drip-form-2211">
            <div style="display: none">
              <input type="hidden" name="form_id" value="2211">
              
            </div>
            <dl class="no-labels">
                  <dt class="label-for-type-email">
    Email Address
      <span title="Required"> *</span>
  </dt>
  <dd>
    <input type="email" name="fields[email]" value="" placeholder="Email Address" class="drip-text-field" id="drip-email-field-2211" tabindex="0">
<div id="drip-errors-for-email-2211" class="drip-errors"></div>

  </dd>

                  <dt class="label-for-type-eu_consent">
    
  </dt>
  <dd>
      <div class="classic--checkbox hidden" data-container="eu-checkbox">
    <input type="hidden" name="fields[eu_consent]" id="drip-field-eu_consent-2211-denied" value="denied" disabled="disabled">
    <input type="checkbox" name="fields[eu_consent]" id="drip-field-eu_consent-2211" value="granted" disabled="disabled">
    <label for="drip-field-eu_consent-2211">I consent to receive information about services and special offers by email. For more information, see the <a href="https://machinelearningmastery.com/privacy/">Privacy Policy</a>.</label>
  </div>

  </dd>

                <input type="hidden" name="fields[eu_consent_message]" value="I consent to receive information about services and special offers by email. For more information, see the Privacy Policy (https://machinelearningmastery.com/privacy/)." tabindex="-1">

              <div style="display: none;" aria-hidden="true">
  <dt for="website">Website</dt>
  <dd>
    <input type="text" id="website" name="website" placeholder="Website" class="drip-text-field" tabindex="-1" autocomplete="false" value="">
  </dd>
</div>

            </dl>
            <div class="form-controls">
              <input type="submit" name="submit" value="Start My Email Course" id="drip-submit-2211" class="drip-submit-button">
            </div>
            <div id="drip-errors-for-base-2211" class="drip-errors dfwid-error"></div>

          </form>
        </div>
      </div>

      <div id="drip-success-panel-2211" class="drip-success drip-panel drip-clearfix drip-form-success-message" style="display: none">
        <a id="drip-hide-2211" class="drip-close">×</a>
        <h3>Thank you for signing up!</h3>
        <p class="drip-description">Please check your email and click the link provided to confirm your subscription.</p>
      </div>
    </div>
  </div>
</div><div style="position: absolute; inset: 0px; z-index: 2147483646; background: black; width: 100%; opacity: 0.5; display: none; height: 48282px;"></div><iframe src="./How to Explore the GAN Latent Space When Generating Faces_files/saved_resource.html" style="position: absolute; left: 0px; top: 0px; width: 100%; display: none; border: none; z-index: 2147483647; height: 794px;"></iframe><iframe scrolling="no" frameborder="0" allowtransparency="true" src="./How to Explore the GAN Latent Space When Generating Faces_files/widget_iframe.0edc1ef9f8b82d9b79c6115bda79f63f.html" title="Twitter settings iframe" style="display: none;"></iframe><iframe id="rufous-sandbox" scrolling="no" frameborder="0" allowtransparency="true" allowfullscreen="true" style="position: absolute; visibility: hidden; display: none; width: 0px; height: 0px; padding: 0px; border: none;" title="Twitter analytics iframe" src="./How to Explore the GAN Latent Space When Generating Faces_files/saved_resource(1).html"></iframe></body></html>