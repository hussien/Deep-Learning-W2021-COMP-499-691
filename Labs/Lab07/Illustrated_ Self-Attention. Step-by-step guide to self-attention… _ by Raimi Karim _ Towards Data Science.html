<!DOCTYPE html>
<!-- saved from url=(0070)https://towardsdatascience.com/illustrated-self-attention-2d627e33b20a -->
<html lang="en" data-rh="lang"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script async="" src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/branch-latest.min.js.download"></script><script async="" src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/analytics.js.download"></script><script type="text/javascript" async="" src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/recaptcha__en.js.download" crossorigin="anonymous" integrity="sha384-EybSWcHgiPeEiW8PyVFCqH8ltF5BJVYLCCHJpTp2QsYs58TZJuGZOUGfGAPF4IjR"></script><script defer="" src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/16180790160.js.download"></script><title>Illustrated: Self-Attention. Step-by-step guide to self-attention… | by Raimi Karim | Towards Data Science</title><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"><meta data-rh="true" name="theme-color" content="#000000"><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"><meta data-rh="true" property="al:ios:app_name" content="Medium"><meta data-rh="true" property="al:ios:app_store_id" content="828256236"><meta data-rh="true" property="al:android:package" content="com.medium.reader"><meta data-rh="true" property="fb:app_id" content="542599432471018"><meta data-rh="true" property="og:site_name" content="Medium"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2021-02-18T11:14:47.638Z"><meta data-rh="true" name="title" content="Illustrated: Self-Attention. Step-by-step guide to self-attention… | by Raimi Karim | Towards Data Science"><meta data-rh="true" property="og:title" content="Illustrated: Self-Attention"><meta data-rh="true" property="twitter:title" content="Illustrated: Self-Attention"><meta data-rh="true" name="twitter:site" content="@TDataScience"><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/2d627e33b20a"><meta data-rh="true" property="al:android:url" content="medium://p/2d627e33b20a"><meta data-rh="true" property="al:ios:url" content="medium://p/2d627e33b20a"><meta data-rh="true" property="al:android:app_name" content="Medium"><meta data-rh="true" name="description" content="This article walks you through the mathematical operations in a self-attention module. Includes illustrations and code."><meta data-rh="true" property="og:description" content="Step-by-step guide to self-attention with illustration and code"><meta data-rh="true" property="twitter:description" content="Step-by-step guide to self-attention with illustration and code"><meta data-rh="true" property="og:url" content="https://towardsdatascience.com/illustrated-self-attention-2d627e33b20a"><meta data-rh="true" property="al:web:url" content="https://towardsdatascience.com/illustrated-self-attention-2d627e33b20a"><meta data-rh="true" property="og:image" content="https://miro.medium.com/freeze/max/1200/1*_92bnsMJy8Bl539G4v93yg.gif"><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/freeze/max/1200/1*_92bnsMJy8Bl539G4v93yg.gif"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="article:author" content="https://medium.com/@remykarem"><meta data-rh="true" name="twitter:creator" content="@remykarem"><meta data-rh="true" name="author" content="Raimi Karim"><meta data-rh="true" name="robots" content="index,follow,max-image-preview:large"><meta data-rh="true" name="referrer" content="unsafe-url"><meta data-rh="true" name="twitter:label1" content="Reading time"><meta data-rh="true" name="twitter:data1" content="8 min read"><meta data-rh="true" name="parsely-post-id" content="2d627e33b20a"><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="https://towardsdatascience.com/osd.xml"><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://miro.medium.com/fit/c/152/152/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://miro.medium.com/fit/c/120/120/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://miro.medium.com/fit/c/76/76/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://miro.medium.com/fit/c/60/60/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"><link data-rh="true" rel="mask-icon" href="https://cdn-static-1.medium.com/_/fp/icons/Medium-Avatar-500x500.svg" color="#171717"><link data-rh="true" id="glyph_preload_link" rel="preload" as="style" type="text/css" href="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/unbound.css"><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/unbound.css"><link data-rh="true" rel="author" href="https://medium.com/@remykarem"><link data-rh="true" rel="canonical" href="https://towardsdatascience.com/illustrated-self-attention-2d627e33b20a"><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/2d627e33b20a"><link rel="preload" href="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/16180790160.js.download" as="script"><style type="text/css" data-fela-rehydration="643" data-fela-type="STATIC">html{box-sizing:border-box}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}:root{--reach-tabs:1;--reach-menu-button:1}</style><style type="text/css" data-fela-rehydration="643" data-fela-type="KEYFRAME">@-webkit-keyframes k1{0%{opacity:0;transform:translateY(-60px)}100%{opacity:1;transform:translateY(0px)}}@-moz-keyframes k1{0%{opacity:0;transform:translateY(-60px)}100%{opacity:1;transform:translateY(0px)}}@keyframes k1{0%{opacity:0;transform:translateY(-60px)}100%{opacity:1;transform:translateY(0px)}}@-webkit-keyframes k2{0%{opacity:1;transform:translateY(0px)}100%{opacity:0;transform:translateY(-60px)}}@-moz-keyframes k2{0%{opacity:1;transform:translateY(0px)}100%{opacity:0;transform:translateY(-60px)}}@keyframes k2{0%{opacity:1;transform:translateY(0px)}100%{opacity:0;transform:translateY(-60px)}}@-webkit-keyframes k3{0%{transform:translateX(-1%)}20%{transform:translateX(1%)}40%{transform:translateX(-1%)}60%{transform:translateX(1%)}80%{transform:translateX(-1%)}100%{transform:translateX(1%)}}@-moz-keyframes k3{0%{transform:translateX(-1%)}20%{transform:translateX(1%)}40%{transform:translateX(-1%)}60%{transform:translateX(1%)}80%{transform:translateX(-1%)}100%{transform:translateX(1%)}}@keyframes k3{0%{transform:translateX(-1%)}20%{transform:translateX(1%)}40%{transform:translateX(-1%)}60%{transform:translateX(1%)}80%{transform:translateX(-1%)}100%{transform:translateX(1%)}}@-webkit-keyframes k4{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@-moz-keyframes k4{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@keyframes k4{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}</style><style type="text/css" data-fela-rehydration="643" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.l{height:100vh}.m{width:100vw}.n{display:flex}.o{align-items:center}.p{justify-content:center}.q{height:25px}.r{fill:rgba(41, 41, 41, 1)}.s{display:block}.t{margin-bottom:36px}.v{width:100%}.w{overflow-x:scroll}.x{white-space:nowrap}.y{scrollbar-width:none}.z{-ms-overflow-style:none}.ab::-webkit-scrollbar{display:none}.ac{box-shadow:inset 0 -1px 0 rgba(230, 230, 230, 1)}.ae{min-height:184px}.ah{flex-direction:column}.ai{background-color:#355876}.aj{display:none}.al{border-bottom:none}.am{position:relative}.an{z-index:500}.at{max-width:1192px}.au{min-width:0}.av{height:62px}.aw{flex-direction:row}.ax{flex:1 0 auto}.ay{margin-right:16px}.az{font-family:sohne, "Helvetica Neue", Helvetica, Arial, sans-serif}.ba{font-size:14px}.bb{line-height:20px}.bc{color:rgba(233, 241, 250, 1)}.bd{padding:7px 16px 9px}.be{background:0}.bf{fill:rgba(233, 241, 250, 1)}.bg{border-color:rgba(215, 226, 238, 1)}.bl:disabled{cursor:inherit}.bm:disabled{opacity:0.3}.bn:disabled:hover{color:rgba(233, 241, 250, 1)}.bo:disabled:hover{fill:rgba(233, 241, 250, 1)}.bp:disabled:hover{border-color:rgba(215, 226, 238, 1)}.bq{border-radius:4px}.br{border-width:1px}.bs{border-style:solid}.bt{box-sizing:border-box}.bu{display:inline-block}.bv{text-decoration:none}.bw{margin-left:0px}.bx{color:rgba(197, 210, 225, 1)}.by{font-size:inherit}.bz{border:inherit}.ca{font-family:inherit}.cb{letter-spacing:inherit}.cc{font-weight:inherit}.cd{padding:0}.ce{margin:0}.cf:disabled{cursor:default}.cg:disabled{color:rgba(163, 208, 162, 0.5)}.ch:disabled{fill:rgba(163, 208, 162, 0.5)}.ci{min-height:115px}.cj{justify-content:space-between}.cp{align-items:flex-start}.cq{margin-bottom:0px}.cr{margin-top:-32px}.cs{flex-wrap:wrap}.cv{margin-top:32px}.cw{margin-right:24px}.cy{height:35px}.cz{width:112px}.da{flex:0 0 auto}.db{justify-self:flex-end}.dc{margin-bottom:-3px}.dd{margin-left:14px}.de{margin-top:-3px}.df{fill:rgba(251, 255, 255, 1)}.dg{padding-top:1px}.dh{height:70px}.dj{font-size:16px}.dk{line-height:24px}.dl:before{margin-bottom:-10px}.dm:before{content:""}.dn:before{display:table}.do:before{border-collapse:collapse}.dp:after{margin-top:-6px}.dq:after{content:""}.dr:after{display:table}.ds:after{border-collapse:collapse}.dt{color:rgba(117, 117, 117, 1)}.du{margin-right:32px}.dv{margin-bottom:-16px}.dw{margin-top:-14px}.dx{color:rgba(255, 255, 255, 1)}.dy{fill:rgba(255, 255, 255, 1)}.dz{background:rgba(102, 138, 170, 1)}.ea{border-color:rgba(102, 138, 170, 1)}.ed:disabled:hover{background:rgba(102, 138, 170, 1)}.ee:disabled:hover{border-color:rgba(102, 138, 170, 1)}.ef{margin-right:12px}.eg{display:inline-flex}.eh{color:inherit}.ei{fill:inherit}.el:disabled{color:rgba(117, 117, 117, 1)}.em:disabled{fill:rgba(117, 117, 117, 1)}.en{margin-left:12px}.eo{margin:0 12px}.ep{position:absolute}.eq{right:24px}.er{margin:0px}.es{border:0px}.et{padding:0px}.eu{cursor:pointer}.ev{stroke:rgba(117, 117, 117, 1)}.ey{border-top:none}.ez{left:0}.fa{opacity:0}.fb{position:fixed}.fc{right:0}.fd{top:0}.fe{visibility:hidden}.fg{height:60px}.fj{color:rgba(102, 138, 170, 1)}.fk{fill:rgba(102, 138, 170, 1)}.fn:disabled:hover{color:rgba(102, 138, 170, 1)}.fo:disabled:hover{fill:rgba(102, 138, 170, 1)}.fp{margin-left:16px}.fq{padding-left:24px}.fr{padding-right:24px}.fs{margin-left:auto}.ft{margin-right:auto}.fu{max-width:728px}.fv{background:rgba(255, 255, 255, 1)}.fw{border:1px solid rgba(230, 230, 230, 1)}.fx{box-shadow:0 1px 4px rgba(230, 230, 230, 1)}.fy{max-height:100vh}.fz{overflow-y:auto}.ga{top:calc(100vh + 100px)}.gb{bottom:calc(100vh + 100px)}.gc{width:10px}.gd{pointer-events:none}.ge{word-break:break-word}.gf{word-wrap:break-word}.gg:after{display:block}.gh:after{clear:both}.gi{clear:both}.gr{max-width:1578px}.gx{padding-bottom:5px}.gy{padding-top:5px}.ha{cursor:zoom-in}.hb{z-index:auto}.hd{transition:opacity 100ms 400ms}.he{height:100%}.hf{overflow:hidden}.hg{will-change:transform}.hh{transform:translateZ(0)}.hi{margin:auto}.hj{background-color:rgba(242, 242, 242, 1)}.hk{padding-bottom:60.13941698352345%}.hl{height:0}.hm{filter:blur(20px)}.hn{transform:scale(1.1)}.ho{visibility:visible}.hp{max-width:680px}.hq{line-height:18px}.hr{letter-spacing:0.077em}.hs{font-style:normal}.ht{font-size:13px}.hz{margin-bottom:-0.31em}.ia{text-transform:uppercase}.ib{line-height:1.23}.ic{letter-spacing:0}.id{font-weight:700}.iy{margin-bottom:-0.27em}.iz{color:rgba(41, 41, 41, 1)}.ja{line-height:1.394}.jq{margin-bottom:-0.42em}.ju{width:28px}.jv{height:28px}.jw{fill:rgba(26, 137, 23, 1)}.jx{width:calc(100% + 24px)}.jy{height:calc(100% + 24px)}.jz{top:50%}.ka{left:50%}.kb{transform:translateX(-50%) translateY(-50%)}.kc{border-radius:50%}.kd{fill:rgba(61, 61, 61, 1)}.ke{margin-top:-2px}.kf{padding-left:4px}.kg{margin:0 4px}.kh{margin:0 7px}.ki{align-items:flex-end}.kr{padding-right:8px}.ks{margin-right:8px}.kt{fill:rgba(117, 117, 117, 1)}.ku{line-height:1.58}.kv{letter-spacing:-0.004em}.kw{font-family:charter, Georgia, Cambria, "Times New Roman", Times, serif}.lk{margin-top:24px}.ll{margin-bottom:-0.46em}.lm{font-style:italic}.ln{text-decoration:underline}.lo{background:none}.lu{clear:left}.lv{float:left}.lw{font-size:66px}.lx{line-height:.83}.md{line-height:1.18}.me{letter-spacing:-0.022em}.mf{font-weight:500}.mx{list-style-type:decimal}.my{margin-left:30px}.mz{padding-left:0px}.nf{margin-bottom:14px}.ng{padding-top:24px}.nh{padding-bottom:10px}.ni{background-color:rgba(8, 8, 8, 1)}.nj{height:3px}.nk{width:3px}.nl{margin-right:20px}.nm{box-shadow:inset 3px 0 0 0 rgba(41, 41, 41, 1)}.nn{padding-left:23px}.no{margin-left:-20px}.nu{margin-top:10px}.nv{text-align:center}.ny{padding:20px}.nz{background:rgba(242, 242, 242, 1)}.oa{overflow-x:auto}.ob{font-family:Menlo, Monaco, "Courier New", Courier, monospace}.oc{margin-top:-0.09em}.od{margin-bottom:-0.09em}.oe{white-space:pre-wrap}.of{max-width:1580px}.og{padding-bottom:65.56962025316456%}.oh{padding:2px 4px}.oi{font-size:75%}.oj> strong{font-family:inherit}.ok{padding-bottom:NaN%}.ol{list-style-type:disc}.om{will-change:opacity}.on{width:188px}.oo{transform:translateX(406px)}.op{top:calc(65px + 54px + 14px)}.os{will-change:opacity, transform}.ot{transform:translateY(159px)}.ov{width:131px}.ow{padding-bottom:28px}.ox{border-bottom:1px solid rgba(230, 230, 230, 1)}.oy{padding-top:2px}.oz{padding-top:14px}.pa{padding-top:28px}.pb{margin-bottom:19px}.pc{margin-left:-3px}.pi{outline:0}.pj{border:0}.pk{user-select:none}.pl> svg{pointer-events:none}.pn{-webkit-user-select:none}.px button{text-align:left}.py{opacity:0.4}.pz{cursor:not-allowed}.qa{padding-right:9px}.qj{margin-top:40px}.qk{border-top:3px solid rgba(102, 138, 170, 1)}.ql{padding:32px 32px 26px 32px}.qm{margin-top:8px}.qn{margin-bottom:25px}.qo{background-color:rgba(250, 250, 250, 1)}.qq{padding-bottom:0px}.qr{padding-top:4px}.qs{padding-top:8px}.rd{justify-content:flex-start}.re{display:inline}.rf{height:56px}.ri{margin-top:}.rk{background:transparent}.rl{border:none}.rm{outline:none}.rn::-webkit-inner-spin-button{-webkit-appearance:none}.ro::-webkit-inner-spin-button{-moz-appearance:none}.rp::-webkit-inner-spin-button{appearance:none}.rq::-webkit-inner-spin-button{margin:0}.rr::-webkit-outer-spin-button{-webkit-appearance:none}.rs::-webkit-outer-spin-button{-moz-appearance:none}.rt::-webkit-outer-spin-button{appearance:none}.ru::-webkit-outer-spin-button{margin:0}.rv{width:375px}.rw{font:inherit}.rx{padding-left:auto}.ry{padding-right:auto}.rz{text-align:start}.sa::placeholder{color:rgba(117, 117, 117, 1)}.sb{padding-bottom:1px}.sc{border-bottom:1px solid rgba(168, 168, 168, 1)}.sd{margin-bottom:auto}.se{margin-left:15px}.sg{padding:7px 20px 9px}.sh{padding-top:}.si{font-size:11px}.sj{line-height:16px}.sk{margin-bottom:15px}.sl{margin-top:5px}.sm{padding-bottom:25px}.sn{margin-top:25px}.so{max-width:155px}.ss{top:1px}.tg{margin-left:-1px}.th{margin-left:-4px}.tp{padding-bottom:40px}.tq{list-style-type:none}.tr{margin-bottom:8px}.ts{line-height:22px}.tt{border-radius:3px}.tu{padding:5px 10px}.tv{padding-bottom:4px}.tw{padding-top:32px}.uh{text-overflow:ellipsis}.ui{display:-webkit-box}.uj{-webkit-line-clamp:1}.uk{-webkit-box-orient:vertical}.um{padding-right:168px}.un{padding-top:25px}.uq{max-width:100%}.ur{margin-bottom:96px}.us{margin-bottom:40px}.ut{padding-bottom:16px}.uu{margin-bottom:24px}.we{flex-grow:0}.wf{padding-bottom:24px}.wg{max-width:500px}.wh{flex:0 1 auto}.wl{padding-bottom:8px}.wt{padding-bottom:100%}.xe{padding:32px 0}.xf{background-color:rgba(0, 0, 0, 0.9)}.xj:disabled{color:rgba(255, 255, 255, 0.7)}.xk:disabled{fill:rgba(255, 255, 255, 0.7)}.xl{height:22px}.xm{width:200px}.xo{color:rgba(255, 255, 255, 0.98)}.xr{color:rgba(255, 255, 255, 0.7)}.bh:hover{color:rgba(251, 255, 255, 1)}.bi:hover{fill:rgba(251, 255, 255, 1)}.bj:hover{border-color:rgba(251, 255, 255, 1)}.bk:hover{cursor:pointer}.eb:hover{background:rgba(90, 118, 144, 1)}.ec:hover{border-color:rgba(90, 118, 144, 1)}.ej:hover{color:rgba(25, 25, 25, 1)}.ek:hover{fill:rgba(25, 25, 25, 1)}.fl:hover{color:rgba(90, 118, 144, 1)}.fm:hover{fill:rgba(90, 118, 144, 1)}.pp:hover{fill:rgba(117, 117, 117, 1)}.wq:hover{text-decoration:underline}.xh:hover{color:rgba(255, 255, 255, 0.99)}.xi:hover{fill:rgba(255, 255, 255, 0.99)}.hc:focus{transform:scale(1.01)}.po:focus{fill:rgba(117, 117, 117, 1)}.pm:active{border-style:none}</style><style type="text/css" data-fela-rehydration="643" data-fela-type="RULE" media="all and (min-width: 1080px)">.d{display:none}.as{margin:0 64px}.gq{max-width:1192px}.gw{margin-top:32px}.hy{margin-top:3.88em}.iu{font-size:46px}.iv{margin-top:0.17em}.iw{line-height:56px}.ix{letter-spacing:-0.011em}.jn{font-size:22px}.jo{margin-top:0.92em}.jp{line-height:28px}.kp{margin-left:30px}.lh{font-size:21px}.li{line-height:32px}.lj{letter-spacing:-0.003em}.lt{margin-top:2em}.mc{padding-top:7px}.mq{margin-top:1.72em}.mr{letter-spacing:0}.mw{margin-top:0.86em}.ne{margin-top:1.05em}.nt{margin-top:56px}.ph{margin-right:5px}.pw{margin-top:5px}.qi{padding-left:6px}.rb{font-size:16px}.rc{line-height:24px}.su{display:inline-block}.sz{margin-left:7px}.ta{margin-top:8px}.tf{width:25px}.tn{padding-left:7px}.to{top:3px}.uf{font-size:20px}.ug{max-height:24px}.up{margin:0}.vj{width:calc(100% + 32px)}.vk{margin-left:-16px}.vl{margin-right:-16px}.wa{padding-left:16px}.wb{padding-right:16px}.wc{flex-basis:25%}.wd{max-width:25%}.wo{line-height:20px}.xc{min-width:70px}.xd{min-height:70px}</style><style type="text/css" data-fela-rehydration="643" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.e{display:none}.ko{margin-left:30px}.nw{margin-left:auto}.nx{text-align:center}.pg{margin-right:5px}.pv{margin-top:5px}.qh{padding-left:6px}.st{display:inline-block}.sx{margin-left:7px}.sy{margin-top:8px}.te{width:25px}.tl{padding-left:7px}.tm{top:3px}</style><style type="text/css" data-fela-rehydration="643" data-fela-type="RULE" media="all and (max-width: 903.98px)">.f{display:none}.kn{margin-left:30px}.pf{margin-right:5px}.pu{margin-top:5px}.qf{padding-left:6px}.qg{top:3px}.sr{display:inline-block}.sv{margin-left:7px}.sw{margin-top:8px}.td{width:15px}.tk{padding-left:3px}.wk{margin-right:16px}</style><style type="text/css" data-fela-rehydration="643" data-fela-type="RULE" media="all and (max-width: 727.98px)">.g{display:none}.u{margin-bottom:20px}.af{box-shadow:inset 0 -1px 0 rgba(230, 230, 230, 1)}.ag{min-height:230px}.ak{display:block}.ck{min-height:98px}.cl{display:flex}.cm{align-items:flex-start}.cn{flex-direction:column}.co{justify-content:flex-end}.ct{margin-bottom:28px}.cu{margin-top:0px}.cx{margin-top:28px}.di{margin:0}.ew{border-top:1px solid rgba(230, 230, 230, 1)}.ex{border-bottom:1px solid rgba(230, 230, 230, 1)}.fh{align-items:center}.fi{flex:1 0 auto}.js{margin-top:32px}.jt{flex-direction:column-reverse}.kl{margin-bottom:30px}.km{margin-left:0px}.pe{margin-left:8px}.ps{margin-top:2px}.pt{margin-right:8px}.qd{padding-left:6px}.qe{top:3px}.qp{padding:24px 24px 28px 24px}.rg{padding-top:16px}.rh{height:130px}.rj{margin-top:0}.sf{margin-top:15px}.sq{display:inline-block}.tc{width:15px}.tj{padding-left:3px}.uv{padding-bottom:12px}.uw{margin-top:16px}.wj{margin-right:16px}.wr{margin-left:16px}.ws{margin-right:0px}.xg{padding:32px 0}.xn{width:140px}.xp{margin-bottom:16px}.xq{margin-top:30px}.xs{width:100%}.xt{flex-direction:row}</style><style type="text/css" data-fela-rehydration="643" data-fela-type="RULE" media="all and (max-width: 551.98px)">.h{display:none}.ao{margin:0 24px}.gj{margin:0}.gk{max-width:100%}.gs{margin-top:24px}.hu{margin-top:2.64em}.ie{font-size:32px}.if{margin-top:0.51em}.ig{line-height:40px}.ih{letter-spacing:-0.016em}.jb{font-size:18px}.jc{margin-top:0.79em}.jd{line-height:24px}.jr{margin-top:32px}.kj{margin-bottom:30px}.kk{margin-left:0px}.kx{line-height:28px}.ky{letter-spacing:-0.003em}.lp{margin-top:1.56em}.ly{padding-top:0}.mg{font-size:20px}.mh{margin-top:1.23em}.mi{letter-spacing:0}.ms{margin-top:0.67em}.na{margin-top:1.34em}.np{margin-top:40px}.pd{margin-left:8px}.pq{margin-top:2px}.pr{margin-right:8px}.qb{padding-left:6px}.qc{top:3px}.qt{font-size:14px}.qu{line-height:20px}.sp{display:inline-block}.tb{width:15px}.ti{padding-left:3px}.tx{font-size:16px}.ty{max-height:20px}.ux{width:calc(100% + 24px)}.uy{margin-left:-12px}.uz{margin-right:-12px}.vm{padding-left:12px}.vn{padding-right:12px}.vo{flex-basis:100%}.wi{margin-right:16px}.wp{margin-bottom:0px}.wu{min-width:48px}.wv{min-height:48px}</style><style type="text/css" data-fela-rehydration="643" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.i{display:none}.ar{margin:0 64px}.gp{max-width:1192px}.gv{margin-top:32px}.hx{margin-top:3.88em}.iq{font-size:46px}.ir{margin-top:0.17em}.is{line-height:56px}.it{letter-spacing:-0.011em}.jk{font-size:22px}.jl{margin-top:0.92em}.jm{line-height:28px}.le{font-size:21px}.lf{line-height:32px}.lg{letter-spacing:-0.003em}.ls{margin-top:2em}.mb{padding-top:7px}.mo{margin-top:1.72em}.mp{letter-spacing:0}.mv{margin-top:0.86em}.nd{margin-top:1.05em}.ns{margin-top:56px}.qz{font-size:16px}.ra{line-height:24px}.ud{font-size:20px}.ue{max-height:24px}.uo{margin:0}.vg{width:calc(100% + 32px)}.vh{margin-left:-16px}.vi{margin-right:-16px}.vw{padding-left:16px}.vx{padding-right:16px}.vy{flex-basis:25%}.vz{max-width:25%}.wn{line-height:20px}.xa{min-width:70px}.xb{min-height:70px}</style><style type="text/css" data-fela-rehydration="643" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.j{display:none}.aq{margin:0 48px}.gn{margin:0}.go{max-width:100%}.gu{margin-top:32px}.hw{margin-top:3.88em}.im{font-size:46px}.in{margin-top:0.17em}.io{line-height:56px}.ip{letter-spacing:-0.011em}.jh{font-size:22px}.ji{margin-top:0.92em}.jj{line-height:28px}.lb{font-size:21px}.lc{line-height:32px}.ld{letter-spacing:-0.003em}.lr{margin-top:2em}.ma{padding-top:7px}.mm{margin-top:1.72em}.mn{letter-spacing:0}.mu{margin-top:0.86em}.nc{margin-top:1.05em}.nr{margin-top:56px}.qx{font-size:16px}.qy{line-height:24px}.ub{font-size:20px}.uc{max-height:24px}.vd{width:calc(100% + 28px)}.ve{margin-left:-14px}.vf{margin-right:-14px}.vs{padding-left:14px}.vt{padding-right:14px}.vu{flex-basis:50%}.vv{max-width:50%}.wm{line-height:20px}.wy{min-width:48px}.wz{min-height:48px}</style><style type="text/css" data-fela-rehydration="643" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.k{display:none}.ap{margin:0 24px}.gl{margin:0}.gm{max-width:100%}.gt{margin-top:24px}.hv{margin-top:2.64em}.ii{font-size:32px}.ij{margin-top:0.51em}.ik{line-height:40px}.il{letter-spacing:-0.016em}.je{font-size:18px}.jf{margin-top:0.79em}.jg{line-height:24px}.kz{line-height:28px}.la{letter-spacing:-0.003em}.lq{margin-top:1.56em}.lz{padding-top:0}.mj{font-size:20px}.mk{margin-top:1.23em}.ml{letter-spacing:0}.mt{margin-top:0.67em}.nb{margin-top:1.34em}.nq{margin-top:40px}.qv{font-size:14px}.qw{line-height:20px}.tz{font-size:16px}.ua{max-height:20px}.va{width:calc(100% + 24px)}.vb{margin-left:-12px}.vc{margin-right:-12px}.vp{padding-left:12px}.vq{padding-right:12px}.vr{flex-basis:100%}.ww{min-width:48px}.wx{min-height:48px}</style><style type="text/css" data-fela-rehydration="643" data-fela-type="RULE" media="print">.kq{display:none}</style><style type="text/css" data-fela-rehydration="643" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.ff{animation:k2 .2s ease-in-out both}.gz{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}.oq{transition:opacity 200ms}</style><style type="text/css" data-fela-rehydration="643" data-fela-type="RULE" media="all and (max-width: 1230px)">.or{display:none}</style><style type="text/css" data-fela-rehydration="643" data-fela-type="RULE" media="all and (max-width: 1198px)">.ou{display:none}</style><style type="text/css" data-fela-rehydration="643" data-fela-type="RULE" media="(orientation: landscape) and (max-width: 903.98px)">.ul{max-height:none}</style><link rel="icon" href="https://miro.medium.com/fit/c/128/128/1*ChFMdf--f5jbm-AYv6VdYA@2x.png" data-rh="true"><link rel="preload" href="https://miro.medium.com/max/1401/1*sfUruIusLq6tbpLx0sDYZQ.png" as="image" data-rh="true"><script type="application/ld+json" data-rh="true">{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":["https:\u002F\u002Fmiro.medium.com\u002Ffreeze\u002Fmax\u002F1200\u002F1*_92bnsMJy8Bl539G4v93yg.gif"],"url":"https:\u002F\u002Ftowardsdatascience.com\u002Fillustrated-self-attention-2d627e33b20a","dateCreated":"2019-11-18T05:37:56.662Z","datePublished":"2019-11-18T05:37:56.662Z","dateModified":"2021-02-18T11:15:24.866Z","headline":"Illustrated: Self-Attention - Towards Data Science","name":"Illustrated: Self-Attention - Towards Data Science","description":"This article walks you through the mathematical operations in a self-attention module. Includes illustrations and code.","identifier":"2d627e33b20a","keywords":["Lite:true","Tag:Machine Learning","Tag:Towards Data Science","Tag:Transformers","Tag:Attention","Tag:NLP","Publication:towards-data-science","Elevated:false","LockedPostSource:LOCKED_POST_SOURCE_UGC","LayerCake:3"],"author":{"@type":"Person","name":"Raimi Karim","url":"https:\u002F\u002Ftowardsdatascience.com\u002F@remykarem"},"creator":["Raimi Karim"],"publisher":{"@type":"Organization","name":"Towards Data Science","url":"towardsdatascience.com","logo":{"@type":"ImageObject","width":165,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F165\u002F1*mG6i4Bh_LgixUYXJgQpYsg@2x.png"}},"mainEntityOfPage":"https:\u002F\u002Ftowardsdatascience.com\u002Fillustrated-self-attention-2d627e33b20a","isAccessibleForFree":"False","hasPart":{"@type":"WebPageElement","isAccessibleForFree":"False","cssSelector":".meteredContent"}}</script><script data-rh="true">(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-24232453-2', 'auto');
ga('send', 'pageview');</script><script type="text/javascript" data-rh="true">(function(b,r,a,n,c,h,_,s,d,k){if(!b[n]||!b[n]._q){for(;s<_.length;)c(h,_[s++]);d=r.createElement(a);d.async=1;d.src="https://cdn.branch.io/branch-latest.min.js";k=r.getElementsByTagName(a)[0];k.parentNode.insertBefore(d,k);b[n]=h}})(window,document,"script","branch",function(b,r){b[r]=function(){b._q.push([r,arguments])}},{_q:[],_v:1},"addListener applyCode autoAppIndex banner closeBanner closeJourney creditHistory credits data deepview deepviewCta first getCode init link logout redeem referrals removeListener sendSMS setBranchViewData setIdentity track validateCode trackCommerceEvent logEvent".split(" "), 0);
branch.init('key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm', {metadata: {}, 'no_journeys': true, 'disable_exit_animation': true, 'disable_entry_animation': true, 'tracking_disabled': null}, function(err, data) {});</script></head><body data-new-gr-c-s-check-loaded="14.1001.0" data-gr-ext-installed=""><div id="root"><div class="a b c"><div class="d e f g h i j k"></div><script>document.domain = document.domain;</script><div><script>if (window.self !== window.top) window.location = "about:blank"</script></div><script>window.PARSELY = window.PARSELY || {autotrack: false}</script><div class="s"><div class="t s u"><div class="ac ae s af ag"><div class="n ah ai"><div class="aj ak"><div class="al s am an"><div class="n p"><div class="ao ap aq ar as at au v"><div class="av n o"><div class="n o aw ax"><div class="ho" id="lo-meta-header-sign-up-button"><div class="ay s"><span><a href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Ftowardsdatascience.com%2Fillustrated-self-attention-2d627e33b20a&amp;source=post_page-----2d627e33b20a---------------------nav_reg-----------" class="az b ba bb bc bd be bf bg bh bi bj bk bl bm bn bo bp bq br bs bt bu bv" rel="noopener">Get started</a></span></div></div><div class="ho" id="lo-ShowPostUnderCollection-navbar-open-in-app-button"><div class="bw aj ak"><span class="az b ba bb bx"><a href="https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F2d627e33b20a&amp;~feature=LoOpenInAppButton&amp;~channel=ShowPostUnderCollection&amp;~stage=mobileNavBar&amp;source=post_page-----2d627e33b20a--------------------------------" class="bc bf by bz ca cb cc cd ce bk bh bi cf xv xw" rel="noopener nofollow">Open in app</a></span></div></div></div><a href="https://medium.com/?source=post_page-----2d627e33b20a--------------------------------" aria-label="Homepage" rel="noopener"><svg viewBox="0 0 1043.63 592.71" class="q bf"><g data-name="Layer 2"><g data-name="Layer 1"><path d="M588.67 296.36c0 163.67-131.78 296.35-294.33 296.35S0 460 0 296.36 131.78 0 294.34 0s294.33 132.69 294.33 296.36M911.56 296.36c0 154.06-65.89 279-147.17 279s-147.17-124.94-147.17-279 65.88-279 147.16-279 147.17 124.9 147.17 279M1043.63 296.36c0 138-23.17 249.94-51.76 249.94s-51.75-111.91-51.75-249.94 23.17-249.94 51.75-249.94 51.76 111.9 51.76 249.94"></path></g></g></svg></a></div></div></div></div></div><div class="n p"><div class="ao ap aq ar as at au v"><div class="ci n o aw cj ck cl cm cn co"><div class="v n cp cj"><div class="n v"><div class="cq cr v n o aw cs ct cu cl cm cn"><div class="cv cw s cx"><a aria-label="Publication Homepage" rel="noopener" href="https://towardsdatascience.com/?source=post_page-----2d627e33b20a--------------------------------"><div class="cy cz s"><img alt="Towards Data Science" class="" src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/1_AGyTPCaRzVqL77kFwUwHKg.png" width="112" height="35"></div></a></div></div></div><div class="n o da db an g"><div class="ho" id="lo-meta-header-sign-in-link"><p class="az b ba bb bx"><span><a href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Ftowardsdatascience.com%2Fillustrated-self-attention-2d627e33b20a&amp;source=post_page-----2d627e33b20a---------------------nav_reg-----------" class="bc bf by bz ca cb cc cd ce bk bh bi cf xv xw" rel="noopener">Sign in</a></span></p></div><div class="ho" id="lo-meta-header-sign-up-button"><div class="dc dd de cw s"><span><a href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Ftowardsdatascience.com%2Fillustrated-self-attention-2d627e33b20a&amp;source=post_page-----2d627e33b20a---------------------nav_reg-----------" class="az b ba bb bc bd be bf bg bh bi bj bk bl bm bn bo bp bq br bs bt bu bv" rel="noopener">Get started</a></span></div></div><a href="https://medium.com/?source=post_page-----2d627e33b20a--------------------------------" aria-label="Homepage" rel="noopener"><svg viewBox="0 0 1043.63 592.71" class="q df"><g data-name="Layer 2"><g data-name="Layer 1"><path d="M588.67 296.36c0 163.67-131.78 296.35-294.33 296.35S0 460 0 296.36 131.78 0 294.34 0s294.33 132.69 294.33 296.36M911.56 296.36c0 154.06-65.89 279-147.17 279s-147.17-124.94-147.17-279 65.88-279 147.16-279 147.17 124.9 147.17 279M1043.63 296.36c0 138-23.17 249.94-51.76 249.94s-51.75-111.91-51.75-249.94 23.17-249.94 51.75-249.94 51.76 111.9 51.76 249.94"></path></g></g></svg></a></div></div></div></div></div></div><div class="s ak"><div class="n p"><div class="ao ap aq ar as at au v"><div class="w x y z ab"><div class="dg dh n o"><div class="s di"><span class="az b dj dk dl dm dn do dp dq dr ds dt"><div class="n o"><div class="du s"><div class="dv dw s"><div class="bu" aria-hidden="false" aria-describedby="collectionFollowPopover" aria-labelledby="collectionFollowPopover"><span><a href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science&amp;operation=register&amp;redirect=https%3A%2F%2Ftowardsdatascience.com%2Fillustrated-self-attention-2d627e33b20a&amp;source=post_page-----2d627e33b20a---------------------follow_header-----------" class="az b ba bb dx bd dy dz ea eb ec bk bl bm ed ee bq br bs bt bu bv" rel="noopener"><div class="n aw">Follow</div></a></span></div></div></div><div class="ef eg ah"><a class="eh ei by bz ca cb cc cd ce bk ej ek cf el em" rel="noopener" href="https://towardsdatascience.com/followers?source=post_page-----2d627e33b20a--------------------------------">572K Followers</a></div><div class="en s g">·</div><div class="en s g"><nav class="n o"><span class="eo n ah"><a class="eh ei by bz ca cb cc cd ce bk ej ek cf el em" rel="noopener" href="https://towardsdatascience.com/tagged/editors-pick?source=post_page-----2d627e33b20a--------------------------------">Editors' Picks</a></span><span class="eo n ah"><a class="eh ei by bz ca cb cc cd ce bk ej ek cf el em" rel="noopener" href="https://towardsdatascience.com/tagged/tds-features?source=post_page-----2d627e33b20a--------------------------------">Features</a></span><span class="eo n ah"><a class="eh ei by bz ca cb cc cd ce bk ej ek cf el em" rel="noopener" href="https://towardsdatascience.com/tagged/explore?source=post_page-----2d627e33b20a--------------------------------">Explore</a></span><span class="eo n ah"><a class="eh ei by bz ca cb cc cd ce bk ej ek cf el em" rel="noopener" href="https://towardsdatascience.com/how-to-get-the-most-out-of-towards-data-science-3bf37f75a345?source=post_page-----2d627e33b20a--------------------------------">Grow</a></span><span class="eo n ah"><a class="eh ei by bz ca cb cc cd ce bk ej ek cf el em" rel="noopener" href="https://towardsdatascience.com/questions-96667b06af5?source=post_page-----2d627e33b20a--------------------------------">Contribute</a></span></nav></div><div class="en n ah g"><a class="eh ei by bz ca cb cc cd ce bk ej ek cf el em" rel="noopener" href="https://towardsdatascience.com/about?source=post_page-----2d627e33b20a--------------------------------">About</a></div></div></span></div><div class="aj ep eq ak"><button class="n o p er es et eu" aria-label="Expand navbar"><svg width="14" height="14" class="ev"><path d="M0 .5h14M0 7h14M0 13.5h14"></path></svg></button></div></div></div></div></div></div></div><div class="ew ex ey al c ez yq fb fc fd ho an aen"><div class="n p"><div class="ao ap aq ar as at au v"><div class="fg v aj fd an cl fh"><div class="aj cl fh fi"><div class="ho" id="lo-sticky-header-sign-up-button"><span><a href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Ftowardsdatascience.com%2Fillustrated-self-attention-2d627e33b20a&amp;source=post_page-----2d627e33b20a---------------------nav_reg-----------" class="az b ba bb fj bd be fk ea fl fm ec bk bl bm fn fo ee bq br bs bt bu bv" rel="noopener">Get started</a></span></div><div class="ho" id="lo-ShowPostUnderCollection-navbar-open-in-app-button"><div class="fp aj ak"><span class="az b ba bb dt"><a href="https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F2d627e33b20a&amp;~feature=LoOpenInAppButton&amp;~channel=ShowPostUnderCollection&amp;~stage=mobileNavBar&amp;source=post_page-----2d627e33b20a--------------------------------" class="fj fk by bz ca cb cc cd ce bk fl fm cf xv xw" rel="noopener nofollow">Open in app</a></span></div></div></div><a href="https://medium.com/?source=post_page-----2d627e33b20a--------------------------------" aria-label="Homepage" rel="noopener"><svg viewBox="0 0 1043.63 592.71" class="q r"><g data-name="Layer 2"><g data-name="Layer 1"><path d="M588.67 296.36c0 163.67-131.78 296.35-294.33 296.35S0 460 0 296.36 131.78 0 294.34 0s294.33 132.69 294.33 296.36M911.56 296.36c0 154.06-65.89 279-147.17 279s-147.17-124.94-147.17-279 65.88-279 147.16-279 147.17 124.9 147.17 279M1043.63 296.36c0 138-23.17 249.94-51.76 249.94s-51.75-111.91-51.75-249.94 23.17-249.94 51.75-249.94 51.76 111.9 51.76 249.94"></path></g></g></svg></a></div></div></div></div></div><div class="s kq"><div class="ye yf v he fb yg yh eu fa yi gd" aria-hidden="true"></div><div class="yj fb yk yl ym ye he bt yn yo yp yq yr ys yt xs yu yv yw yx fe" aria-hidden="true"><div class="za zb n o aw cj"><h2 class="az mf zc dk ic iz">Responses (16)</h2><div class="n aw"><div><div class="bu" role="tooltip" aria-hidden="false" aria-describedby="4" aria-labelledby="4"><a href="https://policy.medium.com/medium-rules-30e5502c4eb4?source=responses-----2d627e33b20a--------------------------------" class="kd ek" target="_blank" rel="noopener"><svg width="25" height="25" viewBox="0 0 25 25"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.99 5.04c.26-.21.64-.22.91-.01.97.72 1.77 1.21 2.6 1.54.83.32 1.72.48 2.89.5.41.01.74.35.74.76-.02 3.62-.43 6.26-1.45 8.21-1.03 1.98-2.66 3.21-4.97 4.08a.75.75 0 0 1-.53 0c-2.25-.87-3.86-2.1-4.9-4.07-1.02-1.95-1.46-4.59-1.48-8.22 0-.41.33-.75.75-.76 1.19-.02 2.1-.18 2.92-.5.82-.32 1.6-.81 2.52-1.53zm.46.9c-.9.69-1.71 1.21-2.62 1.56a8.9 8.9 0 0 1-3.02.57c.03 3.45.46 5.82 1.36 7.51.88 1.69 2.25 2.77 4.28 3.57 2.1-.8 3.47-1.89 4.34-3.57.89-1.7 1.3-4.07 1.34-7.51a8.8 8.8 0 0 1-3-.57 11.8 11.8 0 0 1-2.68-1.56zm0 9.15a2.67 2.67 0 1 0 0-5.34 2.67 2.67 0 0 0 0 5.34zm0 1a3.67 3.67 0 1 0 0-7.34 3.67 3.67 0 0 0 0 7.34zm-1.82-3.77l.53-.53.91.92 1.63-1.63.52.53-2.15 2.15-1.44-1.44z"></path></svg></a></div></div><div class="s am zd"><div class="s am fd fc"><button class="eh ei by bz ca cb cc cd ce bk ej ek cf el em" data-testid="close-button" aria-label="close"><svg width="25" height="25" viewBox="0 0 25 25" class="kt"><path d="M18.13 6.11l-5.61 5.61-5.6-5.61-.81.8 5.61 5.61-5.61 5.61.8.8 5.61-5.6 5.61 5.6.8-.8-5.6-5.6 5.6-5.62"></path></svg></button></div></div></div></div><div><div class="az b ba bb iz"><div class="dk"><div class="acv zo acw s"><div class="yl acn bq n ah aco acp acq"><div class="n ah"><span><a href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Ftowardsdatascience.com%2Fillustrated-self-attention-2d627e33b20a&amp;source=responses-----2d627e33b20a---------------------respond_sidebar-----------" class="eh ei by bz ca cb cc cd ce bk ej ek cf el em" rel="noopener"><div class="acx s"><p class="az b ba bb dt">What are your thoughts?</p></div></a></span><div class="acr n acs act fa acu"><div class="acm"><button class="az b ba bb iz acy r be acz aea aeb aec bk bl bm aed aee aef bq br bs bt bu bv">Cancel</button></div><button class="az b ba bb dx acy dy aeg aeh aei aej bk bl bm aek ael bq br bs bt bu bv" disabled="">Respond</button></div></div></div></div></div></div></div><div class="s"><div class="s"><div class="ox abj s"><div><div class="v he"><div class="abp un s"><div class="n aw cj"><div class="n o aw"><img alt="Manuel Romero" class="s kc zr zs" src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/1__eOyq5lAgOVtQTc9jeH5IQ.jpeg" width="32" height="32"><div class="abr s"><div class="n aw"><div><div class="bu" role="tooltip" aria-hidden="false" aria-describedby="38" aria-labelledby="38"><a href="https://medium.com/@mrm8488?source=responses-----2d627e33b20a----0----------------------------" class="eh ei by bz ca cb cc cd ce bk ej ek cf el em" rel="noopener"><p class="az b ba bb iz">Manuel Romero</p></a></div></div></div><a href="https://medium.com/@mrm8488/i-loved-it-so-much-so-i-made-a-colab-c2f451bfb16e?source=responses-----2d627e33b20a----0----------------------------" class="eh ei by bz ca cb cc cd ce bk wq cf el em" rel="noopener nofollow"><p class="az b ba bb dt">over 1 year ago</p></a></div></div><button class="eu pj kd ek abq"><svg class="overflow-dots-filled-25px_svg__svgIcon-use" width="25" height="25"><path d="M5 12.5c0 .55.2 1.02.59 1.41.39.4.86.59 1.41.59.55 0 1.02-.2 1.41-.59.4-.39.59-.86.59-1.41 0-.55-.2-1.02-.59-1.41A1.93 1.93 0 0 0 7 10.5c-.55 0-1.02.2-1.41.59-.4.39-.59.86-.59 1.41zm5.62 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.42.59.55 0 1.02-.2 1.41-.59.4-.39.59-.86.59-1.41 0-.55-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.03.2-1.42.59-.39.39-.58.86-.58 1.41zm5.6 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.43.59.56 0 1.03-.2 1.42-.59.39-.39.58-.86.58-1.41 0-.55-.2-1.02-.58-1.41a1.93 1.93 0 0 0-1.42-.59c-.56 0-1.04.2-1.43.59-.39.39-.58.86-.58 1.41z" fill-rule="evenodd"></path></svg></button></div><a href="https://medium.com/@mrm8488/i-loved-it-so-much-so-i-made-a-colab-c2f451bfb16e?source=responses-----2d627e33b20a----0----------------------------" rel="noopener"><div class="abk abl tt abm abn c"><div class="kt abo"><div class="az b ht bb dt"><div class="abs n o da"><div class="n o"><svg width="19" height="19" viewBox="0 0 19 19" class="abt s"><g fill-rule="evenodd"><path d="M6.93 15.34l-2.06-2.06c-2.16-2.16-3.53-3.15-2.9-3.79.33-.32.8-.39 1.2 0l2.13 2.2c.08.08.16.07.38.13.21.05.36-.05.54-.23.17-.16.07-.6-.09-.77L3.5 8.2c-.37-.36-.5-1-.1-1.39.37-.37.8-.19 1.14.15.39.38 2.7 2.76 2.7 2.76a.42.42 0 0 0 .3.13.54.54 0 0 0 .33-.16c.17-.16.25-.46.09-.63 0 0-1.34-1.4-1.82-1.88-.71-.72-.77-1.22-.46-1.54.45-.44 1.05-.3 1.86.62l3.58 3.89-.75-1.95s-.47-1.25 0-1.5.84.4 1.17.9l1.86 3.34c1.01 1.65.69 3.8-.73 5.19-1.87 1.87-4.07.87-5.73-.78zM10.26.04H8.73l.77 3.3zM13.93 1.2L12.5.7l-.4 3.36zM6.5.57l-1.44.52L6.9 3.93z"></path><path d="M14.3 7.03c-.34-.5-.9-.52-1.25-.24-.25.19-.21.6-.2.9l1.51 2.64c1.17 1.9 1.33 3.66 0 5.45.4-.19.52-.23.9-.61 1.52-1.52 1.86-3.32.85-4.96l-1.8-3.18z"></path></g></svg><div>51</div></div><div class="n o"><svg width="19" height="19" viewBox="0 0 19 19" class="zt abt s"><path d="M16.19 9.42c0 1.67-.72 2.84-2.03 4l-.1.09v.13a4.3 4.3 0 0 0 .15.85c.17.6.46 1.2.86 1.8a4.94 4.94 0 0 1-2.46-.84c-.26-.17-.33-.2-.54-.4l-.13-.12-.16.05c-.68.2-2.75.46-4.88-.16a5.9 5.9 0 0 1-4.1-5.4c0-3.37 3-6.12 6.7-6.12s6.69 2.75 6.69 6.12z" fill-rule="evenodd"></path></svg><div>1</div></div></div></div></div><p class="az b ba bb hf abu uh ui abv uk ul iz"><div class="s">I loved it so much so I made a Colab: https://colab.research.google.com/drive/1rPk3ohrmVclqhH7uQ7qys4oznDdAhpzF</div></p></div></a></div></div></div><div class="uu en abi"><div class="s"><div class="al abj s"><div><div class="v he"><div class="abp un s"><div class="n aw cj"><div class="n o aw"><div class="am zs zr"><div class="jw n aw o p ep acc acd jz ka kb gd"><svg width="39" height="39" viewBox="0 0 39 39"><path fill-rule="evenodd" clip-rule="evenodd" d="M19.5 1C11.83 1 5.17 5.75 1.9 12.71L1 12.3C4.4 5.02 11.4 0 19.5 0S34.6 5.02 38 12.29l-.9.42C33.82 5.75 27.16 1 19.5 1zM1.9 26.29C5.18 33.25 11.84 38 19.5 38c7.67 0 14.33-4.75 17.6-11.71l.9.42C34.6 33.98 27.6 39 19.5 39S4.4 33.98 1 26.71l.9-.42z"></path></svg></div><img alt="Raimi Karim" class="s kc zr zs" src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/1_BEc6O6Z6fCy2NDHL9K462A@2x.jpeg" width="32" height="32"></div><div class="abr s"><div class="n aw"><div><div class="bu" role="tooltip" aria-hidden="false" aria-describedby="50" aria-labelledby="50"><a href="https://medium.com/@remykarem?source=responses-----2d627e33b20a----0----------------------------" class="eh ei by bz ca cb cc cd ce bk ej ek cf el em" rel="noopener"><p class="az b ba bb iz">Raimi Karim</p></a></div></div><div class="acg ach aci si acj ack n o zt abz">AUTHOR</div></div><a href="https://medium.com/@remykarem/hi-manuel-romero-thats-amazing-i-ll-have-this-link-included-in-the-article-c71db49ac85b?source=responses-----2d627e33b20a----0----------------------------" class="eh ei by bz ca cb cc cd ce bk wq cf el em" rel="noopener nofollow"><p class="az b ba bb dt">over 1 year ago</p></a></div></div><button class="eu pj kd ek abq"><svg class="overflow-dots-filled-25px_svg__svgIcon-use" width="25" height="25"><path d="M5 12.5c0 .55.2 1.02.59 1.41.39.4.86.59 1.41.59.55 0 1.02-.2 1.41-.59.4-.39.59-.86.59-1.41 0-.55-.2-1.02-.59-1.41A1.93 1.93 0 0 0 7 10.5c-.55 0-1.02.2-1.41.59-.4.39-.59.86-.59 1.41zm5.62 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.42.59.55 0 1.02-.2 1.41-.59.4-.39.59-.86.59-1.41 0-.55-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.03.2-1.42.59-.39.39-.58.86-.58 1.41zm5.6 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.43.59.56 0 1.03-.2 1.42-.59.39-.39.58-.86.58-1.41 0-.55-.2-1.02-.58-1.41a1.93 1.93 0 0 0-1.42-.59c-.56 0-1.04.2-1.43.59-.39.39-.58.86-.58 1.41z" fill-rule="evenodd"></path></svg></button></div><a href="https://medium.com/@remykarem/hi-manuel-romero-thats-amazing-i-ll-have-this-link-included-in-the-article-c71db49ac85b?source=responses-----2d627e33b20a----0----------------------------" rel="noopener"><div class="abk abl tt abm abn c"><div class="kt abo"><div class="az b ht bb dt"><div class="acl n o da"></div></div></div><p class="az b ba bb hf abu uh ui abv uk ul iz"><div class="s">Hi Manuel Romero, that’s amazing 💯:) I’ll have this link included in the article.</div></p></div></a></div></div></div></div></div></div></div><div class="ox abj s"><div><div class="v he"><div class="ut un s"><div class="n aw cj"><div class="n o aw"><img alt="Nitin Siwach" class="s kc zr zs" src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/0_bwkPMr5VmflDxaBr_" width="32" height="32"><div class="abr s"><div class="n aw"><div><div class="bu" role="tooltip" aria-hidden="false" aria-describedby="39" aria-labelledby="39"><a href="https://medium.com/@nitinsiwach?source=responses-----2d627e33b20a----1----------------------------" class="eh ei by bz ca cb cc cd ce bk ej ek cf el em" rel="noopener"><p class="az b ba bb iz">Nitin Siwach</p></a></div></div></div><a href="https://medium.com/@nitinsiwach/a-suggestion-the-images-become-hard-to-follow-with-disappearing-vectors-b828696b3d0c?source=responses-----2d627e33b20a----1----------------------------" class="eh ei by bz ca cb cc cd ce bk wq cf el em" rel="noopener nofollow"><p class="az b ba bb dt">12 months ago</p></a></div></div><button class="eu pj kd ek abq"><svg class="overflow-dots-filled-25px_svg__svgIcon-use" width="25" height="25"><path d="M5 12.5c0 .55.2 1.02.59 1.41.39.4.86.59 1.41.59.55 0 1.02-.2 1.41-.59.4-.39.59-.86.59-1.41 0-.55-.2-1.02-.59-1.41A1.93 1.93 0 0 0 7 10.5c-.55 0-1.02.2-1.41.59-.4.39-.59.86-.59 1.41zm5.62 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.42.59.55 0 1.02-.2 1.41-.59.4-.39.59-.86.59-1.41 0-.55-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.03.2-1.42.59-.39.39-.58.86-.58 1.41zm5.6 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.43.59.56 0 1.03-.2 1.42-.59.39-.39.58-.86.58-1.41 0-.55-.2-1.02-.58-1.41a1.93 1.93 0 0 0-1.42-.59c-.56 0-1.04.2-1.43.59-.39.39-.58.86-.58 1.41z" fill-rule="evenodd"></path></svg></button></div><div class="sl s"><pre class="oe"><div class="abw s"><div class="az b ba bb iz"><div class="dk">A suggestion: the images become hard to follow with disappearing vectors. Lighting them up to show the flow would have been better</div></div></div></pre></div><div class="aby n o aw cj"><div class="n o"><div class="n o"><div class="s am kk km pf pg ph"><span><a href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2Fb828696b3d0c&amp;operation=register&amp;redirect=https%3A%2F%2Ftowardsdatascience.com%2Fillustrated-self-attention-2d627e33b20a&amp;source=responses-----b828696b3d0c----1-----------------respond_sidebar-----------" class="eh ei by bz ca cb cc cd ce bk ej ek cf el em" rel="noopener"><div class="cd pi pj pk eu pl pm xx r po pp"><svg width="25" height="25" viewBox="0 0 25 25" aria-label="clap"><g fill-rule="evenodd"><path d="M11.74 0l.76 2.97.76-2.97zM14.81 3.78l1.84-2.56-1.42-.47zM8.38 1.22l1.84 2.56L9.8.75zM20.38 21.62a5.11 5.11 0 0 1-3.16 1.61l.49-.45c2.88-2.89 3.45-5.98 1.69-9.21l-1.1-1.94-.96-2.02c-.31-.67-.23-1.18.25-1.55a.84.84 0 0 1 .66-.16c.34.05.66.28.88.6l2.85 5.02c1.18 1.97 1.38 5.12-1.6 8.1M7.1 21.1l-5.02-5.02a1 1 0 0 1 .7-1.7 1 1 0 0 1 .72.3l2.6 2.6a.44.44 0 0 0 .63-.62L4.1 14.04l-1.75-1.75a1 1 0 1 1 1.41-1.41l4.15 4.15a.44.44 0 0 0 .63 0 .44.44 0 0 0 0-.62L4.4 10.26 3.22 9.08a1 1 0 0 1 0-1.4 1.02 1.02 0 0 1 1.41 0l1.18 1.16L9.96 13a.44.44 0 0 0 .62 0 .44.44 0 0 0 0-.63L6.43 8.22a.99.99 0 0 1-.3-.7.99.99 0 0 1 .3-.7 1 1 0 0 1 1.41 0l7 6.98a.44.44 0 0 0 .7-.5l-1.35-2.85c-.31-.68-.23-1.19.25-1.56a.85.85 0 0 1 .66-.16c.34.06.66.28.88.6L18.63 14c1.57 2.88 1.07 5.54-1.55 8.16a5.62 5.62 0 0 1-5.06 1.65 9.35 9.35 0 0 1-4.93-2.72zM11 5.98l2.56 2.56c-.5.6-.56 1.41-.15 2.28l.26.56-4.25-4.25a.98.98 0 0 1-.12-.45 1 1 0 0 1 .29-.7 1.02 1.02 0 0 1 1.41 0zm8.89 2.06c-.38-.56-.9-.92-1.49-1.01a1.74 1.74 0 0 0-1.34.33c-.38.29-.61.65-.71 1.06a2.1 2.1 0 0 0-1.1-.56 1.78 1.78 0 0 0-.99.13l-2.64-2.64a1.88 1.88 0 0 0-2.65 0 1.86 1.86 0 0 0-.48.85 1.89 1.89 0 0 0-2.67-.01 1.87 1.87 0 0 0-.5.9c-.76-.75-2-.75-2.7-.04a1.88 1.88 0 0 0 0 2.66c-.3.12-.61.29-.87.55a1.88 1.88 0 0 0 0 2.66l.62.62a1.88 1.88 0 0 0-.9 3.16l5.01 5.02c1.6 1.6 3.52 2.64 5.4 2.96a7.16 7.16 0 0 0 1.18.1c1.03 0 2-.25 2.9-.7A5.9 5.9 0 0 0 21 22.24c3.34-3.34 3.08-6.93 1.74-9.17l-2.87-5.04z"></path></g></svg></div></a></span></div><div class="s pq pr ps pt pu pv pw"><div class="am ss px"><p class="az b ba bb iz">15<span class="s h g f st su"></span></p></div></div></div><div class="en q n o"><button class="eh ei by bz ca cb cc cd ce bk ej ek cf el em"><div class="n o"><svg width="29" height="29" class="r q abx" aria-label="responses"><path d="M21.27 20.06a9.04 9.04 0 0 0 2.75-6.68C24.02 8.21 19.67 4 14.1 4S4 8.21 4 13.38c0 5.18 4.53 9.39 10.1 9.39 1 0 2-.14 2.95-.41.28.25.6.49.92.7a7.46 7.46 0 0 0 4.19 1.3c.27 0 .5-.13.6-.35a.63.63 0 0 0-.05-.65 8.08 8.08 0 0 1-1.29-2.58 5.42 5.42 0 0 1-.15-.75zm-3.85 1.32l-.08-.28-.4.12a9.72 9.72 0 0 1-2.84.43c-4.96 0-9-3.71-9-8.27 0-4.55 4.04-8.26 9-8.26 4.95 0 8.77 3.71 8.77 8.27 0 2.25-.75 4.35-2.5 5.92l-.24.21v.32a5.59 5.59 0 0 0 .21 1.29c.19.7.49 1.4.89 2.08a6.43 6.43 0 0 1-2.67-1.06c-.34-.22-.88-.48-1.16-.74z"></path></svg><span class="zt abz bu"><span class="az b ht bb iz">1 reply</span></span></div></button></div></div><div class="aca s"><p class="az b ba bb iz"><button class="eh ei by bz ca cb cc cd ce bk wq cf el em">Reply</button></p></div></div></div></div></div></div><div class="ox abj s"><div><div class="v he"><div class="ut un s"><div class="n aw cj"><div class="n o aw"><div class="am zs zr"><div class="jw n aw o p ep acc acd jz ka kb gd"><svg width="39" height="39" viewBox="0 0 39 39"><path fill-rule="evenodd" clip-rule="evenodd" d="M19.5 1C11.83 1 5.17 5.75 1.9 12.71L1 12.3C4.4 5.02 11.4 0 19.5 0S34.6 5.02 38 12.29l-.9.42C33.82 5.75 27.16 1 19.5 1zM1.9 26.29C5.18 33.25 11.84 38 19.5 38c7.67 0 14.33-4.75 17.6-11.71l.9.42C34.6 33.98 27.6 39 19.5 39S4.4 33.98 1 26.71l.9-.42z"></path></svg></div><img alt="Emil Rijcken" class="s kc zr zs" src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/0_bxlZkslD3-kJY3nU" width="32" height="32"></div><div class="abr s"><div class="n aw"><div><div class="bu" role="tooltip" aria-hidden="false" aria-describedby="40" aria-labelledby="40"><a href="https://emilrijcken.medium.com/?source=responses-----2d627e33b20a----2----------------------------" class="eh ei by bz ca cb cc cd ce bk ej ek cf el em" rel="noopener"><p class="az b ba bb iz">Emil Rijcken</p></a></div></div></div><a href="https://emilrijcken.medium.com/thanks-for-this-article-it-makes-the-concept-easier-to-understand-afeaa67cf398?source=responses-----2d627e33b20a----2----------------------------" class="eh ei by bz ca cb cc cd ce bk wq cf el em" rel="noopener nofollow"><p class="az b ba bb dt">about 1 year ago</p></a></div></div><button class="eu pj kd ek abq"><svg class="overflow-dots-filled-25px_svg__svgIcon-use" width="25" height="25"><path d="M5 12.5c0 .55.2 1.02.59 1.41.39.4.86.59 1.41.59.55 0 1.02-.2 1.41-.59.4-.39.59-.86.59-1.41 0-.55-.2-1.02-.59-1.41A1.93 1.93 0 0 0 7 10.5c-.55 0-1.02.2-1.41.59-.4.39-.59.86-.59 1.41zm5.62 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.42.59.55 0 1.02-.2 1.41-.59.4-.39.59-.86.59-1.41 0-.55-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.03.2-1.42.59-.39.39-.58.86-.58 1.41zm5.6 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.43.59.56 0 1.03-.2 1.42-.59.39-.39.58-.86.58-1.41 0-.55-.2-1.02-.58-1.41a1.93 1.93 0 0 0-1.42-.59c-.56 0-1.04.2-1.43.59-.39.39-.58.86-.58 1.41z" fill-rule="evenodd"></path></svg></button></div><div class="sl s"><pre class="oe"><div class="abw s"><div class="az b ba bb iz"><div class="dk">Thanks for this article, it makes the concept easier to understand. What I struggle to understand though is the intuitition behind the key, value and queries. In your example, you initialise them and mention that normally they are initialised…...</div></div></div></pre></div><button class="rl acb eu"><span class="az b ht bb ace">Read More</span></button><div class="aby n o aw cj"><div class="n o"><div class="n o"><div class="s am kk km pf pg ph"><span><a href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2Fafeaa67cf398&amp;operation=register&amp;redirect=https%3A%2F%2Ftowardsdatascience.com%2Fillustrated-self-attention-2d627e33b20a&amp;source=responses-----afeaa67cf398----2-----------------respond_sidebar-----------" class="eh ei by bz ca cb cc cd ce bk ej ek cf el em" rel="noopener"><div class="cd pi pj pk eu pl pm xx r po pp"><svg width="25" height="25" viewBox="0 0 25 25" aria-label="clap"><g fill-rule="evenodd"><path d="M11.74 0l.76 2.97.76-2.97zM14.81 3.78l1.84-2.56-1.42-.47zM8.38 1.22l1.84 2.56L9.8.75zM20.38 21.62a5.11 5.11 0 0 1-3.16 1.61l.49-.45c2.88-2.89 3.45-5.98 1.69-9.21l-1.1-1.94-.96-2.02c-.31-.67-.23-1.18.25-1.55a.84.84 0 0 1 .66-.16c.34.05.66.28.88.6l2.85 5.02c1.18 1.97 1.38 5.12-1.6 8.1M7.1 21.1l-5.02-5.02a1 1 0 0 1 .7-1.7 1 1 0 0 1 .72.3l2.6 2.6a.44.44 0 0 0 .63-.62L4.1 14.04l-1.75-1.75a1 1 0 1 1 1.41-1.41l4.15 4.15a.44.44 0 0 0 .63 0 .44.44 0 0 0 0-.62L4.4 10.26 3.22 9.08a1 1 0 0 1 0-1.4 1.02 1.02 0 0 1 1.41 0l1.18 1.16L9.96 13a.44.44 0 0 0 .62 0 .44.44 0 0 0 0-.63L6.43 8.22a.99.99 0 0 1-.3-.7.99.99 0 0 1 .3-.7 1 1 0 0 1 1.41 0l7 6.98a.44.44 0 0 0 .7-.5l-1.35-2.85c-.31-.68-.23-1.19.25-1.56a.85.85 0 0 1 .66-.16c.34.06.66.28.88.6L18.63 14c1.57 2.88 1.07 5.54-1.55 8.16a5.62 5.62 0 0 1-5.06 1.65 9.35 9.35 0 0 1-4.93-2.72zM11 5.98l2.56 2.56c-.5.6-.56 1.41-.15 2.28l.26.56-4.25-4.25a.98.98 0 0 1-.12-.45 1 1 0 0 1 .29-.7 1.02 1.02 0 0 1 1.41 0zm8.89 2.06c-.38-.56-.9-.92-1.49-1.01a1.74 1.74 0 0 0-1.34.33c-.38.29-.61.65-.71 1.06a2.1 2.1 0 0 0-1.1-.56 1.78 1.78 0 0 0-.99.13l-2.64-2.64a1.88 1.88 0 0 0-2.65 0 1.86 1.86 0 0 0-.48.85 1.89 1.89 0 0 0-2.67-.01 1.87 1.87 0 0 0-.5.9c-.76-.75-2-.75-2.7-.04a1.88 1.88 0 0 0 0 2.66c-.3.12-.61.29-.87.55a1.88 1.88 0 0 0 0 2.66l.62.62a1.88 1.88 0 0 0-.9 3.16l5.01 5.02c1.6 1.6 3.52 2.64 5.4 2.96a7.16 7.16 0 0 0 1.18.1c1.03 0 2-.25 2.9-.7A5.9 5.9 0 0 0 21 22.24c3.34-3.34 3.08-6.93 1.74-9.17l-2.87-5.04z"></path></g></svg></div></a></span></div><div class="s pq pr ps pt pu pv pw"><div class="am ss px"><p class="az b ba bb iz">2<span class="s h g f st su"></span></p></div></div></div><div class="en q n o"><button class="eh ei by bz ca cb cc cd ce bk ej ek cf el em"><div class="n o"><svg width="29" height="29" class="r q abx" aria-label="responses"><path d="M21.27 20.06a9.04 9.04 0 0 0 2.75-6.68C24.02 8.21 19.67 4 14.1 4S4 8.21 4 13.38c0 5.18 4.53 9.39 10.1 9.39 1 0 2-.14 2.95-.41.28.25.6.49.92.7a7.46 7.46 0 0 0 4.19 1.3c.27 0 .5-.13.6-.35a.63.63 0 0 0-.05-.65 8.08 8.08 0 0 1-1.29-2.58 5.42 5.42 0 0 1-.15-.75zm-3.85 1.32l-.08-.28-.4.12a9.72 9.72 0 0 1-2.84.43c-4.96 0-9-3.71-9-8.27 0-4.55 4.04-8.26 9-8.26 4.95 0 8.77 3.71 8.77 8.27 0 2.25-.75 4.35-2.5 5.92l-.24.21v.32a5.59 5.59 0 0 0 .21 1.29c.19.7.49 1.4.89 2.08a6.43 6.43 0 0 1-2.67-1.06c-.34-.22-.88-.48-1.16-.74z"></path></svg><span class="zt abz bu"><span class="az b ht bb iz">1 reply</span></span></div></button></div></div><div class="aca s"><p class="az b ba bb iz"><button class="eh ei by bz ca cb cc cd ce bk wq cf el em">Reply</button></p></div></div></div></div></div></div><div class="ox abj s"><div><div class="v he"><div class="ut un s"><div class="n aw cj"><div class="n o aw"><img alt="Ganapathy Krishnan" class="s kc zr zs" src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/0_8yayRPQUhfS3IShp" width="32" height="32"><div class="abr s"><div class="n aw"><div><div class="bu" role="tooltip" aria-hidden="false" aria-describedby="41" aria-labelledby="41"><a href="https://medium.com/@krishnan.g?source=responses-----2d627e33b20a----3----------------------------" class="eh ei by bz ca cb cc cd ce bk ej ek cf el em" rel="noopener"><p class="az b ba bb iz">Ganapathy Krishnan</p></a></div></div></div><a href="https://medium.com/@krishnan.g/nicely-done-7bdb66fbeb10?source=responses-----2d627e33b20a----3----------------------------" class="eh ei by bz ca cb cc cd ce bk wq cf el em" rel="noopener nofollow"><p class="az b ba bb dt">9 months ago</p></a></div></div><button class="eu pj kd ek abq"><svg class="overflow-dots-filled-25px_svg__svgIcon-use" width="25" height="25"><path d="M5 12.5c0 .55.2 1.02.59 1.41.39.4.86.59 1.41.59.55 0 1.02-.2 1.41-.59.4-.39.59-.86.59-1.41 0-.55-.2-1.02-.59-1.41A1.93 1.93 0 0 0 7 10.5c-.55 0-1.02.2-1.41.59-.4.39-.59.86-.59 1.41zm5.62 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.42.59.55 0 1.02-.2 1.41-.59.4-.39.59-.86.59-1.41 0-.55-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.03.2-1.42.59-.39.39-.58.86-.58 1.41zm5.6 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.43.59.56 0 1.03-.2 1.42-.59.39-.39.58-.86.58-1.41 0-.55-.2-1.02-.58-1.41a1.93 1.93 0 0 0-1.42-.59c-.56 0-1.04.2-1.43.59-.39.39-.58.86-.58 1.41z" fill-rule="evenodd"></path></svg></button></div><div class="sl s"><pre class="oe"><div class="abw s"><div class="az b ba bb iz"><div class="dk">Nicely done. However, I wanted to mention that the while the animations were beautifully done, they were distracting.</div></div></div></pre></div><div class="aby n o aw cj"><div class="n o"><div class="n o"><div class="s am kk km pf pg ph"><span><a href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2F7bdb66fbeb10&amp;operation=register&amp;redirect=https%3A%2F%2Ftowardsdatascience.com%2Fillustrated-self-attention-2d627e33b20a&amp;source=responses-----7bdb66fbeb10----3-----------------respond_sidebar-----------" class="eh ei by bz ca cb cc cd ce bk ej ek cf el em" rel="noopener"><div class="cd pi pj pk eu pl pm xx r po pp"><svg width="25" height="25" viewBox="0 0 25 25" aria-label="clap"><g fill-rule="evenodd"><path d="M11.74 0l.76 2.97.76-2.97zM14.81 3.78l1.84-2.56-1.42-.47zM8.38 1.22l1.84 2.56L9.8.75zM20.38 21.62a5.11 5.11 0 0 1-3.16 1.61l.49-.45c2.88-2.89 3.45-5.98 1.69-9.21l-1.1-1.94-.96-2.02c-.31-.67-.23-1.18.25-1.55a.84.84 0 0 1 .66-.16c.34.05.66.28.88.6l2.85 5.02c1.18 1.97 1.38 5.12-1.6 8.1M7.1 21.1l-5.02-5.02a1 1 0 0 1 .7-1.7 1 1 0 0 1 .72.3l2.6 2.6a.44.44 0 0 0 .63-.62L4.1 14.04l-1.75-1.75a1 1 0 1 1 1.41-1.41l4.15 4.15a.44.44 0 0 0 .63 0 .44.44 0 0 0 0-.62L4.4 10.26 3.22 9.08a1 1 0 0 1 0-1.4 1.02 1.02 0 0 1 1.41 0l1.18 1.16L9.96 13a.44.44 0 0 0 .62 0 .44.44 0 0 0 0-.63L6.43 8.22a.99.99 0 0 1-.3-.7.99.99 0 0 1 .3-.7 1 1 0 0 1 1.41 0l7 6.98a.44.44 0 0 0 .7-.5l-1.35-2.85c-.31-.68-.23-1.19.25-1.56a.85.85 0 0 1 .66-.16c.34.06.66.28.88.6L18.63 14c1.57 2.88 1.07 5.54-1.55 8.16a5.62 5.62 0 0 1-5.06 1.65 9.35 9.35 0 0 1-4.93-2.72zM11 5.98l2.56 2.56c-.5.6-.56 1.41-.15 2.28l.26.56-4.25-4.25a.98.98 0 0 1-.12-.45 1 1 0 0 1 .29-.7 1.02 1.02 0 0 1 1.41 0zm8.89 2.06c-.38-.56-.9-.92-1.49-1.01a1.74 1.74 0 0 0-1.34.33c-.38.29-.61.65-.71 1.06a2.1 2.1 0 0 0-1.1-.56 1.78 1.78 0 0 0-.99.13l-2.64-2.64a1.88 1.88 0 0 0-2.65 0 1.86 1.86 0 0 0-.48.85 1.89 1.89 0 0 0-2.67-.01 1.87 1.87 0 0 0-.5.9c-.76-.75-2-.75-2.7-.04a1.88 1.88 0 0 0 0 2.66c-.3.12-.61.29-.87.55a1.88 1.88 0 0 0 0 2.66l.62.62a1.88 1.88 0 0 0-.9 3.16l5.01 5.02c1.6 1.6 3.52 2.64 5.4 2.96a7.16 7.16 0 0 0 1.18.1c1.03 0 2-.25 2.9-.7A5.9 5.9 0 0 0 21 22.24c3.34-3.34 3.08-6.93 1.74-9.17l-2.87-5.04z"></path></g></svg></div></a></span></div><div class="s pq pr ps pt pu pv pw"><div class="am ss px"><p class="az b ba bb iz">2<span class="s h g f st su"></span></p></div></div></div><div class="en q n o"></div></div><div class="aca s"><p class="az b ba bb iz"><button class="eh ei by bz ca cb cc cd ce bk wq cf el em">Reply</button></p></div></div></div></div></div></div><div class="ox abj s"><div><div class="v he"><div class="ut un s"><div class="n aw cj"><div class="n o aw"><img alt="Yaohwang Dav" class="s kc zr zs" src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/0_jkLqlO6L1VWU1tAX.jpg" width="32" height="32"><div class="abr s"><div class="n aw"><div><div class="bu" role="tooltip" aria-hidden="false" aria-describedby="42" aria-labelledby="42"><a href="https://medium.com/@yaohwang.dav?source=responses-----2d627e33b20a----4----------------------------" class="eh ei by bz ca cb cc cd ce bk ej ek cf el em" rel="noopener"><p class="az b ba bb iz">Yaohwang Dav</p></a></div></div></div><a href="https://medium.com/@yaohwang.dav/hey-raimi-which-tool-did-u-use-for-thest-graphes-may-i-get-that-e1929750831a?source=responses-----2d627e33b20a----4----------------------------" class="eh ei by bz ca cb cc cd ce bk wq cf el em" rel="noopener nofollow"><p class="az b ba bb dt">4 months ago&nbsp;(edited)</p></a></div></div><button class="eu pj kd ek abq"><svg class="overflow-dots-filled-25px_svg__svgIcon-use" width="25" height="25"><path d="M5 12.5c0 .55.2 1.02.59 1.41.39.4.86.59 1.41.59.55 0 1.02-.2 1.41-.59.4-.39.59-.86.59-1.41 0-.55-.2-1.02-.59-1.41A1.93 1.93 0 0 0 7 10.5c-.55 0-1.02.2-1.41.59-.4.39-.59.86-.59 1.41zm5.62 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.42.59.55 0 1.02-.2 1.41-.59.4-.39.59-.86.59-1.41 0-.55-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.03.2-1.42.59-.39.39-.58.86-.58 1.41zm5.6 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.43.59.56 0 1.03-.2 1.42-.59.39-.39.58-.86.58-1.41 0-.55-.2-1.02-.58-1.41a1.93 1.93 0 0 0-1.42-.59c-.56 0-1.04.2-1.43.59-.39.39-.58.86-.58 1.41z" fill-rule="evenodd"></path></svg></button></div><div class="sl s"><pre class="oe"><div class="abw s"><div class="az b ba bb iz"><div class="dk">hey Raimi, which tool did u use for these graphes, may i get that?</div></div></div></pre></div><div class="aby n o aw cj"><div class="n o"><div class="n o"><div class="s am kk km pf pg ph"><span><a href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2Fe1929750831a&amp;operation=register&amp;redirect=https%3A%2F%2Ftowardsdatascience.com%2Fillustrated-self-attention-2d627e33b20a&amp;source=responses-----e1929750831a----4-----------------respond_sidebar-----------" class="eh ei by bz ca cb cc cd ce bk ej ek cf el em" rel="noopener"><div class="cd pi pj pk eu pl pm xx r po pp"><svg width="25" height="25" viewBox="0 0 25 25" aria-label="clap"><g fill-rule="evenodd"><path d="M11.74 0l.76 2.97.76-2.97zM14.81 3.78l1.84-2.56-1.42-.47zM8.38 1.22l1.84 2.56L9.8.75zM20.38 21.62a5.11 5.11 0 0 1-3.16 1.61l.49-.45c2.88-2.89 3.45-5.98 1.69-9.21l-1.1-1.94-.96-2.02c-.31-.67-.23-1.18.25-1.55a.84.84 0 0 1 .66-.16c.34.05.66.28.88.6l2.85 5.02c1.18 1.97 1.38 5.12-1.6 8.1M7.1 21.1l-5.02-5.02a1 1 0 0 1 .7-1.7 1 1 0 0 1 .72.3l2.6 2.6a.44.44 0 0 0 .63-.62L4.1 14.04l-1.75-1.75a1 1 0 1 1 1.41-1.41l4.15 4.15a.44.44 0 0 0 .63 0 .44.44 0 0 0 0-.62L4.4 10.26 3.22 9.08a1 1 0 0 1 0-1.4 1.02 1.02 0 0 1 1.41 0l1.18 1.16L9.96 13a.44.44 0 0 0 .62 0 .44.44 0 0 0 0-.63L6.43 8.22a.99.99 0 0 1-.3-.7.99.99 0 0 1 .3-.7 1 1 0 0 1 1.41 0l7 6.98a.44.44 0 0 0 .7-.5l-1.35-2.85c-.31-.68-.23-1.19.25-1.56a.85.85 0 0 1 .66-.16c.34.06.66.28.88.6L18.63 14c1.57 2.88 1.07 5.54-1.55 8.16a5.62 5.62 0 0 1-5.06 1.65 9.35 9.35 0 0 1-4.93-2.72zM11 5.98l2.56 2.56c-.5.6-.56 1.41-.15 2.28l.26.56-4.25-4.25a.98.98 0 0 1-.12-.45 1 1 0 0 1 .29-.7 1.02 1.02 0 0 1 1.41 0zm8.89 2.06c-.38-.56-.9-.92-1.49-1.01a1.74 1.74 0 0 0-1.34.33c-.38.29-.61.65-.71 1.06a2.1 2.1 0 0 0-1.1-.56 1.78 1.78 0 0 0-.99.13l-2.64-2.64a1.88 1.88 0 0 0-2.65 0 1.86 1.86 0 0 0-.48.85 1.89 1.89 0 0 0-2.67-.01 1.87 1.87 0 0 0-.5.9c-.76-.75-2-.75-2.7-.04a1.88 1.88 0 0 0 0 2.66c-.3.12-.61.29-.87.55a1.88 1.88 0 0 0 0 2.66l.62.62a1.88 1.88 0 0 0-.9 3.16l5.01 5.02c1.6 1.6 3.52 2.64 5.4 2.96a7.16 7.16 0 0 0 1.18.1c1.03 0 2-.25 2.9-.7A5.9 5.9 0 0 0 21 22.24c3.34-3.34 3.08-6.93 1.74-9.17l-2.87-5.04z"></path></g></svg></div></a></span></div><div class="s pq pr ps pt pu pv pw"><div class="am ss px"><p class="az b ba bb iz">1<span class="s h g f st su"></span></p></div></div></div><div class="en q n o"><button class="eh ei by bz ca cb cc cd ce bk ej ek cf el em"><div class="n o"><svg width="29" height="29" class="r q abx" aria-label="responses"><path d="M21.27 20.06a9.04 9.04 0 0 0 2.75-6.68C24.02 8.21 19.67 4 14.1 4S4 8.21 4 13.38c0 5.18 4.53 9.39 10.1 9.39 1 0 2-.14 2.95-.41.28.25.6.49.92.7a7.46 7.46 0 0 0 4.19 1.3c.27 0 .5-.13.6-.35a.63.63 0 0 0-.05-.65 8.08 8.08 0 0 1-1.29-2.58 5.42 5.42 0 0 1-.15-.75zm-3.85 1.32l-.08-.28-.4.12a9.72 9.72 0 0 1-2.84.43c-4.96 0-9-3.71-9-8.27 0-4.55 4.04-8.26 9-8.26 4.95 0 8.77 3.71 8.77 8.27 0 2.25-.75 4.35-2.5 5.92l-.24.21v.32a5.59 5.59 0 0 0 .21 1.29c.19.7.49 1.4.89 2.08a6.43 6.43 0 0 1-2.67-1.06c-.34-.22-.88-.48-1.16-.74z"></path></svg><span class="zt abz bu"><span class="az b ht bb iz">2 replies</span></span></div></button></div></div><div class="aca s"><p class="az b ba bb iz"><button class="eh ei by bz ca cb cc cd ce bk wq cf el em">Reply</button></p></div></div></div></div></div></div><div class="ox abj s"><div><div class="v he"><div class="ut un s"><div class="n aw cj"><div class="n o aw"><img alt="Andrej Anka" class="s kc zr zs" src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/1_ObsyBXKKfsObHHnpT7z72Q.jpeg" width="32" height="32"><div class="abr s"><div class="n aw"><div><div class="bu" role="tooltip" aria-hidden="false" aria-describedby="43" aria-labelledby="43"><a href="https://medium.com/@ankas?source=responses-----2d627e33b20a----5----------------------------" class="eh ei by bz ca cb cc cd ce bk ej ek cf el em" rel="noopener"><p class="az b ba bb iz">Andrej Anka</p></a></div></div></div><a href="https://medium.com/@ankas/what-tool-did-you-use-to-make-the-animations-pics-really-enjoyed-it-af711438b683?source=responses-----2d627e33b20a----5----------------------------" class="eh ei by bz ca cb cc cd ce bk wq cf el em" rel="noopener nofollow"><p class="az b ba bb dt">12 months ago</p></a></div></div><button class="eu pj kd ek abq"><svg class="overflow-dots-filled-25px_svg__svgIcon-use" width="25" height="25"><path d="M5 12.5c0 .55.2 1.02.59 1.41.39.4.86.59 1.41.59.55 0 1.02-.2 1.41-.59.4-.39.59-.86.59-1.41 0-.55-.2-1.02-.59-1.41A1.93 1.93 0 0 0 7 10.5c-.55 0-1.02.2-1.41.59-.4.39-.59.86-.59 1.41zm5.62 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.42.59.55 0 1.02-.2 1.41-.59.4-.39.59-.86.59-1.41 0-.55-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.03.2-1.42.59-.39.39-.58.86-.58 1.41zm5.6 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.43.59.56 0 1.03-.2 1.42-.59.39-.39.58-.86.58-1.41 0-.55-.2-1.02-.58-1.41a1.93 1.93 0 0 0-1.42-.59c-.56 0-1.04.2-1.43.59-.39.39-.58.86-.58 1.41z" fill-rule="evenodd"></path></svg></button></div><div class="sl s"><pre class="oe"><div class="abw s"><div class="az b ba bb iz"><div class="dk">What tool did you use to make the animations/pics? Really enjoyed it!</div></div></div></pre></div><div class="aby n o aw cj"><div class="n o"><div class="n o"><div class="s am kk km pf pg ph"><span><a href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2Faf711438b683&amp;operation=register&amp;redirect=https%3A%2F%2Ftowardsdatascience.com%2Fillustrated-self-attention-2d627e33b20a&amp;source=responses-----af711438b683----5-----------------respond_sidebar-----------" class="eh ei by bz ca cb cc cd ce bk ej ek cf el em" rel="noopener"><div class="cd pi pj pk eu pl pm xx r po pp"><svg width="25" height="25" viewBox="0 0 25 25" aria-label="clap"><g fill-rule="evenodd"><path d="M11.74 0l.76 2.97.76-2.97zM14.81 3.78l1.84-2.56-1.42-.47zM8.38 1.22l1.84 2.56L9.8.75zM20.38 21.62a5.11 5.11 0 0 1-3.16 1.61l.49-.45c2.88-2.89 3.45-5.98 1.69-9.21l-1.1-1.94-.96-2.02c-.31-.67-.23-1.18.25-1.55a.84.84 0 0 1 .66-.16c.34.05.66.28.88.6l2.85 5.02c1.18 1.97 1.38 5.12-1.6 8.1M7.1 21.1l-5.02-5.02a1 1 0 0 1 .7-1.7 1 1 0 0 1 .72.3l2.6 2.6a.44.44 0 0 0 .63-.62L4.1 14.04l-1.75-1.75a1 1 0 1 1 1.41-1.41l4.15 4.15a.44.44 0 0 0 .63 0 .44.44 0 0 0 0-.62L4.4 10.26 3.22 9.08a1 1 0 0 1 0-1.4 1.02 1.02 0 0 1 1.41 0l1.18 1.16L9.96 13a.44.44 0 0 0 .62 0 .44.44 0 0 0 0-.63L6.43 8.22a.99.99 0 0 1-.3-.7.99.99 0 0 1 .3-.7 1 1 0 0 1 1.41 0l7 6.98a.44.44 0 0 0 .7-.5l-1.35-2.85c-.31-.68-.23-1.19.25-1.56a.85.85 0 0 1 .66-.16c.34.06.66.28.88.6L18.63 14c1.57 2.88 1.07 5.54-1.55 8.16a5.62 5.62 0 0 1-5.06 1.65 9.35 9.35 0 0 1-4.93-2.72zM11 5.98l2.56 2.56c-.5.6-.56 1.41-.15 2.28l.26.56-4.25-4.25a.98.98 0 0 1-.12-.45 1 1 0 0 1 .29-.7 1.02 1.02 0 0 1 1.41 0zm8.89 2.06c-.38-.56-.9-.92-1.49-1.01a1.74 1.74 0 0 0-1.34.33c-.38.29-.61.65-.71 1.06a2.1 2.1 0 0 0-1.1-.56 1.78 1.78 0 0 0-.99.13l-2.64-2.64a1.88 1.88 0 0 0-2.65 0 1.86 1.86 0 0 0-.48.85 1.89 1.89 0 0 0-2.67-.01 1.87 1.87 0 0 0-.5.9c-.76-.75-2-.75-2.7-.04a1.88 1.88 0 0 0 0 2.66c-.3.12-.61.29-.87.55a1.88 1.88 0 0 0 0 2.66l.62.62a1.88 1.88 0 0 0-.9 3.16l5.01 5.02c1.6 1.6 3.52 2.64 5.4 2.96a7.16 7.16 0 0 0 1.18.1c1.03 0 2-.25 2.9-.7A5.9 5.9 0 0 0 21 22.24c3.34-3.34 3.08-6.93 1.74-9.17l-2.87-5.04z"></path></g></svg></div></a></span></div><div class="s pq pr ps pt pu pv pw"><div class="am ss px"><p class="az b ba bb iz">1<span class="s h g f st su"></span></p></div></div></div><div class="en q n o"><button class="eh ei by bz ca cb cc cd ce bk ej ek cf el em"><div class="n o"><svg width="29" height="29" class="r q abx" aria-label="responses"><path d="M21.27 20.06a9.04 9.04 0 0 0 2.75-6.68C24.02 8.21 19.67 4 14.1 4S4 8.21 4 13.38c0 5.18 4.53 9.39 10.1 9.39 1 0 2-.14 2.95-.41.28.25.6.49.92.7a7.46 7.46 0 0 0 4.19 1.3c.27 0 .5-.13.6-.35a.63.63 0 0 0-.05-.65 8.08 8.08 0 0 1-1.29-2.58 5.42 5.42 0 0 1-.15-.75zm-3.85 1.32l-.08-.28-.4.12a9.72 9.72 0 0 1-2.84.43c-4.96 0-9-3.71-9-8.27 0-4.55 4.04-8.26 9-8.26 4.95 0 8.77 3.71 8.77 8.27 0 2.25-.75 4.35-2.5 5.92l-.24.21v.32a5.59 5.59 0 0 0 .21 1.29c.19.7.49 1.4.89 2.08a6.43 6.43 0 0 1-2.67-1.06c-.34-.22-.88-.48-1.16-.74z"></path></svg><span class="zt abz bu"><span class="az b ht bb iz">1 reply</span></span></div></button></div></div><div class="aca s"><p class="az b ba bb iz"><button class="eh ei by bz ca cb cc cd ce bk wq cf el em">Reply</button></p></div></div></div></div></div></div><div class="ox abj s"><div><div class="v he"><div class="abp un s"><div class="n aw cj"><div class="n o aw"><img alt="Praveen Pareek" class="s kc zr zs" src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/2_0cu0FJhu-CxYE6lxA4nung.jpeg" width="32" height="32"><div class="abr s"><div class="n aw"><div><div class="bu" role="tooltip" aria-hidden="false" aria-describedby="44" aria-labelledby="44"><a href="https://praveen-pareek.medium.com/?source=responses-----2d627e33b20a----6----------------------------" class="eh ei by bz ca cb cc cd ce bk ej ek cf el em" rel="noopener"><p class="az b ba bb iz">Praveen Pareek</p></a></div></div></div><a href="https://praveen-pareek.medium.com/hi-raimi-you-write-well-keep-writing-i-also-write-at-praveen-pareek-check-it-out-8d4e848d0920?source=responses-----2d627e33b20a----6----------------------------" class="eh ei by bz ca cb cc cd ce bk wq cf el em" rel="noopener nofollow"><p class="az b ba bb dt">11 months ago</p></a></div></div><button class="eu pj kd ek abq"><svg class="overflow-dots-filled-25px_svg__svgIcon-use" width="25" height="25"><path d="M5 12.5c0 .55.2 1.02.59 1.41.39.4.86.59 1.41.59.55 0 1.02-.2 1.41-.59.4-.39.59-.86.59-1.41 0-.55-.2-1.02-.59-1.41A1.93 1.93 0 0 0 7 10.5c-.55 0-1.02.2-1.41.59-.4.39-.59.86-.59 1.41zm5.62 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.42.59.55 0 1.02-.2 1.41-.59.4-.39.59-.86.59-1.41 0-.55-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.03.2-1.42.59-.39.39-.58.86-.58 1.41zm5.6 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.43.59.56 0 1.03-.2 1.42-.59.39-.39.58-.86.58-1.41 0-.55-.2-1.02-.58-1.41a1.93 1.93 0 0 0-1.42-.59c-.56 0-1.04.2-1.43.59-.39.39-.58.86-.58 1.41z" fill-rule="evenodd"></path></svg></button></div><a href="https://praveen-pareek.medium.com/hi-raimi-you-write-well-keep-writing-i-also-write-at-praveen-pareek-check-it-out-8d4e848d0920?source=responses-----2d627e33b20a----6----------------------------" rel="noopener"><div class="abk abl tt abm abn c"><div class="kt abo"><div class="az b ht bb dt"><div class="abs n o da"><div class="n o"><svg width="19" height="19" viewBox="0 0 19 19" class="abt s"><g fill-rule="evenodd"><path d="M6.93 15.34l-2.06-2.06c-2.16-2.16-3.53-3.15-2.9-3.79.33-.32.8-.39 1.2 0l2.13 2.2c.08.08.16.07.38.13.21.05.36-.05.54-.23.17-.16.07-.6-.09-.77L3.5 8.2c-.37-.36-.5-1-.1-1.39.37-.37.8-.19 1.14.15.39.38 2.7 2.76 2.7 2.76a.42.42 0 0 0 .3.13.54.54 0 0 0 .33-.16c.17-.16.25-.46.09-.63 0 0-1.34-1.4-1.82-1.88-.71-.72-.77-1.22-.46-1.54.45-.44 1.05-.3 1.86.62l3.58 3.89-.75-1.95s-.47-1.25 0-1.5.84.4 1.17.9l1.86 3.34c1.01 1.65.69 3.8-.73 5.19-1.87 1.87-4.07.87-5.73-.78zM10.26.04H8.73l.77 3.3zM13.93 1.2L12.5.7l-.4 3.36zM6.5.57l-1.44.52L6.9 3.93z"></path><path d="M14.3 7.03c-.34-.5-.9-.52-1.25-.24-.25.19-.21.6-.2.9l1.51 2.64c1.17 1.9 1.33 3.66 0 5.45.4-.19.52-.23.9-.61 1.52-1.52 1.86-3.32.85-4.96l-1.8-3.18z"></path></g></svg><div>2</div></div><div class="n o"><svg width="19" height="19" viewBox="0 0 19 19" class="zt abt s"><path d="M16.19 9.42c0 1.67-.72 2.84-2.03 4l-.1.09v.13a4.3 4.3 0 0 0 .15.85c.17.6.46 1.2.86 1.8a4.94 4.94 0 0 1-2.46-.84c-.26-.17-.33-.2-.54-.4l-.13-.12-.16.05c-.68.2-2.75.46-4.88-.16a5.9 5.9 0 0 1-4.1-5.4c0-3.37 3-6.12 6.7-6.12s6.69 2.75 6.69 6.12z" fill-rule="evenodd"></path></svg><div>1</div></div></div></div></div><p class="az b ba bb hf abu uh ui abv uk ul iz"><div class="s">Hi Raimi
You write well. Keep writing! 🌸
I also write at Praveen Pareek. Check it out. 📝</div></p></div></a></div></div></div></div><div class="ox abj s"><div><div class="v he"><div class="ut un s"><div class="n aw cj"><div class="n o aw"><img alt="Beckswu" class="s kc zr zs" src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/0_kROqVGIK3SVuELHC.jpg" width="32" height="32"><div class="abr s"><div class="n aw"><div><div class="bu" role="tooltip" aria-hidden="false" aria-describedby="45" aria-labelledby="45"><a href="https://medium.com/@beckswu?source=responses-----2d627e33b20a----7----------------------------" class="eh ei by bz ca cb cc cd ce bk ej ek cf el em" rel="noopener"><p class="az b ba bb iz">Beckswu</p></a></div></div></div><a href="https://medium.com/@beckswu/it-is-a-great-post-explain-the-idea-with-number-is-always-a-good-choice-8759dd48bb75?source=responses-----2d627e33b20a----7----------------------------" class="eh ei by bz ca cb cc cd ce bk wq cf el em" rel="noopener nofollow"><p class="az b ba bb dt">24 days ago</p></a></div></div><button class="eu pj kd ek abq"><svg class="overflow-dots-filled-25px_svg__svgIcon-use" width="25" height="25"><path d="M5 12.5c0 .55.2 1.02.59 1.41.39.4.86.59 1.41.59.55 0 1.02-.2 1.41-.59.4-.39.59-.86.59-1.41 0-.55-.2-1.02-.59-1.41A1.93 1.93 0 0 0 7 10.5c-.55 0-1.02.2-1.41.59-.4.39-.59.86-.59 1.41zm5.62 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.42.59.55 0 1.02-.2 1.41-.59.4-.39.59-.86.59-1.41 0-.55-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.03.2-1.42.59-.39.39-.58.86-.58 1.41zm5.6 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.43.59.56 0 1.03-.2 1.42-.59.39-.39.58-.86.58-1.41 0-.55-.2-1.02-.58-1.41a1.93 1.93 0 0 0-1.42-.59c-.56 0-1.04.2-1.43.59-.39.39-.58.86-.58 1.41z" fill-rule="evenodd"></path></svg></button></div><div class="sl s"><pre class="oe"><div class="abw s"><div class="az b ba bb iz"><div class="dk">It is a great post! Explain the idea with number is always a good choice</div></div></div></pre></div><div class="aby n o aw cj"><div class="n o"><div class="n o"><div class="s am kk km pf pg ph"><span><a href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2F8759dd48bb75&amp;operation=register&amp;redirect=https%3A%2F%2Ftowardsdatascience.com%2Fillustrated-self-attention-2d627e33b20a&amp;source=responses-----8759dd48bb75----7-----------------respond_sidebar-----------" class="eh ei by bz ca cb cc cd ce bk ej ek cf el em" rel="noopener"><div class="cd pi pj pk eu pl pm xx r po pp"><svg width="25" height="25" viewBox="0 0 25 25" aria-label="clap"><g fill-rule="evenodd"><path d="M11.74 0l.76 2.97.76-2.97zM14.81 3.78l1.84-2.56-1.42-.47zM8.38 1.22l1.84 2.56L9.8.75zM20.38 21.62a5.11 5.11 0 0 1-3.16 1.61l.49-.45c2.88-2.89 3.45-5.98 1.69-9.21l-1.1-1.94-.96-2.02c-.31-.67-.23-1.18.25-1.55a.84.84 0 0 1 .66-.16c.34.05.66.28.88.6l2.85 5.02c1.18 1.97 1.38 5.12-1.6 8.1M7.1 21.1l-5.02-5.02a1 1 0 0 1 .7-1.7 1 1 0 0 1 .72.3l2.6 2.6a.44.44 0 0 0 .63-.62L4.1 14.04l-1.75-1.75a1 1 0 1 1 1.41-1.41l4.15 4.15a.44.44 0 0 0 .63 0 .44.44 0 0 0 0-.62L4.4 10.26 3.22 9.08a1 1 0 0 1 0-1.4 1.02 1.02 0 0 1 1.41 0l1.18 1.16L9.96 13a.44.44 0 0 0 .62 0 .44.44 0 0 0 0-.63L6.43 8.22a.99.99 0 0 1-.3-.7.99.99 0 0 1 .3-.7 1 1 0 0 1 1.41 0l7 6.98a.44.44 0 0 0 .7-.5l-1.35-2.85c-.31-.68-.23-1.19.25-1.56a.85.85 0 0 1 .66-.16c.34.06.66.28.88.6L18.63 14c1.57 2.88 1.07 5.54-1.55 8.16a5.62 5.62 0 0 1-5.06 1.65 9.35 9.35 0 0 1-4.93-2.72zM11 5.98l2.56 2.56c-.5.6-.56 1.41-.15 2.28l.26.56-4.25-4.25a.98.98 0 0 1-.12-.45 1 1 0 0 1 .29-.7 1.02 1.02 0 0 1 1.41 0zm8.89 2.06c-.38-.56-.9-.92-1.49-1.01a1.74 1.74 0 0 0-1.34.33c-.38.29-.61.65-.71 1.06a2.1 2.1 0 0 0-1.1-.56 1.78 1.78 0 0 0-.99.13l-2.64-2.64a1.88 1.88 0 0 0-2.65 0 1.86 1.86 0 0 0-.48.85 1.89 1.89 0 0 0-2.67-.01 1.87 1.87 0 0 0-.5.9c-.76-.75-2-.75-2.7-.04a1.88 1.88 0 0 0 0 2.66c-.3.12-.61.29-.87.55a1.88 1.88 0 0 0 0 2.66l.62.62a1.88 1.88 0 0 0-.9 3.16l5.01 5.02c1.6 1.6 3.52 2.64 5.4 2.96a7.16 7.16 0 0 0 1.18.1c1.03 0 2-.25 2.9-.7A5.9 5.9 0 0 0 21 22.24c3.34-3.34 3.08-6.93 1.74-9.17l-2.87-5.04z"></path></g></svg></div></a></span></div><div class="s pq pr ps pt pu pv pw"><div class="am ss px"><p class="az b ba bb iz">1<span class="s h g f st su"></span></p></div></div></div><div class="en q n o"><button class="eh ei by bz ca cb cc cd ce bk ej ek cf el em"><div class="n o"><svg width="29" height="29" class="r q abx" aria-label="responses"><path d="M21.27 20.06a9.04 9.04 0 0 0 2.75-6.68C24.02 8.21 19.67 4 14.1 4S4 8.21 4 13.38c0 5.18 4.53 9.39 10.1 9.39 1 0 2-.14 2.95-.41.28.25.6.49.92.7a7.46 7.46 0 0 0 4.19 1.3c.27 0 .5-.13.6-.35a.63.63 0 0 0-.05-.65 8.08 8.08 0 0 1-1.29-2.58 5.42 5.42 0 0 1-.15-.75zm-3.85 1.32l-.08-.28-.4.12a9.72 9.72 0 0 1-2.84.43c-4.96 0-9-3.71-9-8.27 0-4.55 4.04-8.26 9-8.26 4.95 0 8.77 3.71 8.77 8.27 0 2.25-.75 4.35-2.5 5.92l-.24.21v.32a5.59 5.59 0 0 0 .21 1.29c.19.7.49 1.4.89 2.08a6.43 6.43 0 0 1-2.67-1.06c-.34-.22-.88-.48-1.16-.74z"></path></svg><span class="zt abz bu"><span class="az b ht bb iz">1 reply</span></span></div></button></div></div><div class="aca s"><p class="az b ba bb iz"><button class="eh ei by bz ca cb cc cd ce bk wq cf el em">Reply</button></p></div></div></div></div></div></div><div class="ox abj s"><div><div class="v he"><div class="ut un s"><div class="n aw cj"><div class="n o aw"><img alt="Haremsoc" class="s kc zr zs" src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/0_B__4wugYMQFXynuB.jpg" width="32" height="32"><div class="abr s"><div class="n aw"><div><div class="bu" role="tooltip" aria-hidden="false" aria-describedby="46" aria-labelledby="46"><a href="https://medium.com/@haremsoc?source=responses-----2d627e33b20a----8----------------------------" class="eh ei by bz ca cb cc cd ce bk ej ek cf el em" rel="noopener"><p class="az b ba bb iz">Haremsoc</p></a></div></div></div><a href="https://medium.com/@haremsoc/thank-you-very-much-765225aca769?source=responses-----2d627e33b20a----8----------------------------" class="eh ei by bz ca cb cc cd ce bk wq cf el em" rel="noopener nofollow"><p class="az b ba bb dt">about 1 year ago</p></a></div></div><button class="eu pj kd ek abq"><svg class="overflow-dots-filled-25px_svg__svgIcon-use" width="25" height="25"><path d="M5 12.5c0 .55.2 1.02.59 1.41.39.4.86.59 1.41.59.55 0 1.02-.2 1.41-.59.4-.39.59-.86.59-1.41 0-.55-.2-1.02-.59-1.41A1.93 1.93 0 0 0 7 10.5c-.55 0-1.02.2-1.41.59-.4.39-.59.86-.59 1.41zm5.62 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.42.59.55 0 1.02-.2 1.41-.59.4-.39.59-.86.59-1.41 0-.55-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.03.2-1.42.59-.39.39-.58.86-.58 1.41zm5.6 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.43.59.56 0 1.03-.2 1.42-.59.39-.39.58-.86.58-1.41 0-.55-.2-1.02-.58-1.41a1.93 1.93 0 0 0-1.42-.59c-.56 0-1.04.2-1.43.59-.39.39-.58.86-.58 1.41z" fill-rule="evenodd"></path></svg></button></div><div class="sl s"><pre class="oe"><div class="abw s"><div class="az b ba bb iz"><div class="dk">Thank you very much</div></div></div></pre></div><div class="aby n o aw cj"><div class="n o"><div class="n o"><div class="s am kk km pf pg ph"><span><a href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2F765225aca769&amp;operation=register&amp;redirect=https%3A%2F%2Ftowardsdatascience.com%2Fillustrated-self-attention-2d627e33b20a&amp;source=responses-----765225aca769----8-----------------respond_sidebar-----------" class="eh ei by bz ca cb cc cd ce bk ej ek cf el em" rel="noopener"><div class="cd pi pj pk eu pl pm xx r po pp"><svg width="25" height="25" viewBox="0 0 25 25" aria-label="clap"><g fill-rule="evenodd"><path d="M11.74 0l.76 2.97.76-2.97zM14.81 3.78l1.84-2.56-1.42-.47zM8.38 1.22l1.84 2.56L9.8.75zM20.38 21.62a5.11 5.11 0 0 1-3.16 1.61l.49-.45c2.88-2.89 3.45-5.98 1.69-9.21l-1.1-1.94-.96-2.02c-.31-.67-.23-1.18.25-1.55a.84.84 0 0 1 .66-.16c.34.05.66.28.88.6l2.85 5.02c1.18 1.97 1.38 5.12-1.6 8.1M7.1 21.1l-5.02-5.02a1 1 0 0 1 .7-1.7 1 1 0 0 1 .72.3l2.6 2.6a.44.44 0 0 0 .63-.62L4.1 14.04l-1.75-1.75a1 1 0 1 1 1.41-1.41l4.15 4.15a.44.44 0 0 0 .63 0 .44.44 0 0 0 0-.62L4.4 10.26 3.22 9.08a1 1 0 0 1 0-1.4 1.02 1.02 0 0 1 1.41 0l1.18 1.16L9.96 13a.44.44 0 0 0 .62 0 .44.44 0 0 0 0-.63L6.43 8.22a.99.99 0 0 1-.3-.7.99.99 0 0 1 .3-.7 1 1 0 0 1 1.41 0l7 6.98a.44.44 0 0 0 .7-.5l-1.35-2.85c-.31-.68-.23-1.19.25-1.56a.85.85 0 0 1 .66-.16c.34.06.66.28.88.6L18.63 14c1.57 2.88 1.07 5.54-1.55 8.16a5.62 5.62 0 0 1-5.06 1.65 9.35 9.35 0 0 1-4.93-2.72zM11 5.98l2.56 2.56c-.5.6-.56 1.41-.15 2.28l.26.56-4.25-4.25a.98.98 0 0 1-.12-.45 1 1 0 0 1 .29-.7 1.02 1.02 0 0 1 1.41 0zm8.89 2.06c-.38-.56-.9-.92-1.49-1.01a1.74 1.74 0 0 0-1.34.33c-.38.29-.61.65-.71 1.06a2.1 2.1 0 0 0-1.1-.56 1.78 1.78 0 0 0-.99.13l-2.64-2.64a1.88 1.88 0 0 0-2.65 0 1.86 1.86 0 0 0-.48.85 1.89 1.89 0 0 0-2.67-.01 1.87 1.87 0 0 0-.5.9c-.76-.75-2-.75-2.7-.04a1.88 1.88 0 0 0 0 2.66c-.3.12-.61.29-.87.55a1.88 1.88 0 0 0 0 2.66l.62.62a1.88 1.88 0 0 0-.9 3.16l5.01 5.02c1.6 1.6 3.52 2.64 5.4 2.96a7.16 7.16 0 0 0 1.18.1c1.03 0 2-.25 2.9-.7A5.9 5.9 0 0 0 21 22.24c3.34-3.34 3.08-6.93 1.74-9.17l-2.87-5.04z"></path></g></svg></div></a></span></div><div class="s pq pr ps pt pu pv pw"><div class="am ss px"><p class="az b ba bb iz">1<span class="s h g f st su"></span></p></div></div></div><div class="en q n o"></div></div><div class="aca s"><p class="az b ba bb iz"><button class="eh ei by bz ca cb cc cd ce bk wq cf el em">Reply</button></p></div></div></div></div></div></div><div class="al abj s"><div><div class="v he"><div class="ut un s"><div class="n aw cj"><div class="n o aw"><div class="am zs zr"><div class="jw n aw o p ep acc acd jz ka kb gd"><svg width="39" height="39" viewBox="0 0 39 39"><path fill-rule="evenodd" clip-rule="evenodd" d="M19.5 1C11.83 1 5.17 5.75 1.9 12.71L1 12.3C4.4 5.02 11.4 0 19.5 0S34.6 5.02 38 12.29l-.9.42C33.82 5.75 27.16 1 19.5 1zM1.9 26.29C5.18 33.25 11.84 38 19.5 38c7.67 0 14.33-4.75 17.6-11.71l.9.42C34.6 33.98 27.6 39 19.5 39S4.4 33.98 1 26.71l.9-.42z"></path></svg></div><img alt="Adithya Other" class="s kc zr zs" src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/0_logQHA917qLykwrt.jpg" width="32" height="32"></div><div class="abr s"><div class="n aw"><div><div class="bu" role="tooltip" aria-hidden="false" aria-describedby="47" aria-labelledby="47"><a href="https://medium.com/@adithya.1111.other?source=responses-----2d627e33b20a----9----------------------------" class="eh ei by bz ca cb cc cd ce bk ej ek cf el em" rel="noopener"><p class="az b ba bb iz">Adithya Other</p></a></div></div></div><a href="https://medium.com/@adithya.1111.other/great-article-this-thank-you-raimi-7000d8bdaed4?source=responses-----2d627e33b20a----9----------------------------" class="eh ei by bz ca cb cc cd ce bk wq cf el em" rel="noopener nofollow"><p class="az b ba bb dt">3 months ago</p></a></div></div><button class="eu pj kd ek abq"><svg class="overflow-dots-filled-25px_svg__svgIcon-use" width="25" height="25"><path d="M5 12.5c0 .55.2 1.02.59 1.41.39.4.86.59 1.41.59.55 0 1.02-.2 1.41-.59.4-.39.59-.86.59-1.41 0-.55-.2-1.02-.59-1.41A1.93 1.93 0 0 0 7 10.5c-.55 0-1.02.2-1.41.59-.4.39-.59.86-.59 1.41zm5.62 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.42.59.55 0 1.02-.2 1.41-.59.4-.39.59-.86.59-1.41 0-.55-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.03.2-1.42.59-.39.39-.58.86-.58 1.41zm5.6 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.43.59.56 0 1.03-.2 1.42-.59.39-.39.58-.86.58-1.41 0-.55-.2-1.02-.58-1.41a1.93 1.93 0 0 0-1.42-.59c-.56 0-1.04.2-1.43.59-.39.39-.58.86-.58 1.41z" fill-rule="evenodd"></path></svg></button></div><div class="sl s"><pre class="oe"><div class="abw s"><div class="az b ba bb iz"><div class="dk">Great article this. Thank you Raimi</div></div></div></pre></div><div class="aby n o aw cj"><div class="n o"><div class="n o"><div class="s am kk km pf pg ph"><span><a href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2F7000d8bdaed4&amp;operation=register&amp;redirect=https%3A%2F%2Ftowardsdatascience.com%2Fillustrated-self-attention-2d627e33b20a&amp;source=responses-----7000d8bdaed4----9-----------------respond_sidebar-----------" class="eh ei by bz ca cb cc cd ce bk ej ek cf el em" rel="noopener"><div class="cd pi pj pk eu pl pm xx r po pp"><svg width="25" height="25" viewBox="0 0 25 25" aria-label="clap"><g fill-rule="evenodd"><path d="M11.74 0l.76 2.97.76-2.97zM14.81 3.78l1.84-2.56-1.42-.47zM8.38 1.22l1.84 2.56L9.8.75zM20.38 21.62a5.11 5.11 0 0 1-3.16 1.61l.49-.45c2.88-2.89 3.45-5.98 1.69-9.21l-1.1-1.94-.96-2.02c-.31-.67-.23-1.18.25-1.55a.84.84 0 0 1 .66-.16c.34.05.66.28.88.6l2.85 5.02c1.18 1.97 1.38 5.12-1.6 8.1M7.1 21.1l-5.02-5.02a1 1 0 0 1 .7-1.7 1 1 0 0 1 .72.3l2.6 2.6a.44.44 0 0 0 .63-.62L4.1 14.04l-1.75-1.75a1 1 0 1 1 1.41-1.41l4.15 4.15a.44.44 0 0 0 .63 0 .44.44 0 0 0 0-.62L4.4 10.26 3.22 9.08a1 1 0 0 1 0-1.4 1.02 1.02 0 0 1 1.41 0l1.18 1.16L9.96 13a.44.44 0 0 0 .62 0 .44.44 0 0 0 0-.63L6.43 8.22a.99.99 0 0 1-.3-.7.99.99 0 0 1 .3-.7 1 1 0 0 1 1.41 0l7 6.98a.44.44 0 0 0 .7-.5l-1.35-2.85c-.31-.68-.23-1.19.25-1.56a.85.85 0 0 1 .66-.16c.34.06.66.28.88.6L18.63 14c1.57 2.88 1.07 5.54-1.55 8.16a5.62 5.62 0 0 1-5.06 1.65 9.35 9.35 0 0 1-4.93-2.72zM11 5.98l2.56 2.56c-.5.6-.56 1.41-.15 2.28l.26.56-4.25-4.25a.98.98 0 0 1-.12-.45 1 1 0 0 1 .29-.7 1.02 1.02 0 0 1 1.41 0zm8.89 2.06c-.38-.56-.9-.92-1.49-1.01a1.74 1.74 0 0 0-1.34.33c-.38.29-.61.65-.71 1.06a2.1 2.1 0 0 0-1.1-.56 1.78 1.78 0 0 0-.99.13l-2.64-2.64a1.88 1.88 0 0 0-2.65 0 1.86 1.86 0 0 0-.48.85 1.89 1.89 0 0 0-2.67-.01 1.87 1.87 0 0 0-.5.9c-.76-.75-2-.75-2.7-.04a1.88 1.88 0 0 0 0 2.66c-.3.12-.61.29-.87.55a1.88 1.88 0 0 0 0 2.66l.62.62a1.88 1.88 0 0 0-.9 3.16l5.01 5.02c1.6 1.6 3.52 2.64 5.4 2.96a7.16 7.16 0 0 0 1.18.1c1.03 0 2-.25 2.9-.7A5.9 5.9 0 0 0 21 22.24c3.34-3.34 3.08-6.93 1.74-9.17l-2.87-5.04z"></path></g></svg></div></a></span></div><div class="s pq pr ps pt pu pv pw"><div class="am ss px"><p class="az b ba bb iz">1<span class="s h g f st su"></span></p></div></div></div><div class="en q n o"><button class="eh ei by bz ca cb cc cd ce bk ej ek cf el em"><div class="n o"><svg width="29" height="29" class="r q abx" aria-label="responses"><path d="M21.27 20.06a9.04 9.04 0 0 0 2.75-6.68C24.02 8.21 19.67 4 14.1 4S4 8.21 4 13.38c0 5.18 4.53 9.39 10.1 9.39 1 0 2-.14 2.95-.41.28.25.6.49.92.7a7.46 7.46 0 0 0 4.19 1.3c.27 0 .5-.13.6-.35a.63.63 0 0 0-.05-.65 8.08 8.08 0 0 1-1.29-2.58 5.42 5.42 0 0 1-.15-.75zm-3.85 1.32l-.08-.28-.4.12a9.72 9.72 0 0 1-2.84.43c-4.96 0-9-3.71-9-8.27 0-4.55 4.04-8.26 9-8.26 4.95 0 8.77 3.71 8.77 8.27 0 2.25-.75 4.35-2.5 5.92l-.24.21v.32a5.59 5.59 0 0 0 .21 1.29c.19.7.49 1.4.89 2.08a6.43 6.43 0 0 1-2.67-1.06c-.34-.22-.88-.48-1.16-.74z"></path></svg><span class="zt abz bu"><span class="az b ht bb iz">1 reply</span></span></div></button></div></div><div class="aca s"><p class="az b ba bb iz"><button class="eh ei by bz ca cb cc cd ce bk wq cf el em">Reply</button></p></div></div></div></div></div></div></div></div></div></div><article class="meteredContent"><section class="fq fr fs ft v fu bt s"><div><div class="ho" id="lo-highlight-meter-1-highlight-box"><div class="ze bq zf am zg"><div class="zh zi n cj zj"><p class="az b dj dk iz"><span class="ho" id="lo-highlight-meter-1-copy">You have <b>2</b> free member-only stories left this month. </span><div class="re x"><span class="ho" id="lo-highlight-meter-1-link"><span><a href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Ftowardsdatascience.com%2Fillustrated-self-attention-2d627e33b20a&amp;source=-----2d627e33b20a---------------------smart_meter-----------" class="eh ei by bz ca cb cc cd ce bk cf el em ln" rel="noopener">Sign up for Medium and get an extra one</a></span></span></div></p></div></div></div></div></section><span class="s"></span><div><div class="ep ez zm gb gc gd"></div><div class="fs ft fu am"><div class="s h g f e"><aside class="ym ep fd" style="width: 295.5px;"><div class="abg uq ep aer x v"><p class="az b ht bb dt"><span class="bu uq x hf uh">Top highlight</span></p></div></aside></div></div><section class="ge gf gg dq gh"><div class="gi"><div class="n p"><div class="gj gk gl gm gn go ar gp as gq au v"><figure class="gs gt gu gv gw gi gx gy paragraph-image"><div role="button" tabindex="0" class="gz ha am hb v hc"><div class="fs ft gr"><div class="hi s am hj"><div class="hk hl s"><div class="fa hd ep fd ez he v hf hg hh"><img alt="" class="ep fd ez he v hm hn fe aem" src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/1__92bnsMJy8Bl539G4v93yg.gif" width="1578" height="949" role="presentation"></div><img alt="" class="yq abb ep fd ez he v c" width="1578" height="949" role="presentation" src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/1__92bnsMJy8Bl539G4v93yg(1).gif" srcset="https://miro.medium.com/max/276/1*_92bnsMJy8Bl539G4v93yg.gif 276w, https://miro.medium.com/max/552/1*_92bnsMJy8Bl539G4v93yg.gif 552w, https://miro.medium.com/max/640/1*_92bnsMJy8Bl539G4v93yg.gif 640w, https://miro.medium.com/max/728/1*_92bnsMJy8Bl539G4v93yg.gif 728w, https://miro.medium.com/max/816/1*_92bnsMJy8Bl539G4v93yg.gif 816w, https://miro.medium.com/max/904/1*_92bnsMJy8Bl539G4v93yg.gif 904w, https://miro.medium.com/max/992/1*_92bnsMJy8Bl539G4v93yg.gif 992w, https://miro.medium.com/max/1000/1*_92bnsMJy8Bl539G4v93yg.gif 1000w" sizes="1000px"><noscript><img alt="" class="ep fd ez he v" src="https://miro.medium.com/max/3156/1*_92bnsMJy8Bl539G4v93yg.gif" width="1578" height="949" srcSet="https://miro.medium.com/max/552/1*_92bnsMJy8Bl539G4v93yg.gif 276w, https://miro.medium.com/max/1104/1*_92bnsMJy8Bl539G4v93yg.gif 552w, https://miro.medium.com/max/1280/1*_92bnsMJy8Bl539G4v93yg.gif 640w, https://miro.medium.com/max/1456/1*_92bnsMJy8Bl539G4v93yg.gif 728w, https://miro.medium.com/max/1632/1*_92bnsMJy8Bl539G4v93yg.gif 816w, https://miro.medium.com/max/1808/1*_92bnsMJy8Bl539G4v93yg.gif 904w, https://miro.medium.com/max/1984/1*_92bnsMJy8Bl539G4v93yg.gif 992w, https://miro.medium.com/max/2000/1*_92bnsMJy8Bl539G4v93yg.gif 1000w" sizes="1000px" role="presentation"/></noscript></div></div></div></div></figure></div></div></div><div class="n p"><div class="ao ap aq ar as hp au v"><h2 id="f9fa" class="hq hr hs az b ht hu hv hw hx hy hz dt ia" data-selectable-paragraph="">Inside AI</h2><div class=""><h1 id="423b" class="ib ic hs az id ie if ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz">Illustrated: Self-Attention</h1></div><div class=""><h2 id="e0a7" class="ja ic hs az b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq dt">Step-by-step guide to self-attention with illustrations and code</h2><div class="cv"><div class="n cj jr js jt"><div class="o n"><div><a href="https://medium.com/@remykarem?source=post_page-----2d627e33b20a--------------------------------" rel="noopener"><div class="am ju jv"><div class="jw n aw o p ep jx jy jz ka kb gd"><svg width="36" height="36" viewBox="0 0 36 36"><path fill-rule="evenodd" clip-rule="evenodd" d="M18 1.87c-6.63 0-12.4 4.14-15.21 10.21L2 11.71C4.94 5.37 11 1 18 1s13.06 4.37 16 10.71l-.79.37C30.4 6.01 24.63 1.88 18 1.88zM2.79 23.92c2.81 6.07 8.58 10.2 15.21 10.2 6.63 0 12.4-4.13 15.21-10.2l.79.37C31.06 30.63 25 35 18 35S4.94 30.63 2 24.29l.79-.37z"></path></svg></div><img alt="Raimi Karim" class="s kc jv ju" src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/1_BEc6O6Z6fCy2NDHL9K462A@2x(1).jpeg" width="28" height="28"></div></a></div><div class="en v n cs"><div class="n"><div style="flex:1"><span class="az b ba bb iz"><div><div class="bu" role="tooltip" aria-hidden="false" aria-describedby="5" aria-labelledby="5"><a href="https://medium.com/@remykarem?source=post_page-----2d627e33b20a--------------------------------" class="" rel="noopener"><p class="az b ba bb fj">Raimi Karim</p></a></div></div></span></div></div><span class="az b ba bb dt"><a class="" rel="noopener" href="https://towardsdatascience.com/illustrated-self-attention-2d627e33b20a?source=post_page-----2d627e33b20a--------------------------------"><p class="az b ba bb dt"><span class="kg"></span>Nov 18, 2019<span class="kh">·</span>8 min read<svg class="kd ke kf" width="15" height="15" viewBox="0 0 15 15"><path d="M7.44 2.32c.03-.1.09-.1.12 0l1.2 3.53a.29.29 0 0 0 .26.2h3.88c.11 0 .13.04.04.1L9.8 8.33a.27.27 0 0 0-.1.29l1.2 3.53c.03.1-.01.13-.1.07l-3.14-2.18a.3.3 0 0 0-.32 0L4.2 12.22c-.1.06-.14.03-.1-.07l1.2-3.53a.27.27 0 0 0-.1-.3L2.06 6.16c-.1-.06-.07-.12.03-.12h3.89a.29.29 0 0 0 .26-.19l1.2-3.52z"></path></svg></p></a></span></div></div><div class="n ki kj kk kl km kn ko kp kq"><div class="n o"><div class="kr s"><div class="bu" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bu" role="tooltip" aria-hidden="false" aria-describedby="1" aria-labelledby="1"><button class="eh ei by bz ca cb cc cd ce bk ej ek cf el em" aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post"><svg width="25" height="25" class="r"><g fill-rule="evenodd"><path d="M15.6 5a.42.42 0 0 0 .17-.3.42.42 0 0 0-.12-.33l-2.8-2.79a.5.5 0 0 0-.7 0l-2.8 2.8a.4.4 0 0 0-.1.32c0 .12.07.23.16.3h.02a.45.45 0 0 0 .57-.04l2-2V10c0 .28.23.5.5.5s.5-.22.5-.5V2.93l2.02 2.02c.08.07.18.12.3.13.11.01.21-.02.3-.08v.01"></path><path d="M18 7h-1.5a.5.5 0 0 0 0 1h1.6c.5 0 .9.4.9.9v10.2c0 .5-.4.9-.9.9H6.9a.9.9 0 0 1-.9-.9V8.9c0-.5.4-.9.9-.9h1.6a.5.5 0 0 0 .35-.15A.5.5 0 0 0 9 7.5a.5.5 0 0 0-.15-.35A.5.5 0 0 0 8.5 7H7a2 2 0 0 0-2 2v10c0 1.1.9 2 2 2h11a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2"></path></g></svg></button></div></div></div></div><div class="ks s"><div class="kt"><span><a href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2d627e33b20a&amp;operation=register&amp;redirect=https%3A%2F%2Ftowardsdatascience.com%2Fillustrated-self-attention-2d627e33b20a&amp;source=post_actions_header--------------------------bookmark_preview-----------" class="eh ei by bz ca cb cc cd ce bk ej ek cf el em" rel="noopener"><svg width="25" height="25" viewBox="0 0 25 25"><path d="M19 6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14.66h.01c.01.1.05.2.12.28a.5.5 0 0 0 .7.03l5.67-4.12 5.66 4.13a.5.5 0 0 0 .71-.03.5.5 0 0 0 .12-.29H19V6zm-6.84 9.97L7 19.64V6a1 1 0 0 1 1-1h9a1 1 0 0 1 1 1v13.64l-5.16-3.67a.49.49 0 0 0-.68 0z" fill-rule="evenodd"></path></svg></a></span></div></div><div class="s ax"></div></div></div></div></div></div><p id="b308" class="ku kv hs kw b jb kx ky je kz la lb lc ld le lf lg lh li lj lk ll ge iz" data-selectable-paragraph=""><em class="lm">The illustrations are best viewed on Desktop. A Colab version can be found </em><a href="https://colab.research.google.com/drive/1rPk3ohrmVclqhH7uQ7qys4oznDdAhpzF" class="eh ln" rel="noopener nofollow"><em class="lm">here</em></a><em class="lm">, (thanks to </em><div class="bu abf"><div><div class="bu" role="tooltip" aria-hidden="false" aria-describedby="36" aria-labelledby="36"><a href="https://medium.com/u/3f2bb9b4510b?source=post_page-----2d627e33b20a--------------------------------" class="lo fj bv" target="_blank" rel="noopener"><em class="lm">Manuel Romero</em></a></div></div></div><em class="lm">!).</em></p><p id="318a" class="ku kv hs kw b jb lp kx ky je lq kz la lb lr lc ld le ls lf lg lh lt li lj ll ge iz lu" data-selectable-paragraph=""><span class="s lv lw lx ef ly lz ma mb mc am">W</span>hat do BERT, RoBERTa, ALBERT, SpanBERT, DistilBERT, SesameBERT, SemBERT, SciBERT, BioBERT, MobileBERT, TinyBERT and CamemBERT all have in common? And I’m not looking for the answer “BERT” 🤭.</p><p id="dfee" class="ku kv hs kw b jb lp kx ky je lq kz la lb lr lc ld le ls lf lg lh lt li lj ll ge iz" data-selectable-paragraph="">Answer: <strong class="kw id">self-attention 🤗</strong>. We are not only talking abo<span id="rmm"><span id="rmm"><span id="rmm"><span id="rmm"><span id="rmm"><span id="rmm"><span id="rmm"><span id="rmm"><span id="rmm">u</span></span></span></span></span></span></span></span></span>t architectures bearing the name “BERT’, but more correctly <strong class="kw id">Transformer-based</strong> architectures. <mark class="abd abe eu">Transformer-based architectures, which are primarily used in modelling language understanding tasks, eschew the use of recurrence in neural network and instead trust entirely on </mark><mark class="abd abe eu"><strong class="kw id">self-attention</strong></mark><mark class="abd abe eu"> mechanisms to draw global dependencies between inputs and outputs.</mark> But what’s the math behind this?</p><p id="b9f7" class="ku kv hs kw b jb lp kx ky je lq kz la lb lr lc ld le ls lf lg lh lt li lj ll ge iz" data-selectable-paragraph="">That’s what we’re going to find out today. The main content of this post is to walk you through the mathematical operations involved in a self-attention module. By the end of this article, you should be able to write or code a self-attention module from scratch.</p><p id="d989" class="ku kv hs kw b jb lp kx ky je lq kz la lb lr lc ld le ls lf lg lh lt li lj ll ge iz" data-selectable-paragraph="">This article does not aim to provide the intuitions and explanations behind the different numerical representations and mathematical operations in the self-attention module. It also does not aim to demonstrate the why’s and how-exactly’s of self-attention in Transformers (I believe there’s a lot out there already). Note that the difference between attention and self-attention is also not detailed in this article.</p><h2 id="e39c" class="md me hs az mf mg mh jd mi mj mk jg ml jh mm jj mn jk mo jm mp jn mq jp mr hz iz" data-selectable-paragraph="">Content</h2><ol class=""><li id="6345" class="ku kv hs kw b jb ms kx ky je mt kz la lb mu lc ld le mv lf lg lh mw li lj ll mx my mz iz" data-selectable-paragraph=""><a href="https://towardsdatascience.com/illustrated-self-attention-2d627e33b20a#570c" class="eh ln" rel="noopener">Illustrations</a></li><li id="88a3" class="ku kv hs kw b jb na kx ky je nb kz la lb nc lc ld le nd lf lg lh ne li lj ll mx my mz iz" data-selectable-paragraph=""><a href="https://towardsdatascience.com/illustrated-self-attention-2d627e33b20a#8481" class="eh ln" rel="noopener">Code</a></li><li id="df33" class="ku kv hs kw b jb na kx ky je nb kz la lb nc lc ld le nd lf lg lh ne li lj ll mx my mz iz" data-selectable-paragraph=""><a href="https://towardsdatascience.com/illustrated-self-attention-2d627e33b20a#faae" class="eh ln" rel="noopener">Extending to Transformers</a></li></ol><p id="66c1" class="ku kv hs kw b jb lp kx ky je lq kz la lb lr lc ld le ls lf lg lh lt li lj ll ge iz" data-selectable-paragraph="">Now let’s get on to it!</p></div></div></section><div class="n p cv nf ng nh" role="separator"><span class="ni kc bu nj nk nl"></span><span class="ni kc bu nj nk nl"></span><span class="ni kc bu nj nk"></span></div><section class="ge gf gg dq gh"><div class="n p"><div class="ao ap aq ar as hp au v"><h2 id="570c" class="md me hs az mf mg mh jd mi mj mk jg ml jh mm jj mn jk mo jm mp jn mq jp mr hz iz" data-selectable-paragraph="">0. What is self-attention?</h2><p id="59b8" class="ku kv hs kw b jb ms kx ky je mt kz la lb mu lc ld le mv lf lg lh mw li lj ll ge iz" data-selectable-paragraph="">If you’re thinking if self-attention is similar to <strong class="kw id">attention</strong>, then the answer is yes! They fundamentally share the same concept and many common mathematical operations.</p><p id="66af" class="ku kv hs kw b jb lp kx ky je lq kz la lb lr lc ld le ls lf lg lh lt li lj ll ge iz" data-selectable-paragraph="">A self-attention module takes in <em class="lm">n</em> inputs, and returns <em class="lm">n </em>outputs. What happens in this module? In layman’s terms, the self-attention mechanism allows the inputs to interact with each other (“self”) and find out who they should pay more attention to (“attention”). The outputs are aggregates of these interactions and attention scores.</p><h2 id="3140" class="md me hs az mf mg mh jd mi mj mk jg ml jh mm jj mn jk mo jm mp jn mq jp mr hz iz" data-selectable-paragraph="">1. Illustrations</h2><p id="46c5" class="ku kv hs kw b jb ms kx ky je mt kz la lb mu lc ld le mv lf lg lh mw li lj ll ge iz" data-selectable-paragraph="">The illustrations are divided into the following steps:</p><ol class=""><li id="aacd" class="ku kv hs kw b jb lp kx ky je lq kz la lb lr lc ld le ls lf lg lh lt li lj ll mx my mz iz" data-selectable-paragraph="">Prepare inputs</li><li id="aaf2" class="ku kv hs kw b jb na kx ky je nb kz la lb nc lc ld le nd lf lg lh ne li lj ll mx my mz iz" data-selectable-paragraph="">Initialise weights</li><li id="c673" class="ku kv hs kw b jb na kx ky je nb kz la lb nc lc ld le nd lf lg lh ne li lj ll mx my mz iz" data-selectable-paragraph="">Derive <strong class="kw id">key</strong>, <strong class="kw id">query</strong> and <strong class="kw id">value</strong></li><li id="2f82" class="ku kv hs kw b jb na kx ky je nb kz la lb nc lc ld le nd lf lg lh ne li lj ll mx my mz iz" data-selectable-paragraph="">Calculate attention scores for Input 1</li><li id="5319" class="ku kv hs kw b jb na kx ky je nb kz la lb nc lc ld le nd lf lg lh ne li lj ll mx my mz iz" data-selectable-paragraph="">Calculate softmax</li><li id="342e" class="ku kv hs kw b jb na kx ky je nb kz la lb nc lc ld le nd lf lg lh ne li lj ll mx my mz iz" data-selectable-paragraph="">Multiply scores with <strong class="kw id">values</strong></li><li id="b758" class="ku kv hs kw b jb na kx ky je nb kz la lb nc lc ld le nd lf lg lh ne li lj ll mx my mz iz" data-selectable-paragraph="">Sum <strong class="kw id">weighted</strong> <strong class="kw id">values</strong> to get Output 1</li><li id="1654" class="ku kv hs kw b jb na kx ky je nb kz la lb nc lc ld le nd lf lg lh ne li lj ll mx my mz iz" data-selectable-paragraph="">Repeat steps 4–7 for Input 2 &amp; Input 3</li></ol><blockquote class="nm nn no"><p id="400c" class="ku kv lm kw b jb lp kx ky je lq kz la lb lr lc ld le ls lf lg lh lt li lj ll ge iz" data-selectable-paragraph=""><strong class="kw id"><em class="hs">Note</em></strong><em class="hs"><br>In practice, the mathematical operations are vectorised, i.e. all the inputs undergo the mathematical operations together. We’ll see this later in the Code section.</em></p></blockquote><p id="a0b2" class="ku kv hs kw b jb lp kx ky je lq kz la lb lr lc ld le ls lf lg lh lt li lj ll ge iz" data-selectable-paragraph=""><strong class="kw id">Step 1: Prepare inputs</strong></p><figure class="np nq nr ns nt gi fs ft paragraph-image"><div role="button" tabindex="0" class="gz ha am hb v hc"><div class="fs ft gr"><div class="hi s am hj"><div class="hk hl s"><div class="fa hd ep fd ez he v hf hg hh"><img alt="" class="ep fd ez he v hm hn fe aem" src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/1_hmvdDXrxhJsGhOQClQdkBA.png" width="1578" height="949" role="presentation"></div><img alt="" class="yq abb ep fd ez he v c" width="1578" height="949" role="presentation" src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/1_hmvdDXrxhJsGhOQClQdkBA(1).png" srcset="https://miro.medium.com/max/276/1*hmvdDXrxhJsGhOQClQdkBA.png 276w, https://miro.medium.com/max/552/1*hmvdDXrxhJsGhOQClQdkBA.png 552w, https://miro.medium.com/max/640/1*hmvdDXrxhJsGhOQClQdkBA.png 640w, https://miro.medium.com/max/700/1*hmvdDXrxhJsGhOQClQdkBA.png 700w" sizes="700px"><noscript><img alt="" class="ep fd ez he v" src="https://miro.medium.com/max/3156/1*hmvdDXrxhJsGhOQClQdkBA.png" width="1578" height="949" srcSet="https://miro.medium.com/max/552/1*hmvdDXrxhJsGhOQClQdkBA.png 276w, https://miro.medium.com/max/1104/1*hmvdDXrxhJsGhOQClQdkBA.png 552w, https://miro.medium.com/max/1280/1*hmvdDXrxhJsGhOQClQdkBA.png 640w, https://miro.medium.com/max/1400/1*hmvdDXrxhJsGhOQClQdkBA.png 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div><figcaption class="nu nv fu fs ft nw nx az b ba bb dt" data-selectable-paragraph="">Fig. 1.1: Prepare inputs</figcaption></figure><p id="3e28" class="ku kv hs kw b jb lp kx ky je lq kz la lb lr lc ld le ls lf lg lh lt li lj ll ge iz" data-selectable-paragraph="">For this tutorial, we start with 3 inputs, each with dimension 4.</p><pre class="np nq nr ns nt ny nz oa"><span id="d284" class="iz md me hs ob b dj oc od s oe" data-selectable-paragraph="">Input 1: [1, 0, 1, 0] <br>Input 2: [0, 2, 0, 2]<br>Input 3: [1, 1, 1, 1]</span></pre><p id="d825" class="ku kv hs kw b jb lp kx ky je lq kz la lb lr lc ld le ls lf lg lh lt li lj ll ge iz" data-selectable-paragraph=""><strong class="kw id">Step 2: Initialise weights</strong></p><p id="f1bf" class="ku kv hs kw b jb lp kx ky je lq kz la lb lr lc ld le ls lf lg lh lt li lj ll ge iz" data-selectable-paragraph="">Every input must have three representations (see diagram below). These representations are called <strong class="kw id">key </strong>(orange), <strong class="kw id">query </strong>(red), and <strong class="kw id">value </strong>(purple). For this example, let’s take that we want these representations to have a dimension of 3. Because every input has a dimension of 4, this means each set of the weights must have a shape of 4×3.</p><blockquote class="nm nn no"><p id="8594" class="ku kv lm kw b jb lp kx ky je lq kz la lb lr lc ld le ls lf lg lh lt li lj ll ge iz" data-selectable-paragraph=""><strong class="kw id"><em class="hs">Note</em></strong><em class="hs"><br>We’ll see later that the dimension of </em><strong class="kw id"><em class="hs">value</em></strong><em class="hs"> is also the dimension of the output.</em></p></blockquote><figure class="np nq nr ns nt gi fs ft paragraph-image"><div role="button" tabindex="0" class="gz ha am hb v hc"><div class="fs ft of"><div class="hi s am hj"><div class="og hl s"><div class="fa hd ep fd ez he v hf hg hh"><img alt="" class="ep fd ez he v hm hn fe aem" src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/1_VPvXYMGjv0kRuoYqgFvCag.gif" width="1580" height="1036" role="presentation"></div><img alt="" class="yq abb ep fd ez he v c" width="1580" height="1036" role="presentation" src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/1_VPvXYMGjv0kRuoYqgFvCag(1).gif" srcset="https://miro.medium.com/max/276/1*VPvXYMGjv0kRuoYqgFvCag.gif 276w, https://miro.medium.com/max/552/1*VPvXYMGjv0kRuoYqgFvCag.gif 552w, https://miro.medium.com/max/640/1*VPvXYMGjv0kRuoYqgFvCag.gif 640w, https://miro.medium.com/max/700/1*VPvXYMGjv0kRuoYqgFvCag.gif 700w" sizes="700px"><noscript><img alt="" class="ep fd ez he v" src="https://miro.medium.com/max/3160/1*VPvXYMGjv0kRuoYqgFvCag.gif" width="1580" height="1036" srcSet="https://miro.medium.com/max/552/1*VPvXYMGjv0kRuoYqgFvCag.gif 276w, https://miro.medium.com/max/1104/1*VPvXYMGjv0kRuoYqgFvCag.gif 552w, https://miro.medium.com/max/1280/1*VPvXYMGjv0kRuoYqgFvCag.gif 640w, https://miro.medium.com/max/1400/1*VPvXYMGjv0kRuoYqgFvCag.gif 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div><figcaption class="nu nv fu fs ft nw nx az b ba bb dt" data-selectable-paragraph="">Fig. 1.2: Deriving <strong class="az mf">key</strong>, <strong class="az mf">query</strong> and <strong class="az mf">value</strong> representations from each input</figcaption></figure><p id="654a" class="ku kv hs kw b jb lp kx ky je lq kz la lb lr lc ld le ls lf lg lh lt li lj ll ge iz" data-selectable-paragraph="">In order to obtain these representations, every input (green) is multiplied with a set of weights for <strong class="kw id">keys</strong>, a set of weights for <strong class="kw id">querys </strong>(I know that’s not the right spelling), and a set of weights for <strong class="kw id">values</strong>. In our example, we initialise the three sets of weights as follows.</p><p id="ac7b" class="ku kv hs kw b jb lp kx ky je lq kz la lb lr lc ld le ls lf lg lh lt li lj ll ge iz" data-selectable-paragraph="">Weights for <strong class="kw id">key</strong>:</p><pre class="np nq nr ns nt ny nz oa"><span id="44d6" class="iz md me hs ob b dj oc od s oe" data-selectable-paragraph="">[[0, 0, 1],<br> [1, 1, 0],<br> [0, 1, 0],<br> [1, 1, 0]]</span></pre><p id="835f" class="ku kv hs kw b jb lp kx ky je lq kz la lb lr lc ld le ls lf lg lh lt li lj ll ge iz" data-selectable-paragraph="">Weights for <strong class="kw id">query</strong>:</p><pre class="np nq nr ns nt ny nz oa"><span id="99d2" class="iz md me hs ob b dj oc od s oe" data-selectable-paragraph="">[[1, 0, 1],<br> [1, 0, 0],<br> [0, 0, 1],<br> [0, 1, 1]]</span></pre><p id="c5b8" class="ku kv hs kw b jb lp kx ky je lq kz la lb lr lc ld le ls lf lg lh lt li lj ll ge iz" data-selectable-paragraph="">Weights for <strong class="kw id">value</strong>:</p><pre class="np nq nr ns nt ny nz oa"><span id="3c52" class="iz md me hs ob b dj oc od s oe" data-selectable-paragraph="">[[0, 2, 0],<br> [0, 3, 0],<br> [1, 0, 3],<br> [1, 1, 0]]</span></pre><blockquote class="nm nn no"><p id="f0c4" class="ku kv lm kw b jb lp kx ky je lq kz la lb lr lc ld le ls lf lg lh lt li lj ll ge iz" data-selectable-paragraph=""><strong class="kw id"><em class="hs">Notes<br></em></strong><em class="hs">In a neural network setting, these weights are usually small numbers, initialised randomly using an appropriate random distribution like Gaussian, Xavier and Kaiming distributions. This initialisation is done once before training.</em></p></blockquote><p id="ee49" class="ku kv hs kw b jb lp kx ky je lq kz la lb lr lc ld le ls lf lg lh lt li lj ll ge iz" data-selectable-paragraph=""><strong class="kw id">Step 3: Derive key, query and value</strong></p><p id="38f2" class="ku kv hs kw b jb lp kx ky je lq kz la lb lr lc ld le ls lf lg lh lt li lj ll ge iz" data-selectable-paragraph="">Now that we have the three sets of weights, let’s actually obtain the <strong class="kw id">key</strong>, <strong class="kw id">query</strong> and <strong class="kw id">value </strong>representations for every input.</p><p id="3eb7" class="ku kv hs kw b jb lp kx ky je lq kz la lb lr lc ld le ls lf lg lh lt li lj ll ge iz" data-selectable-paragraph=""><strong class="kw id">Key</strong> representation for Input 1:</p><pre class="np nq nr ns nt ny nz oa"><span id="0368" class="iz md me hs ob b dj oc od s oe" data-selectable-paragraph="">               [0, 0, 1]<br>[1, 0, 1, 0] x [1, 1, 0] = [0, 1, 1]<br>               [0, 1, 0]<br>               [1, 1, 0]</span></pre><p id="4444" class="ku kv hs kw b jb lp kx ky je lq kz la lb lr lc ld le ls lf lg lh lt li lj ll ge iz" data-selectable-paragraph="">Use the same set of weights to get the <strong class="kw id">key</strong> representation for Input 2:</p><pre class="np nq nr ns nt ny nz oa"><span id="3c3b" class="iz md me hs ob b dj oc od s oe" data-selectable-paragraph="">               [0, 0, 1]<br>[0, 2, 0, 2] x [1, 1, 0] = [4, 4, 0]<br>               [0, 1, 0]<br>               [1, 1, 0]</span></pre><p id="036b" class="ku kv hs kw b jb lp kx ky je lq kz la lb lr lc ld le ls lf lg lh lt li lj ll ge iz" data-selectable-paragraph="">Use the same set of weights to get the <strong class="kw id">key</strong> representation for Input 3:</p><pre class="np nq nr ns nt ny nz oa"><span id="e9b1" class="iz md me hs ob b dj oc od s oe" data-selectable-paragraph="">               [0, 0, 1]<br>[1, 1, 1, 1] x [1, 1, 0] = [2, 3, 1]<br>               [0, 1, 0]<br>               [1, 1, 0]</span></pre><p id="bd7e" class="ku kv hs kw b jb lp kx ky je lq kz la lb lr lc ld le ls lf lg lh lt li lj ll ge iz" data-selectable-paragraph="">A faster way is to vectorise the above operations:</p><pre class="np nq nr ns nt ny nz oa"><span id="9359" class="iz md me hs ob b dj oc od s oe" data-selectable-paragraph="">               [0, 0, 1]<br>[1, 0, 1, 0]   [1, 1, 0]   [0, 1, 1]<br>[0, 2, 0, 2] x [0, 1, 0] = [4, 4, 0]<br>[1, 1, 1, 1]   [1, 1, 0]   [2, 3, 1]</span></pre><figure class="np nq nr ns nt gi fs ft paragraph-image"><div role="button" tabindex="0" class="gz ha am hb v hc"><div class="fs ft of"><div class="hi s am hj"><div class="og hl s"><div class="fa hd ep fd ez he v hf hg hh"><img alt="" class="ep fd ez he v hm hn fe aem" src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/1_dr6NIaTfTxEWzxB2rc0JWg.gif" width="1580" height="1036" role="presentation"></div><img alt="" class="yq abb ep fd ez he v c" width="1580" height="1036" role="presentation" src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/1_dr6NIaTfTxEWzxB2rc0JWg(1).gif" srcset="https://miro.medium.com/max/276/1*dr6NIaTfTxEWzxB2rc0JWg.gif 276w, https://miro.medium.com/max/552/1*dr6NIaTfTxEWzxB2rc0JWg.gif 552w, https://miro.medium.com/max/640/1*dr6NIaTfTxEWzxB2rc0JWg.gif 640w, https://miro.medium.com/max/700/1*dr6NIaTfTxEWzxB2rc0JWg.gif 700w" sizes="700px"><noscript><img alt="" class="ep fd ez he v" src="https://miro.medium.com/max/3160/1*dr6NIaTfTxEWzxB2rc0JWg.gif" width="1580" height="1036" srcSet="https://miro.medium.com/max/552/1*dr6NIaTfTxEWzxB2rc0JWg.gif 276w, https://miro.medium.com/max/1104/1*dr6NIaTfTxEWzxB2rc0JWg.gif 552w, https://miro.medium.com/max/1280/1*dr6NIaTfTxEWzxB2rc0JWg.gif 640w, https://miro.medium.com/max/1400/1*dr6NIaTfTxEWzxB2rc0JWg.gif 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div><figcaption class="nu nv fu fs ft nw nx az b ba bb dt" data-selectable-paragraph="">Fig. 1.3a: Derive <strong class="az mf">key</strong> representations from each input</figcaption></figure><p id="e69c" class="ku kv hs kw b jb lp kx ky je lq kz la lb lr lc ld le ls lf lg lh lt li lj ll ge iz" data-selectable-paragraph="">Let’s do the same to obtain the <strong class="kw id">value </strong>representations for every input:</p><pre class="np nq nr ns nt ny nz oa"><span id="ab13" class="iz md me hs ob b dj oc od s oe" data-selectable-paragraph="">               [0, 2, 0]<br>[1, 0, 1, 0]   [0, 3, 0]   [1, 2, 3] <br>[0, 2, 0, 2] x [1, 0, 3] = [2, 8, 0]<br>[1, 1, 1, 1]   [1, 1, 0]   [2, 6, 3]</span></pre><figure class="np nq nr ns nt gi fs ft paragraph-image"><div role="button" tabindex="0" class="gz ha am hb v hc"><div class="fs ft of"><div class="hi s am hj"><div class="og hl s"><div class="fa hd ep fd ez he v hf hg hh"><img alt="" class="ep fd ez he v hm hn fe aem" src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/1_5kqW7yEwvcC0tjDOW3Ia-A.gif" width="1580" height="1036" role="presentation"></div><img alt="" class="yq abb ep fd ez he v c" width="1580" height="1036" role="presentation" src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/1_5kqW7yEwvcC0tjDOW3Ia-A(1).gif" srcset="https://miro.medium.com/max/276/1*5kqW7yEwvcC0tjDOW3Ia-A.gif 276w, https://miro.medium.com/max/552/1*5kqW7yEwvcC0tjDOW3Ia-A.gif 552w, https://miro.medium.com/max/640/1*5kqW7yEwvcC0tjDOW3Ia-A.gif 640w, https://miro.medium.com/max/700/1*5kqW7yEwvcC0tjDOW3Ia-A.gif 700w" sizes="700px"><noscript><img alt="" class="ep fd ez he v" src="https://miro.medium.com/max/3160/1*5kqW7yEwvcC0tjDOW3Ia-A.gif" width="1580" height="1036" srcSet="https://miro.medium.com/max/552/1*5kqW7yEwvcC0tjDOW3Ia-A.gif 276w, https://miro.medium.com/max/1104/1*5kqW7yEwvcC0tjDOW3Ia-A.gif 552w, https://miro.medium.com/max/1280/1*5kqW7yEwvcC0tjDOW3Ia-A.gif 640w, https://miro.medium.com/max/1400/1*5kqW7yEwvcC0tjDOW3Ia-A.gif 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div><figcaption class="nu nv fu fs ft nw nx az b ba bb dt" data-selectable-paragraph="">Fig. 1.3b: Derive <strong class="az mf">value</strong> representations from each input</figcaption></figure><p id="b167" class="ku kv hs kw b jb lp kx ky je lq kz la lb lr lc ld le ls lf lg lh lt li lj ll ge iz" data-selectable-paragraph="">and finally the <strong class="kw id">query</strong> representations:</p><pre class="np nq nr ns nt ny nz oa"><span id="531f" class="iz md me hs ob b dj oc od s oe" data-selectable-paragraph="">               [1, 0, 1]<br>[1, 0, 1, 0]   [1, 0, 0]   [1, 0, 2]<br>[0, 2, 0, 2] x [0, 0, 1] = [2, 2, 2]<br>[1, 1, 1, 1]   [0, 1, 1]   [2, 1, 3]</span></pre><figure class="np nq nr ns nt gi fs ft paragraph-image"><div role="button" tabindex="0" class="gz ha am hb v hc"><div class="fs ft of"><div class="hi s am hj"><div class="og hl s"><div class="fa hd ep fd ez he v hf hg hh"><img alt="" class="ep fd ez he v hm hn fe aem" src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/1_wO_UqfkWkv3WmGQVHvrMJw.gif" width="1580" height="1036" role="presentation"></div><img alt="" class="yq abb ep fd ez he v c" width="1580" height="1036" role="presentation" src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/1_wO_UqfkWkv3WmGQVHvrMJw(1).gif" srcset="https://miro.medium.com/max/276/1*wO_UqfkWkv3WmGQVHvrMJw.gif 276w, https://miro.medium.com/max/552/1*wO_UqfkWkv3WmGQVHvrMJw.gif 552w, https://miro.medium.com/max/640/1*wO_UqfkWkv3WmGQVHvrMJw.gif 640w, https://miro.medium.com/max/700/1*wO_UqfkWkv3WmGQVHvrMJw.gif 700w" sizes="700px"><noscript><img alt="" class="ep fd ez he v" src="https://miro.medium.com/max/3160/1*wO_UqfkWkv3WmGQVHvrMJw.gif" width="1580" height="1036" srcSet="https://miro.medium.com/max/552/1*wO_UqfkWkv3WmGQVHvrMJw.gif 276w, https://miro.medium.com/max/1104/1*wO_UqfkWkv3WmGQVHvrMJw.gif 552w, https://miro.medium.com/max/1280/1*wO_UqfkWkv3WmGQVHvrMJw.gif 640w, https://miro.medium.com/max/1400/1*wO_UqfkWkv3WmGQVHvrMJw.gif 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div><figcaption class="nu nv fu fs ft nw nx az b ba bb dt" data-selectable-paragraph="">Fig. 1.3c: Derive <strong class="az mf">query</strong> representations from each input</figcaption></figure><blockquote class="nm nn no"><p id="9180" class="ku kv lm kw b jb lp kx ky je lq kz la lb lr lc ld le ls lf lg lh lt li lj ll ge iz" data-selectable-paragraph=""><strong class="kw id"><em class="hs">Notes</em></strong><em class="hs"><br>In practice, a </em>bias vector<em class="hs"> may be added to the product of matrix multiplication.</em></p></blockquote><p id="57fe" class="ku kv hs kw b jb lp kx ky je lq kz la lb lr lc ld le ls lf lg lh lt li lj ll ge iz" data-selectable-paragraph=""><strong class="kw id">Step 4: Calculate attention scores for Input 1</strong></p><figure class="np nq nr ns nt gi fs ft paragraph-image"><div role="button" tabindex="0" class="gz ha am hb v hc"><div class="fs ft gr"><div class="hi s am hj"><div class="hk hl s"><div class="fa hd ep fd ez he v hf hg hh"><img alt="" class="ep fd ez he v hm hn fe aem" src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/1_u27nhUppoWYIGkRDmYFN2A.gif" width="1578" height="949" role="presentation"></div><img alt="" class="yq abb ep fd ez he v c" width="1578" height="949" role="presentation" src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/1_u27nhUppoWYIGkRDmYFN2A(1).gif" srcset="https://miro.medium.com/max/276/1*u27nhUppoWYIGkRDmYFN2A.gif 276w, https://miro.medium.com/max/552/1*u27nhUppoWYIGkRDmYFN2A.gif 552w, https://miro.medium.com/max/640/1*u27nhUppoWYIGkRDmYFN2A.gif 640w, https://miro.medium.com/max/700/1*u27nhUppoWYIGkRDmYFN2A.gif 700w" sizes="700px"><noscript><img alt="" class="ep fd ez he v" src="https://miro.medium.com/max/3156/1*u27nhUppoWYIGkRDmYFN2A.gif" width="1578" height="949" srcSet="https://miro.medium.com/max/552/1*u27nhUppoWYIGkRDmYFN2A.gif 276w, https://miro.medium.com/max/1104/1*u27nhUppoWYIGkRDmYFN2A.gif 552w, https://miro.medium.com/max/1280/1*u27nhUppoWYIGkRDmYFN2A.gif 640w, https://miro.medium.com/max/1400/1*u27nhUppoWYIGkRDmYFN2A.gif 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div><figcaption class="nu nv fu fs ft nw nx az b ba bb dt" data-selectable-paragraph="">Fig. 1.4: Calculating attention scores (blue) from query 1</figcaption></figure><p id="2ede" class="ku kv hs kw b jb lp kx ky je lq kz la lb lr lc ld le ls lf lg lh lt li lj ll ge iz" data-selectable-paragraph="">To obtain <em class="lm">attention scores</em>, we start off with taking a dot product between Input 1’s <strong class="kw id">query </strong>(red) with all <strong class="kw id">keys </strong>(orange), including itself. Since there are 3 <strong class="kw id">key </strong>representations (because we have 3 inputs), we obtain 3 attention scores (blue).</p><pre class="np nq nr ns nt ny nz oa"><span id="1468" class="iz md me hs ob b dj oc od s oe" data-selectable-paragraph="">            [0, 4, 2]<br>[1, 0, 2] x [1, 4, 3] = [2, 4, 4]<br>            [1, 0, 1]</span></pre><p id="e48a" class="ku kv hs kw b jb lp kx ky je lq kz la lb lr lc ld le ls lf lg lh lt li lj ll ge iz" data-selectable-paragraph="">Notice that we only use the <strong class="kw id">query</strong> from Input 1. Later we’ll work on repeating this same step for the other <strong class="kw id">querys</strong>.</p><blockquote class="nm nn no"><p id="444a" class="ku kv lm kw b jb lp kx ky je lq kz la lb lr lc ld le ls lf lg lh lt li lj ll ge iz" data-selectable-paragraph=""><strong class="kw id"><em class="hs">Note</em></strong><em class="hs"><br>The above operation is known as </em>dot product attention<em class="hs">, one of the several </em><a class="eh ln" rel="noopener" href="https://towardsdatascience.com/attn-illustrated-attention-5ec4ad276ee3#ba24"><strong class="kw id"><em class="hs">score functions</em></strong></a>. <em class="hs">Other score functions include </em>scaled dot product <em class="hs">and </em>additive/concat.</p></blockquote><p id="7439" class="ku kv hs kw b jb lp kx ky je lq kz la lb lr lc ld le ls lf lg lh lt li lj ll ge iz" data-selectable-paragraph=""><strong class="kw id">Step 5: Calculate softmax</strong></p><figure class="np nq nr ns nt gi fs ft paragraph-image"><div role="button" tabindex="0" class="gz ha am hb v hc"><div class="fs ft gr"><div class="hi s am hj"><div class="hk hl s"><div class="fa hd ep fd ez he v hf hg hh"><img alt="" class="ep fd ez he v hm hn fe aem" src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/1_jf__2D8RNCzefwS0TP1Kyg.gif" width="1578" height="949" role="presentation"></div><img alt="" class="yq abb ep fd ez he v c" width="1578" height="949" role="presentation" src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/1_jf__2D8RNCzefwS0TP1Kyg(1).gif" srcset="https://miro.medium.com/max/276/1*jf__2D8RNCzefwS0TP1Kyg.gif 276w, https://miro.medium.com/max/552/1*jf__2D8RNCzefwS0TP1Kyg.gif 552w, https://miro.medium.com/max/640/1*jf__2D8RNCzefwS0TP1Kyg.gif 640w, https://miro.medium.com/max/700/1*jf__2D8RNCzefwS0TP1Kyg.gif 700w" sizes="700px"><noscript><img alt="" class="ep fd ez he v" src="https://miro.medium.com/max/3156/1*jf__2D8RNCzefwS0TP1Kyg.gif" width="1578" height="949" srcSet="https://miro.medium.com/max/552/1*jf__2D8RNCzefwS0TP1Kyg.gif 276w, https://miro.medium.com/max/1104/1*jf__2D8RNCzefwS0TP1Kyg.gif 552w, https://miro.medium.com/max/1280/1*jf__2D8RNCzefwS0TP1Kyg.gif 640w, https://miro.medium.com/max/1400/1*jf__2D8RNCzefwS0TP1Kyg.gif 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div><figcaption class="nu nv fu fs ft nw nx az b ba bb dt" data-selectable-paragraph="">Fig. 1.5: Softmax the attention scores (blue)</figcaption></figure><p id="0b14" class="ku kv hs kw b jb lp kx ky je lq kz la lb lr lc ld le ls lf lg lh lt li lj ll ge iz" data-selectable-paragraph="">Take the <a href="https://en.wikipedia.org/wiki/Softmax_function" class="eh ln" rel="noopener nofollow">softmax</a> across these attention scores (blue).</p><pre class="np nq nr ns nt ny nz oa"><span id="8f3a" class="iz md me hs ob b dj oc od s oe" data-selectable-paragraph="">softmax([2, 4, 4]) = [0.0, 0.5, 0.5]</span></pre><p id="731f" class="ku kv hs kw b jb lp kx ky je lq kz la lb lr lc ld le ls lf lg lh lt li lj ll ge iz" data-selectable-paragraph="">Note that we round of to 1 decimal place here for readability.</p><p id="8aa6" class="ku kv hs kw b jb lp kx ky je lq kz la lb lr lc ld le ls lf lg lh lt li lj ll ge iz" data-selectable-paragraph=""><strong class="kw id">Step 6: Multiply scores with values</strong></p><figure class="np nq nr ns nt gi fs ft paragraph-image"><div role="button" tabindex="0" class="gz ha am hb v hc"><div class="fs ft gr"><div class="hi s am hj"><div class="hk hl s"><div class="fa hd ep fd ez he v hf hg hh"><img alt="" class="ep fd ez he v hm hn fe aem" src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/1_9cTaJGgXPbiJ4AOCc6QHyA.gif" width="1578" height="949" role="presentation"></div><img alt="" class="yq abb ep fd ez he v c" width="1578" height="949" role="presentation" src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/1_9cTaJGgXPbiJ4AOCc6QHyA(1).gif" srcset="https://miro.medium.com/max/276/1*9cTaJGgXPbiJ4AOCc6QHyA.gif 276w, https://miro.medium.com/max/552/1*9cTaJGgXPbiJ4AOCc6QHyA.gif 552w, https://miro.medium.com/max/640/1*9cTaJGgXPbiJ4AOCc6QHyA.gif 640w, https://miro.medium.com/max/700/1*9cTaJGgXPbiJ4AOCc6QHyA.gif 700w" sizes="700px"><noscript><img alt="" class="ep fd ez he v" src="https://miro.medium.com/max/3156/1*9cTaJGgXPbiJ4AOCc6QHyA.gif" width="1578" height="949" srcSet="https://miro.medium.com/max/552/1*9cTaJGgXPbiJ4AOCc6QHyA.gif 276w, https://miro.medium.com/max/1104/1*9cTaJGgXPbiJ4AOCc6QHyA.gif 552w, https://miro.medium.com/max/1280/1*9cTaJGgXPbiJ4AOCc6QHyA.gif 640w, https://miro.medium.com/max/1400/1*9cTaJGgXPbiJ4AOCc6QHyA.gif 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div><figcaption class="nu nv fu fs ft nw nx az b ba bb dt" data-selectable-paragraph="">Fig. 1.6: Derive <strong class="az mf">weighted</strong> <strong class="az mf">value</strong> representation (yellow) from multiply <strong class="az mf">value </strong>(purple) and score (blue)</figcaption></figure><p id="ca19" class="ku kv hs kw b jb lp kx ky je lq kz la lb lr lc ld le ls lf lg lh lt li lj ll ge iz" data-selectable-paragraph="">The softmaxed attention scores for each input (blue) is multiplied with its corresponding <strong class="kw id">value </strong>(purple). This results in 3 <em class="lm">alignment vectors</em> (yellow). In this tutorial, we’ll refer to them as <strong class="kw id">weighted values</strong>.</p><pre class="np nq nr ns nt ny nz oa"><span id="5ac4" class="iz md me hs ob b dj oc od s oe" data-selectable-paragraph="">1: 0.0 * [1, 2, 3] = [0.0, 0.0, 0.0]<br>2: 0.5 * [2, 8, 0] = [1.0, 4.0, 0.0]<br>3: 0.5 * [2, 6, 3] = [1.0, 3.0, 1.5]</span></pre><p id="9d4e" class="ku kv hs kw b jb lp kx ky je lq kz la lb lr lc ld le ls lf lg lh lt li lj ll ge iz" data-selectable-paragraph=""><strong class="kw id">Step 7: Sum weighted values to get Output 1</strong></p><figure class="np nq nr ns nt gi fs ft paragraph-image"><div role="button" tabindex="0" class="gz ha am hb v hc"><div class="fs ft gr"><div class="hi s am hj"><div class="hk hl s"><div class="fa hd ep fd ez he v hf hg hh"><img alt="" class="ep fd ez he v hm hn fe aem" src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/1_1je5TwhVAwwnIeDFvww3ew.gif" width="1578" height="949" role="presentation"></div><img alt="" class="yq abb ep fd ez he v c" width="1578" height="949" role="presentation" src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/1_1je5TwhVAwwnIeDFvww3ew(1).gif" srcset="https://miro.medium.com/max/276/1*1je5TwhVAwwnIeDFvww3ew.gif 276w, https://miro.medium.com/max/552/1*1je5TwhVAwwnIeDFvww3ew.gif 552w, https://miro.medium.com/max/640/1*1je5TwhVAwwnIeDFvww3ew.gif 640w, https://miro.medium.com/max/700/1*1je5TwhVAwwnIeDFvww3ew.gif 700w" sizes="700px"><noscript><img alt="" class="ep fd ez he v" src="https://miro.medium.com/max/3156/1*1je5TwhVAwwnIeDFvww3ew.gif" width="1578" height="949" srcSet="https://miro.medium.com/max/552/1*1je5TwhVAwwnIeDFvww3ew.gif 276w, https://miro.medium.com/max/1104/1*1je5TwhVAwwnIeDFvww3ew.gif 552w, https://miro.medium.com/max/1280/1*1je5TwhVAwwnIeDFvww3ew.gif 640w, https://miro.medium.com/max/1400/1*1je5TwhVAwwnIeDFvww3ew.gif 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div><figcaption class="nu nv fu fs ft nw nx az b ba bb dt" data-selectable-paragraph="">Fig. 1.7: Sum all <strong class="az mf">weighted values</strong> (yellow) to get Output 1 (dark green)</figcaption></figure><p id="d1da" class="ku kv hs kw b jb lp kx ky je lq kz la lb lr lc ld le ls lf lg lh lt li lj ll ge iz" data-selectable-paragraph="">Take all the <strong class="kw id">weighted</strong> <strong class="kw id">values </strong>(yellow) and sum them element-wise:</p><pre class="np nq nr ns nt ny nz oa"><span id="8227" class="iz md me hs ob b dj oc od s oe" data-selectable-paragraph="">  [0.0, 0.0, 0.0]<br>+ [1.0, 4.0, 0.0]<br>+ [1.0, 3.0, 1.5]<br>-----------------<br>= [2.0, 7.0, 1.5]</span></pre><p id="5133" class="ku kv hs kw b jb lp kx ky je lq kz la lb lr lc ld le ls lf lg lh lt li lj ll ge iz" data-selectable-paragraph="">The resulting vector [2.0, 7.0, 1.5] (dark green) is Output 1, which is based on the <strong class="kw id">query representation from Input 1</strong> interacting with all other keys, including itself.</p><p id="c14b" class="ku kv hs kw b jb lp kx ky je lq kz la lb lr lc ld le ls lf lg lh lt li lj ll ge iz" data-selectable-paragraph=""><strong class="kw id">Step 8: Repeat for Input 2 &amp; Input 3</strong></p><p id="7a43" class="ku kv hs kw b jb lp kx ky je lq kz la lb lr lc ld le ls lf lg lh lt li lj ll ge iz" data-selectable-paragraph="">Now that we’re done with Output 1, we repeat Steps 4 to 7 for Output 2 and Output 3. I trust that I can leave you to work out the operations yourself 👍🏼.</p><figure class="np nq nr ns nt gi fs ft paragraph-image"><div role="button" tabindex="0" class="gz ha am hb v hc"><div class="fs ft gr"><div class="hi s am hj"><div class="hk hl s"><div class="fa hd ep fd ez he v hf hg hh"><img alt="" class="ep fd ez he v hm hn fe aem" src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/1_G8thyDVqeD8WHim_QzjvFg.gif" width="1578" height="949" role="presentation"></div><img alt="" class="yq abb ep fd ez he v c" width="1578" height="949" role="presentation" src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/1_G8thyDVqeD8WHim_QzjvFg(1).gif" srcset="https://miro.medium.com/max/276/1*G8thyDVqeD8WHim_QzjvFg.gif 276w, https://miro.medium.com/max/552/1*G8thyDVqeD8WHim_QzjvFg.gif 552w, https://miro.medium.com/max/640/1*G8thyDVqeD8WHim_QzjvFg.gif 640w, https://miro.medium.com/max/700/1*G8thyDVqeD8WHim_QzjvFg.gif 700w" sizes="700px"><noscript><img alt="" class="ep fd ez he v" src="https://miro.medium.com/max/3156/1*G8thyDVqeD8WHim_QzjvFg.gif" width="1578" height="949" srcSet="https://miro.medium.com/max/552/1*G8thyDVqeD8WHim_QzjvFg.gif 276w, https://miro.medium.com/max/1104/1*G8thyDVqeD8WHim_QzjvFg.gif 552w, https://miro.medium.com/max/1280/1*G8thyDVqeD8WHim_QzjvFg.gif 640w, https://miro.medium.com/max/1400/1*G8thyDVqeD8WHim_QzjvFg.gif 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div><figcaption class="nu nv fu fs ft nw nx az b ba bb dt" data-selectable-paragraph="">Fig. 1.8: Repeat previous steps for Input 2 &amp; Input 3</figcaption></figure><blockquote class="nm nn no"><p id="f2f3" class="ku kv lm kw b jb lp kx ky je lq kz la lb lr lc ld le ls lf lg lh lt li lj ll ge iz" data-selectable-paragraph=""><strong class="kw id"><em class="hs">Notes<br></em></strong><em class="hs">The dimension of </em><strong class="kw id"><em class="hs">query</em></strong><em class="hs"> and </em><strong class="kw id"><em class="hs">key</em></strong><em class="hs"> must always be the same because of the dot product score function. However, the dimension of </em><strong class="kw id"><em class="hs">value </em></strong><em class="hs">may be different from </em><strong class="kw id"><em class="hs">query</em></strong><em class="hs"> and </em><strong class="kw id"><em class="hs">key</em></strong><em class="hs">. The resulting output will consequently follow the dimension of </em><strong class="kw id"><em class="hs">value</em></strong><em class="hs">.</em></p></blockquote><h2 id="8481" class="md me hs az mf mg mh jd mi mj mk jg ml jh mm jj mn jk mo jm mp jn mq jp mr hz iz" data-selectable-paragraph="">2. Code</h2><p id="f24e" class="ku kv hs kw b jb ms kx ky je mt kz la lb mu lc ld le mv lf lg lh mw li lj ll ge iz" data-selectable-paragraph="">Here is the code in <a href="https://pytorch.org/" class="eh ln" rel="noopener nofollow">PyTorch</a> 🤗, a popular deep learning framework in Python. To enjoy the APIs for <code class="hj oh oi oj ob b">@</code> operator, <code class="hj oh oi oj ob b">.T</code> and <code class="hj oh oi oj ob b"><strong class="kw id">None</strong></code> indexing in the following code snippets, make sure you’re on Python≥3.6 and PyTorch 1.3.1. Just follow along and copy paste these in a Python/IPython REPL or Jupyter Notebook.</p><p id="8ff4" class="ku kv hs kw b jb lp kx ky je lq kz la lb lr lc ld le ls lf lg lh lt li lj ll ge iz" data-selectable-paragraph=""><strong class="kw id">Step 1: Prepare inputs</strong></p><figure class="np nq nr ns nt gi"><div class="hi s am"><div class="aeq hl s"><iframe src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/112c29c58877b90b23fbcb56d07be715.html" allowfullscreen="" frameborder="0" height="215" width="680" title="Prepare inputs" class="ep fd ez he v" scrolling="auto"></iframe></div></div></figure><p id="313d" class="ku kv hs kw b jb lp kx ky je lq kz la lb lr lc ld le ls lf lg lh lt li lj ll ge iz" data-selectable-paragraph=""><strong class="kw id">Step 2: Initialise weights</strong></p><figure class="np nq nr ns nt gi"><div class="hi s am"><div class="aes hl s"><iframe src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/f17a83e9432698502e45e31e578d207e.html" allowfullscreen="" frameborder="0" height="501" width="680" title="Generate key, query and value" class="ep fd ez he v" scrolling="auto"></iframe></div></div></figure><p id="5c4a" class="ku kv hs kw b jb lp kx ky je lq kz la lb lr lc ld le ls lf lg lh lt li lj ll ge iz" data-selectable-paragraph=""><strong class="kw id">Step 3: Derive key, query and value</strong></p><figure class="np nq nr ns nt gi"><div class="hi s am"><div class="aet hl s"><iframe src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/fefd23ecf80aee21b3bf0d6ff7adfe4b.html" allowfullscreen="" frameborder="0" height="435" width="680" title="selfattn_multiply_weights.py" class="ep fd ez he v" scrolling="auto"></iframe></div></div></figure><p id="442b" class="ku kv hs kw b jb lp kx ky je lq kz la lb lr lc ld le ls lf lg lh lt li lj ll ge iz" data-selectable-paragraph=""><strong class="kw id">Step 4: Calculate attention scores</strong></p><figure class="np nq nr ns nt gi"><div class="hi s am"><div class="aeu hl s"><iframe src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/e4853d88a87d1ccde41db69dbbe03be1.html" allowfullscreen="" frameborder="0" height="149" width="680" title="Calculate attention scores" class="ep fd ez he v" scrolling="auto"></iframe></div></div></figure><p id="a04c" class="ku kv hs kw b jb lp kx ky je lq kz la lb lr lc ld le ls lf lg lh lt li lj ll ge iz" data-selectable-paragraph=""><strong class="kw id">Step 5: Calculate softmax</strong></p><figure class="np nq nr ns nt gi"><div class="hi s am"><div class="aev hl s"><iframe src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/b1c6f389118337b9653981419a839880.html" allowfullscreen="" frameborder="0" height="347" width="680" title="Calculate softmax of attention scores" class="ep fd ez he v" scrolling="auto"></iframe></div></div></figure><p id="686c" class="ku kv hs kw b jb lp kx ky je lq kz la lb lr lc ld le ls lf lg lh lt li lj ll ge iz" data-selectable-paragraph=""><strong class="kw id">Step 6: Multiply scores with values</strong></p><figure class="np nq nr ns nt gi"><div class="hi s am"><div class="aew hl s"><iframe src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/93152f4e5ef330f8e02fdd9a235d270d.html" allowfullscreen="" frameborder="0" height="325" width="680" title="Multiply with value" class="ep fd ez he v" scrolling="auto"></iframe></div></div></figure><p id="1110" class="ku kv hs kw b jb lp kx ky je lq kz la lb lr lc ld le ls lf lg lh lt li lj ll ge iz" data-selectable-paragraph=""><strong class="kw id">Step 7: Sum weighted values</strong></p><figure class="np nq nr ns nt gi"><div class="hi s am"><div class="aeu hl s"><iframe src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/8c42fcb1d2c29c1c5bd6a7c8c000cf4b.html" allowfullscreen="" frameborder="0" height="149" width="680" title="Aggregate by adding" class="ep fd ez he v" scrolling="auto"></iframe></div></div></figure><blockquote class="nm nn no"><p id="5256" class="ku kv lm kw b jb lp kx ky je lq kz la lb lr lc ld le ls lf lg lh lt li lj ll ge iz" data-selectable-paragraph=""><strong class="kw id"><em class="hs">Note</em></strong><em class="hs"><br>PyTorch has provided an API for this called </em><code class="hj oh oi oj ob b"><a href="https://pytorch.org/docs/master/nn.html#multiheadattention" class="eh ln" rel="noopener nofollow"><em class="hs">nn.MultiheadAttention</em></a></code><em class="hs">. However, this API requires that you feed in key, query and value PyTorch tensors. Moreover, the outputs of this module undergo a linear transformation.</em></p></blockquote><h2 id="faae" class="md me hs az mf mg mh jd mi mj mk jg ml jh mm jj mn jk mo jm mp jn mq jp mr hz iz" data-selectable-paragraph="">3. Extending to Transformers</h2><p id="9163" class="ku kv hs kw b jb ms kx ky je mt kz la lb mu lc ld le mv lf lg lh mw li lj ll ge iz" data-selectable-paragraph="">So, where do we go from here? Transformers! Indeed we live in exciting times of deep learning research and high compute resources. Transformer is the incarnation from <a href="https://towardsdatascience.com/illustrated-self-attention-2d627e33b20a#9abf" class="eh ln" rel="noopener">Attention Is All You Need</a>, orginally born to perform <a href="https://en.wikipedia.org/wiki/Neural_machine_translation" class="eh ln" rel="noopener nofollow">neural machine translation</a>. Researchers picked up from here, reassembling, cutting, adding and extending the parts, and extend its usage to more language tasks.</p><p id="ab0e" class="ku kv hs kw b jb lp kx ky je lq kz la lb lr lc ld le ls lf lg lh lt li lj ll ge iz" data-selectable-paragraph="">Here I will briefly mention how we can extend self-attention to a Transformer architecture.</p><p id="9183" class="ku kv hs kw b jb lp kx ky je lq kz la lb lr lc ld le ls lf lg lh lt li lj ll ge iz" data-selectable-paragraph="">Within the self-attention module:</p><ul class=""><li id="bfec" class="ku kv hs kw b jb lp kx ky je lq kz la lb lr lc ld le ls lf lg lh lt li lj ll ol my mz iz" data-selectable-paragraph="">Dimension</li><li id="915a" class="ku kv hs kw b jb na kx ky je nb kz la lb nc lc ld le nd lf lg lh ne li lj ll ol my mz iz" data-selectable-paragraph="">Bias</li></ul><p id="5743" class="ku kv hs kw b jb lp kx ky je lq kz la lb lr lc ld le ls lf lg lh lt li lj ll ge iz" data-selectable-paragraph="">Inputs to the self-attention module:</p><ul class=""><li id="d096" class="ku kv hs kw b jb lp kx ky je lq kz la lb lr lc ld le ls lf lg lh lt li lj ll ol my mz iz" data-selectable-paragraph="">Embedding module</li><li id="a754" class="ku kv hs kw b jb na kx ky je nb kz la lb nc lc ld le nd lf lg lh ne li lj ll ol my mz iz" data-selectable-paragraph="">Positional encoding</li><li id="60ce" class="ku kv hs kw b jb na kx ky je nb kz la lb nc lc ld le nd lf lg lh ne li lj ll ol my mz iz" data-selectable-paragraph="">Truncating</li><li id="79ef" class="ku kv hs kw b jb na kx ky je nb kz la lb nc lc ld le nd lf lg lh ne li lj ll ol my mz iz" data-selectable-paragraph="">Masking</li></ul><p id="c16c" class="ku kv hs kw b jb lp kx ky je lq kz la lb lr lc ld le ls lf lg lh lt li lj ll ge iz" data-selectable-paragraph="">Adding more self-attention modules:</p><ul class=""><li id="26ec" class="ku kv hs kw b jb lp kx ky je lq kz la lb lr lc ld le ls lf lg lh lt li lj ll ol my mz iz" data-selectable-paragraph="">Multihead</li><li id="7c37" class="ku kv hs kw b jb na kx ky je nb kz la lb nc lc ld le nd lf lg lh ne li lj ll ol my mz iz" data-selectable-paragraph="">Layer stacking</li></ul><p id="0a2c" class="ku kv hs kw b jb lp kx ky je lq kz la lb lr lc ld le ls lf lg lh lt li lj ll ge iz" data-selectable-paragraph="">Modules between self-attention modules:</p><ul class=""><li id="15c1" class="ku kv hs kw b jb lp kx ky je lq kz la lb lr lc ld le ls lf lg lh lt li lj ll ol my mz iz" data-selectable-paragraph="">Linear transformations</li><li id="31a5" class="ku kv hs kw b jb na kx ky je nb kz la lb nc lc ld le nd lf lg lh ne li lj ll ol my mz iz" data-selectable-paragraph="">LayerNorm</li></ul></div></div></section><div class="n p cv nf ng nh" role="separator"><span class="ni kc bu nj nk nl"></span><span class="ni kc bu nj nk nl"></span><span class="ni kc bu nj nk"></span></div><section class="ge gf gg dq gh"><div class="n p"><div class="ao ap aq ar as hp au v"><p id="3ef7" class="ku kv hs kw b jb lp kx ky je lq kz la lb lr lc ld le ls lf lg lh lt li lj ll ge iz" data-selectable-paragraph="">That’s all folks! Hope you find the content easy to digest. Is there something that you think I should add or elaborate further in this article? Do drop a comment! Also, do check out an illustration I created for attention below</p><h2 id="9abf" class="md me hs az mf mg mh jd mi mj mk jg ml jh mm jj mn jk mo jm mp jn mq jp mr hz iz" data-selectable-paragraph="">References</h2><p id="214a" class="ku kv hs kw b jb ms kx ky je mt kz la lb mu lc ld le mv lf lg lh mw li lj ll ge iz" data-selectable-paragraph=""><a href="https://arxiv.org/abs/1706.03762" class="eh ln" rel="noopener nofollow">Attention Is All You Need</a> (arxiv.org)</p><p id="0400" class="ku kv hs kw b jb lp kx ky je lq kz la lb lr lc ld le ls lf lg lh lt li lj ll ge iz" data-selectable-paragraph=""><a href="https://jalammar.github.io/illustrated-transformer/" class="eh ln" rel="noopener nofollow">The Illustrated Transformer</a> (jalammar.github.io)</p><h2 id="51ff" class="md me hs az mf mg mh jd mi mj mk jg ml jh mm jj mn jk mo jm mp jn mq jp mr hz iz" data-selectable-paragraph="">Related Articles</h2><p id="e122" class="ku kv hs kw b jb ms kx ky je mt kz la lb mu lc ld le mv lf lg lh mw li lj ll ge iz" data-selectable-paragraph=""><a class="eh ln" rel="noopener" href="https://towardsdatascience.com/attn-illustrated-attention-5ec4ad276ee3">Attn: Illustrated Attention</a> (towardsdatascience.com)</p><h2 id="9223" class="md me hs az mf mg mh jd mi mj mk jg ml jh mm jj mn jk mo jm mp jn mq jp mr hz iz" data-selectable-paragraph="">Credits</h2><p id="2e2a" class="ku kv hs kw b jb ms kx ky je mt kz la lb mu lc ld le mv lf lg lh mw li lj ll ge iz" data-selectable-paragraph="">Special thanks to Xin Jie, Serene, Ren Jie, Kevin and Wei Yih for ideas, suggestions and corrections to this article.</p><p id="4d00" class="ku kv hs kw b jb lp kx ky je lq kz la lb lr lc ld le ls lf lg lh lt li lj ll ge iz" data-selectable-paragraph=""><em class="lm">Follow me on Twitter </em><a href="https://twitter.com/remykarem" class="eh ln" rel="noopener nofollow"><em class="lm">@remykarem</em></a><em class="lm"> for digested articles and other tweets on AI, ML, Deep Learning and Python.</em></p></div></div></section></div></article><div class="yq gd fb os v abc fd oq ou" data-test-id="post-sidebar"><div class="n p"><div class="ao ap aq ar as at au v"><div class="ov n ah"><div class="aeo"><div><div class="ow ox s"><div class="gx s"><a href="https://medium.com/@remykarem?source=post_sidebar--------------------------post_sidebar-----------" class="eh ei by bz ca cb cc cd ce bk ej ek cf el em" rel="noopener"><h2 class="az mf dj bb ic iz ge">Raimi Karim</h2></a></div><div class="oy s"><p class="az b ba bb dt">Assoc Software Engineer at GovTech 🇸🇬, MComp (AI) at NUS.</p></div><div class="oz s"><span><a href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc2958659896a%2F2d627e33b20a&amp;operation=register&amp;redirect=https%3A%2F%2Ftowardsdatascience.com%2Fillustrated-self-attention-2d627e33b20a&amp;source=post_sidebar-c2958659896a-------------------------follow_card-----------" class="az b ba bb dx bd dy dz ea eb ec bk bl bm ed ee bq br bs bt bu bv" rel="noopener">Follow</a></span></div></div><div class="pa pb pc n"><div class="n o"><div class="s am pd pe pf pg ph"><span><a href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F2d627e33b20a&amp;operation=register&amp;redirect=https%3A%2F%2Ftowardsdatascience.com%2Fillustrated-self-attention-2d627e33b20a&amp;source=post_sidebar-----2d627e33b20a---------------------clap_sidebar-----------" class="eh ei by bz ca cb cc cd ce bk ej ek cf el em" rel="noopener"><div class="cd pi pj pk eu pl pm pn r po pp"><svg width="29" height="29" aria-label="clap"><g fill-rule="evenodd"><path d="M13.74 1l.76 2.97.76-2.97zM16.82 4.78l1.84-2.56-1.43-.47zM10.38 2.22l1.84 2.56-.41-3.03zM22.38 22.62a5.11 5.11 0 0 1-3.16 1.61l.49-.45c2.88-2.89 3.45-5.98 1.69-9.21l-1.1-1.94-.96-2.02c-.31-.67-.23-1.18.25-1.55a.84.84 0 0 1 .66-.16c.34.05.66.28.88.6l2.85 5.02c1.18 1.97 1.38 5.12-1.6 8.1M9.1 22.1l-5.02-5.02a1 1 0 0 1 .7-1.7 1 1 0 0 1 .72.3l2.6 2.6a.44.44 0 0 0 .63-.62L6.1 15.04l-1.75-1.75a1 1 0 1 1 1.41-1.41l4.15 4.15a.44.44 0 0 0 .63 0 .44.44 0 0 0 0-.62L6.4 11.26l-1.18-1.18a1 1 0 0 1 0-1.4 1.02 1.02 0 0 1 1.41 0l1.18 1.16L11.96 14a.44.44 0 0 0 .62 0 .44.44 0 0 0 0-.63L8.43 9.22a.99.99 0 0 1-.3-.7.99.99 0 0 1 .3-.7 1 1 0 0 1 1.41 0l7 6.98a.44.44 0 0 0 .7-.5l-1.35-2.85c-.31-.68-.23-1.19.25-1.56a.85.85 0 0 1 .66-.16c.34.06.66.28.88.6L20.63 15c1.57 2.88 1.07 5.54-1.55 8.16a5.62 5.62 0 0 1-5.06 1.65 9.35 9.35 0 0 1-4.93-2.72zM13 6.98l2.56 2.56c-.5.6-.56 1.41-.15 2.28l.26.56-4.25-4.25a.98.98 0 0 1-.12-.45 1 1 0 0 1 .29-.7 1.02 1.02 0 0 1 1.41 0zm8.89 2.06c-.38-.56-.9-.92-1.49-1.01a1.74 1.74 0 0 0-1.34.33c-.38.29-.61.65-.71 1.06a2.1 2.1 0 0 0-1.1-.56 1.78 1.78 0 0 0-.99.13l-2.64-2.64a1.88 1.88 0 0 0-2.65 0 1.86 1.86 0 0 0-.48.85 1.89 1.89 0 0 0-2.67-.01 1.87 1.87 0 0 0-.5.9c-.76-.75-2-.75-2.7-.04a1.88 1.88 0 0 0 0 2.66c-.3.12-.61.29-.87.55a1.88 1.88 0 0 0 0 2.66l.62.62a1.88 1.88 0 0 0-.9 3.16l5.01 5.02c1.6 1.6 3.52 2.64 5.4 2.96a7.16 7.16 0 0 0 1.18.1c1.03 0 2-.25 2.9-.7A5.9 5.9 0 0 0 23 23.24c3.34-3.34 3.08-6.93 1.74-9.17l-2.87-5.04z"></path></g></svg></div></a></span></div><div class="s pq pr ps pt pu pv pw"><div class="px"><p class="az b ba bb dt"><button class="eh ei by bz ca cb cc cd ce bk ej ek cf el em">2.6K </button></p></div></div></div></div><div class="pb s"><button class="eu pj cd"><div class="qa n o aw"><svg width="25" height="25" class="r" aria-label="responses"><path d="M19.07 21.12a6.33 6.33 0 0 1-3.53-1.1 7.8 7.8 0 0 1-.7-.52c-.77.21-1.57.32-2.38.32-4.67 0-8.46-3.5-8.46-7.8C4 7.7 7.79 4.2 12.46 4.2c4.66 0 8.46 3.5 8.46 7.8 0 2.06-.85 3.99-2.4 5.45a6.28 6.28 0 0 0 1.14 2.59c.15.21.17.48.06.7a.69.69 0 0 1-.62.38h-.03zm0-1v.5l.03-.5h-.03zm-3.92-1.64l.21.2a6.09 6.09 0 0 0 3.24 1.54 7.14 7.14 0 0 1-.83-1.84 5.15 5.15 0 0 1-.16-.75 2.4 2.4 0 0 1-.02-.29v-.23l.18-.15a6.6 6.6 0 0 0 2.3-4.96c0-3.82-3.4-6.93-7.6-6.93-4.19 0-7.6 3.11-7.6 6.93 0 3.83 3.41 6.94 7.6 6.94.83 0 1.64-.12 2.41-.35l.28-.08z" fill-rule="evenodd"></path></svg><div class="s am qb qc qd qe qf qg qh qi"><p class="az b ba bb dt">16<!-- --> </p></div></div></button></div><div class="kt"><span><a href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2d627e33b20a&amp;operation=register&amp;redirect=https%3A%2F%2Ftowardsdatascience.com%2Fillustrated-self-attention-2d627e33b20a&amp;source=post_sidebar-----2d627e33b20a---------------------bookmark_sidebar-----------" class="eh ei by bz ca cb cc cd ce bk ej ek cf el em" rel="noopener"><svg width="25" height="25" viewBox="0 0 25 25"><path d="M19 6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14.66h.01c.01.1.05.2.12.28a.5.5 0 0 0 .7.03l5.67-4.12 5.66 4.13a.5.5 0 0 0 .71-.03.5.5 0 0 0 .12-.29H19V6zm-6.84 9.97L7 19.64V6a1 1 0 0 1 1-1h9a1 1 0 0 1 1 1v13.64l-5.16-3.67a.49.49 0 0 0-.68 0z" fill-rule="evenodd"></path></svg></a></span></div></div></div></div></div></div></div><div class="yq aeo om fb on ka oo op oq or"></div><div><div class="qj gi n ah p"><div class="n p"><div class="ao ap aq ar as hp au v"><div class="n cs"></div><div class="n o cs"></div><div class="qk ql qm qn qo qp"><div class="qq s"><h2 class="az mf mg jd mi mj jg ml jh jj mn jk jm mp jn jp mr iz">Sign up for The Variable</h2></div><div class="qr s"><h3 class="az b ht bb iz">By Towards Data Science</h3></div><div class="nh qs s"><p class="az b qt qu qv qw qx qy qz ra rb rc iz">Every Thursday, the Variable delivers the very best of Towards Data Science: from hands-on tutorials and cutting-edge research to original features you don't want to miss.&nbsp;<a href="https://medium.com/towards-data-science/newsletters/the-variable?source=newsletter_v3_promo--------------------------newsletter_v3_promo-----------" class="eh ei by bz ca cb cc cd ce bk cf el em ln" rel="noopener">Take a look.</a></p></div><div class="n cs"><div class="n cp ah rd"><div id="g-recaptcha"></div><div class="re"><div class="rf n o cj rg rh cm cn"><div class="xy s rj"><div class=""><div class="sb rv n o ah rz"><div class="am"><div class="sc s"><p class="az b dj dk dt"><input aria-label="email" class="rk rl rm xz ya rp rq yb yc rt ru rv rw rx ry rz iz sa" pattern=".*" placeholder="Your email" type="text" value=""></p></div></div></div></div></div><div class="sd se s km sf"><div><button class="az b dj dk dx sg dy dz ea eb ec bk bl bm ed ee bq br bs bt bu bv"><span class="ks" aria-hidden="true"><svg width="20" height="16" viewBox="0 0 20 16"><path d="M0 .35v15.3h20V.35H0zm6.95 9.38l3.05 2.5 3.05-2.5 4.88 4.73H2.07l4.88-4.73zM1.2 13.64V5.02l4.82 3.94-4.82 4.68zm12.78-4.68l4.82-3.94v8.62l-4.82-4.68zm4.82-7.42v1.94l-8.8 7.2-8.8-7.2V1.54h17.6z"></path></svg></span>Get this newsletter</button></div></div></div><div class="yd nu s rj"><p class="az b si sj iz">By signing up, you will create a Medium account if you don’t already have one. Review our <a href="https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=newsletter_v3_promo--------------------------newsletter_v3_promo-----------" class="eh ei by bz ca cb cc cd ce bk cf el em ln" target="_blank" rel="noopener">Privacy Policy</a> for more information about our privacy practices.</p></div></div><div class="sk sl aj"><p class="az b ba bb iz"><b>Check your inbox</b><br>Medium sent you an email at  to complete your subscription.</p></div></div></div></div><div class="sm qj s"><div class="sn n cj kq"><div class="n aw"><div class="so s"><span class="s sp sq sr e d"><div class="n o"><div class="s am pd pe pf pg ph"><span><a href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F2d627e33b20a&amp;operation=register&amp;redirect=https%3A%2F%2Ftowardsdatascience.com%2Fillustrated-self-attention-2d627e33b20a&amp;source=post_actions_footer-----2d627e33b20a---------------------clap_footer-----------" class="eh ei by bz ca cb cc cd ce bk ej ek cf el em" rel="noopener"><div class="cd pi pj pk eu pl pm pn r po pp"><svg width="25" height="25" viewBox="0 0 25 25" aria-label="clap"><g fill-rule="evenodd"><path d="M11.74 0l.76 2.97.76-2.97zM14.81 3.78l1.84-2.56-1.42-.47zM8.38 1.22l1.84 2.56L9.8.75zM20.38 21.62a5.11 5.11 0 0 1-3.16 1.61l.49-.45c2.88-2.89 3.45-5.98 1.69-9.21l-1.1-1.94-.96-2.02c-.31-.67-.23-1.18.25-1.55a.84.84 0 0 1 .66-.16c.34.05.66.28.88.6l2.85 5.02c1.18 1.97 1.38 5.12-1.6 8.1M7.1 21.1l-5.02-5.02a1 1 0 0 1 .7-1.7 1 1 0 0 1 .72.3l2.6 2.6a.44.44 0 0 0 .63-.62L4.1 14.04l-1.75-1.75a1 1 0 1 1 1.41-1.41l4.15 4.15a.44.44 0 0 0 .63 0 .44.44 0 0 0 0-.62L4.4 10.26 3.22 9.08a1 1 0 0 1 0-1.4 1.02 1.02 0 0 1 1.41 0l1.18 1.16L9.96 13a.44.44 0 0 0 .62 0 .44.44 0 0 0 0-.63L6.43 8.22a.99.99 0 0 1-.3-.7.99.99 0 0 1 .3-.7 1 1 0 0 1 1.41 0l7 6.98a.44.44 0 0 0 .7-.5l-1.35-2.85c-.31-.68-.23-1.19.25-1.56a.85.85 0 0 1 .66-.16c.34.06.66.28.88.6L18.63 14c1.57 2.88 1.07 5.54-1.55 8.16a5.62 5.62 0 0 1-5.06 1.65 9.35 9.35 0 0 1-4.93-2.72zM11 5.98l2.56 2.56c-.5.6-.56 1.41-.15 2.28l.26.56-4.25-4.25a.98.98 0 0 1-.12-.45 1 1 0 0 1 .29-.7 1.02 1.02 0 0 1 1.41 0zm8.89 2.06c-.38-.56-.9-.92-1.49-1.01a1.74 1.74 0 0 0-1.34.33c-.38.29-.61.65-.71 1.06a2.1 2.1 0 0 0-1.1-.56 1.78 1.78 0 0 0-.99.13l-2.64-2.64a1.88 1.88 0 0 0-2.65 0 1.86 1.86 0 0 0-.48.85 1.89 1.89 0 0 0-2.67-.01 1.87 1.87 0 0 0-.5.9c-.76-.75-2-.75-2.7-.04a1.88 1.88 0 0 0 0 2.66c-.3.12-.61.29-.87.55a1.88 1.88 0 0 0 0 2.66l.62.62a1.88 1.88 0 0 0-.9 3.16l5.01 5.02c1.6 1.6 3.52 2.64 5.4 2.96a7.16 7.16 0 0 0 1.18.1c1.03 0 2-.25 2.9-.7A5.9 5.9 0 0 0 21 22.24c3.34-3.34 3.08-6.93 1.74-9.17l-2.87-5.04z"></path></g></svg></div></a></span></div><div class="s pq pr ps pt pu pv pw"><div class="am ss px"><p class="az b ba bb iz"><button class="eh ei by bz ca cb cc cd ce bk ej ek cf el em">2.6K<span class="s h g f st su">&nbsp;</span></button><span class="s h g f st su"></span></p></div></div></div></span><span class="s h g f st su"><div class="n cp"><div class="s am pd pe"><span><a href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F2d627e33b20a&amp;operation=register&amp;redirect=https%3A%2F%2Ftowardsdatascience.com%2Fillustrated-self-attention-2d627e33b20a&amp;source=post_actions_footer-----2d627e33b20a---------------------clap_footer-----------" class="eh ei by bz ca cb cc cd ce bk ej ek cf el em" rel="noopener"><div class="cd pi pj pk eu pl pm pn r po pp"><svg width="33" height="33" viewBox="0 0 33 33" aria-label="clap"><path d="M28.86 17.34l-3.64-6.4c-.3-.43-.71-.73-1.16-.8a1.12 1.12 0 0 0-.9.21c-.62.5-.73 1.18-.32 2.06l1.22 2.6 1.4 2.45c2.23 4.09 1.51 8-2.15 11.66a9.6 9.6 0 0 1-.8.71 6.53 6.53 0 0 0 4.3-2.1c3.82-3.82 3.57-7.87 2.05-10.39zm-6.25 11.08c3.35-3.35 4-6.78 1.98-10.47L21.2 12c-.3-.43-.71-.72-1.16-.8a1.12 1.12 0 0 0-.9.22c-.62.49-.74 1.18-.32 2.06l1.72 3.63a.5.5 0 0 1-.81.57l-8.91-8.9a1.33 1.33 0 0 0-1.89 1.88l5.3 5.3a.5.5 0 0 1-.71.7l-5.3-5.3-1.49-1.49c-.5-.5-1.38-.5-1.88 0a1.34 1.34 0 0 0 0 1.89l1.49 1.5 5.3 5.28a.5.5 0 0 1-.36.86.5.5 0 0 1-.36-.15l-5.29-5.29a1.34 1.34 0 0 0-1.88 0 1.34 1.34 0 0 0 0 1.89l2.23 2.23L9.3 21.4a.5.5 0 0 1-.36.85.5.5 0 0 1-.35-.14l-3.32-3.33a1.33 1.33 0 0 0-1.89 0 1.32 1.32 0 0 0-.39.95c0 .35.14.69.4.94l6.39 6.4c3.53 3.53 8.86 5.3 12.82 1.35zM12.73 9.26l5.68 5.68-.49-1.04c-.52-1.1-.43-2.13.22-2.89l-3.3-3.3a1.34 1.34 0 0 0-1.88 0 1.33 1.33 0 0 0-.4.94c0 .22.07.42.17.61zm14.79 19.18a7.46 7.46 0 0 1-6.41 2.31 7.92 7.92 0 0 1-3.67.9c-3.05 0-6.12-1.63-8.36-3.88l-6.4-6.4A2.31 2.31 0 0 1 2 19.72a2.33 2.33 0 0 1 1.92-2.3l-.87-.87a2.34 2.34 0 0 1 0-3.3 2.33 2.33 0 0 1 1.24-.64l-.14-.14a2.34 2.34 0 0 1 0-3.3 2.39 2.39 0 0 1 3.3 0l.14.14a2.33 2.33 0 0 1 3.95-1.24l.09.09c.09-.42.29-.83.62-1.16a2.34 2.34 0 0 1 3.3 0l3.38 3.39a2.17 2.17 0 0 1 1.27-.17c.54.08 1.03.35 1.45.76.1-.55.41-1.03.9-1.42a2.12 2.12 0 0 1 1.67-.4 2.8 2.8 0 0 1 1.85 1.25l3.65 6.43c1.7 2.83 2.03 7.37-2.2 11.6zM13.22.48l-1.92.89 2.37 2.83-.45-3.72zm8.48.88L19.78.5l-.44 3.7 2.36-2.84zM16.5 3.3L15.48 0h2.04L16.5 3.3z" fill-rule="evenodd"></path></svg></div></a></span></div><div class="s pq pr ps pt sv sw sx sy sz ta"><div class="am ss px"><p class="az b ba bb iz"><button class="eh ei by bz ca cb cc cd ce bk ej ek cf el em">2.6K<span class="s h g f st su">&nbsp;</span></button><span class="s h g f st su"></span></p></div></div></div></span></div><div class="s tb tc td te tf"></div><button class="eu pj cd"><div class="qa n o aw"><div><div class="bu" role="tooltip" aria-hidden="false" aria-describedby="2" aria-labelledby="2"><span class="tg s h g f st su"><svg width="33" height="33" viewBox="0 0 33 33" fill="none" class="r" aria-label="responses"><path fill-rule="evenodd" clip-rule="evenodd" d="M24.28 25.5l.32-.29c2.11-1.94 3.4-4.61 3.4-7.56C28 11.83 22.92 7 16.5 7S5 11.83 5 17.65s5.08 10.66 11.5 10.66c1.22 0 2.4-.18 3.5-.5l.5-.15.41.33a8.86 8.86 0 0 0 4.68 2.1 7.34 7.34 0 0 1-1.3-4.15v-.43zm1 .45c0 1.5.46 2.62 1.69 4.44.22.32.01.75-.38.75a9.69 9.69 0 0 1-6.31-2.37c-1.2.35-2.46.54-3.78.54C9.6 29.3 4 24.09 4 17.65 4 11.22 9.6 6 16.5 6S29 11.22 29 17.65c0 3.25-1.42 6.18-3.72 8.3z"></path></svg></span><span class="th s sp sq sr e d"><svg width="25" height="25" class="r" aria-label="responses"><path d="M19.07 21.12a6.33 6.33 0 0 1-3.53-1.1 7.8 7.8 0 0 1-.7-.52c-.77.21-1.57.32-2.38.32-4.67 0-8.46-3.5-8.46-7.8C4 7.7 7.79 4.2 12.46 4.2c4.66 0 8.46 3.5 8.46 7.8 0 2.06-.85 3.99-2.4 5.45a6.28 6.28 0 0 0 1.14 2.59c.15.21.17.48.06.7a.69.69 0 0 1-.62.38h-.03zm0-1v.5l.03-.5h-.03zm-3.92-1.64l.21.2a6.09 6.09 0 0 0 3.24 1.54 7.14 7.14 0 0 1-.83-1.84 5.15 5.15 0 0 1-.16-.75 2.4 2.4 0 0 1-.02-.29v-.23l.18-.15a6.6 6.6 0 0 0 2.3-4.96c0-3.82-3.4-6.93-7.6-6.93-4.19 0-7.6 3.11-7.6 6.93 0 3.83 3.41 6.94 7.6 6.94.83 0 1.64-.12 2.41-.35l.28-.08z" fill-rule="evenodd"></path></svg></span></div></div><div class="s am ti qc tj qe tk qg tl tm tn to"><p class="az b ba bb iz">16<!-- --> </p></div></div></button></div><div class="n o"><div class="kr s"><div class="bu" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bu" role="tooltip" aria-hidden="false" aria-describedby="3" aria-labelledby="3"><button class="eh ei by bz ca cb cc cd ce bk ej ek cf el em" aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post"><svg width="25" height="25" class="r"><g fill-rule="evenodd"><path d="M15.6 5a.42.42 0 0 0 .17-.3.42.42 0 0 0-.12-.33l-2.8-2.79a.5.5 0 0 0-.7 0l-2.8 2.8a.4.4 0 0 0-.1.32c0 .12.07.23.16.3h.02a.45.45 0 0 0 .57-.04l2-2V10c0 .28.23.5.5.5s.5-.22.5-.5V2.93l2.02 2.02c.08.07.18.12.3.13.11.01.21-.02.3-.08v.01"></path><path d="M18 7h-1.5a.5.5 0 0 0 0 1h1.6c.5 0 .9.4.9.9v10.2c0 .5-.4.9-.9.9H6.9a.9.9 0 0 1-.9-.9V8.9c0-.5.4-.9.9-.9h1.6a.5.5 0 0 0 .35-.15A.5.5 0 0 0 9 7.5a.5.5 0 0 0-.15-.35A.5.5 0 0 0 8.5 7H7a2 2 0 0 0-2 2v10c0 1.1.9 2 2 2h11a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2"></path></g></svg></button></div></div></div></div><div class="kr s da"><div class="kt"><span><a href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2d627e33b20a&amp;operation=register&amp;redirect=https%3A%2F%2Ftowardsdatascience.com%2Fillustrated-self-attention-2d627e33b20a&amp;source=post_actions_footer--------------------------bookmark_footer-----------" class="eh ei by bz ca cb cc cd ce bk ej ek cf el em" rel="noopener"><svg width="25" height="25" viewBox="0 0 25 25"><path d="M19 6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14.66h.01c.01.1.05.2.12.28a.5.5 0 0 0 .7.03l5.67-4.12 5.66 4.13a.5.5 0 0 0 .71-.03.5.5 0 0 0 .12-.29H19V6zm-6.84 9.97L7 19.64V6a1 1 0 0 1 1-1h9a1 1 0 0 1 1 1v13.64l-5.16-3.67a.49.49 0 0 0-.68 0z" fill-rule="evenodd"></path></svg></a></span></div></div></div></div></div><div class="tp sn s"><ul class="cd ce"><li class="bu tq ks tr"><a href="https://towardsdatascience.com/tagged/machine-learning" class="az b ht ts dt tt tu bv s nz">Machine Learning</a></li><li class="bu tq ks tr"><a href="https://towardsdatascience.com/tagged/towards-data-science" class="az b ht ts dt tt tu bv s nz">Towards Data Science</a></li><li class="bu tq ks tr"><a href="https://towardsdatascience.com/tagged/transformers" class="az b ht ts dt tt tu bv s nz">Transformers</a></li><li class="bu tq ks tr"><a href="https://towardsdatascience.com/tagged/attention" class="az b ht ts dt tt tu bv s nz">Attention</a></li><li class="bu tq ks tr"><a href="https://towardsdatascience.com/tagged/nlp" class="az b ht ts dt tt tu bv s nz">NLP</a></li></ul></div></div></div><div><div class="n p"><div class="ao ap aq ar as hp au v"></div></div><div class="s kq"><div class="tv tw s qo"><div class="n p"><div class="ao ap aq ar as hp au v"><div class="n o cj"><h2 class="az mf tx qu ty mi tz qw ua ml ub qy uc mn ud ra ue mp uf rc ug mr hf uh ui uj uk ul iz"><a href="https://towardsdatascience.com/?source=follow_footer-------------------------------------" class="eh ei by bz ca cb cc cd ce bk ej ek cf el em" rel="noopener">More from Towards Data Science</a></h2><div class="bu" aria-hidden="false" aria-describedby="collectionFollowPopover" aria-labelledby="collectionFollowPopover"><span><a href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F2d627e33b20a&amp;operation=register&amp;redirect=https%3A%2F%2Ftowardsdatascience.com%2Fillustrated-self-attention-2d627e33b20a&amp;source=follow_footer--------------------------follow_footer-----------" class="az b ba bb dx bd dy dz ea eb ec bk bl bm ed ee bq br bs bt bu bv" rel="noopener"><div class="n aw">Follow</div></a></span></div></div><div class="gy um s"><p class="az b ba bb dt">Your home for data science. A Medium publication sharing concepts, ideas and codes.</p></div></div></div></div></div><div class="un s qo kq"><div class="n p"><div class="gj gl gn uo up uq au v"><div class="ur qj s"><div class="uq s nv"><a href="https://towardsdatascience.com/?source=follow_footer-------------------------------------" class="az b ba bb dx bd dy dz ea eb ec bk bl bm ed ee bq br bs bt bu bv" rel="noopener">Read more from <!-- -->Towards Data Science</a></div></div></div></div></div><div class="s fv kq"><div class="n p"><div class="ao ap aq ar as at au v"><div class="us lk s"><div class="ut ox uu lk s uv uw"><h2 class="az mf mg jd mi mj jg ml jh jj mn jk jm mp jn jp mr iz">More From Medium</h2></div><div class="cp n aw cs ux uy uz va vb vc vd ve vf vg vh vi vj vk vl"><div class="vm vn vo gk vp vq vr gm vs vt vu vv vw vx vy vz wa wb wc wd we"><div class="wf wg s"><div class="v he"><div class="n cj"><div class="s wh wi wj wk"><div class="wl s"><h2 class="az mf tx qu mi tz qw ml qx wm mn qz wn mp rb wo mr iz"><a rel="noopener" href="https://towardsdatascience.com/towards-the-end-of-deep-learning-and-the-beginning-of-agi-d214d222c4cb?source=post_internal_links---------0----------------------------">Towards the end of deep learning and the beginning of AGI</a></h2></div><div class="o n"><div></div><div class="v s"><div class="n"><div style="flex:1"><span class="az b ba bb iz"><div class="cq n o wp"><span class="az b ht bb iz"><a href="https://medium.com/@ideami?source=post_internal_links---------0----------------------------" class="eh ei by bz ca cb cc cd ce bk wq cf el em" rel="noopener">Javier Ideami</a><span> <!-- -->in<!-- --> <a href="https://towardsdatascience.com/?source=post_internal_links---------0----------------------------" class="eh ei by bz ca cb cc cd ce bk wq cf el em" rel="noopener">Towards Data Science</a></span></span></div></span></div></div></div></div></div><div class="en ks s wr ws"><a class="eh ei by bz ca cb cc cd ce bk ej ek cf el em s" rel="noopener" href="https://towardsdatascience.com/towards-the-end-of-deep-learning-and-the-beginning-of-agi-d214d222c4cb?source=post_internal_links---------0----------------------------"><div class="hi s am hj"><div class="wt hl s"><div class="fa hd ep fd ez he v hf hg hh"><img class="ep fd ez he v hm hn fe aem" src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/1_GBJnNA6UicklMlFvLHsEMg.jpeg" width="70" height="70" role="presentation"></div><img class="yq abb wu wv ww wx wy wz xa xb xc xd c" width="70" height="70" role="presentation" src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/1_GBJnNA6UicklMlFvLHsEMg(1).jpeg" srcset="https://miro.medium.com/fit/c/48/70/1*GBJnNA6UicklMlFvLHsEMg.jpeg 48w, https://miro.medium.com/fit/c/70/70/1*GBJnNA6UicklMlFvLHsEMg.jpeg 70w" sizes="70px"><noscript></noscript></div></div></a></div></div></div></div></div><div class="vm vn vo gk vp vq vr gm vs vt vu vv vw vx vy vz wa wb wc wd we"><div class="wf wg s"><div class="v he"><div class="n cj"><div class="s wh wi wj wk"><div class="wl s"><h2 class="az mf tx qu mi tz qw ml qx wm mn qz wn mp rb wo mr iz"><a rel="noopener" href="https://towardsdatascience.com/switch-case-statements-are-coming-to-python-d0caf7b2bfd3?source=post_internal_links---------1----------------------------">Switch-Case Statements Are Coming to Python</a></h2></div><div class="o n"><div></div><div class="v s"><div class="n"><div style="flex:1"><span class="az b ba bb iz"><div class="cq n o wp"><span class="az b ht bb iz"><a href="https://jamescalam.medium.com/?source=post_internal_links---------1----------------------------" class="eh ei by bz ca cb cc cd ce bk wq cf el em" rel="noopener">James Briggs</a><span> <!-- -->in<!-- --> <a href="https://towardsdatascience.com/?source=post_internal_links---------1----------------------------" class="eh ei by bz ca cb cc cd ce bk wq cf el em" rel="noopener">Towards Data Science</a></span></span></div></span></div></div></div></div></div><div class="en ks s wr ws"><a class="eh ei by bz ca cb cc cd ce bk ej ek cf el em s" rel="noopener" href="https://towardsdatascience.com/switch-case-statements-are-coming-to-python-d0caf7b2bfd3?source=post_internal_links---------1----------------------------"><div class="hi s am hj"><div class="wt hl s"><div class="fa hd ep fd ez he v hf hg hh"><img class="ep fd ez he v hm hn fe aem" src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/1_OfS9n8O6FQO6pnu1Wj_ksg.jpeg" width="70" height="70" role="presentation"></div><img class="yq abb wu wv ww wx wy wz xa xb xc xd c" width="70" height="70" role="presentation" src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/1_OfS9n8O6FQO6pnu1Wj_ksg(1).jpeg" srcset="https://miro.medium.com/fit/c/48/70/1*OfS9n8O6FQO6pnu1Wj_ksg.jpeg 48w, https://miro.medium.com/fit/c/70/70/1*OfS9n8O6FQO6pnu1Wj_ksg.jpeg 70w" sizes="70px"><noscript></noscript></div></div></a></div></div></div></div></div><div class="vm vn vo gk vp vq vr gm vs vt vu vv vw vx vy vz wa wb wc wd we"><div class="wf wg s"><div class="v he"><div class="n cj"><div class="s wh wi wj wk"><div class="wl s"><h2 class="az mf tx qu mi tz qw ml qx wm mn qz wn mp rb wo mr iz"><a rel="noopener" href="https://towardsdatascience.com/5-python-debugging-tools-that-are-better-than-print-1aa02eba35?source=post_internal_links---------2----------------------------">5 Python Debugging Tools That Are Better Than “Print”</a></h2></div><div class="o n"><div></div><div class="v s"><div class="n"><div style="flex:1"><span class="az b ba bb iz"><div class="cq n o wp"><span class="az b ht bb iz"><a href="https://saraametwalli.medium.com/?source=post_internal_links---------2----------------------------" class="eh ei by bz ca cb cc cd ce bk wq cf el em" rel="noopener">Sara A. Metwalli</a><span> <!-- -->in<!-- --> <a href="https://towardsdatascience.com/?source=post_internal_links---------2----------------------------" class="eh ei by bz ca cb cc cd ce bk wq cf el em" rel="noopener">Towards Data Science</a></span></span></div></span></div></div></div></div></div><div class="en ks s wr ws"><a class="eh ei by bz ca cb cc cd ce bk ej ek cf el em s" rel="noopener" href="https://towardsdatascience.com/5-python-debugging-tools-that-are-better-than-print-1aa02eba35?source=post_internal_links---------2----------------------------"><div class="hi s am hj"><div class="wt hl s"><div class="fa hd ep fd ez he v hf hg hh"><img class="ep fd ez he v hm hn fe aem" src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/0_WMJ5Jw1FsCbLpYk7" width="70" height="70" role="presentation"></div><img class="yq abb wu wv ww wx wy wz xa xb xc xd c" width="70" height="70" role="presentation" src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/0_WMJ5Jw1FsCbLpYk7(1)" srcset="https://miro.medium.com/fit/c/48/70/0*WMJ5Jw1FsCbLpYk7 48w, https://miro.medium.com/fit/c/70/70/0*WMJ5Jw1FsCbLpYk7 70w" sizes="70px"><noscript></noscript></div></div></a></div></div></div></div></div><div class="vm vn vo gk vp vq vr gm vs vt vu vv vw vx vy vz wa wb wc wd we"><div class="wf wg s"><div class="v he"><div class="n cj"><div class="s wh wi wj wk"><div class="wl s"><h2 class="az mf tx qu mi tz qw ml qx wm mn qz wn mp rb wo mr iz"><a rel="noopener" href="https://towardsdatascience.com/17-types-of-similarity-and-dissimilarity-measures-used-in-data-science-3eb914d2681?source=post_internal_links---------3----------------------------">17 types of similarity and dissimilarity measures used in data science.</a></h2></div><div class="o n"><div></div><div class="v s"><div class="n"><div style="flex:1"><span class="az b ba bb iz"><div class="cq n o wp"><span class="az b ht bb iz"><a href="https://mahmoudharmouch.medium.com/?source=post_internal_links---------3----------------------------" class="eh ei by bz ca cb cc cd ce bk wq cf el em" rel="noopener">Mahmoud Harmouch</a><span> <!-- -->in<!-- --> <a href="https://towardsdatascience.com/?source=post_internal_links---------3----------------------------" class="eh ei by bz ca cb cc cd ce bk wq cf el em" rel="noopener">Towards Data Science</a></span></span></div></span></div></div></div></div></div><div class="en ks s wr ws"><a class="eh ei by bz ca cb cc cd ce bk ej ek cf el em s" rel="noopener" href="https://towardsdatascience.com/17-types-of-similarity-and-dissimilarity-measures-used-in-data-science-3eb914d2681?source=post_internal_links---------3----------------------------"><div class="hi s am hj"><div class="wt hl s"><div class="fa hd ep fd ez he v hf hg hh"><img class="ep fd ez he v hm hn fe aem" src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/1_n97707zKau5I5libJWl_XQ.png" width="70" height="70" role="presentation"></div><img class="yq abb wu wv ww wx wy wz xa xb xc xd c" width="70" height="70" role="presentation" src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/1_n97707zKau5I5libJWl_XQ(1).png" srcset="https://miro.medium.com/fit/c/48/70/1*n97707zKau5I5libJWl_XQ.png 48w, https://miro.medium.com/fit/c/70/70/1*n97707zKau5I5libJWl_XQ.png 70w" sizes="70px"><noscript></noscript></div></div></a></div></div></div></div></div><div class="vm vn vo gk vp vq vr gm vs vt vu vv vw vx vy vz wa wb wc wd we"><div class="wf wg s"><div class="v he"><div class="n cj"><div class="s wh wi wj wk"><div class="wl s"><h2 class="az mf tx qu mi tz qw ml qx wm mn qz wn mp rb wo mr iz"><a rel="noopener" href="https://towardsdatascience.com/two-cool-functions-to-know-in-python-7c36da49f884?source=post_internal_links---------4----------------------------">Two Cool Functions To Know in Python</a></h2></div><div class="o n"><div></div><div class="v s"><div class="n"><div style="flex:1"><span class="az b ba bb iz"><div class="cq n o wp"><span class="az b ht bb iz"><a href="https://medium.com/@lmatalka90?source=post_internal_links---------4----------------------------" class="eh ei by bz ca cb cc cd ce bk wq cf el em" rel="noopener">Luay Matalka</a><span> <!-- -->in<!-- --> <a href="https://towardsdatascience.com/?source=post_internal_links---------4----------------------------" class="eh ei by bz ca cb cc cd ce bk wq cf el em" rel="noopener">Towards Data Science</a></span></span></div></span></div></div></div></div></div><div class="en ks s wr ws"><a class="eh ei by bz ca cb cc cd ce bk ej ek cf el em s" rel="noopener" href="https://towardsdatascience.com/two-cool-functions-to-know-in-python-7c36da49f884?source=post_internal_links---------4----------------------------"><div class="hi s am hj"><div class="wt hl s"><div class="fa hd ep fd ez he v hf hg hh"><img class="ep fd ez he v hm hn fe aem" src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/0_8_mAMYWGcQJyRUxS" width="70" height="70" role="presentation"></div><img class="yq abb wu wv ww wx wy wz xa xb xc xd c" width="70" height="70" role="presentation" src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/0_8_mAMYWGcQJyRUxS(1)" srcset="https://miro.medium.com/fit/c/48/70/0*8_mAMYWGcQJyRUxS 48w, https://miro.medium.com/fit/c/70/70/0*8_mAMYWGcQJyRUxS 70w" sizes="70px"><noscript></noscript></div></div></a></div></div></div></div></div><div class="vm vn vo gk vp vq vr gm vs vt vu vv vw vx vy vz wa wb wc wd we"><div class="wf wg s"><div class="v he"><div class="n cj"><div class="s wh wi wj wk"><div class="wl s"><h2 class="az mf tx qu mi tz qw ml qx wm mn qz wn mp rb wo mr iz"><a rel="noopener" href="https://towardsdatascience.com/how-to-run-30-machine-learning-models-with-2-lines-of-code-d0f94a537e52?source=post_internal_links---------5----------------------------">How to Run 30 Machine Learning Models with 2 Lines of Code</a></h2></div><div class="o n"><div></div><div class="v s"><div class="n"><div style="flex:1"><span class="az b ba bb iz"><div class="cq n o wp"><span class="az b ht bb iz"><a href="https://ismaelaraujo.medium.com/?source=post_internal_links---------5----------------------------" class="eh ei by bz ca cb cc cd ce bk wq cf el em" rel="noopener">Ismael Araujo</a><span> <!-- -->in<!-- --> <a href="https://towardsdatascience.com/?source=post_internal_links---------5----------------------------" class="eh ei by bz ca cb cc cd ce bk wq cf el em" rel="noopener">Towards Data Science</a></span></span></div></span></div></div></div></div></div><div class="en ks s wr ws"><a class="eh ei by bz ca cb cc cd ce bk ej ek cf el em s" rel="noopener" href="https://towardsdatascience.com/how-to-run-30-machine-learning-models-with-2-lines-of-code-d0f94a537e52?source=post_internal_links---------5----------------------------"><div class="hi s am hj"><div class="wt hl s"><div class="fa hd ep fd ez he v hf hg hh"><img class="ep fd ez he v hm hn fe aem" src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/1_4-VrCeuHwnnOd-j-pKT4xw.jpeg" width="70" height="70" role="presentation"></div><img class="yq abb wu wv ww wx wy wz xa xb xc xd c" width="70" height="70" role="presentation" src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/1_4-VrCeuHwnnOd-j-pKT4xw(1).jpeg" srcset="https://miro.medium.com/fit/c/48/70/1*4-VrCeuHwnnOd-j-pKT4xw.jpeg 48w, https://miro.medium.com/fit/c/70/70/1*4-VrCeuHwnnOd-j-pKT4xw.jpeg 70w" sizes="70px"><noscript></noscript></div></div></a></div></div></div></div></div><div class="vm vn vo gk vp vq vr gm vs vt vu vv vw vx vy vz wa wb wc wd we"><div class="wf wg s"><div class="v he"><div class="n cj"><div class="s wh wi wj wk"><div class="wl s"><h2 class="az mf tx qu mi tz qw ml qx wm mn qz wn mp rb wo mr iz"><a rel="noopener" href="https://towardsdatascience.com/scikit-learn-cheat-sheet-2021-python-for-data-science-c634fd5dcbd0?source=post_internal_links---------6----------------------------">Scikit-Learn Cheat Sheet (2021), Python for Data Science</a></h2></div><div class="o n"><div></div><div class="v s"><div class="n"><div style="flex:1"><span class="az b ba bb iz"><div class="cq n o wp"><span class="az b ht bb iz"><a href="https://christopherzita.medium.com/?source=post_internal_links---------6----------------------------" class="eh ei by bz ca cb cc cd ce bk wq cf el em" rel="noopener">Christopher Zita</a><span> <!-- -->in<!-- --> <a href="https://towardsdatascience.com/?source=post_internal_links---------6----------------------------" class="eh ei by bz ca cb cc cd ce bk wq cf el em" rel="noopener">Towards Data Science</a></span></span></div></span></div></div></div></div></div><div class="en ks s wr ws"><a class="eh ei by bz ca cb cc cd ce bk ej ek cf el em s" rel="noopener" href="https://towardsdatascience.com/scikit-learn-cheat-sheet-2021-python-for-data-science-c634fd5dcbd0?source=post_internal_links---------6----------------------------"><div class="hi s am hj"><div class="wt hl s"><div class="fa hd ep fd ez he v hf hg hh"><img class="ep fd ez he v hm hn fe aem" src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/1_ffESrGTkAoz4f6JNwalksg.jpeg" width="70" height="70" role="presentation"></div><img class="yq abb wu wv ww wx wy wz xa xb xc xd c" width="70" height="70" role="presentation" src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/1_ffESrGTkAoz4f6JNwalksg(1).jpeg" srcset="https://miro.medium.com/fit/c/48/70/1*ffESrGTkAoz4f6JNwalksg.jpeg 48w, https://miro.medium.com/fit/c/70/70/1*ffESrGTkAoz4f6JNwalksg.jpeg 70w" sizes="70px"><noscript></noscript></div></div></a></div></div></div></div></div><div class="vm vn vo gk vp vq vr gm vs vt vu vv vw vx vy vz wa wb wc wd we"><div class="wf wg s"><div class="v he"><div class="n cj"><div class="s wh wi wj wk"><div class="wl s"><h2 class="az mf tx qu mi tz qw ml qx wm mn qz wn mp rb wo mr iz"><a rel="noopener" href="https://towardsdatascience.com/find-the-difference-in-python-68bbd000e513?source=post_internal_links---------7----------------------------">“Find the Difference” in Python</a></h2></div><div class="o n"><div></div><div class="v s"><div class="n"><div style="flex:1"><span class="az b ba bb iz"><div class="cq n o wp"><span class="az b ht bb iz"><a href="https://medium.com/@qiuyujx?source=post_internal_links---------7----------------------------" class="eh ei by bz ca cb cc cd ce bk wq cf el em" rel="noopener">Christopher Tao</a><span> <!-- -->in<!-- --> <a href="https://towardsdatascience.com/?source=post_internal_links---------7----------------------------" class="eh ei by bz ca cb cc cd ce bk wq cf el em" rel="noopener">Towards Data Science</a></span></span></div></span></div></div></div></div></div><div class="en ks s wr ws"><a class="eh ei by bz ca cb cc cd ce bk ej ek cf el em s" rel="noopener" href="https://towardsdatascience.com/find-the-difference-in-python-68bbd000e513?source=post_internal_links---------7----------------------------"><div class="hi s am hj"><div class="wt hl s"><div class="fa hd ep fd ez he v hf hg hh"><img class="ep fd ez he v hm hn fe aem" src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/1_KbGLNRZLx0j624cjCMn49g.jpeg" width="70" height="70" role="presentation"></div><img class="yq abb wu wv ww wx wy wz xa xb xc xd c" width="70" height="70" role="presentation" src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/1_KbGLNRZLx0j624cjCMn49g(1).jpeg" srcset="https://miro.medium.com/fit/c/48/70/1*KbGLNRZLx0j624cjCMn49g.jpeg 48w, https://miro.medium.com/fit/c/70/70/1*KbGLNRZLx0j624cjCMn49g.jpeg 70w" sizes="70px"><noscript></noscript></div></div></a></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="xe s xf xg"><div class="n p"><div class="ao ap aq ar as at au v"><div class="n ah"><div class="n o cj"><a href="https://medium.com/?source=post_page-----2d627e33b20a--------------------------------" class="eh ei by bz ca cb cc cd ce bk xh xi cf xj xk" rel="noopener"><svg viewBox="0 0 3940 610" class="dy xl"><path d="M594.79 308.2c0 163.76-131.85 296.52-294.5 296.52S5.8 472 5.8 308.2 137.65 11.69 300.29 11.69s294.5 132.75 294.5 296.51M917.86 308.2c0 154.16-65.93 279.12-147.25 279.12s-147.25-125-147.25-279.12S689.29 29.08 770.61 29.08s147.25 125 147.25 279.12M1050 308.2c0 138.12-23.19 250.08-51.79 250.08s-51.79-112-51.79-250.08 23.19-250.08 51.8-250.08S1050 170.09 1050 308.2M1862.77 37.4l.82-.18v-6.35h-167.48l-155.51 365.5-155.51-365.5h-180.48v6.35l.81.18c30.57 6.9 46.09 17.19 46.09 54.3v434.45c0 37.11-15.58 47.4-46.15 54.3l-.81.18V587H1327v-6.35l-.81-.18c-30.57-6.9-46.09-17.19-46.09-54.3V116.9L1479.87 587h11.33l205.59-483.21V536.9c-2.62 29.31-18 38.36-45.68 44.61l-.82.19v6.3h213.3v-6.3l-.82-.19c-27.71-6.25-43.46-15.3-46.08-44.61l-.14-445.2h.14c0-37.11 15.52-47.4 46.08-54.3m97.43 287.8c3.49-78.06 31.52-134.4 78.56-135.37 14.51.24 26.68 5 36.14 14.16 20.1 19.51 29.55 60.28 28.09 121.21zm-2.11 22h250v-1.05c-.71-59.69-18-106.12-51.34-138-28.82-27.55-71.49-42.71-116.31-42.71h-1c-23.26 0-51.79 5.64-72.09 15.86-23.11 10.7-43.49 26.7-60.45 47.7-27.3 33.83-43.84 79.55-47.86 130.93-.13 1.54-.24 3.08-.35 4.62s-.18 2.92-.25 4.39a332.64 332.64 0 0 0-.36 21.69C1860.79 507 1923.65 600 2035.3 600c98 0 155.07-71.64 169.3-167.8l-7.19-2.53c-25 51.68-69.9 83-121 79.18-69.76-5.22-123.2-75.95-118.35-161.63m532.69 157.68c-8.2 19.45-25.31 30.15-48.24 30.15s-43.89-15.74-58.78-44.34c-16-30.7-24.42-74.1-24.42-125.51 0-107 33.28-176.21 84.79-176.21 21.57 0 38.55 10.7 46.65 29.37zm165.84 76.28c-30.57-7.23-46.09-18-46.09-57V5.28L2424.77 60v6.7l1.14-.09c25.62-2.07 43 1.47 53.09 10.79 7.9 7.3 11.75 18.5 11.75 34.26v71.14c-18.31-11.69-40.09-17.38-66.52-17.38-53.6 0-102.59 22.57-137.92 63.56-36.83 42.72-56.3 101.1-56.3 168.81C2230 518.72 2289.53 600 2378.13 600c51.83 0 93.53-28.4 112.62-76.3V588h166.65v-6.66zm159.29-505.33c0-37.76-28.47-66.24-66.24-66.24-37.59 0-67 29.1-67 66.24s29.44 66.24 67 66.24c37.77 0 66.24-28.48 66.24-66.24m43.84 505.33c-30.57-7.23-46.09-18-46.09-57h-.13V166.65l-166.66 47.85v6.5l1 .09c36.06 3.21 45.93 15.63 45.93 57.77V588h166.8v-6.66zm427.05 0c-30.57-7.23-46.09-18-46.09-57V166.65L3082 212.92v6.52l.94.1c29.48 3.1 38 16.23 38 58.56v226c-9.83 19.45-28.27 31-50.61 31.78-36.23 0-56.18-24.47-56.18-68.9V166.66l-166.66 47.85V221l1 .09c36.06 3.2 45.94 15.62 45.94 57.77v191.27a214.48 214.48 0 0 0 3.47 39.82l3 13.05c14.11 50.56 51.08 77 109 77 49.06 0 92.06-30.37 111-77.89v66h166.66v-6.66zM3934.2 588v-6.67l-.81-.19c-33.17-7.65-46.09-22.07-46.09-51.43v-243.2c0-75.83-42.59-121.09-113.93-121.09-52 0-95.85 30.05-112.73 76.86-13.41-49.6-52-76.86-109.06-76.86-50.12 0-89.4 26.45-106.25 71.13v-69.87l-166.66 45.89v6.54l1 .09c35.63 3.16 45.93 15.94 45.93 57V588h155.5v-6.66l-.82-.2c-26.46-6.22-35-17.56-35-46.66V255.72c7-16.35 21.11-35.72 49-35.72 34.64 0 52.2 24 52.2 71.28V588h155.54v-6.66l-.82-.2c-26.46-6.22-35-17.56-35-46.66v-248a160.45 160.45 0 0 0-2.2-27.68c7.42-17.77 22.34-38.8 51.37-38.8 35.13 0 52.2 23.31 52.2 71.28V588z"></path></svg></a><div class="qs xm n cj xn cl"><p class="az b dj dk xo"><a href="https://medium.com/about?autoplay=1&amp;source=post_page-----2d627e33b20a--------------------------------" class="eh ei by bz ca cb cc cd ce bk wq cf xj xk" rel="noopener">About</a></p><p class="az b dj dk xo"><a href="https://help.medium.com/hc/en-us?source=post_page-----2d627e33b20a--------------------------------" class="eh ei by bz ca cb cc cd ce bk wq cf xj xk" rel="noopener">Help</a></p><p class="az b dj dk xo"><a href="https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----2d627e33b20a--------------------------------" class="eh ei by bz ca cb cc cd ce bk wq cf xj xk" rel="noopener">Legal</a></p></div></div><div class="aj xp xq cl"><p class="az b dj dk xr">Get the Medium app</p></div><div class="aj xp xs cl xt"><div class="ay s"><a href="https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&amp;mt=8&amp;ct=post_page&amp;source=post_page-----2d627e33b20a--------------------------------" class="eh ei by bz ca cb cc cd ce bk xh xi cf xj xk" rel="noopener nofollow"><img alt="A button that says &#39;Download on the App Store&#39;, and if clicked it will lead you to the iOS App store" class="" src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/1_Crl55Tm6yDNMoucPo1tvDg.png" width="135" height="41"></a></div><div class="s"><a href="https://play.google.com/store/apps/details?id=com.medium.reader&amp;source=post_page-----2d627e33b20a--------------------------------" class="eh ei by bz ca cb cc cd ce bk xh xi cf xj xk" rel="noopener nofollow"><img alt="A button that says &#39;Get it on, Google Play&#39;, and if clicked it will lead you to the Google Play store" class="" src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/1_W_RAPQ62h0em559zluJLdQ.png" width="135" height="41"></a></div></div></div></div></div></div></div></div></div><script>window.__BUILD_ID__ = "main-20210325-212324-8f2944bf9e"</script><script>window.__GRAPHQL_URI__ = "https://towardsdatascience.com/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"auroraPage":{"isAuroraPageEnabled":true},"bookReader":{"assets":{},"reader":{"currentAsset":null,"settingsPanelIsOpen":false,"settings":{"fontFamily":"CHARTER","fontScale":"M","publisherStyling":true,"textAlignment":"START","theme":"White","lineSpacing":0,"wordSpacing":0,"letterSpacing":0},"internalNavCounter":0}},"cache":{"experimentGroupSet":false,"reason":"This is a locked post","group":"disabled","tags":[],"serverVariantState":""},"client":{"hydrated":false,"isUs":false,"isNativeMedium":false,"isSafariMobile":false,"isSafari":false,"routingEntity":{"type":"COLLECTION","id":"7f60cf5620c9","explicit":true},"supportsWebp":true},"config":{"nodeEnv":"production","version":"main-20210325-212324-8f2944bf9e","isTaggedVersion":false,"target":"production","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","glyphUrl":"https:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","lightStep":{"name":"lite-web","host":"lightstep.medium.systems","token":"ce5be895bef60919541332990ac9fef2","appVersion":"main-20210325-212324-8f2944bf9e"},"algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","recaptcha3Key":"6Lf8R9wUAAAAABMI_85Wb8melS7Zj6ziuf99Yot5","datadog":{"clientToken":"pub853ea8d17ad6821d9f8f11861d23dfed","context":{"deployment":{"target":"production","tag":"main-20210325-212324-8f2944bf9e","commit":"8f2944bf9e50f5f9eab961a6521a647f952d136d"}},"datacenter":"us"},"isAmp":false,"googleAnalyticsCode":"UA-24232453-2","signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumOwnedAndOperatedCollectionIds":["544c7006046e","bcc38c8f6edf","444d13b52878","8d6b8a439e32","92d2092dc598","1285ba81cada","cb8577c9149e","8ccfed20cbb2","ae2a65f35510","3f6ecf56618","7b6769f2748b","fc8964313712","ef8e90590e66","191186aaafa0","d944778ce714","bdc4052bbdba","88d9857e584e","9dc80918cc93","8a9336e5bb4","cef6983b292","54c98c43354d","193b68bd4fba","b7e45b22fec3","55760f21cdc5"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io","betterhumans.coach.me","theascent.pub"],"topicsToFollow":["d61cf867d93f","8a146bc21b28","1eca0103fff3","4d562ee63426","aef1078a3ef5","e15e46793f8d","6158eb913466","55f1c20aba7a","3d18b94f6858","4861fee224fd","63c6f1f93ee","1d98b3a9a871","decb52b64abf","ae5d4995e225","830cded25262"],"defaultImages":{"avatar":{"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","height":150,"width":150},"orgLogo":{"imageId":"1*OMF3fSqH8t4xBJ9-6oZDZw.png","height":106,"width":545},"postLogo":{"imageId":"1*kFrc4tBFM_tCis-2Ic87WA.png","height":810,"width":1440},"postPreviewImage":{"imageId":"1*hn4v1tCaJy7cWMyb0bpNpQ.png","height":386,"width":579}},"performanceTags":[],"collectionStructuredData":{"8d6b8a439e32":{"name":"Elemental","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F980\u002F1*9ygdqoKprhwuTVKUM0DLPA@2x.png","width":980,"height":159}}},"3f6ecf56618":{"name":"Forge","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F596\u002F1*uULpIlImcO5TDuBZ6lm7Lg@2x.png","width":596,"height":183}}},"ae2a65f35510":{"name":"GEN","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F264\u002F1*RdVZMdvfV3YiZTw6mX7yWA.png","width":264,"height":140}}},"88d9857e584e":{"name":"LEVEL","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*JqYMhNX6KNNb2UlqGqO2WQ.png","width":540,"height":108}}},"7b6769f2748b":{"name":"Marker","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F383\u002F1*haCUs0wF6TgOOvfoY-jEoQ@2x.png","width":383,"height":92}}},"444d13b52878":{"name":"OneZero","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*cw32fIqCbRWzwJaoQw6BUg.png","width":540,"height":123}}},"8ccfed20cbb2":{"name":"Zora","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*tZUQqRcCCZDXjjiZ4bDvgQ.png","width":540,"height":106}}}},"embeddedPostIds":{"coronavirus":"cd3010f9d81f"},"sharedCdcMessaging":{"COVID_APPLICABLE_TAG_SLUGS":[],"COVID_APPLICABLE_TOPIC_NAMES":[],"COVID_APPLICABLE_TOPIC_NAMES_FOR_TOPIC_PAGE":[],"COVID_MESSAGES":{"tierA":{"text":"For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":66,"end":73,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"tierB":{"text":"Anyone can publish on Medium per our Policies, but we don’t fact-check every story. For more info about the coronavirus, see cdc.gov.","markups":[{"start":37,"end":45,"href":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Fcategories\u002F201931128-Policies-Safety"},{"start":125,"end":132,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"paywall":{"text":"This article has been made free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":56,"end":70,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":138,"end":145,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"unbound":{"text":"This article is free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":45,"end":59,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":127,"end":134,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]}},"COVID_BANNER_POST_ID_OVERRIDE_WHITELIST":["3b31a67bff4a"]},"sharedVoteMessaging":{"TAGS":["politics","election-2020","government","us-politics","election","2020-presidential-race","trump","donald-trump","democrats","republicans","congress","republican-party","democratic-party","biden","joe-biden","maga"],"TOPICS":["politics","election"],"MESSAGE":{"text":"Find out more about the U.S. election results here.","markups":[{"start":46,"end":50,"href":"https:\u002F\u002Fcookpolitical.com\u002F2020-national-popular-vote-tracker"}]},"EXCLUDE_POSTS":["397ef29e3ca5"]},"embedPostRules":[],"recircOptions":{"v1":{"limit":3},"v2":{"limit":8}},"braintreeClientKey":"production_zjkj96jm_m56f8fqpf7ngnrd4","paypalClientId":"AXj1G4fotC2GE8KzWX9mSxCH1wmPE3nJglf4Z2ig_amnhvlMVX87otaq58niAg9iuLktVNF_1WCMnN7v","stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl","errorTracking":"none"},"debug":{"requestId":"334ec716-a802-4e9e-875c-c82571da1308","branchDeployConfig":null,"hybridDevServices":[],"originalSpanCarrier":{"ot-tracer-spanid":"20f160fb4b2c6542","ot-tracer-traceid":"53a52bab73799a09","ot-tracer-sampled":"true"}},"multiVote":{"clapsPerPost":{}},"navigation":{"branch":{"show":null,"hasRendered":null,"blockedByCTA":false},"hideGoogleOneTap":false,"hasRenderedGoogleOneTap":null,"hasRenderedAlternateUserBanner":null,"currentLocation":"https:\u002F\u002Ftowardsdatascience.com\u002Fillustrated-self-attention-2d627e33b20a","host":"towardsdatascience.com","hostname":"towardsdatascience.com","referrer":"https:\u002F\u002Fwww.google.com\u002F","hasSetReferrer":false,"susiModal":{"step":null,"operation":"register"},"postRead":false},"session":{"user":{"id":"lo_6b4342ce1bfc"},"xsrf":"","isSpoofed":false},"tracing":{}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY":{"__typename":"Query","viewer":null,"variantFlags":[{"__typename":"VariantFlag","name":"allow_access","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"allow_signup","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"allow_test_auth","valueType":{"__typename":"VariantFlagString","value":"disallow"}},{"__typename":"VariantFlag","name":"android_enable_lock_responses","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"assign_default_topic_to_posts","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"available_annual_plan","valueType":{"__typename":"VariantFlagString","value":"2c754bcc2995"}},{"__typename":"VariantFlag","name":"available_monthly_plan","valueType":{"__typename":"VariantFlagString","value":"60e220181034"}},{"__typename":"VariantFlag","name":"bane_add_user","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"bane_verify_domain","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"branch_seo_metadata","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"browsable_stream_config_bucket","valueType":{"__typename":"VariantFlagString","value":"curated-topics"}},{"__typename":"VariantFlag","name":"coronavirus_topic_recirc","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"covid_19_cdc_banner","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"default_seo_post_titles","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"deindex_from_external_search_threshold","valueType":{"__typename":"VariantFlagString","value":"1609488000000"}},{"__typename":"VariantFlag","name":"disable_android_subscription_activity_carousel","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"disable_ios_resume_reading_toast","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"disable_ios_subscription_activity_carousel","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"disable_mobile_featured_chunk","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"disable_post_recommended_from_friends_provider","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_android_local_currency","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_annual_renewal_reminder_email","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_app_flirty_thirty","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_apple_parse_expires_at","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_apple_sign_in","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_apple_webhook","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_apple_webhook_renewal_failure","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_aurora_about_page_routing","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_aurora_general_admission","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_aurora_nav","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_aurora_profile_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_aurora_pub_follower_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_aurora_recirc","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_aurora_sticky_nav","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_aurora_tag_page_routing","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_author_autotier","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_author_cards","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_author_cards_byline","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_automated_mission_control_triggers","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_apple_pay","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_client","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_integration","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_paypal","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_trial_membership","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_webhook","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_branch_io","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_branch_text_me_the_app","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_branding","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_branding_fonts","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_cleansweep_double_writes","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_client_error_tracking","valueType":{"__typename":"VariantFlagString","value":"none"}},{"__typename":"VariantFlag","name":"enable_confirm_sign_in","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_cta_meter","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_curation_priority_queue_experiment","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_custom_domain_v2_settings","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_dedicated_series_tab_api_ios","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_digest_feature_logging","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_digest_tagline","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_earn_redirect","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_edit_alt_text","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_email_sign_in_captcha","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_embedding_based_diversification","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_end_of_post_cleanup","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_evhead_com_to_ev_medium_com_redirect","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_expanded_feature_chunk_pool","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_filter_by_resend_rules","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_filter_expire_processor","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_footer_app_buttons","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_global_susi_modal","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_google_one_tap","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_google_webhook","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_google_webhook_subscription_cancelled","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_highlander_member_digest","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_hightower_user_minimum_guarantee","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_homepage_who_to_follow_module","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_homepage_write_button","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ios_post_stats","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_json_logs_trained_ranker","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_kbfd_rex","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_kbfd_rex_app_highlights","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_kiln_for_digest_editors_picks","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_auto_expand_responses","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_homepage","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_homepage_feed","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_notifications","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_pay_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_post","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_post_cd","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_pub_homepage_for_selected_domains","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_server_upstream_deadlines","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_stories","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_topics","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_unread_notification_count_mutation","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lock_responses","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_login_code_flow","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_marketing_emails","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_media_resource_try_catch","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_medium2_kbfd","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_membership_remove_section_a","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_miro_on_kubernetes","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_mission_control","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ml_rank_modules","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ml_rank_rex_anno","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_mps_digest_rendering","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_mute","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_new_checkout_flow","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_new_collaborative_filtering_data","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_new_login_flow","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_new_member_welcome_email_enhancement","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_new_three_dot_menu","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_new_user_onboarding_email_enhancement","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_parsely","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_patronus_on_kubernetes","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_popularity_feature","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_post_import","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_post_page_nav_stickiness_removal","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_post_settings_screen","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_pp_tax_status_clarity","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_primary_topic_for_mobile","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_profile_design_reminder","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_profile_page_seo_titles","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_publish_to_email_for_publication_posts","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_receipt_notes","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_responses_all","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_responses_edit_and_delete","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_responses_moderation","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_rex_follow_feed_cache","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_rito_upstream_deadlines","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_rtr_channel","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_s3_sites","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_save_to_medium","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_signup_friction","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_starspace","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_starspace_ranker_starspace","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_stripegate","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tick_landing_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tipalti_onboarding","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_trending_posts_diversification","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tribute_landing_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_triton_predictions","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_trumpland_landing_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_twitter_auth_suggestions","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_unfiltered_cf","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"entity_driven_subscription_milestone_1","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"filter_last_seen","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"glyph_font_set","valueType":{"__typename":"VariantFlagString","value":"m2-unbound"}},{"__typename":"VariantFlag","name":"google_sign_in_android","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_generic_home_modules","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_home_post_menu","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_lock_responses","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_iceland_nux","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_pub_follow_email_opt_in","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"is_not_medium_subscriber","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"kill_fastrak","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"kill_stripe_express","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"limit_post_referrers","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"limit_user_follows","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"make_nav_sticky","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"new_transition_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"provider_for_credit_card_form","valueType":{"__typename":"VariantFlagString","value":"BRAINTREE"}},{"__typename":"VariantFlag","name":"pub_sidebar","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"redefine_average_post_reading_time","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"remove_low_quality_posts_from_internal_search","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"remove_post_post_similarity","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"retrained_ranker","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"sign_up_with_email_button","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"signin_services","valueType":{"__typename":"VariantFlagString","value":"twitter,facebook,google,email,google-fastidv,google-one-tap,apple"}},{"__typename":"VariantFlag","name":"signup_services","valueType":{"__typename":"VariantFlagString","value":"twitter,facebook,google,email,google-fastidv,google-one-tap,apple"}},{"__typename":"VariantFlag","name":"skip_sign_in_recaptcha","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"suppress_apple_missing_expires_date_alert","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"use_new_admin_topic_backend","valueType":{"__typename":"VariantFlagBoolean","value":true}}],"meterPost({\"postId\":\"2d627e33b20a\",\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\",\"sk\":null}})":{"__ref":"MeteringInfo:{}"},"postResult({\"id\":\"2d627e33b20a\"})":{"__ref":"Post:2d627e33b20a"}},"MeteringInfo:{}":{"__typename":"MeteringInfo","postIds":["2d627e33b20a"],"maxUnlockCount":3,"unlocksRemaining":2},"ImageMetadata:1*ChFMdf--f5jbm-AYv6VdYA@2x.png":{"id":"1*ChFMdf--f5jbm-AYv6VdYA@2x.png","__typename":"ImageMetadata"},"CustomStyleSheet:8a80db885f47":{"id":"8a80db885f47","__typename":"CustomStyleSheet","global":{"__typename":"GlobalStyles","colorPalette":{"__typename":"StyleSheetColorPalette","primary":{"__typename":"ColorValue","colorPalette":{"__typename":"ColorPalette","highlightSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FFEDF4FC","point":0},{"__typename":"ColorPoint","color":"#FFE9F2FD","point":0.1},{"__typename":"ColorPoint","color":"#FFE6F1FD","point":0.2},{"__typename":"ColorPoint","color":"#FFE2EFFD","point":0.3},{"__typename":"ColorPoint","color":"#FFDFEEFD","point":0.4},{"__typename":"ColorPoint","color":"#FFDBECFE","point":0.5},{"__typename":"ColorPoint","color":"#FFD7EBFE","point":0.6},{"__typename":"ColorPoint","color":"#FFD4E9FE","point":0.7},{"__typename":"ColorPoint","color":"#FFD0E7FF","point":0.8},{"__typename":"ColorPoint","color":"#FFCCE6FF","point":0.9},{"__typename":"ColorPoint","color":"#FFC8E4FF","point":1}]},"defaultBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FF668AAA","point":0},{"__typename":"ColorPoint","color":"#FF61809D","point":0.1},{"__typename":"ColorPoint","color":"#FF5A7690","point":0.2},{"__typename":"ColorPoint","color":"#FF546C83","point":0.3},{"__typename":"ColorPoint","color":"#FF4D6275","point":0.4},{"__typename":"ColorPoint","color":"#FF455768","point":0.5},{"__typename":"ColorPoint","color":"#FF3D4C5A","point":0.6},{"__typename":"ColorPoint","color":"#FF34414C","point":0.7},{"__typename":"ColorPoint","color":"#FF2B353E","point":0.8},{"__typename":"ColorPoint","color":"#FF21282F","point":0.9},{"__typename":"ColorPoint","color":"#FF161B1F","point":1}]},"tintBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FF355876","colorPoints":[{"__typename":"ColorPoint","color":"#FF355876","point":0},{"__typename":"ColorPoint","color":"#FF4D6C88","point":0.1},{"__typename":"ColorPoint","color":"#FF637F99","point":0.2},{"__typename":"ColorPoint","color":"#FF7791A8","point":0.3},{"__typename":"ColorPoint","color":"#FF8CA2B7","point":0.4},{"__typename":"ColorPoint","color":"#FF9FB3C6","point":0.5},{"__typename":"ColorPoint","color":"#FFB2C3D4","point":0.6},{"__typename":"ColorPoint","color":"#FFC5D2E1","point":0.7},{"__typename":"ColorPoint","color":"#FFD7E2EE","point":0.8},{"__typename":"ColorPoint","color":"#FFE9F1FA","point":0.9},{"__typename":"ColorPoint","color":"#FFFBFFFF","point":1}]}}},"background":null},"fonts":{"__typename":"StyleSheetFonts","font1":{"__typename":"StyleSheetFont","name":"SANS_SERIF_1"},"font2":{"__typename":"StyleSheetFont","name":"SANS_SERIF_1"},"font3":{"__typename":"StyleSheetFont","name":"SERIF_2"}}},"header":{"__typename":"HeaderStyles","backgroundColor":{"__typename":"ColorValue","colorPalette":{"__typename":"ColorPalette","tintBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FF355876","colorPoints":[{"__typename":"ColorPoint","color":"#FF355876","point":0},{"__typename":"ColorPoint","color":"#FF4D6C88","point":0.1},{"__typename":"ColorPoint","color":"#FF637F99","point":0.2},{"__typename":"ColorPoint","color":"#FF7791A8","point":0.3},{"__typename":"ColorPoint","color":"#FF8CA2B7","point":0.4},{"__typename":"ColorPoint","color":"#FF9FB3C6","point":0.5},{"__typename":"ColorPoint","color":"#FFB2C3D4","point":0.6},{"__typename":"ColorPoint","color":"#FFC5D2E1","point":0.7},{"__typename":"ColorPoint","color":"#FFD7E2EE","point":0.8},{"__typename":"ColorPoint","color":"#FFE9F1FA","point":0.9},{"__typename":"ColorPoint","color":"#FFFBFFFF","point":1}]}},"rgb":"355876","alpha":"99"},"postBackgroundColor":null,"backgroundImage":{"__ref":"ImageMetadata:1*sfUruIusLq6tbpLx0sDYZQ.png"},"headerScale":"HEADER_SCALE_MEDIUM","horizontalAlignment":"CENTER","backgroundImageDisplayMode":"IMAGE_DISPLAY_MODE_FILL","backgroundImageVerticalAlignment":"END","backgroundColorDisplayMode":"COLOR_DISPLAY_MODE_SOLID","secondaryBackgroundColor":null,"nameColor":null,"nameTreatment":"NAME_TREATMENT_LOGO","postNameTreatment":"NAME_TREATMENT_LOGO","logoImage":{"__ref":"ImageMetadata:1*AGyTPCaRzVqL77kFwUwHKg.png"},"logoScale":"HEADER_SCALE_LARGE","taglineColor":{"__typename":"ColorValue","rgb":"ffffff","alpha":"ff"},"taglineTreatment":"TAGLINE_TREATMENT_HEADER"},"navigation":{"__typename":"HeaderNavigation","navItems":[{"__typename":"HeaderNavigationItem","name":"Editors' Picks","href":null,"type":"NAV_TYPE_TAG","tags":[{"__ref":"Tag:editors-pick"}],"tagSlugs":["editors-pick"]},{"__typename":"HeaderNavigationItem","name":"Features","href":null,"type":"NAV_TYPE_TAG","tags":[{"__ref":"Tag:tds-features"}],"tagSlugs":["tds-features"]},{"__typename":"HeaderNavigationItem","name":"Explore","href":null,"type":"NAV_TYPE_TAG","tags":[{"__ref":"Tag:explore"}],"tagSlugs":["explore"]},{"__typename":"HeaderNavigationItem","name":"Grow","href":"https:\u002F\u002Ftowardsdatascience.com\u002Fhow-to-get-the-most-out-of-towards-data-science-3bf37f75a345","type":"NAV_TYPE_LINK","tags":[],"tagSlugs":[]},{"__typename":"HeaderNavigationItem","name":"Contribute","href":"https:\u002F\u002Ftowardsdatascience.com\u002Fquestions-96667b06af5","type":"NAV_TYPE_LINK","tags":[],"tagSlugs":[]}]},"postBody":null,"blogroll":null},"ImageMetadata:1*sfUruIusLq6tbpLx0sDYZQ.png":{"id":"1*sfUruIusLq6tbpLx0sDYZQ.png","__typename":"ImageMetadata","originalWidth":1401},"ImageMetadata:1*mG6i4Bh_LgixUYXJgQpYsg@2x.png":{"id":"1*mG6i4Bh_LgixUYXJgQpYsg@2x.png","__typename":"ImageMetadata","originalWidth":337,"originalHeight":122},"User:7e12c71dfa81":{"id":"7e12c71dfa81","__typename":"User","atsQualifiedAt":1612205680542},"ImageMetadata:1*eLxNtw6hQ4-3HrHda5BCCw.png":{"id":"1*eLxNtw6hQ4-3HrHda5BCCw.png","__typename":"ImageMetadata"},"NewsletterV3:d6fe9076899":{"id":"d6fe9076899","__typename":"NewsletterV3","slug":"the-variable","isSubscribed":false,"showPromo":true,"name":"The Variable","description":"Every Thursday, the Variable delivers the very best of Towards Data Science: from hands-on tutorials and cutting-edge research to original features you don't want to miss.","type":"NEWSLETTER_TYPE_COLLECTION","user":{"__ref":"User:895063a310f4"},"collection":{"__ref":"Collection:7f60cf5620c9"}},"Collection:7f60cf5620c9":{"id":"7f60cf5620c9","__typename":"Collection","domain":"towardsdatascience.com","googleAnalyticsId":null,"slug":"towards-data-science","colorBehavior":"ACCENT_COLOR_AND_FILL_BACKGROUND","isAuroraVisible":true,"favicon":{"__ref":"ImageMetadata:1*ChFMdf--f5jbm-AYv6VdYA@2x.png"},"name":"Towards Data Science","colorPalette":{"__typename":"ColorPalette","highlightSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FFEDF4FC","point":0},{"__typename":"ColorPoint","color":"#FFE9F2FD","point":0.1},{"__typename":"ColorPoint","color":"#FFE6F1FD","point":0.2},{"__typename":"ColorPoint","color":"#FFE2EFFD","point":0.3},{"__typename":"ColorPoint","color":"#FFDFEEFD","point":0.4},{"__typename":"ColorPoint","color":"#FFDBECFE","point":0.5},{"__typename":"ColorPoint","color":"#FFD7EBFE","point":0.6},{"__typename":"ColorPoint","color":"#FFD4E9FE","point":0.7},{"__typename":"ColorPoint","color":"#FFD0E7FF","point":0.8},{"__typename":"ColorPoint","color":"#FFCCE6FF","point":0.9},{"__typename":"ColorPoint","color":"#FFC8E4FF","point":1}]},"defaultBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FF668AAA","point":0},{"__typename":"ColorPoint","color":"#FF61809D","point":0.1},{"__typename":"ColorPoint","color":"#FF5A7690","point":0.2},{"__typename":"ColorPoint","color":"#FF546C83","point":0.3},{"__typename":"ColorPoint","color":"#FF4D6275","point":0.4},{"__typename":"ColorPoint","color":"#FF455768","point":0.5},{"__typename":"ColorPoint","color":"#FF3D4C5A","point":0.6},{"__typename":"ColorPoint","color":"#FF34414C","point":0.7},{"__typename":"ColorPoint","color":"#FF2B353E","point":0.8},{"__typename":"ColorPoint","color":"#FF21282F","point":0.9},{"__typename":"ColorPoint","color":"#FF161B1F","point":1}]},"tintBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FF355876","colorPoints":[{"__typename":"ColorPoint","color":"#FF355876","point":0},{"__typename":"ColorPoint","color":"#FF4D6C88","point":0.1},{"__typename":"ColorPoint","color":"#FF637F99","point":0.2},{"__typename":"ColorPoint","color":"#FF7791A8","point":0.3},{"__typename":"ColorPoint","color":"#FF8CA2B7","point":0.4},{"__typename":"ColorPoint","color":"#FF9FB3C6","point":0.5},{"__typename":"ColorPoint","color":"#FFB2C3D4","point":0.6},{"__typename":"ColorPoint","color":"#FFC5D2E1","point":0.7},{"__typename":"ColorPoint","color":"#FFD7E2EE","point":0.8},{"__typename":"ColorPoint","color":"#FFE9F1FA","point":0.9},{"__typename":"ColorPoint","color":"#FFFBFFFF","point":1}]}},"customStyleSheet":{"__ref":"CustomStyleSheet:8a80db885f47"},"tagline":"A Medium publication sharing concepts, ideas and codes.","isAuroraEligible":true,"viewerIsEditor":false,"logo":{"__ref":"ImageMetadata:1*mG6i4Bh_LgixUYXJgQpYsg@2x.png"},"navItems":[{"__typename":"NavItem","title":"Data Science","url":"https:\u002F\u002Ftowardsdatascience.com\u002Fdata-science\u002Fhome","type":"TOPIC_PAGE"},{"__typename":"NavItem","title":"Machine Learning","url":"https:\u002F\u002Ftowardsdatascience.com\u002Fmachine-learning\u002Fhome","type":"TOPIC_PAGE"},{"__typename":"NavItem","title":"Programming","url":"https:\u002F\u002Ftowardsdatascience.com\u002Fprogramming\u002Fhome","type":"TOPIC_PAGE"},{"__typename":"NavItem","title":"Visualization","url":"https:\u002F\u002Ftowardsdatascience.com\u002Fdata-visualization\u002Fhome","type":"TOPIC_PAGE"},{"__typename":"NavItem","title":"Video","url":"https:\u002F\u002Ftowardsdatascience.com\u002Fvideo\u002Fhome","type":"TOPIC_PAGE"},{"__typename":"NavItem","title":"★","url":"https:\u002F\u002Ftowardsdatascience.com\u002Feditors-picks\u002Fhome","type":"TOPIC_PAGE"},{"__typename":"NavItem","title":"About","url":"https:\u002F\u002Ftowardsdatascience.com\u002Fabout-us\u002Fhome","type":"TOPIC_PAGE"},{"__typename":"NavItem","title":"Contribute","url":"https:\u002F\u002Ftowardsdatascience.com\u002Fcontribute\u002Fhome","type":"EXTERNAL_LINK_NAV_ITEM"}],"creator":{"__ref":"User:7e12c71dfa81"},"subscriberCount":572316,"avatar":{"__ref":"ImageMetadata:1*eLxNtw6hQ4-3HrHda5BCCw.png"},"isEnrolledInHightower":false,"newsletterV3":{"__ref":"NewsletterV3:d6fe9076899"},"viewerIsFollowing":false,"viewerIsSubscribedToLetters":false,"canToggleEmail":true,"isUserSubscribedToCollectionEmails":false,"viewerIsMuting":false,"viewerCanEditOwnPosts":false,"viewerCanEditPosts":false,"description":"Your home for data science. A Medium publication sharing concepts, ideas and codes.","ampEnabled":false,"twitterUsername":"TDataScience","facebookPageId":null,"customDomainState":{"__typename":"CustomDomainState","live":{"__typename":"CustomDomain","status":"ACTIVE","isSubdomain":false}},"ptsQualifiedAt":0},"User:c2958659896a":{"id":"c2958659896a","__typename":"User","isFollowing":null,"viewerIsUser":false,"isSuspended":false,"name":"Raimi Karim","hasCompletedProfile":false,"bio":"Assoc Software Engineer at GovTech 🇸🇬, MComp (AI) at NUS.","imageId":"1*BEc6O6Z6fCy2NDHL9K462A@2x.jpeg","username":"remykarem","customStyleSheet":null,"customDomainState":null,"isAuroraVisible":true,"createdAt":0,"mediumMemberAt":1598268878000,"lastPostCreatedAt":0,"socialStats":{"__typename":"SocialStats","followerCount":1287,"followingCount":44},"hasSubdomain":false,"isAllowEdsEnabled":false,"isBlocking":null,"isMuting":null,"allowNotes":true,"newsletterV3":{"__ref":"NewsletterV3:307a18475417"},"twitterScreenName":"remykarem","atsQualifiedAt":1612205436189},"ImageMetadata:1*AGyTPCaRzVqL77kFwUwHKg.png":{"id":"1*AGyTPCaRzVqL77kFwUwHKg.png","__typename":"ImageMetadata","originalWidth":1376,"originalHeight":429},"Tag:editors-pick":{"id":"editors-pick","__typename":"Tag","normalizedTagSlug":""},"Tag:tds-features":{"id":"tds-features","__typename":"Tag","normalizedTagSlug":""},"Tag:explore":{"id":"explore","__typename":"Tag","normalizedTagSlug":""},"Paragraph:8ec1ac28362d_0":{"id":"8ec1ac28362d_0","__typename":"Paragraph","name":"a887","text":"","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*_92bnsMJy8Bl539G4v93yg.gif"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ec1ac28362d_1":{"id":"8ec1ac28362d_1","__typename":"Paragraph","name":"f9fa","text":"Inside AI","type":"H4","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ec1ac28362d_2":{"id":"8ec1ac28362d_2","__typename":"Paragraph","name":"423b","text":"Illustrated: Self-Attention","type":"H3","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ec1ac28362d_3":{"id":"8ec1ac28362d_3","__typename":"Paragraph","name":"e0a7","text":"Step-by-step guide to self-attention with illustrations and code","type":"H4","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ec1ac28362d_4":{"id":"8ec1ac28362d_4","__typename":"Paragraph","name":"b308","text":"The illustrations are best viewed on Desktop. A Colab version can be found here, (thanks to Manuel Romero!).","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":75,"end":79,"type":"A","href":"https:\u002F\u002Fcolab.research.google.com\u002Fdrive\u002F1rPk3ohrmVclqhH7uQ7qys4oznDdAhpzF","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","start":92,"end":105,"type":"A","href":null,"anchorType":"USER","userId":"3f2bb9b4510b","linkMetadata":null},{"__typename":"Markup","start":0,"end":108,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ec1ac28362d_5":{"id":"8ec1ac28362d_5","__typename":"Paragraph","name":"318a","text":"What do BERT, RoBERTa, ALBERT, SpanBERT, DistilBERT, SesameBERT, SemBERT, SciBERT, BioBERT, MobileBERT, TinyBERT and CamemBERT all have in common? And I’m not looking for the answer “BERT” 🤭.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":true,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ec1ac28362d_6":{"id":"8ec1ac28362d_6","__typename":"Paragraph","name":"dfee","text":"Answer: self-attention 🤗. We are not only talking about architectures bearing the name “BERT’, but more correctly Transformer-based architectures. Transformer-based architectures, which are primarily used in modelling language understanding tasks, eschew the use of recurrence in neural network and instead trust entirely on self-attention mechanisms to draw global dependencies between inputs and outputs. But what’s the math behind this?","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":8,"end":25,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":115,"end":132,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":326,"end":340,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ec1ac28362d_7":{"id":"8ec1ac28362d_7","__typename":"Paragraph","name":"b9f7","text":"That’s what we’re going to find out today. The main content of this post is to walk you through the mathematical operations involved in a self-attention module. By the end of this article, you should be able to write or code a self-attention module from scratch.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ec1ac28362d_8":{"id":"8ec1ac28362d_8","__typename":"Paragraph","name":"d989","text":"This article does not aim to provide the intuitions and explanations behind the different numerical representations and mathematical operations in the self-attention module. It also does not aim to demonstrate the why’s and how-exactly’s of self-attention in Transformers (I believe there’s a lot out there already). Note that the difference between attention and self-attention is also not detailed in this article.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ec1ac28362d_9":{"id":"8ec1ac28362d_9","__typename":"Paragraph","name":"e39c","text":"Content","type":"H4","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ec1ac28362d_10":{"id":"8ec1ac28362d_10","__typename":"Paragraph","name":"6345","text":"Illustrations","type":"OLI","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":0,"end":13,"type":"A","href":"#570c","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ec1ac28362d_11":{"id":"8ec1ac28362d_11","__typename":"Paragraph","name":"88a3","text":"Code","type":"OLI","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":0,"end":4,"type":"A","href":"#8481","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ec1ac28362d_12":{"id":"8ec1ac28362d_12","__typename":"Paragraph","name":"df33","text":"Extending to Transformers","type":"OLI","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":0,"end":25,"type":"A","href":"#faae","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ec1ac28362d_13":{"id":"8ec1ac28362d_13","__typename":"Paragraph","name":"66c1","text":"Now let’s get on to it!","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ec1ac28362d_14":{"id":"8ec1ac28362d_14","__typename":"Paragraph","name":"570c","text":"0. What is self-attention?","type":"H4","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ec1ac28362d_15":{"id":"8ec1ac28362d_15","__typename":"Paragraph","name":"59b8","text":"If you’re thinking if self-attention is similar to attention, then the answer is yes! They fundamentally share the same concept and many common mathematical operations.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":51,"end":60,"type":"STRONG","href":"","anchorType":"LINK","userId":"","linkMetadata":null}],"dropCapImage":null},"Paragraph:8ec1ac28362d_16":{"id":"8ec1ac28362d_16","__typename":"Paragraph","name":"66af","text":"A self-attention module takes in n inputs, and returns n outputs. What happens in this module? In layman’s terms, the self-attention mechanism allows the inputs to interact with each other (“self”) and find out who they should pay more attention to (“attention”). The outputs are aggregates of these interactions and attention scores.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":33,"end":34,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":55,"end":57,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ec1ac28362d_17":{"id":"8ec1ac28362d_17","__typename":"Paragraph","name":"3140","text":"1. Illustrations","type":"H4","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ec1ac28362d_18":{"id":"8ec1ac28362d_18","__typename":"Paragraph","name":"46c5","text":"The illustrations are divided into the following steps:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ec1ac28362d_19":{"id":"8ec1ac28362d_19","__typename":"Paragraph","name":"aacd","text":"Prepare inputs","type":"OLI","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ec1ac28362d_20":{"id":"8ec1ac28362d_20","__typename":"Paragraph","name":"aaf2","text":"Initialise weights","type":"OLI","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ec1ac28362d_21":{"id":"8ec1ac28362d_21","__typename":"Paragraph","name":"c673","text":"Derive key, query and value","type":"OLI","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":7,"end":10,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":12,"end":17,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":22,"end":27,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ec1ac28362d_22":{"id":"8ec1ac28362d_22","__typename":"Paragraph","name":"2f82","text":"Calculate attention scores for Input 1","type":"OLI","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ec1ac28362d_23":{"id":"8ec1ac28362d_23","__typename":"Paragraph","name":"5319","text":"Calculate softmax","type":"OLI","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ec1ac28362d_24":{"id":"8ec1ac28362d_24","__typename":"Paragraph","name":"342e","text":"Multiply scores with values","type":"OLI","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":21,"end":27,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ec1ac28362d_25":{"id":"8ec1ac28362d_25","__typename":"Paragraph","name":"b758","text":"Sum weighted values to get Output 1","type":"OLI","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":4,"end":12,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":13,"end":19,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ec1ac28362d_26":{"id":"8ec1ac28362d_26","__typename":"Paragraph","name":"1654","text":"Repeat steps 4–7 for Input 2 & Input 3","type":"OLI","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ec1ac28362d_27":{"id":"8ec1ac28362d_27","__typename":"Paragraph","name":"400c","text":"Note\nIn practice, the mathematical operations are vectorised, i.e. all the inputs undergo the mathematical operations together. We’ll see this later in the Code section.","type":"BQ","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":0,"end":4,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":0,"end":169,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ec1ac28362d_28":{"id":"8ec1ac28362d_28","__typename":"Paragraph","name":"a0b2","text":"Step 1: Prepare inputs","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":0,"end":22,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ec1ac28362d_29":{"id":"8ec1ac28362d_29","__typename":"Paragraph","name":"b4f7","text":"Fig. 1.1: Prepare inputs","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*hmvdDXrxhJsGhOQClQdkBA.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ec1ac28362d_30":{"id":"8ec1ac28362d_30","__typename":"Paragraph","name":"3e28","text":"For this tutorial, we start with 3 inputs, each with dimension 4.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ec1ac28362d_31":{"id":"8ec1ac28362d_31","__typename":"Paragraph","name":"d284","text":"Input 1: [1, 0, 1, 0] \nInput 2: [0, 2, 0, 2]\nInput 3: [1, 1, 1, 1]","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ec1ac28362d_32":{"id":"8ec1ac28362d_32","__typename":"Paragraph","name":"d825","text":"Step 2: Initialise weights","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":0,"end":26,"type":"STRONG","href":"","anchorType":"LINK","userId":"","linkMetadata":null}],"dropCapImage":null},"Paragraph:8ec1ac28362d_33":{"id":"8ec1ac28362d_33","__typename":"Paragraph","name":"f1bf","text":"Every input must have three representations (see diagram below). These representations are called key (orange), query (red), and value (purple). For this example, let’s take that we want these representations to have a dimension of 3. Because every input has a dimension of 4, this means each set of the weights must have a shape of 4×3.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":98,"end":102,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":112,"end":118,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":129,"end":135,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ec1ac28362d_34":{"id":"8ec1ac28362d_34","__typename":"Paragraph","name":"8594","text":"Note\nWe’ll see later that the dimension of value is also the dimension of the output.","type":"BQ","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":0,"end":4,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":43,"end":48,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":0,"end":85,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ec1ac28362d_35":{"id":"8ec1ac28362d_35","__typename":"Paragraph","name":"ecfe","text":"Fig. 1.2: Deriving key, query and value representations from each input","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*VPvXYMGjv0kRuoYqgFvCag.gif"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":19,"end":22,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":24,"end":29,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":34,"end":39,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ec1ac28362d_36":{"id":"8ec1ac28362d_36","__typename":"Paragraph","name":"654a","text":"In order to obtain these representations, every input (green) is multiplied with a set of weights for keys, a set of weights for querys (I know that’s not the right spelling), and a set of weights for values. In our example, we initialise the three sets of weights as follows.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":102,"end":106,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":129,"end":136,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":201,"end":207,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ec1ac28362d_37":{"id":"8ec1ac28362d_37","__typename":"Paragraph","name":"ac7b","text":"Weights for key:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":12,"end":15,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ec1ac28362d_38":{"id":"8ec1ac28362d_38","__typename":"Paragraph","name":"44d6","text":"[[0, 0, 1],\n [1, 1, 0],\n [0, 1, 0],\n [1, 1, 0]]","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ec1ac28362d_39":{"id":"8ec1ac28362d_39","__typename":"Paragraph","name":"835f","text":"Weights for query:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":12,"end":17,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ec1ac28362d_40":{"id":"8ec1ac28362d_40","__typename":"Paragraph","name":"99d2","text":"[[1, 0, 1],\n [1, 0, 0],\n [0, 0, 1],\n [0, 1, 1]]","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ec1ac28362d_41":{"id":"8ec1ac28362d_41","__typename":"Paragraph","name":"c5b8","text":"Weights for value:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":12,"end":17,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ec1ac28362d_42":{"id":"8ec1ac28362d_42","__typename":"Paragraph","name":"3c52","text":"[[0, 2, 0],\n [0, 3, 0],\n [1, 0, 3],\n [1, 1, 0]]","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ec1ac28362d_43":{"id":"8ec1ac28362d_43","__typename":"Paragraph","name":"f0c4","text":"Notes\nIn a neural network setting, these weights are usually small numbers, initialised randomly using an appropriate random distribution like Gaussian, Xavier and Kaiming distributions. This initialisation is done once before training.","type":"BQ","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":0,"end":6,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":0,"end":236,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ec1ac28362d_44":{"id":"8ec1ac28362d_44","__typename":"Paragraph","name":"ee49","text":"Step 3: Derive key, query and value","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":0,"end":35,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ec1ac28362d_45":{"id":"8ec1ac28362d_45","__typename":"Paragraph","name":"38f2","text":"Now that we have the three sets of weights, let’s actually obtain the key, query and value representations for every input.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":70,"end":73,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":75,"end":80,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":85,"end":91,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ec1ac28362d_46":{"id":"8ec1ac28362d_46","__typename":"Paragraph","name":"3eb7","text":"Key representation for Input 1:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":0,"end":3,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ec1ac28362d_47":{"id":"8ec1ac28362d_47","__typename":"Paragraph","name":"0368","text":"               [0, 0, 1]\n[1, 0, 1, 0] x [1, 1, 0] = [0, 1, 1]\n               [0, 1, 0]\n               [1, 1, 0]","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ec1ac28362d_48":{"id":"8ec1ac28362d_48","__typename":"Paragraph","name":"4444","text":"Use the same set of weights to get the key representation for Input 2:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":39,"end":42,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ec1ac28362d_49":{"id":"8ec1ac28362d_49","__typename":"Paragraph","name":"3c3b","text":"               [0, 0, 1]\n[0, 2, 0, 2] x [1, 1, 0] = [4, 4, 0]\n               [0, 1, 0]\n               [1, 1, 0]","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ec1ac28362d_50":{"id":"8ec1ac28362d_50","__typename":"Paragraph","name":"036b","text":"Use the same set of weights to get the key representation for Input 3:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":39,"end":42,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ec1ac28362d_51":{"id":"8ec1ac28362d_51","__typename":"Paragraph","name":"e9b1","text":"               [0, 0, 1]\n[1, 1, 1, 1] x [1, 1, 0] = [2, 3, 1]\n               [0, 1, 0]\n               [1, 1, 0]","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ec1ac28362d_52":{"id":"8ec1ac28362d_52","__typename":"Paragraph","name":"bd7e","text":"A faster way is to vectorise the above operations:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ec1ac28362d_53":{"id":"8ec1ac28362d_53","__typename":"Paragraph","name":"9359","text":"               [0, 0, 1]\n[1, 0, 1, 0]   [1, 1, 0]   [0, 1, 1]\n[0, 2, 0, 2] x [0, 1, 0] = [4, 4, 0]\n[1, 1, 1, 1]   [1, 1, 0]   [2, 3, 1]","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ec1ac28362d_54":{"id":"8ec1ac28362d_54","__typename":"Paragraph","name":"b045","text":"Fig. 1.3a: Derive key representations from each input","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*dr6NIaTfTxEWzxB2rc0JWg.gif"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":18,"end":21,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ec1ac28362d_55":{"id":"8ec1ac28362d_55","__typename":"Paragraph","name":"e69c","text":"Let’s do the same to obtain the value representations for every input:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":32,"end":38,"type":"STRONG","href":"","anchorType":"LINK","userId":"","linkMetadata":null}],"dropCapImage":null},"Paragraph:8ec1ac28362d_56":{"id":"8ec1ac28362d_56","__typename":"Paragraph","name":"ab13","text":"               [0, 2, 0]\n[1, 0, 1, 0]   [0, 3, 0]   [1, 2, 3] \n[0, 2, 0, 2] x [1, 0, 3] = [2, 8, 0]\n[1, 1, 1, 1]   [1, 1, 0]   [2, 6, 3]","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ec1ac28362d_57":{"id":"8ec1ac28362d_57","__typename":"Paragraph","name":"98ef","text":"Fig. 1.3b: Derive value representations from each input","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*5kqW7yEwvcC0tjDOW3Ia-A.gif"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":18,"end":23,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ec1ac28362d_58":{"id":"8ec1ac28362d_58","__typename":"Paragraph","name":"b167","text":"and finally the query representations:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":16,"end":21,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ec1ac28362d_59":{"id":"8ec1ac28362d_59","__typename":"Paragraph","name":"531f","text":"               [1, 0, 1]\n[1, 0, 1, 0]   [1, 0, 0]   [1, 0, 2]\n[0, 2, 0, 2] x [0, 0, 1] = [2, 2, 2]\n[1, 1, 1, 1]   [0, 1, 1]   [2, 1, 3]","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ec1ac28362d_60":{"id":"8ec1ac28362d_60","__typename":"Paragraph","name":"e03d","text":"Fig. 1.3c: Derive query representations from each input","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*wO_UqfkWkv3WmGQVHvrMJw.gif"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":18,"end":23,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ec1ac28362d_61":{"id":"8ec1ac28362d_61","__typename":"Paragraph","name":"9180","text":"Notes\nIn practice, a bias vector may be added to the product of matrix multiplication.","type":"BQ","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":0,"end":5,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":0,"end":21,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":32,"end":86,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ec1ac28362d_62":{"id":"8ec1ac28362d_62","__typename":"Paragraph","name":"57fe","text":"Step 4: Calculate attention scores for Input 1","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":0,"end":46,"type":"STRONG","href":"","anchorType":"LINK","userId":"","linkMetadata":null}],"dropCapImage":null},"Paragraph:8ec1ac28362d_63":{"id":"8ec1ac28362d_63","__typename":"Paragraph","name":"1afd","text":"Fig. 1.4: Calculating attention scores (blue) from query 1","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*u27nhUppoWYIGkRDmYFN2A.gif"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ec1ac28362d_64":{"id":"8ec1ac28362d_64","__typename":"Paragraph","name":"2ede","text":"To obtain attention scores, we start off with taking a dot product between Input 1’s query (red) with all keys (orange), including itself. Since there are 3 key representations (because we have 3 inputs), we obtain 3 attention scores (blue).","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":85,"end":91,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":106,"end":111,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":157,"end":161,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":10,"end":26,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ec1ac28362d_65":{"id":"8ec1ac28362d_65","__typename":"Paragraph","name":"1468","text":"            [0, 4, 2]\n[1, 0, 2] x [1, 4, 3] = [2, 4, 4]\n            [1, 0, 1]","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ec1ac28362d_66":{"id":"8ec1ac28362d_66","__typename":"Paragraph","name":"e48a","text":"Notice that we only use the query from Input 1. Later we’ll work on repeating this same step for the other querys.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":28,"end":33,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":107,"end":113,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ec1ac28362d_67":{"id":"8ec1ac28362d_67","__typename":"Paragraph","name":"444a","text":"Note\nThe above operation is known as dot product attention, one of the several score functions. Other score functions include scaled dot product and additive\u002Fconcat.","type":"BQ","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":79,"end":94,"type":"A","href":"https:\u002F\u002Ftowardsdatascience.com\u002Fattn-illustrated-attention-5ec4ad276ee3#ba24","anchorType":"LINK","userId":"","linkMetadata":null},{"__typename":"Markup","start":0,"end":4,"type":"STRONG","href":"","anchorType":"LINK","userId":"","linkMetadata":null},{"__typename":"Markup","start":79,"end":94,"type":"STRONG","href":"","anchorType":"LINK","userId":"","linkMetadata":null},{"__typename":"Markup","start":0,"end":37,"type":"EM","href":"","anchorType":"LINK","userId":"","linkMetadata":null},{"__typename":"Markup","start":58,"end":94,"type":"EM","href":"","anchorType":"LINK","userId":"","linkMetadata":null},{"__typename":"Markup","start":96,"end":126,"type":"EM","href":"","anchorType":"LINK","userId":"","linkMetadata":null},{"__typename":"Markup","start":145,"end":149,"type":"EM","href":"","anchorType":"LINK","userId":"","linkMetadata":null}],"dropCapImage":null},"Paragraph:8ec1ac28362d_68":{"id":"8ec1ac28362d_68","__typename":"Paragraph","name":"7439","text":"Step 5: Calculate softmax","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":0,"end":25,"type":"STRONG","href":"","anchorType":"LINK","userId":"","linkMetadata":null}],"dropCapImage":null},"Paragraph:8ec1ac28362d_69":{"id":"8ec1ac28362d_69","__typename":"Paragraph","name":"8824","text":"Fig. 1.5: Softmax the attention scores (blue)","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*jf__2D8RNCzefwS0TP1Kyg.gif"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ec1ac28362d_70":{"id":"8ec1ac28362d_70","__typename":"Paragraph","name":"0b14","text":"Take the softmax across these attention scores (blue).","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":9,"end":16,"type":"A","href":"https:\u002F\u002Fen.wikipedia.org\u002Fwiki\u002FSoftmax_function","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ec1ac28362d_71":{"id":"8ec1ac28362d_71","__typename":"Paragraph","name":"8f3a","text":"softmax([2, 4, 4]) = [0.0, 0.5, 0.5]","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ec1ac28362d_72":{"id":"8ec1ac28362d_72","__typename":"Paragraph","name":"731f","text":"Note that we round of to 1 decimal place here for readability.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ec1ac28362d_73":{"id":"8ec1ac28362d_73","__typename":"Paragraph","name":"8aa6","text":"Step 6: Multiply scores with values","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":0,"end":35,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ec1ac28362d_74":{"id":"8ec1ac28362d_74","__typename":"Paragraph","name":"d08f","text":"Fig. 1.6: Derive weighted value representation (yellow) from multiply value (purple) and score (blue)","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*9cTaJGgXPbiJ4AOCc6QHyA.gif"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":17,"end":25,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":26,"end":31,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":70,"end":76,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ec1ac28362d_75":{"id":"8ec1ac28362d_75","__typename":"Paragraph","name":"ca19","text":"The softmaxed attention scores for each input (blue) is multiplied with its corresponding value (purple). This results in 3 alignment vectors (yellow). In this tutorial, we’ll refer to them as weighted values.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":90,"end":96,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":193,"end":208,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":124,"end":141,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ec1ac28362d_76":{"id":"8ec1ac28362d_76","__typename":"Paragraph","name":"5ac4","text":"1: 0.0 * [1, 2, 3] = [0.0, 0.0, 0.0]\n2: 0.5 * [2, 8, 0] = [1.0, 4.0, 0.0]\n3: 0.5 * [2, 6, 3] = [1.0, 3.0, 1.5]","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ec1ac28362d_77":{"id":"8ec1ac28362d_77","__typename":"Paragraph","name":"9d4e","text":"Step 7: Sum weighted values to get Output 1","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":0,"end":43,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ec1ac28362d_78":{"id":"8ec1ac28362d_78","__typename":"Paragraph","name":"84e5","text":"Fig. 1.7: Sum all weighted values (yellow) to get Output 1 (dark green)","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*1je5TwhVAwwnIeDFvww3ew.gif"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":18,"end":33,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ec1ac28362d_79":{"id":"8ec1ac28362d_79","__typename":"Paragraph","name":"d1da","text":"Take all the weighted values (yellow) and sum them element-wise:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":13,"end":21,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":22,"end":29,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ec1ac28362d_80":{"id":"8ec1ac28362d_80","__typename":"Paragraph","name":"8227","text":"  [0.0, 0.0, 0.0]\n+ [1.0, 4.0, 0.0]\n+ [1.0, 3.0, 1.5]\n-----------------\n= [2.0, 7.0, 1.5]","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ec1ac28362d_81":{"id":"8ec1ac28362d_81","__typename":"Paragraph","name":"5133","text":"The resulting vector [2.0, 7.0, 1.5] (dark green) is Output 1, which is based on the query representation from Input 1 interacting with all other keys, including itself.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":85,"end":118,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ec1ac28362d_82":{"id":"8ec1ac28362d_82","__typename":"Paragraph","name":"c14b","text":"Step 8: Repeat for Input 2 & Input 3","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":0,"end":36,"type":"STRONG","href":"","anchorType":"LINK","userId":"","linkMetadata":null}],"dropCapImage":null},"Paragraph:8ec1ac28362d_83":{"id":"8ec1ac28362d_83","__typename":"Paragraph","name":"7a43","text":"Now that we’re done with Output 1, we repeat Steps 4 to 7 for Output 2 and Output 3. I trust that I can leave you to work out the operations yourself 👍🏼.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ec1ac28362d_84":{"id":"8ec1ac28362d_84","__typename":"Paragraph","name":"33cc","text":"Fig. 1.8: Repeat previous steps for Input 2 & Input 3","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*G8thyDVqeD8WHim_QzjvFg.gif"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ec1ac28362d_85":{"id":"8ec1ac28362d_85","__typename":"Paragraph","name":"f2f3","text":"Notes\nThe dimension of query and key must always be the same because of the dot product score function. However, the dimension of value may be different from query and key. The resulting output will consequently follow the dimension of value.","type":"BQ","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":0,"end":6,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":23,"end":28,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":33,"end":36,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":130,"end":136,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":158,"end":163,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":168,"end":171,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":236,"end":241,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":0,"end":242,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ec1ac28362d_86":{"id":"8ec1ac28362d_86","__typename":"Paragraph","name":"8481","text":"2. Code","type":"H4","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ec1ac28362d_87":{"id":"8ec1ac28362d_87","__typename":"Paragraph","name":"f24e","text":"Here is the code in PyTorch 🤗, a popular deep learning framework in Python. To enjoy the APIs for @ operator, .T and None indexing in the following code snippets, make sure you’re on Python≥3.6 and PyTorch 1.3.1. Just follow along and copy paste these in a Python\u002FIPython REPL or Jupyter Notebook.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":99,"end":100,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":111,"end":113,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":118,"end":122,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":20,"end":27,"type":"A","href":"https:\u002F\u002Fpytorch.org\u002F","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","start":118,"end":122,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ec1ac28362d_88":{"id":"8ec1ac28362d_88","__typename":"Paragraph","name":"8ff4","text":"Step 1: Prepare inputs","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":0,"end":22,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ec1ac28362d_89":{"id":"8ec1ac28362d_89","__typename":"Paragraph","name":"7d9e","text":"","type":"IFRAME","href":null,"layout":"INSET_CENTER","metadata":null,"hasDropCap":null,"iframe":{"__typename":"Iframe","mediaResource":{"__ref":"MediaResource:112c29c58877b90b23fbcb56d07be715"}},"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ec1ac28362d_90":{"id":"8ec1ac28362d_90","__typename":"Paragraph","name":"313d","text":"Step 2: Initialise weights","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":0,"end":26,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ec1ac28362d_91":{"id":"8ec1ac28362d_91","__typename":"Paragraph","name":"e86a","text":"","type":"IFRAME","href":null,"layout":"INSET_CENTER","metadata":null,"hasDropCap":null,"iframe":{"__typename":"Iframe","mediaResource":{"__ref":"MediaResource:f17a83e9432698502e45e31e578d207e"}},"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ec1ac28362d_92":{"id":"8ec1ac28362d_92","__typename":"Paragraph","name":"5c4a","text":"Step 3: Derive key, query and value","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":0,"end":35,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ec1ac28362d_93":{"id":"8ec1ac28362d_93","__typename":"Paragraph","name":"e5f7","text":"","type":"IFRAME","href":null,"layout":"INSET_CENTER","metadata":null,"hasDropCap":null,"iframe":{"__typename":"Iframe","mediaResource":{"__ref":"MediaResource:fefd23ecf80aee21b3bf0d6ff7adfe4b"}},"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ec1ac28362d_94":{"id":"8ec1ac28362d_94","__typename":"Paragraph","name":"442b","text":"Step 4: Calculate attention scores","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":0,"end":34,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ec1ac28362d_95":{"id":"8ec1ac28362d_95","__typename":"Paragraph","name":"e259","text":"","type":"IFRAME","href":null,"layout":"INSET_CENTER","metadata":null,"hasDropCap":null,"iframe":{"__typename":"Iframe","mediaResource":{"__ref":"MediaResource:e4853d88a87d1ccde41db69dbbe03be1"}},"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ec1ac28362d_96":{"id":"8ec1ac28362d_96","__typename":"Paragraph","name":"a04c","text":"Step 5: Calculate softmax","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":0,"end":25,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ec1ac28362d_97":{"id":"8ec1ac28362d_97","__typename":"Paragraph","name":"2f7f","text":"","type":"IFRAME","href":null,"layout":"INSET_CENTER","metadata":null,"hasDropCap":null,"iframe":{"__typename":"Iframe","mediaResource":{"__ref":"MediaResource:b1c6f389118337b9653981419a839880"}},"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ec1ac28362d_98":{"id":"8ec1ac28362d_98","__typename":"Paragraph","name":"686c","text":"Step 6: Multiply scores with values","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":0,"end":35,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ec1ac28362d_99":{"id":"8ec1ac28362d_99","__typename":"Paragraph","name":"b193","text":"","type":"IFRAME","href":null,"layout":"INSET_CENTER","metadata":null,"hasDropCap":null,"iframe":{"__typename":"Iframe","mediaResource":{"__ref":"MediaResource:93152f4e5ef330f8e02fdd9a235d270d"}},"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ec1ac28362d_100":{"id":"8ec1ac28362d_100","__typename":"Paragraph","name":"1110","text":"Step 7: Sum weighted values","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":0,"end":27,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ec1ac28362d_101":{"id":"8ec1ac28362d_101","__typename":"Paragraph","name":"3293","text":"","type":"IFRAME","href":null,"layout":"INSET_CENTER","metadata":null,"hasDropCap":null,"iframe":{"__typename":"Iframe","mediaResource":{"__ref":"MediaResource:8c42fcb1d2c29c1c5bd6a7c8c000cf4b"}},"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ec1ac28362d_102":{"id":"8ec1ac28362d_102","__typename":"Paragraph","name":"5256","text":"Note\nPyTorch has provided an API for this called nn.MultiheadAttention. However, this API requires that you feed in key, query and value PyTorch tensors. Moreover, the outputs of this module undergo a linear transformation.","type":"BQ","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":49,"end":70,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":49,"end":70,"type":"A","href":"https:\u002F\u002Fpytorch.org\u002Fdocs\u002Fmaster\u002Fnn.html#multiheadattention","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","start":0,"end":4,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":0,"end":223,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ec1ac28362d_103":{"id":"8ec1ac28362d_103","__typename":"Paragraph","name":"faae","text":"3. Extending to Transformers","type":"H4","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ec1ac28362d_104":{"id":"8ec1ac28362d_104","__typename":"Paragraph","name":"9163","text":"So, where do we go from here? Transformers! Indeed we live in exciting times of deep learning research and high compute resources. Transformer is the incarnation from Attention Is All You Need, orginally born to perform neural machine translation. Researchers picked up from here, reassembling, cutting, adding and extending the parts, and extend its usage to more language tasks.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":167,"end":192,"type":"A","href":"#9abf","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","start":220,"end":246,"type":"A","href":"https:\u002F\u002Fen.wikipedia.org\u002Fwiki\u002FNeural_machine_translation","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ec1ac28362d_105":{"id":"8ec1ac28362d_105","__typename":"Paragraph","name":"ab0e","text":"Here I will briefly mention how we can extend self-attention to a Transformer architecture.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ec1ac28362d_106":{"id":"8ec1ac28362d_106","__typename":"Paragraph","name":"9183","text":"Within the self-attention module:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ec1ac28362d_107":{"id":"8ec1ac28362d_107","__typename":"Paragraph","name":"bfec","text":"Dimension","type":"ULI","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ec1ac28362d_108":{"id":"8ec1ac28362d_108","__typename":"Paragraph","name":"915a","text":"Bias","type":"ULI","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ec1ac28362d_109":{"id":"8ec1ac28362d_109","__typename":"Paragraph","name":"5743","text":"Inputs to the self-attention module:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ec1ac28362d_110":{"id":"8ec1ac28362d_110","__typename":"Paragraph","name":"d096","text":"Embedding module","type":"ULI","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ec1ac28362d_111":{"id":"8ec1ac28362d_111","__typename":"Paragraph","name":"a754","text":"Positional encoding","type":"ULI","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ec1ac28362d_112":{"id":"8ec1ac28362d_112","__typename":"Paragraph","name":"60ce","text":"Truncating","type":"ULI","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ec1ac28362d_113":{"id":"8ec1ac28362d_113","__typename":"Paragraph","name":"79ef","text":"Masking","type":"ULI","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ec1ac28362d_114":{"id":"8ec1ac28362d_114","__typename":"Paragraph","name":"c16c","text":"Adding more self-attention modules:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ec1ac28362d_115":{"id":"8ec1ac28362d_115","__typename":"Paragraph","name":"26ec","text":"Multihead","type":"ULI","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ec1ac28362d_116":{"id":"8ec1ac28362d_116","__typename":"Paragraph","name":"7c37","text":"Layer stacking","type":"ULI","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ec1ac28362d_117":{"id":"8ec1ac28362d_117","__typename":"Paragraph","name":"0a2c","text":"Modules between self-attention modules:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ec1ac28362d_118":{"id":"8ec1ac28362d_118","__typename":"Paragraph","name":"15c1","text":"Linear transformations","type":"ULI","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ec1ac28362d_119":{"id":"8ec1ac28362d_119","__typename":"Paragraph","name":"31a5","text":"LayerNorm","type":"ULI","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ec1ac28362d_120":{"id":"8ec1ac28362d_120","__typename":"Paragraph","name":"3ef7","text":"That’s all folks! Hope you find the content easy to digest. Is there something that you think I should add or elaborate further in this article? Do drop a comment! Also, do check out an illustration I created for attention below","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ec1ac28362d_121":{"id":"8ec1ac28362d_121","__typename":"Paragraph","name":"9abf","text":"References","type":"H4","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ec1ac28362d_122":{"id":"8ec1ac28362d_122","__typename":"Paragraph","name":"214a","text":"Attention Is All You Need (arxiv.org)","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":0,"end":25,"type":"A","href":"https:\u002F\u002Farxiv.org\u002Fabs\u002F1706.03762","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ec1ac28362d_123":{"id":"8ec1ac28362d_123","__typename":"Paragraph","name":"0400","text":"The Illustrated Transformer (jalammar.github.io)","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":0,"end":27,"type":"A","href":"https:\u002F\u002Fjalammar.github.io\u002Fillustrated-transformer\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ec1ac28362d_124":{"id":"8ec1ac28362d_124","__typename":"Paragraph","name":"51ff","text":"Related Articles","type":"H4","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ec1ac28362d_125":{"id":"8ec1ac28362d_125","__typename":"Paragraph","name":"e122","text":"Attn: Illustrated Attention (towardsdatascience.com)","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":0,"end":27,"type":"A","href":"https:\u002F\u002Ftowardsdatascience.com\u002Fattn-illustrated-attention-5ec4ad276ee3","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ec1ac28362d_126":{"id":"8ec1ac28362d_126","__typename":"Paragraph","name":"9223","text":"Credits","type":"H4","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ec1ac28362d_127":{"id":"8ec1ac28362d_127","__typename":"Paragraph","name":"2e2a","text":"Special thanks to Xin Jie, Serene, Ren Jie, Kevin and Wei Yih for ideas, suggestions and corrections to this article.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ec1ac28362d_128":{"id":"8ec1ac28362d_128","__typename":"Paragraph","name":"4d00","text":"Follow me on Twitter @remykarem for digested articles and other tweets on AI, ML, Deep Learning and Python.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":21,"end":31,"type":"A","href":"https:\u002F\u002Ftwitter.com\u002Fremykarem","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","start":0,"end":107,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"ImageMetadata:1*_92bnsMJy8Bl539G4v93yg.gif":{"id":"1*_92bnsMJy8Bl539G4v93yg.gif","__typename":"ImageMetadata","originalHeight":949,"originalWidth":1578,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*hmvdDXrxhJsGhOQClQdkBA.png":{"id":"1*hmvdDXrxhJsGhOQClQdkBA.png","__typename":"ImageMetadata","originalHeight":949,"originalWidth":1578,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*VPvXYMGjv0kRuoYqgFvCag.gif":{"id":"1*VPvXYMGjv0kRuoYqgFvCag.gif","__typename":"ImageMetadata","originalHeight":1036,"originalWidth":1580,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*dr6NIaTfTxEWzxB2rc0JWg.gif":{"id":"1*dr6NIaTfTxEWzxB2rc0JWg.gif","__typename":"ImageMetadata","originalHeight":1036,"originalWidth":1580,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*5kqW7yEwvcC0tjDOW3Ia-A.gif":{"id":"1*5kqW7yEwvcC0tjDOW3Ia-A.gif","__typename":"ImageMetadata","originalHeight":1036,"originalWidth":1580,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*wO_UqfkWkv3WmGQVHvrMJw.gif":{"id":"1*wO_UqfkWkv3WmGQVHvrMJw.gif","__typename":"ImageMetadata","originalHeight":1036,"originalWidth":1580,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*u27nhUppoWYIGkRDmYFN2A.gif":{"id":"1*u27nhUppoWYIGkRDmYFN2A.gif","__typename":"ImageMetadata","originalHeight":949,"originalWidth":1578,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*jf__2D8RNCzefwS0TP1Kyg.gif":{"id":"1*jf__2D8RNCzefwS0TP1Kyg.gif","__typename":"ImageMetadata","originalHeight":949,"originalWidth":1578,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*9cTaJGgXPbiJ4AOCc6QHyA.gif":{"id":"1*9cTaJGgXPbiJ4AOCc6QHyA.gif","__typename":"ImageMetadata","originalHeight":949,"originalWidth":1578,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*1je5TwhVAwwnIeDFvww3ew.gif":{"id":"1*1je5TwhVAwwnIeDFvww3ew.gif","__typename":"ImageMetadata","originalHeight":949,"originalWidth":1578,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*G8thyDVqeD8WHim_QzjvFg.gif":{"id":"1*G8thyDVqeD8WHim_QzjvFg.gif","__typename":"ImageMetadata","originalHeight":949,"originalWidth":1578,"focusPercentX":null,"focusPercentY":null,"alt":null},"MediaResource:112c29c58877b90b23fbcb56d07be715":{"id":"112c29c58877b90b23fbcb56d07be715","__typename":"MediaResource","iframeSrc":"","iframeHeight":0,"iframeWidth":0,"title":"Prepare inputs"},"MediaResource:f17a83e9432698502e45e31e578d207e":{"id":"f17a83e9432698502e45e31e578d207e","__typename":"MediaResource","iframeSrc":"","iframeHeight":0,"iframeWidth":0,"title":"Generate key, query and value"},"MediaResource:fefd23ecf80aee21b3bf0d6ff7adfe4b":{"id":"fefd23ecf80aee21b3bf0d6ff7adfe4b","__typename":"MediaResource","iframeSrc":"","iframeHeight":0,"iframeWidth":0,"title":"selfattn_multiply_weights.py"},"MediaResource:e4853d88a87d1ccde41db69dbbe03be1":{"id":"e4853d88a87d1ccde41db69dbbe03be1","__typename":"MediaResource","iframeSrc":"","iframeHeight":0,"iframeWidth":0,"title":"Calculate attention scores"},"MediaResource:b1c6f389118337b9653981419a839880":{"id":"b1c6f389118337b9653981419a839880","__typename":"MediaResource","iframeSrc":"","iframeHeight":0,"iframeWidth":0,"title":"Calculate softmax of attention scores"},"MediaResource:93152f4e5ef330f8e02fdd9a235d270d":{"id":"93152f4e5ef330f8e02fdd9a235d270d","__typename":"MediaResource","iframeSrc":"","iframeHeight":0,"iframeWidth":0,"title":"Multiply with value"},"MediaResource:8c42fcb1d2c29c1c5bd6a7c8c000cf4b":{"id":"8c42fcb1d2c29c1c5bd6a7c8c000cf4b","__typename":"MediaResource","iframeSrc":"","iframeHeight":0,"iframeWidth":0,"title":"Aggregate by adding"},"User:895063a310f4":{"id":"895063a310f4","__typename":"User","name":"Ludovic Benistant"},"NewsletterV3:307a18475417":{"id":"307a18475417","__typename":"NewsletterV3","slug":"c2958659896a","name":"c2958659896a","description":"","isSubscribed":false,"type":"NEWSLETTER_TYPE_AUTHOR","user":{"__ref":"User:c2958659896a"},"collection":null,"subscribersCount":1},"Tag:machine-learning":{"id":"machine-learning","__typename":"Tag","displayTitle":"Machine Learning","normalizedTagSlug":""},"Tag:towards-data-science":{"id":"towards-data-science","__typename":"Tag","displayTitle":"Towards Data Science","normalizedTagSlug":""},"Tag:transformers":{"id":"transformers","__typename":"Tag","displayTitle":"Transformers","normalizedTagSlug":""},"Tag:attention":{"id":"attention","__typename":"Tag","displayTitle":"Attention","normalizedTagSlug":""},"Tag:nlp":{"id":"nlp","__typename":"Tag","displayTitle":"NLP","normalizedTagSlug":""},"ImageMetadata:1*GBJnNA6UicklMlFvLHsEMg.jpeg":{"id":"1*GBJnNA6UicklMlFvLHsEMg.jpeg","__typename":"ImageMetadata","focusPercentX":null,"focusPercentY":null},"User:7f7b5d730c84":{"id":"7f7b5d730c84","__typename":"User","name":"Javier Ideami","username":"ideami","bio":"A multidisciplinary engineer, researcher, creative director, artist and entrepreneur, from augmented reality to deep learning, filmmaking, 3D and beyond.","isFollowing":null,"imageId":"1*vJeao0WwYMWImjodsQnZ_w.jpeg","mediumMemberAt":1615179437060,"customDomainState":null,"hasSubdomain":false},"Post:d214d222c4cb":{"id":"d214d222c4cb","__typename":"Post","title":"Towards the end of deep learning and the beginning of AGI","mediumUrl":"https:\u002F\u002Ftowardsdatascience.com\u002Ftowards-the-end-of-deep-learning-and-the-beginning-of-agi-d214d222c4cb","previewImage":{"__ref":"ImageMetadata:1*GBJnNA6UicklMlFvLHsEMg.jpeg"},"isPublished":true,"firstPublishedAt":1615984275605,"readingTime":13.316981132075473,"statusForCollection":"APPROVED","isLocked":true,"isShortform":false,"visibility":"LOCKED","collection":{"__ref":"Collection:7f60cf5620c9"},"creator":{"__ref":"User:7f7b5d730c84"},"previewContent":{"__typename":"PreviewContent","isFullContent":false}},"ImageMetadata:1*OfS9n8O6FQO6pnu1Wj_ksg.jpeg":{"id":"1*OfS9n8O6FQO6pnu1Wj_ksg.jpeg","__typename":"ImageMetadata","focusPercentX":null,"focusPercentY":null},"User:b9d77a4ca1d1":{"id":"b9d77a4ca1d1","__typename":"User","name":"James Briggs","username":"jamescalam","bio":"Data scientist learning and writing about everything.","isFollowing":null,"imageId":"1*EaHS1Q73oTDUDxrkNKGJ8A.jpeg","mediumMemberAt":1594744211000,"customDomainState":{"__typename":"CustomDomainState","live":{"__typename":"CustomDomain","domain":"jamescalam.medium.com"}},"hasSubdomain":true},"Post:d0caf7b2bfd3":{"id":"d0caf7b2bfd3","__typename":"Post","title":"Switch-Case Statements Are Coming to Python","mediumUrl":"https:\u002F\u002Ftowardsdatascience.com\u002Fswitch-case-statements-are-coming-to-python-d0caf7b2bfd3","previewImage":{"__ref":"ImageMetadata:1*OfS9n8O6FQO6pnu1Wj_ksg.jpeg"},"isPublished":true,"firstPublishedAt":1616172358842,"readingTime":4.376729559748427,"statusForCollection":"APPROVED","isLocked":true,"isShortform":false,"visibility":"LOCKED","collection":{"__ref":"Collection:7f60cf5620c9"},"creator":{"__ref":"User:b9d77a4ca1d1"},"previewContent":{"__typename":"PreviewContent","isFullContent":false}},"ImageMetadata:0*WMJ5Jw1FsCbLpYk7":{"id":"0*WMJ5Jw1FsCbLpYk7","__typename":"ImageMetadata","focusPercentX":null,"focusPercentY":null},"User:7938431b336a":{"id":"7938431b336a","__typename":"User","name":"Sara A. Metwalli","username":"saraametwalli","bio":"Ph.D. student working on Quantum Computing. Traveler, writing lover, science enthusiast, and CS instructor. Get in touch with me bit.ly\u002F2CvFAw6","isFollowing":null,"imageId":"1*BY6sCRisdVuk5GyPL_q7rw.jpeg","mediumMemberAt":1575015661000,"customDomainState":{"__typename":"CustomDomainState","live":{"__typename":"CustomDomain","domain":"saraametwalli.medium.com"}},"hasSubdomain":true},"Post:1aa02eba35":{"id":"1aa02eba35","__typename":"Post","title":"5 Python Debugging Tools That Are Better Than “Print”","mediumUrl":"https:\u002F\u002Ftowardsdatascience.com\u002F5-python-debugging-tools-that-are-better-than-print-1aa02eba35","previewImage":{"__ref":"ImageMetadata:0*WMJ5Jw1FsCbLpYk7"},"isPublished":true,"firstPublishedAt":1616505967105,"readingTime":5.766037735849057,"statusForCollection":"APPROVED","isLocked":true,"isShortform":false,"visibility":"LOCKED","collection":{"__ref":"Collection:7f60cf5620c9"},"creator":{"__ref":"User:7938431b336a"},"previewContent":{"__typename":"PreviewContent","isFullContent":false}},"ImageMetadata:1*n97707zKau5I5libJWl_XQ.png":{"id":"1*n97707zKau5I5libJWl_XQ.png","__typename":"ImageMetadata","focusPercentX":null,"focusPercentY":null},"User:b15db3da5667":{"id":"b15db3da5667","__typename":"User","name":"Mahmoud Harmouch","username":"mahmoudharmouch","bio":"Computer programmer\u002Fengineer, writing lover, interested in Programming, Data Science, Computer Vision…https:\u002F\u002Fwww.linkedin.com\u002Fin\u002Fmahmoud-harmouch\u002F","isFollowing":null,"imageId":"1*1jlTtuikkMmgcjxvh25EUg.png","mediumMemberAt":1590348874000,"customDomainState":{"__typename":"CustomDomainState","live":{"__typename":"CustomDomain","domain":"mahmoudharmouch.medium.com"}},"hasSubdomain":true},"Post:3eb914d2681":{"id":"3eb914d2681","__typename":"Post","title":"17 types of similarity and dissimilarity measures used in data science.","mediumUrl":"https:\u002F\u002Ftowardsdatascience.com\u002F17-types-of-similarity-and-dissimilarity-measures-used-in-data-science-3eb914d2681","previewImage":{"__ref":"ImageMetadata:1*n97707zKau5I5libJWl_XQ.png"},"isPublished":true,"firstPublishedAt":1615674698463,"readingTime":24.46320754716981,"statusForCollection":"APPROVED","isLocked":false,"isShortform":false,"visibility":"PUBLIC","collection":{"__ref":"Collection:7f60cf5620c9"},"creator":{"__ref":"User:b15db3da5667"},"previewContent":{"__typename":"PreviewContent","isFullContent":false}},"ImageMetadata:0*8_mAMYWGcQJyRUxS":{"id":"0*8_mAMYWGcQJyRUxS","__typename":"ImageMetadata","focusPercentX":null,"focusPercentY":null},"User:58bd20ab66d4":{"id":"58bd20ab66d4","__typename":"User","name":"Luay Matalka","username":"lmatalka90","bio":"A Data Scientist with a passion for teaching.","isFollowing":null,"imageId":"1*APp1aFV46LZEH0J0z5v9vw.png","mediumMemberAt":0,"customDomainState":null,"hasSubdomain":false},"Post:7c36da49f884":{"id":"7c36da49f884","__typename":"Post","title":"Two Cool Functions To Know in Python","mediumUrl":"https:\u002F\u002Ftowardsdatascience.com\u002Ftwo-cool-functions-to-know-in-python-7c36da49f884","previewImage":{"__ref":"ImageMetadata:0*8_mAMYWGcQJyRUxS"},"isPublished":true,"firstPublishedAt":1616259688856,"readingTime":3.261320754716981,"statusForCollection":"APPROVED","isLocked":true,"isShortform":false,"visibility":"LOCKED","collection":{"__ref":"Collection:7f60cf5620c9"},"creator":{"__ref":"User:58bd20ab66d4"},"previewContent":{"__typename":"PreviewContent","isFullContent":false}},"ImageMetadata:1*4-VrCeuHwnnOd-j-pKT4xw.jpeg":{"id":"1*4-VrCeuHwnnOd-j-pKT4xw.jpeg","__typename":"ImageMetadata","focusPercentX":null,"focusPercentY":null},"User:6b00d9d9f8df":{"id":"6b00d9d9f8df","__typename":"User","name":"Ismael Araujo","username":"ismaelaraujo","bio":"Data Scientist \u002F\u002F Machine Learning Engineer \u002F\u002F Based in NYC \u002F\u002F Astrophysics Enthusiast \u002F\u002F https:\u002F\u002Fwww.linkedin.com\u002Fin\u002Fismael-araujo\u002F","isFollowing":null,"imageId":"1*RvjXQFQDj0ipSsk28X-L8g.jpeg","mediumMemberAt":0,"customDomainState":{"__typename":"CustomDomainState","live":{"__typename":"CustomDomain","domain":"ismaelaraujo.medium.com"}},"hasSubdomain":true},"Post:d0f94a537e52":{"id":"d0f94a537e52","__typename":"Post","title":"How to Run 30 Machine Learning Models with 2 Lines of Code","mediumUrl":"https:\u002F\u002Ftowardsdatascience.com\u002Fhow-to-run-30-machine-learning-models-with-2-lines-of-code-d0f94a537e52","previewImage":{"__ref":"ImageMetadata:1*4-VrCeuHwnnOd-j-pKT4xw.jpeg"},"isPublished":true,"firstPublishedAt":1616175084617,"readingTime":3.8773584905660377,"statusForCollection":"APPROVED","isLocked":true,"isShortform":false,"visibility":"LOCKED","collection":{"__ref":"Collection:7f60cf5620c9"},"creator":{"__ref":"User:6b00d9d9f8df"},"previewContent":{"__typename":"PreviewContent","isFullContent":false}},"ImageMetadata:1*ffESrGTkAoz4f6JNwalksg.jpeg":{"id":"1*ffESrGTkAoz4f6JNwalksg.jpeg","__typename":"ImageMetadata","focusPercentX":null,"focusPercentY":null},"User:a8a1cc2db19f":{"id":"a8a1cc2db19f","__typename":"User","name":"Christopher Zita","username":"christopherzita","bio":"Data Scientist | I Do Dumb and Cool Things with Code| Proud Canadian | pages.christopherzita.com\u002Fclean-code-z","isFollowing":null,"imageId":"1*mXZ4xwbA6vmgvG3MBr4OjA.jpeg","mediumMemberAt":1578622385627,"customDomainState":{"__typename":"CustomDomainState","live":{"__typename":"CustomDomain","domain":"christopherzita.medium.com"}},"hasSubdomain":true},"Post:c634fd5dcbd0":{"id":"c634fd5dcbd0","__typename":"Post","title":"Scikit-Learn Cheat Sheet (2021), Python for Data Science","mediumUrl":"https:\u002F\u002Ftowardsdatascience.com\u002Fscikit-learn-cheat-sheet-2021-python-for-data-science-c634fd5dcbd0","previewImage":{"__ref":"ImageMetadata:1*ffESrGTkAoz4f6JNwalksg.jpeg"},"isPublished":true,"firstPublishedAt":1616518318607,"readingTime":4.132075471698113,"statusForCollection":"APPROVED","isLocked":true,"isShortform":false,"visibility":"LOCKED","collection":{"__ref":"Collection:7f60cf5620c9"},"creator":{"__ref":"User:a8a1cc2db19f"},"previewContent":{"__typename":"PreviewContent","isFullContent":false}},"ImageMetadata:1*KbGLNRZLx0j624cjCMn49g.jpeg":{"id":"1*KbGLNRZLx0j624cjCMn49g.jpeg","__typename":"ImageMetadata","focusPercentX":null,"focusPercentY":null},"User:b8176fabf308":{"id":"b8176fabf308","__typename":"User","name":"Christopher Tao","username":"qiuyujx","bio":"Machine Learning Engineer@AEMO | Cloud Solution Architect | Data Engineer | Data Scientist | PhD of Computer Science","isFollowing":null,"imageId":"1*aL2isee1E3zr8mzSXRiASA.png","mediumMemberAt":1566457200000,"customDomainState":null,"hasSubdomain":false},"Post:68bbd000e513":{"id":"68bbd000e513","__typename":"Post","title":"“Find the Difference” in Python","mediumUrl":"https:\u002F\u002Ftowardsdatascience.com\u002Ffind-the-difference-in-python-68bbd000e513","previewImage":{"__ref":"ImageMetadata:1*KbGLNRZLx0j624cjCMn49g.jpeg"},"isPublished":true,"firstPublishedAt":1616346724812,"readingTime":7.000943396226415,"statusForCollection":"APPROVED","isLocked":true,"isShortform":false,"visibility":"LOCKED","collection":{"__ref":"Collection:7f60cf5620c9"},"creator":{"__ref":"User:b8176fabf308"},"previewContent":{"__typename":"PreviewContent","isFullContent":false}},"Post:2d627e33b20a":{"id":"2d627e33b20a","__typename":"Post","canonicalUrl":"","collection":{"__ref":"Collection:7f60cf5620c9"},"content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\",\"sk\":null}})":{"__typename":"PostContent","isLockedPreviewOnly":false,"validatedShareKey":"","isCacheableContent":false,"bodyModel":{"__typename":"RichText","paragraphs":[{"__ref":"Paragraph:8ec1ac28362d_0"},{"__ref":"Paragraph:8ec1ac28362d_1"},{"__ref":"Paragraph:8ec1ac28362d_2"},{"__ref":"Paragraph:8ec1ac28362d_3"},{"__ref":"Paragraph:8ec1ac28362d_4"},{"__ref":"Paragraph:8ec1ac28362d_5"},{"__ref":"Paragraph:8ec1ac28362d_6"},{"__ref":"Paragraph:8ec1ac28362d_7"},{"__ref":"Paragraph:8ec1ac28362d_8"},{"__ref":"Paragraph:8ec1ac28362d_9"},{"__ref":"Paragraph:8ec1ac28362d_10"},{"__ref":"Paragraph:8ec1ac28362d_11"},{"__ref":"Paragraph:8ec1ac28362d_12"},{"__ref":"Paragraph:8ec1ac28362d_13"},{"__ref":"Paragraph:8ec1ac28362d_14"},{"__ref":"Paragraph:8ec1ac28362d_15"},{"__ref":"Paragraph:8ec1ac28362d_16"},{"__ref":"Paragraph:8ec1ac28362d_17"},{"__ref":"Paragraph:8ec1ac28362d_18"},{"__ref":"Paragraph:8ec1ac28362d_19"},{"__ref":"Paragraph:8ec1ac28362d_20"},{"__ref":"Paragraph:8ec1ac28362d_21"},{"__ref":"Paragraph:8ec1ac28362d_22"},{"__ref":"Paragraph:8ec1ac28362d_23"},{"__ref":"Paragraph:8ec1ac28362d_24"},{"__ref":"Paragraph:8ec1ac28362d_25"},{"__ref":"Paragraph:8ec1ac28362d_26"},{"__ref":"Paragraph:8ec1ac28362d_27"},{"__ref":"Paragraph:8ec1ac28362d_28"},{"__ref":"Paragraph:8ec1ac28362d_29"},{"__ref":"Paragraph:8ec1ac28362d_30"},{"__ref":"Paragraph:8ec1ac28362d_31"},{"__ref":"Paragraph:8ec1ac28362d_32"},{"__ref":"Paragraph:8ec1ac28362d_33"},{"__ref":"Paragraph:8ec1ac28362d_34"},{"__ref":"Paragraph:8ec1ac28362d_35"},{"__ref":"Paragraph:8ec1ac28362d_36"},{"__ref":"Paragraph:8ec1ac28362d_37"},{"__ref":"Paragraph:8ec1ac28362d_38"},{"__ref":"Paragraph:8ec1ac28362d_39"},{"__ref":"Paragraph:8ec1ac28362d_40"},{"__ref":"Paragraph:8ec1ac28362d_41"},{"__ref":"Paragraph:8ec1ac28362d_42"},{"__ref":"Paragraph:8ec1ac28362d_43"},{"__ref":"Paragraph:8ec1ac28362d_44"},{"__ref":"Paragraph:8ec1ac28362d_45"},{"__ref":"Paragraph:8ec1ac28362d_46"},{"__ref":"Paragraph:8ec1ac28362d_47"},{"__ref":"Paragraph:8ec1ac28362d_48"},{"__ref":"Paragraph:8ec1ac28362d_49"},{"__ref":"Paragraph:8ec1ac28362d_50"},{"__ref":"Paragraph:8ec1ac28362d_51"},{"__ref":"Paragraph:8ec1ac28362d_52"},{"__ref":"Paragraph:8ec1ac28362d_53"},{"__ref":"Paragraph:8ec1ac28362d_54"},{"__ref":"Paragraph:8ec1ac28362d_55"},{"__ref":"Paragraph:8ec1ac28362d_56"},{"__ref":"Paragraph:8ec1ac28362d_57"},{"__ref":"Paragraph:8ec1ac28362d_58"},{"__ref":"Paragraph:8ec1ac28362d_59"},{"__ref":"Paragraph:8ec1ac28362d_60"},{"__ref":"Paragraph:8ec1ac28362d_61"},{"__ref":"Paragraph:8ec1ac28362d_62"},{"__ref":"Paragraph:8ec1ac28362d_63"},{"__ref":"Paragraph:8ec1ac28362d_64"},{"__ref":"Paragraph:8ec1ac28362d_65"},{"__ref":"Paragraph:8ec1ac28362d_66"},{"__ref":"Paragraph:8ec1ac28362d_67"},{"__ref":"Paragraph:8ec1ac28362d_68"},{"__ref":"Paragraph:8ec1ac28362d_69"},{"__ref":"Paragraph:8ec1ac28362d_70"},{"__ref":"Paragraph:8ec1ac28362d_71"},{"__ref":"Paragraph:8ec1ac28362d_72"},{"__ref":"Paragraph:8ec1ac28362d_73"},{"__ref":"Paragraph:8ec1ac28362d_74"},{"__ref":"Paragraph:8ec1ac28362d_75"},{"__ref":"Paragraph:8ec1ac28362d_76"},{"__ref":"Paragraph:8ec1ac28362d_77"},{"__ref":"Paragraph:8ec1ac28362d_78"},{"__ref":"Paragraph:8ec1ac28362d_79"},{"__ref":"Paragraph:8ec1ac28362d_80"},{"__ref":"Paragraph:8ec1ac28362d_81"},{"__ref":"Paragraph:8ec1ac28362d_82"},{"__ref":"Paragraph:8ec1ac28362d_83"},{"__ref":"Paragraph:8ec1ac28362d_84"},{"__ref":"Paragraph:8ec1ac28362d_85"},{"__ref":"Paragraph:8ec1ac28362d_86"},{"__ref":"Paragraph:8ec1ac28362d_87"},{"__ref":"Paragraph:8ec1ac28362d_88"},{"__ref":"Paragraph:8ec1ac28362d_89"},{"__ref":"Paragraph:8ec1ac28362d_90"},{"__ref":"Paragraph:8ec1ac28362d_91"},{"__ref":"Paragraph:8ec1ac28362d_92"},{"__ref":"Paragraph:8ec1ac28362d_93"},{"__ref":"Paragraph:8ec1ac28362d_94"},{"__ref":"Paragraph:8ec1ac28362d_95"},{"__ref":"Paragraph:8ec1ac28362d_96"},{"__ref":"Paragraph:8ec1ac28362d_97"},{"__ref":"Paragraph:8ec1ac28362d_98"},{"__ref":"Paragraph:8ec1ac28362d_99"},{"__ref":"Paragraph:8ec1ac28362d_100"},{"__ref":"Paragraph:8ec1ac28362d_101"},{"__ref":"Paragraph:8ec1ac28362d_102"},{"__ref":"Paragraph:8ec1ac28362d_103"},{"__ref":"Paragraph:8ec1ac28362d_104"},{"__ref":"Paragraph:8ec1ac28362d_105"},{"__ref":"Paragraph:8ec1ac28362d_106"},{"__ref":"Paragraph:8ec1ac28362d_107"},{"__ref":"Paragraph:8ec1ac28362d_108"},{"__ref":"Paragraph:8ec1ac28362d_109"},{"__ref":"Paragraph:8ec1ac28362d_110"},{"__ref":"Paragraph:8ec1ac28362d_111"},{"__ref":"Paragraph:8ec1ac28362d_112"},{"__ref":"Paragraph:8ec1ac28362d_113"},{"__ref":"Paragraph:8ec1ac28362d_114"},{"__ref":"Paragraph:8ec1ac28362d_115"},{"__ref":"Paragraph:8ec1ac28362d_116"},{"__ref":"Paragraph:8ec1ac28362d_117"},{"__ref":"Paragraph:8ec1ac28362d_118"},{"__ref":"Paragraph:8ec1ac28362d_119"},{"__ref":"Paragraph:8ec1ac28362d_120"},{"__ref":"Paragraph:8ec1ac28362d_121"},{"__ref":"Paragraph:8ec1ac28362d_122"},{"__ref":"Paragraph:8ec1ac28362d_123"},{"__ref":"Paragraph:8ec1ac28362d_124"},{"__ref":"Paragraph:8ec1ac28362d_125"},{"__ref":"Paragraph:8ec1ac28362d_126"},{"__ref":"Paragraph:8ec1ac28362d_127"},{"__ref":"Paragraph:8ec1ac28362d_128"}],"sections":[{"__typename":"Section","name":"1559","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"a788","startIndex":14,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"97b1","startIndex":120,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null}]}},"creator":{"__ref":"User:c2958659896a"},"customStyleSheet":{"__ref":"CustomStyleSheet:8a80db885f47"},"firstPublishedAt":1574055476662,"isLocked":true,"isPublished":true,"isShortform":false,"layerCake":3,"primaryTopic":null,"title":"Illustrated: Self-Attention","readCreatorPostsCount":0,"mediumUrl":"https:\u002F\u002Ftowardsdatascience.com\u002Fillustrated-self-attention-2d627e33b20a","isLimitedState":false,"visibility":"LOCKED","license":"ALL_RIGHTS_RESERVED","allowResponses":true,"newsletterId":"","sequence":null,"tags":[{"__ref":"Tag:machine-learning"},{"__ref":"Tag:towards-data-science"},{"__ref":"Tag:transformers"},{"__ref":"Tag:attention"},{"__ref":"Tag:nlp"}],"topics":[{"__typename":"Topic","topicId":"1eca0103fff3","name":"Machine Learning"},{"__typename":"Topic","topicId":"ae5d4995e225","name":"Data Science"}],"viewerClapCount":0,"showSubscribeToProfilePromo":false,"showSubscribeToCollectionNewsletterV3Promo":true,"inResponseToPostResult":null,"isNewsletter":false,"socialTitle":"","socialDek":"","noIndex":null,"curationStatus":null,"metaDescription":"This article walks you through the mathematical operations in a self-attention module. Includes illustrations and code.","latestPublishedAt":1613646887638,"readingTime":7.356603773584905,"previewContent":{"__typename":"PreviewContent","subtitle":"Step-by-step guide to self-attention with illustration and code"},"previewImage":{"__ref":"ImageMetadata:1*_92bnsMJy8Bl539G4v93yg.gif"},"creatorPartnerProgramEnrollmentStatus":"PERMISSION_DENIED","clapCount":2671,"lockedSource":"LOCKED_POST_SOURCE_UGC","isSuspended":false,"pendingCollection":null,"statusForCollection":"APPROVED","pinnedAt":0,"pinnedByCreatorAt":0,"curationEligibleAt":1593136356448,"responseDistribution":"NOT_DISTRIBUTED","shareKey":null,"internalLinks({\"paging\":{\"limit\":8}})":{"__typename":"InternalLinksConnection","items":[{"__ref":"Post:d214d222c4cb"},{"__ref":"Post:d0caf7b2bfd3"},{"__ref":"Post:1aa02eba35"},{"__ref":"Post:3eb914d2681"},{"__ref":"Post:7c36da49f884"},{"__ref":"Post:d0f94a537e52"},{"__ref":"Post:c634fd5dcbd0"},{"__ref":"Post:68bbd000e513"}]},"collaborators":[],"translationSourcePost":null,"inResponseToMediaResource":null,"audioVersionUrl":"","seoTitle":"","updatedAt":1613646924866,"shortformType":"SHORTFORM_TYPE_LINK","structuredData":"","seoDescription":"","postResponses":{"__typename":"PostResponses","count":16},"latestPublishedVersion":"8ec1ac28362d","isPublishToEmail":false,"readingList":"READING_LIST_NONE","voterCount":511,"recommenders":[]}}</script><script src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/manifest.4ec9494e.js.download"></script><script src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/2415.935f8d60.js.download"></script><script src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/main.7bd6e39d.js.download"></script><script src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/5573.159bf40f.chunk.js.download"></script>
<script src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/instrumentation.8ebc52ed.chun.download"></script>
<script src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/reporting.de94a6c0.chunk.js.download"></script>
<script src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/1752.a348f767.chunk.js.download"></script>
<script src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/1491.c08ce3ca.chunk.js.download"></script>
<script src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/4964.fb36722e.chunk.js.download"></script>
<script src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/8342.6aa0b45e.chunk.js.download"></script>
<script src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/9692.9c3d69cc.chunk.js.download"></script>
<script src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/4586.6ef6da31.chunk.js.download"></script>
<script src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/5064.310837be.chunk.js.download"></script>
<script src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/9046.878d4fe3.chunk.js.download"></script>
<script src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/2846.a0cdf4b3.chunk.js.download"></script>
<script src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/7012.bfd53edb.chunk.js.download"></script>
<script src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/6230.5a3ce052.chunk.js.download"></script>
<script src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/9972.3921a7c3.chunk.js.download"></script>
<script src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/5127.521f2c8f.chunk.js.download"></script>
<script src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/8580.40a1de9d.chunk.js.download"></script>
<script src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/8751.8f9c15cb.chunk.js.download"></script>
<script src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/2955.ef13c6fc.chunk.js.download"></script>
<script src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/7131.a7a3ca08.chunk.js.download"></script>
<script src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/9546.c20207bf.chunk.js.download"></script>
<script src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/8127.b9258235.chunk.js.download"></script>
<script src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/6371.decfb70c.chunk.js.download"></script>
<script src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/1541.9074257c.chunk.js.download"></script>
<script src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/1725.e6b10edc.chunk.js.download"></script>
<script src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/2514.2c8bf092.chunk.js.download"></script>
<script src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/3874.0aa86c4a.chunk.js.download"></script>
<script src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/2558.968def64.chunk.js.download"></script>
<script src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/8286.65fc7234.chunk.js.download"></script>
<script src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/5399.e1047b78.chunk.js.download"></script>
<script src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/Post.f691ca61.chunk.js.download"></script><script>window.main();</script><script src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/api.js.download" async=""></script><script src="./Illustrated_ Self-Attention. Step-by-step guide to self-attention… _ by Raimi Karim _ Towards Data Science_files/p.js.download" async="" id="parsely-cf"></script></body></html>