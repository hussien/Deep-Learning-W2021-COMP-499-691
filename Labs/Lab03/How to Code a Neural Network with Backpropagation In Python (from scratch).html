<!DOCTYPE html>
<!-- saved from url=(0086)https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/ -->
<html lang="en-US" class=" js csstransforms3d csstransitions"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<title>How to Code a Neural Network with Backpropagation In Python (from scratch)</title><link rel="stylesheet" href="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/90c8e151f7a73f64eb67dc631568d25d.css" media="all" data-minify="1">

<link rel="pingback" href="https://machinelearningmastery.com/xmlrpc.php">

<!--  Mobile viewport scale -->
<meta content="initial-scale=1.0, maximum-scale=1.0, user-scalable=yes" name="viewport">

	<!-- This site is optimized with the Yoast SEO plugin v15.9.1 - https://yoast.com/wordpress/plugins/seo/ -->
	<title>How to Code a Neural Network with Backpropagation In Python (from scratch)</title>
	<meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
	<link rel="canonical" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/">
	<meta property="og:locale" content="en_US">
	<meta property="og:type" content="article">
	<meta property="og:title" content="How to Code a Neural Network with Backpropagation In Python (from scratch)">
	<meta property="og:description" content="The backpropagation algorithm is used in the classical feed-forward artificial neural network. It is the technique still used to train large deep learning networks. In this tutorial, you will discover how to implement the backpropagation algorithm for a neural network from scratch with Python. After completing this tutorial, you will know: How to forward-propagate an […]">
	<meta property="og:url" content="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/">
	<meta property="og:site_name" content="Machine Learning Mastery">
	<meta property="article:publisher" content="https://www.facebook.com/MachineLearningMastery/">
	<meta property="article:author" content="https://www.facebook.com/MachineLearningMastery/">
	<meta property="article:published_time" content="2016-11-06T18:00:52+00:00">
	<meta property="article:modified_time" content="2019-11-30T17:44:14+00:00">
	<meta property="og:image" content="https://machinelearningmastery.com/wp-content/uploads/2016/11/How-to-Implement-the-Backpropagation-Algorithm-From-Scratch-In-Python.jpg">
	<meta property="og:image:width" content="640">
	<meta property="og:image:height" content="512">
	<meta name="twitter:label1" content="Written by">
	<meta name="twitter:data1" content="Jason Brownlee">
	<meta name="twitter:label2" content="Est. reading time">
	<meta name="twitter:data2" content="30 minutes">
	<script id="twitter-wjs" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/widgets.js.download"></script><script id="twitcount_plugins" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/twitcount.js.download"></script><script type="text/javascript" async="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/client.js.download"></script><script type="text/javascript" async="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/9556588.js.download"></script><script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"Organization","@id":"https://machinelearningmastery.com/#organization","name":"Machine Learning Mastery","url":"https://machinelearningmastery.com/","sameAs":["https://www.facebook.com/MachineLearningMastery/","https://www.linkedin.com/company/machine-learning-mastery","https://twitter.com/TeachTheMachine"],"logo":{"@type":"ImageObject","@id":"https://machinelearningmastery.com/#logo","inLanguage":"en-US","url":"https://machinelearningmastery.com/wp-content/uploads/2016/09/cropped-icon.png","width":512,"height":512,"caption":"Machine Learning Mastery"},"image":{"@id":"https://machinelearningmastery.com/#logo"}},{"@type":"WebSite","@id":"https://machinelearningmastery.com/#website","url":"https://machinelearningmastery.com/","name":"Machine Learning Mastery","description":"Making developers awesome at machine learning","publisher":{"@id":"https://machinelearningmastery.com/#organization"},"potentialAction":[{"@type":"SearchAction","target":"https://machinelearningmastery.com/?s={search_term_string}","query-input":"required name=search_term_string"}],"inLanguage":"en-US"},{"@type":"ImageObject","@id":"https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#primaryimage","inLanguage":"en-US","url":"https://machinelearningmastery.com/wp-content/uploads/2016/11/How-to-Implement-the-Backpropagation-Algorithm-From-Scratch-In-Python.jpg","width":640,"height":512,"caption":"How to Implement the Backpropagation Algorithm From Scratch In Python Photo by NICHD, some rights reserved."},{"@type":"WebPage","@id":"https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#webpage","url":"https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/","name":"How to Code a Neural Network with Backpropagation In Python (from scratch)","isPartOf":{"@id":"https://machinelearningmastery.com/#website"},"primaryImageOfPage":{"@id":"https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#primaryimage"},"datePublished":"2016-11-06T18:00:52+00:00","dateModified":"2019-11-30T17:44:14+00:00","breadcrumb":{"@id":"https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#breadcrumb"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/"]}]},{"@type":"BreadcrumbList","@id":"https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"item":{"@type":"WebPage","@id":"https://machinelearningmastery.com/","url":"https://machinelearningmastery.com/","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@type":"WebPage","@id":"https://machinelearningmastery.com/blog/","url":"https://machinelearningmastery.com/blog/","name":"Blog"}},{"@type":"ListItem","position":3,"item":{"@type":"WebPage","@id":"https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/","url":"https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/","name":"How to Code a Neural Network with Backpropagation In Python (from scratch)"}}]},{"@type":"Article","@id":"https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#article","isPartOf":{"@id":"https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#webpage"},"author":{"@id":"https://machinelearningmastery.com/#/schema/person/e2d0ff4828d406a3b47e5a3c9a0591e8"},"headline":"How to Code a Neural Network with Backpropagation In Python (from scratch)","datePublished":"2016-11-06T18:00:52+00:00","dateModified":"2019-11-30T17:44:14+00:00","mainEntityOfPage":{"@id":"https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#webpage"},"commentCount":730,"publisher":{"@id":"https://machinelearningmastery.com/#organization"},"image":{"@id":"https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#primaryimage"},"articleSection":"Code Algorithms From Scratch","inLanguage":"en-US","potentialAction":[{"@type":"CommentAction","name":"Comment","target":["https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#respond"]}]},{"@type":"Person","@id":"https://machinelearningmastery.com/#/schema/person/e2d0ff4828d406a3b47e5a3c9a0591e8","name":"Jason Brownlee","image":{"@type":"ImageObject","@id":"https://machinelearningmastery.com/#personlogo","inLanguage":"en-US","url":"https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=96&d=mm&r=g","caption":"Jason Brownlee"},"description":"Jason Brownlee, PhD is a machine learning specialist who teaches developers how to get results with modern machine learning methods via hands-on tutorials.","sameAs":["http://MachineLearningMastery.com","https://www.facebook.com/MachineLearningMastery/","https://www.linkedin.com/company/machine-learning-mastery","https://twitter.com/teachthemachine"]}]}</script>
	<!-- / Yoast SEO plugin. -->


<link rel="dns-prefetch" href="https://ads.adthrive.com/">
<link rel="dns-prefetch" href="https://www.google-analytics.com/">
<link rel="dns-prefetch" href="https://loadeu.exelator.com/">
<link rel="dns-prefetch" href="https://sync.crwdcntrl.net/">
<link rel="dns-prefetch" href="https://gdpr-wrapper.privacymanager.io/">
<link rel="dns-prefetch" href="https://securepubads.g.doubleclick.net/">
<link rel="dns-prefetch" href="https://gdpr.privacymanager.io/">
<link rel="dns-prefetch" href="https://sb.scorecardresearch.com/">
<link rel="dns-prefetch" href="https://confiant-integrations.global.ssl.fastly.net/">
<link href="https://fonts.gstatic.com/" crossorigin="" rel="preconnect">
<link rel="alternate" type="application/rss+xml" title="Machine Learning Mastery » Feed" href="https://feeds.feedburner.com/MachineLearningMastery">
<link rel="alternate" type="application/rss+xml" title="Machine Learning Mastery » Comments Feed" href="https://machinelearningmastery.com/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="Machine Learning Mastery » How to Code a Neural Network with Backpropagation In Python (from scratch) Comments Feed" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/feed/">
<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	









<!--[if lt IE 9]>
<link href="https://machinelearningmastery.com/wp-content/themes/canvas-new/css/non-responsive.css" rel="stylesheet" type="text/css" />
<style type="text/css">.col-full, #wrapper { width: 960px; max-width: 960px; } #inner-wrapper { padding: 0; } body.full-width #header, #nav-container, body.full-width #content, body.full-width #footer-widgets, body.full-width #footer { padding-left: 0; padding-right: 0; } body.fixed-mobile #top, body.fixed-mobile #header-container, body.fixed-mobile #footer-container, body.fixed-mobile #nav-container, body.fixed-mobile #footer-widgets-container { min-width: 960px; padding: 0 1em; } body.full-width #content { width: auto; padding: 0 1em;}</style>
<![endif]-->
<script type="text/javascript" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/jquery.min.js.download" id="jquery-core-js" defer=""></script>



<script type="text/javascript" id="ssb-front-js-js-extra">
/* <![CDATA[ */
var SSB = {"ajax_url":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","fb_share_nonce":"1d23dfa604"};
/* ]]> */
</script>




<link rel="https://api.w.org/" href="https://machinelearningmastery.com/wp-json/"><link rel="alternate" type="application/json" href="https://machinelearningmastery.com/wp-json/wp/v2/posts/3349"><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://machinelearningmastery.com/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://machinelearningmastery.com/wp-includes/wlwmanifest.xml"> 
<link rel="shortlink" href="https://machinelearningmastery.com/?p=3349">
 <style media="screen">

		.simplesocialbuttons.simplesocialbuttons_inline .ssb-fb-like {
	  margin: ;
	}
		 /*inline margin*/
	
	
	
	
	
	
			 .simplesocialbuttons.simplesocialbuttons_inline.simplesocial-simple-icons button{
		 margin: ;
	 }

			 /*margin-digbar*/

	
	
	
	
	
	
	
</style>

<!-- Open Graph Meta Tags generated by Simple Social Buttons 3.2.1 -->
<meta property="og:title" content="How to Code a Neural Network with Backpropagation In Python (from scratch) - Machine Learning Mastery">
<meta property="og:description" content="The backpropagation algorithm is used in the classical feed-forward artificial neural network.

It is the technique still used to train large deep learning networks.

In this tutorial, you will discover how to implement the backpropagation algorithm for a neural network from scratch with Python.

After completing this tutorial, you will know:

 	How to forward-propagate an input to calculate an output.
 	How to back-propagate">
<meta property="og:url" content="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/">
<meta property="og:site_name" content="Machine Learning Mastery">
<meta property="og:image" content="https://machinelearningmastery.com/wp-content/uploads/2016/11/How-to-Implement-the-Backpropagation-Algorithm-From-Scratch-In-Python.jpg">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:description" content="The backpropagation algorithm is used in the classical feed-forward artificial neural network.

It is the technique still used to train large deep learning networks.

In this tutorial, you will discover how to implement the backpropagation algorithm for a neural network from scratch with Python.

After completing this tutorial, you will know:

 	How to forward-propagate an input to calculate an output.
 	How to back-propagate">
<meta name="twitter:title" content="How to Code a Neural Network with Backpropagation In Python (from scratch) - Machine Learning Mastery">
<meta property="twitter:image" content="https://machinelearningmastery.com/wp-content/uploads/2016/11/How-to-Implement-the-Backpropagation-Algorithm-From-Scratch-In-Python.jpg">
    
<style id="wplmi-inline-css" type="text/css"> span.wplmi-user-avatar { width: 16px;display: inline-block !important;flex-shrink: 0; } img.wplmi-elementor-avatar { border-radius: 100%;margin-right: 3px; } 

</style>

<link rel="preload" as="font" href="https://machinelearningmastery.com/wp-content/themes/canvas-new/includes/fonts/fontawesome-webfont.woff2?v=4.5.0" crossorigin="">
<!-- Custom CSS Styling -->
<style type="text/css">
#logo .site-title, #logo .site-description { display:none; }
body {background-repeat:no-repeat;background-position:top left;background-attachment:scroll;border-top:0px solid #000000;}
#header {background-repeat:no-repeat;background-position:left top;margin-top:0px;margin-bottom:0px;padding-top:10px;padding-bottom:10px;border:0px solid ;}
#logo .site-title a {font:bold 40px/1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
#logo .site-description {font:normal 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#999999;}
body, p { font:normal 14px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
h1 { font:bold 28px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h2 { font:bold 24px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h3 { font:bold 20px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h4 { font:bold 16px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h5 { font:bold 14px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h6 { font:bold 12px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }
.page-title, .post .title, .page .title {font:bold 28px/1.1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
.post .title a:link, .post .title a:visited, .page .title a:link, .page .title a:visited {color:#222222}
.post-meta { font:normal 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
.entry, .entry p{ font:normal 15px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.post-more {font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:;border-top:0px solid #e6e6e6;border-bottom:0px solid #e6e6e6;}
#post-author, #connect {border-top:1px solid #e6e6e6;border-bottom:1px solid #e6e6e6;border-left:1px solid #e6e6e6;border-right:1px solid #e6e6e6;border-radius:5px;-moz-border-radius:5px;-webkit-border-radius:5px;background-color:#fafafa}
.nav-entries a, .woo-pagination { font:normal 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#888; }
.woo-pagination a, .woo-pagination a:hover {color:#888!important}
.widget h3 {font:bold 14px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#555555;border-bottom:1px solid #e6e6e6;}
.widget_recent_comments li, #twitter li { border-color: #e6e6e6;}
.widget p, .widget .textwidget { font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.widget {font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555;border-radius:0px;-moz-border-radius:0px;-webkit-border-radius:0px;}
#tabs .inside li a, .widget_woodojo_tabs .tabbable .tab-pane li a { font:bold 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
#tabs .inside li span.meta, .widget_woodojo_tabs .tabbable .tab-pane li span.meta { font:300 11px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
#tabs ul.wooTabs li a, .widget_woodojo_tabs .tabbable .nav-tabs li a { font:300 11px/2em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
@media only screen and (min-width:768px) {
ul.nav li a, #navigation ul.rss a, #navigation ul.cart a.cart-contents, #navigation .cart-contents #navigation ul.rss, #navigation ul.nav-search, #navigation ul.nav-search a { font:bold 15px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#ffffff; } #navigation ul.rss li a:before, #navigation ul.nav-search a.search-contents:before { color:#ffffff;}
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover a, #navigation ul.nav li ul li a, #navigation ul.cart > li:hover > a, #navigation ul.cart > li > ul > div, #navigation ul.cart > li > ul > div p, #navigation ul.cart > li > ul span, #navigation ul.cart .cart_list a, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a { color:#eeeeee!important; }
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover, #navigation ul.nav li ul, #navigation ul.cart li:hover a.cart-contents, #navigation ul.nav-search li:hover a.search-contents, #navigation ul.nav-search a.search-contents + ul, #navigation ul.cart a.cart-contents + ul, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a{background-color:#84abc7!important}
#navigation ul.nav li ul, #navigation ul.cart > li > ul > div  { border: 0px solid #dbdbdb; }
#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation ul.nav > li  { border-right: 0px solid #dbdbdb; }#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation { box-shadow: none; -moz-box-shadow: none; -webkit-box-shadow: none; }#navigation ul li:first-child, #navigation ul li:first-child a { border-radius:0px 0 0 0px; -moz-border-radius:0px 0 0 0px; -webkit-border-radius:0px 0 0 0px; }
#navigation {background:#84abc7;border-top:0px solid #dbdbdb;border-bottom:0px solid #dbdbdb;border-left:0px solid #dbdbdb;border-right:0px solid #dbdbdb;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
#top ul.nav li a { font:normal 12px/1.6em "Helvetica Neue", Helvetica, sans-serif;color:#ddd; }
}
#footer, #footer p { font:normal 13px/1.4em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
#footer {border-top:1px solid #dbdbdb;border-bottom:0px solid ;border-left:0px solid ;border-right:0px solid ;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
.magazine #loopedSlider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-magazine .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.magazine #loopedSlider .content .excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-magazine .slide-content p, .wooslider-theme-magazine .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.magazine .block .post .title a {font:bold 18px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }
#loopedSlider.business-slider .content h2 { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#loopedSlider.business-slider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#wrapper #loopedSlider.business-slider .content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.archive_header { font:bold 18px/1em Arial, sans-serif;color:#222222; }
.archive_header {border-bottom:1px solid #e6e6e6;}
.archive_header .catrss { display:none; }
</style>

<!-- Custom Favicon -->
<link rel="shortcut icon" href="https://machinelearningmastery.com/wp-content/uploads/2019/09/icon-16x16.png">
<!-- Options Panel Custom CSS -->
<style type="text/css">
#logo img {
   max-width: 100%;
   height: auto;
}
</style>


<!-- Woo Shortcodes CSS -->


<!-- Custom Stylesheet -->


<!-- Theme version -->
<meta name="generator" content="Canvas 5.9.21">
<meta name="generator" content="WooFramework 6.2.9">

<link rel="icon" href="https://machinelearningmastery.com/wp-content/uploads/2016/09/cropped-icon-32x32.png" sizes="32x32">
<link rel="icon" href="https://machinelearningmastery.com/wp-content/uploads/2016/09/cropped-icon-192x192.png" sizes="192x192">
<link rel="apple-touch-icon" href="https://machinelearningmastery.com/wp-content/uploads/2016/09/cropped-icon-180x180.png">
<meta name="msapplication-TileImage" content="https://machinelearningmastery.com/wp-content/uploads/2016/09/cropped-icon-270x270.png">
		<style type="text/css" id="wp-custom-css">
			.display-posts-listing.image-left .listing-item {
	overflow: hidden; 
	margin-bottom: 30px;
	width: 100%;
}

.display-posts-listing.image-left .image {
	float: left;
	margin: 0 10px 0 0;
}

.display-posts-listing.image-left .attachment-thumbnail {
	height: auto; 
	width: auto; 
	max-width: 50px; 
	max-height: 50px;
	border-radius: 50%;
}

.display-posts-listing.image-left .title {
	display: block;
}

.display-posts-listing.image-left .excerpt-dash { 
	display: none; 
}

.display-posts-listing.image-left {
	margin: 0 0 40px 0;
}		</style>
		<noscript><style id="rocket-lazyload-nojs-css">.rll-youtube-player, [data-lazy-src]{display:none !important;}</style></noscript><style type="text/css">
  /* === Form-Specific Styles === */
  /* stylelint-disable */

  #drip-2211 .drip-content,
  #drip-2211 .drip-header {
    background: rgb(116,174,203) !important;
    background: rgba(116,174,203,0.90) !important;
  }

  #drip-2211 .drip-content h3 {
    color: #333333 !important;
    font-size: 21px !important;
  }

  #drip-2211 .drip-submit-button {
    background-color: #333333 !important;
    font-size: 12px !important;
  }

  #drip-2211 .drip-submit-button:hover {
    background-color: #191919 !important;
  }

  #drip-2211 .drip-submit-button:active {
    background-color: #000000 !important;
  }

  #drip-2211 .drip-submit-button:disabled {
    background-color: #808080 !important;
  }

  #drip-2211 dl dt,
  #drip-2211 .drip-content .drip-description,
  #drip-2211 .drip-content .classic--checkbox,
  #drip-2211 .drip-errors {
    font-size: 13px !important;
  }

  #drip-2211 .drip-text-field,
  #drip-2211 .drip-radio-buttons,
  #drip-2211 .drip-dropdown-select {
    font-size: 14px !important;
  }

  /* === Reset styles === */

  .drip-tab h1,
  .drip-tab h2,
  .drip-tab h3,
  .drip-tab dl,
  .drip-tab dt,
  .drip-tab dd,
  .drip-tab p,
  .drip-tab a,
  .drip-tab .drip-text-field,
  .drip-tab .drip-radio-buttons,
  .drip-tab .drip-text-field:focus,
  .drip-tab .drip-submit-button {
    margin: 0;
    padding: 0;
    border: 0;
    font-size: 100%;
    font: inherit;
    vertical-align: baseline;
    float: none;
    width: auto;
    background-image: none;
    letter-spacing: 0;
    -webkit-box-shadow: none;
       -moz-box-shadow: none;
            box-shadow: none;
    -webkit-text-shadow: none !important;
       -moz-text-shadow: none !important;
            text-shadow: none !important;
  }

  .drip-tab a {
    text-decoration: none;
  }

  .drip-tab :focus {
    outline: 0;
  }

  /* === Clearfix === */

  .drip-clearfix:after {
    visibility: hidden;
    display: block;
    font-size: 0;
    content: " ";
    clear: both;
    height: 0;
  }
  * html .drip-clearfix             { zoom: 1; } /* IE6 */
  *:first-child+html .drip-clearfix { zoom: 1; } /* IE7 */

  /* === Main Container === */

  .drip-tab-container * {
    box-sizing: content-box;
  }

  /* === Content === */

  .drip-tab .drip-content {
    margin: 0;
    padding: 5px;
    width: 330px;
    position: fixed;
    font-size: 100%;
    font: inherit;
    z-index: 10000;
    color: #333;
    vertical-align: baseline;
    text-align: left;
    box-sizing: border-box;
    -webkit-box-shadow: 0px 0px 20px rgba(0,0,0,0.25);
       -moz-box-shadow: 0px 0px 20px rgba(0,0,0,0.25);
            box-shadow: 0px 0px 20px rgba(0,0,0,0.25);
  }

  .drip-tab.bottom .drip-content {
    bottom: -800px;
    -webkit-border-radius: 8px 8px 0 0;
       -moz-border-radius: 8px 8px 0 0;
            border-radius: 8px 8px 0 0;
    -webkit-transition: bottom 200ms ease-in;
       -moz-transition: bottom 200ms ease-in;
         -o-transition: bottom 200ms ease-in;
            transition: bottom 200ms ease-in;
  }

  .drip-tab.bottom.left .drip-content {
    left: 40px;
  }

  .drip-tab.bottom.right .drip-content {
    right: 40px;
  }

  .drip-tab.image-left .drip-content,
  .drip-tab.image-right .drip-content {
    width: 510px;
  }

  .drip-tab.side .drip-content {
    top: 10%;
  }

  .drip-tab.side.right .drip-content {
    right: -550px;
    -webkit-border-radius: 8px 0 0 8px;
       -moz-border-radius: 8px 0 0 8px;
            border-radius: 8px 0 0 8px;
    -webkit-transition: right 200ms ease-in;
       -moz-transition: right 200ms ease-in;
         -o-transition: right 200ms ease-in;
            transition: right 200ms ease-in;
  }

  .drip-tab.side.left .drip-content {
    left: -550px;
    -webkit-border-radius: 0 8px 8px 0;
       -moz-border-radius: 0 8px 8px 0;
            border-radius: 0 8px 8px 0;
    -webkit-transition: left 200ms ease-in;
       -moz-transition: left 200ms ease-in;
         -o-transition: left 200ms ease-in;
            transition: left 200ms ease-in;
  }

  .drip-tab.mobile .drip-content {
    width: 100% !important;
    bottom: -800px;
    left: 0;
    -webkit-border-radius: 0;
       -moz-border-radius: 0;
            border-radius: 0;
    -webkit-transition: bottom 200ms ease-in;
       -moz-transition: bottom 200ms ease-in;
         -o-transition: bottom 200ms ease-in;
            transition: bottom 200ms ease-in;
  }

  .drip-tab.drip-scrollable .drip-content {
    overflow-y: scroll;
  }

  /* === Header === */

  .drip-tab .drip-header {
    margin: 0;
    padding: 0;
    position: fixed;
    font-size: 100%;
    font: inherit;
    z-index: 10000;
    color: #333;
    vertical-align: baseline;
    text-align: left;
    -webkit-border-radius: 8px 8px 0 0;
       -moz-border-radius: 8px 8px 0 0;
            border-radius: 8px 8px 0 0;
    -webkit-box-shadow: 0px 10px 28px rgba(0,0,0,0.36);
       -moz-box-shadow: 0px 10px 28px rgba(0,0,0,0.36);
            box-shadow: 0px 10px 28px rgba(0,0,0,0.36);
  }

  .drip-tab.bottom .drip-header {
    width: 330px;
    bottom: 0;
    -webkit-transition: bottom 200ms ease-in;
       -moz-transition: bottom 200ms ease-in;
         -o-transition: bottom 200ms ease-in;
            transition: bottom 200ms ease-in;
  }

  .drip-tab.bottom .drip-header.drip-hidden {
    bottom: -800px;
  }

  .drip-tab.bottom.left .drip-header {
    left: 40px;
  }

  .drip-tab.bottom.right .drip-header {
    right: 40px;
  }

  .drip-tab.bottom.image-left .drip-header,
  .drip-tab.bottom.image-right .drip-header {
    width: 510px;
  }

  .drip-tab.side .drip-header {
    width: 330px;
    top: 10%;
  }

  .drip-tab.side.right .drip-header {
    right: -100px;
    -webkit-transition: right 400ms ease-in;
       -moz-transition: right 400ms ease-in;
         -o-transition: right 400ms ease-in;
            transition: right 400ms ease-in;
    -webkit-transform: rotate(-90deg) !important;
       -moz-transform: rotate(-90deg) !important;
        -ms-transform: rotate(-90deg) !important;
         -o-transform: rotate(-90deg) !important;
            transform: rotate(-90deg) !important;
    -webkit-transform-origin: right center;
       -moz-transform-origin: right center;
         -o-transform-origin: right center;
            transform-origin: right center;
  }

  .drip-tab.side.right .drip-header.drip-hidden {
    right: -100px;
  }

  .drip-tab.side.left .drip-header {
    left: -100px;
    -webkit-transition: left 400ms ease-in;
       -moz-transition: left 400ms ease-in;
         -o-transition: left 400ms ease-in;
            transition: left 400ms ease-in;
    -webkit-transform: rotate(90deg) !important;
       -moz-transform: rotate(90deg) !important;
        -ms-transform: rotate(90deg) !important;
         -o-transform: rotate(90deg) !important;
            transform: rotate(90deg) !important;
    -webkit-transform-origin: left center;
       -moz-transform-origin: left center;
         -o-transform-origin: left center;
            transform-origin: left center;
  }

  .drip-tab.side.left .drip-header.drip-hidden {
    left: -100px;
  }

  .drip-tab.mobile .drip-header {
    width: 100% !important;
    bottom: 0;
    left: 0;
    -webkit-border-radius: 0;
       -moz-border-radius: 0;
            border-radius: 0;
    -webkit-transition: bottom 200ms ease-in;
       -moz-transition: bottom 200ms ease-in;
         -o-transition: bottom 200ms ease-in;
            transition: bottom 200ms ease-in;
  }

  .drip-tab.mobile .drip-header.drip-hidden {
    bottom: -300px;
  }

  /* === Header Toggle === */

  .drip-tab .drip-toggle {
    display: block;
    text-decoration: none;
    padding: 10px 50px 10px 20px; /* extra padding for the arrow */
  }

  /* === Teaser === */

  .drip-tab .drip-header h2 {
    display: block;
    margin: 0 !important;
    padding: 0 !important;
    border: 0 !important;
    font-size: 14px !important;
    line-height: 1.5 !important;
    font-weight: bold !important;
    text-align: left !important;
    color: #fff !important;
    clear: none !important;
    letter-spacing: 0 !important;
    width: auto !important;
  }

  /* === Arrows === */

  .drip-tab .drip-header span.drip-arrow {
    display: block;
    position: absolute;
    margin: 0;
    padding: 0;
    width: 0;
    height: 0;
    line-height: 0;
    top: 17px;
    right: 32px;
  }

  /* === Panel === */

  .drip-tab .drip-content > div.drip-panel {
    padding: 15px 15px 12px;
    background-color: #fff;
    -webkit-border-radius: 6px;
       -moz-border-radius: 6px;
            border-radius: 6px;
  }

  /* === Content Headings & Paragraphs === */

  .drip-tab .drip-content h3 {
    display: block;
    margin: 0 20px 0 0 !important;
    padding: 0 0 15px 0 !important;
    line-height: 1.4 !important;
    font-weight: bold !important;
    text-align: left !important;
    color: #4477bd !important;
    clear: none !important;
  }

  .drip-tab .drip-content .drip-description {
    margin: 0;
    padding: 0 0 20px 0;
    line-height: 1.6;
    text-align: left;
  }

  .drip-tab.image-left .drip-content .drip-description {
    margin-left: 170px;
  }

  .drip-tab.image-right .drip-content .drip-description {
    margin-right: 170px;
  }

  @media screen and (max-width: 510px) {
    .drip-tab.image-left .drip-content .drip-description {
      margin-left: 0; /* 120px; */
    }

    .drip-tab.image-right .drip-content .drip-description {
      margin-right: 0; /* 120px; */
    }
  }

  .drip-tab .drip-content .drip-description a {
    text-decoration: underline;
  }

  .drip-tab .drip-content .drip-description em {
    font-style: italic;
  }

  .drip-tab .drip-content .drip-description ul,
  .drip-tab .drip-content .drip-description ol {
    list-style-position: outside;
    margin: 8px 0 8px 30px;
  }

  .drip-tab .drip-content .drip-description ul li
  .drip-tab .drip-content .drip-description ol li {
    padding: 0;
  }

  .drip-tab .drip-content img.drip-image {
    margin-bottom: 20px;
  }

  .drip-tab.image-left .drip-content img.drip-image {
    float: left;
    width: 150px;
  }

  .drip-tab.image-right .drip-content img.drip-image {
    float: right;
    width: 150px;
  }

  @media screen and (max-width: 510px) {
    .drip-tab.image-left .drip-content img.drip-image {
      margin-right: 20px;
      width: 100px;
    }

    .drip-tab.image-right .drip-content img.drip-image {
      margin-left: 20px;
      width: 100px;
    }
  }

  .drip-tab .drip-content a.drip-close {
    font-family: Arial, Helvetica, sans-serif;
    margin: -1px 0 0 0;
    float: right;
    font-size: 28px;
    line-height: 15px;
    font-weight: normal;
    color: #333;
    opacity: 0.4;
  }

  .drip-tab .drip-content a.drip-close:hover {
    text-decoration: none;
    cursor: pointer;
    opacity: 0.6;
  }

  /* === Content Subscribe Form === */

  .drip-tab form {
    margin: 0 !important;
    padding: 0 !important;
  }

  .drip-tab dl {
    display: block;
    margin: 0;
    padding: 0;
  }

  .drip-tab dl dt {
    display: block;
    padding: 0 0 5px 0;
    font-weight: bold;
  }

  .drip-tab dl.no-labels dt.label-for-type-text,
  .drip-tab dl.no-labels dt.label-for-type-dropdown,
  .drip-tab dl.no-labels dt.label-for-type-email {
    display: none;
  }

  .drip-tab dl dd {
    display: block;
    padding: 0 0 10px 0;
  }

  .drip-lightbox input {
    box-sizing: border-box;
  }

  .drip-tab .drip-date-field,
  .drip-tab .drip-text-field {
    margin: 0 !important;
    height: 34px !important;
    width: 100% !important;
    color: #333 !important;
    background-color: #fff !important;
    border: 1px solid #c4c4c4 !important;
    -webkit-box-shadow: inset 0 0 3px rgba(0,0,0,0.18) !important;
       -moz-box-shadow: inset 0 0 3px rgba(0,0,0,0.18) !important;
            box-shadow: inset 0 0 3px rgba(0,0,0,0.18) !important;
    -webkit-border-radius: 4px !important;
       -moz-border-radius: 4px !important;
            border-radius: 4px !important;
    -webkit-box-sizing: border-box !important;
       -moz-box-sizing: border-box !important;
        -ms-box-sizing: border-box !important;
            box-sizing: border-box !important;
    background-image: none !important;
    min-width: 0 !important;
    min-height: 0 !important;
  }

  .drip-tab .drip-text-field,
  .drip-tab .drip-dropdown-select select {
    padding: 6px !important;
  }

  .drip-tab .drip-text-field::-webkit-input-placeholder { /* WebKit browsers */
    color: #999999 !important;
  }
  .drip-tab .drip-text-field:-moz-placeholder { /* Mozilla Firefox 4 to 18 */
    color: #999999 !important;
  }
  .drip-tab .drip-text-field::-moz-placeholder { /* Mozilla Firefox 19+ */
    color: #999999 !important;
  }
  .drip-tab .drip-text-field:-ms-input-placeholder { /* Internet Explorer 10+ */
    color: #999999 !important;
  }

  .drip-tab .drip-text-field:focus {
    border-color: #a4a4a4 !important;
    outline: 0;
    background-image: none;
    background-color: #fff !important;
  }

  .drip-tab.mobile .drip-text-field {
    font-size: 16px;
  }

  .drip-tab .drip-errors:not(:empty) {
    padding: 5px 0 0 0;
    font-weight: normal;
    color: red;
  }

  /* RADIOS */

  .drip-tab .drip-radio-buttons,
  .drip-tab .drip-radio-buttons * {
    box-sizing: border-box;
  }
  .drip-tab .drip-radio-buttons h4 {
    font-family: inherit;
    font-weight: bold;
    font-size: 15px;
    margin: 0 0 3px;
    padding: 0;
  }

  .drip-tab .drip-radio-button {
    width: 100%;
    display: block;
    position: relative;
    margin-bottom: 6px;
  }

  .drip-tab .drip-radio-button input[type="radio"] {
    height: 0;
    width: 0;
    opacity: 0;
    position: absolute;
    top: 0;
    left: 0;
    display: inline-block;
    border: none;
    padding: 0;
    margin: 0;
  }

  .drip-tab .drip-radio-button label {
    font-size: 15px;
    padding-left: 30px;
    color: #262626;
    white-space: normal;
    word-break: normal;
    cursor: pointer;
  }

  .drip-tab .drip-radio-button label:before {
    content: "";
    display: block;
    background: #f5f5f5;
    width: 18px;
    height: 18px;
    position: absolute;
    top: 50%;
    left: 0;
    transform: translateY(-50%);
    border-radius: 9px;
    border: 1px solid #cccccc;
    box-sizing: border-box;
    padding: 1px;
    transition: background 300ms ease-out, border-color 300ms, border-width 300ms ease-in;
  }
  .drip-tab .drip-radio-button label:hover:before {
    border-color: #000000;
  }

  .drip-tab .drip-radio-button input[type="radio"]:checked ~ label:before {
    background-color: #ffffff;
    border: 5px solid #000000;
  }

  /* DROPDOWNS */

  /* stylelint-disable */

.drip-tab .drip-dropdown-select h4 {
  font-family: inherit;
  font-weight: bold;
  font-size: 15px;
  margin: 0 0 3px;
  padding: 0;
}

.drip-tab .drip-dropdown-select select {
  display: block;
  box-shadow: none;
  position: relative;
  border: 1px solid #A8ACB9;
  outline: none;
  border-radius: 3px;
  line-height: inherit;
  font-family: inherit;
  color: #262626;
  transition: border-color 300ms;
  width: 100%;
  max-width: 100%; /* useful when width is set to anything other than 100% */
  box-sizing: border-box;

  -moz-appearance: none;
  -webkit-appearance: none;
  appearance: none;
  background-color: #fff;
  /* note: bg image below uses 2 urls. The first is an svg data uri for the arrow
    icon, and the second is the gradient. for the icon, if you want to change the
    color, be sure to use `%23` instead of `#`, since it's a url. You can also
    swap in a different svg icon or an external image reference
  */
  background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%23262626%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E'),
    linear-gradient(to bottom, #ffffff 0%, #ffffff 100%);
  background-repeat: no-repeat, repeat;
  /* arrow icon position (1em from the right, 50% vertical) , then gradient position*/
  background-position: right 12px top 50%, 0 0;
  /* icon size, then gradient */
  background-size: 12px auto, 100%;
}

/* Hide arrow icon in IE browsers */
.drip-tab .drip-dropdown-select select::-ms-expand {
  display: none;
}

/* Hover style */
.drip-tab .drip-dropdown-select select:hover {
  border-color: #888;
}

/* Focus style */
.drip-tab .drip-dropdown-select select:focus {
  border-color: #A8ACB9;
  /* It'd be nice to use -webkit-focus-ring-color here but it doesn't work on box-shadow */
  /* box-shadow: 0 0 1px 3px rgba(59, 153, 252, .7);
  box-shadow: 0 0 0 3px -moz-mac-focusring;
  color: #222; */
  outline: none;
}

/* Set options to normal weight */
.drip-tab .drip-dropdown-select select option {
  font-weight:normal;
}

/* Support for rtl text, explicit support for Arabic and Hebrew */
*[dir="rtl"] .drip-tab .drip-dropdown-select select,
:root:lang(ar) .drip-tab .drip-dropdown-select select,
:root:lang(iw) .drip-tab .drip-dropdown-select select {
  background-position: left 12px top 50%, 0 0;
  padding: .6em .8em .5em 1.4em;
}

/* Disabled styles */
.drip-tab .drip-dropdown-select select:disabled,
.drip-tab .drip-dropdown-select select[aria-disabled=true] {
  color: graytext;
  background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22graytext%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E'),
    linear-gradient(to bottom, #ffffff 0%,#e5e5e5 100%);
}
.drip-tab .drip-dropdown-select select:disabled:hover,
.drip-tab .drip-dropdown-select select[aria-disabled=true] {
  border-color: #aaa;
}

/* stylelint-enable */


  /* SUBMIT BUTTON */

  .drip-tab .drip-submit-button {
    font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif !important;
    padding: 3px 12px !important;
    color: #ffffff !important;
    font-weight: bold !important;
    line-height: 1.6 !important;
    border: 0 !important;
    -webkit-border-radius: 15px !important;
       -moz-border-radius: 15px !important;
            border-radius: 15px !important;
    cursor: pointer !important;
    background-image: none !important;
    min-width: 0 !important;
    min-height: 0 !important;
    height: auto;
  }

  .drip-tab .drip-submit-button:hover {
    background-image: none !important;
  }

  .drip-tab .drip-submit-button:active {
    background-image: none !important;
  }

  /* checkbox */
  .drip-tab .classic--checkbox.hidden {
    margin-bottom: -8px;
    display: none;
  }

  .drip-tab .classic--checkbox input[type="checkbox"] {
    display: inline-block;
    width: auto;
  }

  /* telephone input */
  /* stylelint-disable */

.drip-tab .iti + .zenput--checkbox {
  margin-top: 10px;
}

.drip-tab .iti {
  position: relative;
  display: block;
}

.drip-tab .iti * {
  box-sizing: border-box;
  -moz-box-sizing: border-box;
}

.drip-tab .iti__hide {
  display: none;
}

.drip-tab .iti__v-hide {
  visibility: hidden;
}

.drip-tab .iti input,
.drip-tab .iti input[type=text],
.drip-tab .iti input[type=tel] {
  position: relative;
  z-index: 0;
  width: 100%;
  padding: 0 0 0 36px;
  margin: 0 !important;
}

  .drip-tab .iti input,
  .drip-tab .iti input[type=text],
  .drip-tab .iti input[type=tel] {
    height: 34px;
    border: 1px solid #c4c4c4 !important;
    border-radius: 4px !important;
    box-shadow: inset 0 0 3px rgba(0, 0, 0, 0.18) !important;
  }

.drip-tab .iti__flag-container {
  position: absolute;
  top: 0;
  bottom: 0;
  right: 0;
  padding: 1px;
}

.drip-tab .iti__selected-flag {
  z-index: 1;
  position: relative;
  display: flex;
  align-items: center;
  height: 100%;
  padding: 0 6px 0 8px;
}

.drip-tab .iti__arrow {
  margin-left: 6px;
  width: 0;
  height: 0;
  border-left: 3px solid transparent;
  border-right: 3px solid transparent;
  border-top: 4px solid #555;
}

.drip-tab .iti__arrow--up {
  border-top: none;
  border-bottom: 4px solid #555;
}

.drip-tab .iti__country-list {
  position: absolute;
  z-index: 2;
  list-style: none;
  text-align: left;
  padding: 0;
  margin: 0 0 0 -1px;
  box-shadow: 1px 1px 4px rgba(0, 0, 0, 0.2);
  background-color: white;
  border: 1px solid #CCC;
  white-space: nowrap;
  max-height: 200px;
  width: 320px;
  overflow-y: scroll;
  overflow-x: hidden;
  -webkit-overflow-scrolling: touch;
}

.drip-tab .iti__country-list--dropup {
  bottom: 100%;
  margin-bottom: -1px;
}

@media (max-width: 500px) {
  .drip-tab .iti__country-list {
    white-space: normal;
  }
}

.drip-tab .iti__flag-box {
  display: inline-block;
  width: 20px;
}

.drip-tab .iti__divider {
  padding-bottom: 5px;
  margin-bottom: 5px;
  border-bottom: 1px solid #CCC;
}

.drip-tab .iti__country {
  padding: 5px 10px;
  outline: none;
}

.drip-tab .iti__dial-code {
  color: #999;
}

.drip-tab .iti__country.iti__highlight {
  background-color: rgba(0, 0, 0, 0.05);
}

.drip-tab .iti__flag-box,
.drip-tab .iti__country-name,
.drip-tab .iti__dial-code {
  vertical-align: middle;
}

.drip-tab .iti__flag-box,
.drip-tab .iti__country-name {
  margin-right: 6px;
}

.drip-tab .iti--allow-dropdown input,
.drip-tab .iti--allow-dropdown input[type=text],
.drip-tab .iti--allow-dropdown input[type=tel],
.drip-tab .iti--separate-dial-code input,
.drip-tab .iti--separate-dial-code input[type=text],
.drip-tab .iti--separate-dial-code input[type=tel] {
  padding-right: 6px;
  padding-left: 52px;
  margin-left: 0;
}

.drip-tab .iti--allow-dropdown .iti__flag-container,
.drip-tab .iti--separate-dial-code .iti__flag-container {
  right: auto;
  left: 0;
}

.drip-tab .iti--allow-dropdown .iti__flag-container:hover {
  cursor: pointer;
}

.drip-tab .iti--allow-dropdown .iti__flag-container:hover .iti__selected-flag {
  background-color: rgba(0, 0, 0, 0.05);
}

.drip-tab .iti--allow-dropdown input[disabled]+.iti__flag-container:hover,
.drip-tab .iti--allow-dropdown input[readonly]+.iti__flag-container:hover {
  cursor: default;
}

.drip-tab .iti--allow-dropdown input[disabled]+.iti__flag-container:hover .iti__selected-flag,
.drip-tab .iti--allow-dropdown input[readonly]+.iti__flag-container:hover .iti__selected-flag {
  background-color: transparent;
}

.drip-tab .iti--separate-dial-code .iti__selected-flag {
  background-color: rgba(0, 0, 0, 0.05);
}

.drip-tab .iti--separate-dial-code .iti__selected-dial-code {
  margin-left: 6px;
}

.drip-tab .iti--container {
  position: absolute;
  top: -1000px;
  left: -1000px;
  z-index: 1060;
  padding: 1px;
}

.drip-tab .iti--container:hover {
  cursor: pointer;
}

.iti-mobile .drip-tab  .iti--container {
  top: 30px;
  bottom: 30px;
  left: 30px;
  right: 30px;
  position: fixed;
}

.iti-mobile .drip-tab .iti__country-list {
  max-height: 100%;
  width: 100%;
}

.iti-mobile .drip-tab .iti__country {
  padding: 10px 10px;
  line-height: 1.5em;
}

.drip-tab .sms-subtext {
  margin-top: .75em;
  font-size: .75em;
  line-height: 1.4;
  display: inline-block;
}

.drip-tab .sms-subtext a {
  text-decoration: underline;
  cursor: pointer;
}

.drip-tab .iti__flag {
  width: 20px;
}

.drip-tab .iti__flag.iti__be {
  width: 18px;
}

.drip-tab .iti__flag.iti__ch {
  width: 15px;
}

.drip-tab .iti__flag.iti__mc {
  width: 19px;
}

.drip-tab .iti__flag.iti__ne {
  width: 18px;
}

.drip-tab .iti__flag.iti__np {
  width: 13px;
}

.drip-tab .iti__flag.iti__va {
  width: 15px;
}

@media (-webkit-min-device-pixel-ratio: 2),
(min-resolution: 192dpi) {
  .drip-tab .iti__flag {
    background-size: 5652px 15px;
  }
}

.drip-tab .iti__flag.iti__ac {
    height: 10px;
    background-position: 0px 0px;
  }

.drip-tab .iti__flag.iti__ad {
    height: 14px;
    background-position: -22px 0px;
  }

.drip-tab .iti__flag.iti__ae {
    height: 10px;
    background-position: -44px 0px;
  }

.drip-tab .iti__flag.iti__af {
    height: 14px;
    background-position: -66px 0px;
  }

.drip-tab .iti__flag.iti__ag {
    height: 14px;
    background-position: -88px 0px;
  }

.drip-tab .iti__flag.iti__ai {
    height: 10px;
    background-position: -110px 0px;
  }

.drip-tab .iti__flag.iti__al {
    height: 15px;
    background-position: -132px 0px;
  }

.drip-tab .iti__flag.iti__am {
    height: 10px;
    background-position: -154px 0px;
  }

.drip-tab .iti__flag.iti__ao {
    height: 14px;
    background-position: -176px 0px;
  }

.drip-tab .iti__flag.iti__aq {
    height: 14px;
    background-position: -198px 0px;
  }

.drip-tab .iti__flag.iti__ar {
    height: 13px;
    background-position: -220px 0px;
  }

.drip-tab .iti__flag.iti__as {
    height: 10px;
    background-position: -242px 0px;
  }

.drip-tab .iti__flag.iti__at {
    height: 14px;
    background-position: -264px 0px;
  }

.drip-tab .iti__flag.iti__au {
    height: 10px;
    background-position: -286px 0px;
  }

.drip-tab .iti__flag.iti__aw {
    height: 14px;
    background-position: -308px 0px;
  }

.drip-tab .iti__flag.iti__ax {
    height: 13px;
    background-position: -330px 0px;
  }

.drip-tab .iti__flag.iti__az {
    height: 10px;
    background-position: -352px 0px;
  }

.drip-tab .iti__flag.iti__ba {
    height: 10px;
    background-position: -374px 0px;
  }

.drip-tab .iti__flag.iti__bb {
    height: 14px;
    background-position: -396px 0px;
  }

.drip-tab .iti__flag.iti__bd {
    height: 12px;
    background-position: -418px 0px;
  }

.drip-tab .iti__flag.iti__be {
    height: 15px;
    background-position: -440px 0px;
  }

.drip-tab .iti__flag.iti__bf {
    height: 14px;
    background-position: -460px 0px;
  }

.drip-tab .iti__flag.iti__bg {
    height: 12px;
    background-position: -482px 0px;
  }

.drip-tab .iti__flag.iti__bh {
    height: 12px;
    background-position: -504px 0px;
  }

.drip-tab .iti__flag.iti__bi {
    height: 12px;
    background-position: -526px 0px;
  }

.drip-tab .iti__flag.iti__bj {
    height: 14px;
    background-position: -548px 0px;
  }

.drip-tab .iti__flag.iti__bl {
    height: 14px;
    background-position: -570px 0px;
  }

.drip-tab .iti__flag.iti__bm {
    height: 10px;
    background-position: -592px 0px;
  }

.drip-tab .iti__flag.iti__bn {
    height: 10px;
    background-position: -614px 0px;
  }

.drip-tab .iti__flag.iti__bo {
    height: 14px;
    background-position: -636px 0px;
  }

.drip-tab .iti__flag.iti__bq {
    height: 14px;
    background-position: -658px 0px;
  }

.drip-tab .iti__flag.iti__br {
    height: 14px;
    background-position: -680px 0px;
  }

.drip-tab .iti__flag.iti__bs {
    height: 10px;
    background-position: -702px 0px;
  }

.drip-tab .iti__flag.iti__bt {
    height: 14px;
    background-position: -724px 0px;
  }

.drip-tab .iti__flag.iti__bv {
    height: 15px;
    background-position: -746px 0px;
  }

.drip-tab .iti__flag.iti__bw {
    height: 14px;
    background-position: -768px 0px;
  }

.drip-tab .iti__flag.iti__by {
    height: 10px;
    background-position: -790px 0px;
  }

.drip-tab .iti__flag.iti__bz {
    height: 14px;
    background-position: -812px 0px;
  }

.drip-tab .iti__flag.iti__ca {
    height: 10px;
    background-position: -834px 0px;
  }

.drip-tab .iti__flag.iti__cc {
    height: 10px;
    background-position: -856px 0px;
  }

.drip-tab .iti__flag.iti__cd {
    height: 15px;
    background-position: -878px 0px;
  }

.drip-tab .iti__flag.iti__cf {
    height: 14px;
    background-position: -900px 0px;
  }

.drip-tab .iti__flag.iti__cg {
    height: 14px;
    background-position: -922px 0px;
  }

.drip-tab .iti__flag.iti__ch {
    height: 15px;
    background-position: -944px 0px;
  }

.drip-tab .iti__flag.iti__ci {
    height: 14px;
    background-position: -961px 0px;
  }

.drip-tab .iti__flag.iti__ck {
    height: 10px;
    background-position: -983px 0px;
  }

.drip-tab .iti__flag.iti__cl {
    height: 14px;
    background-position: -1005px 0px;
  }

.drip-tab .iti__flag.iti__cm {
    height: 14px;
    background-position: -1027px 0px;
  }

.drip-tab .iti__flag.iti__cn {
    height: 14px;
    background-position: -1049px 0px;
  }

.drip-tab .iti__flag.iti__co {
    height: 14px;
    background-position: -1071px 0px;
  }

.drip-tab .iti__flag.iti__cp {
    height: 14px;
    background-position: -1093px 0px;
  }

.drip-tab .iti__flag.iti__cr {
    height: 12px;
    background-position: -1115px 0px;
  }

.drip-tab .iti__flag.iti__cu {
    height: 10px;
    background-position: -1137px 0px;
  }

.drip-tab .iti__flag.iti__cv {
    height: 12px;
    background-position: -1159px 0px;
  }

.drip-tab .iti__flag.iti__cw {
    height: 14px;
    background-position: -1181px 0px;
  }

.drip-tab .iti__flag.iti__cx {
    height: 10px;
    background-position: -1203px 0px;
  }

.drip-tab .iti__flag.iti__cy {
    height: 14px;
    background-position: -1225px 0px;
  }

.drip-tab .iti__flag.iti__cz {
    height: 14px;
    background-position: -1247px 0px;
  }

.drip-tab .iti__flag.iti__de {
    height: 12px;
    background-position: -1269px 0px;
  }

.drip-tab .iti__flag.iti__dg {
    height: 10px;
    background-position: -1291px 0px;
  }

.drip-tab .iti__flag.iti__dj {
    height: 14px;
    background-position: -1313px 0px;
  }

.drip-tab .iti__flag.iti__dk {
    height: 15px;
    background-position: -1335px 0px;
  }

.drip-tab .iti__flag.iti__dm {
    height: 10px;
    background-position: -1357px 0px;
  }

.drip-tab .iti__flag.iti__do {
    height: 14px;
    background-position: -1379px 0px;
  }

.drip-tab .iti__flag.iti__dz {
    height: 14px;
    background-position: -1401px 0px;
  }

.drip-tab .iti__flag.iti__ea {
    height: 14px;
    background-position: -1423px 0px;
  }

.drip-tab .iti__flag.iti__ec {
    height: 14px;
    background-position: -1445px 0px;
  }

.drip-tab .iti__flag.iti__ee {
    height: 13px;
    background-position: -1467px 0px;
  }

.drip-tab .iti__flag.iti__eg {
    height: 14px;
    background-position: -1489px 0px;
  }

.drip-tab .iti__flag.iti__eh {
    height: 10px;
    background-position: -1511px 0px;
  }

.drip-tab .iti__flag.iti__er {
    height: 10px;
    background-position: -1533px 0px;
  }

.drip-tab .iti__flag.iti__es {
    height: 14px;
    background-position: -1555px 0px;
  }

.drip-tab .iti__flag.iti__et {
    height: 10px;
    background-position: -1577px 0px;
  }

.drip-tab .iti__flag.iti__eu {
    height: 14px;
    background-position: -1599px 0px;
  }

.drip-tab .iti__flag.iti__fi {
    height: 12px;
    background-position: -1621px 0px;
  }

.drip-tab .iti__flag.iti__fj {
    height: 10px;
    background-position: -1643px 0px;
  }

.drip-tab .iti__flag.iti__fk {
    height: 10px;
    background-position: -1665px 0px;
  }

.drip-tab .iti__flag.iti__fm {
    height: 11px;
    background-position: -1687px 0px;
  }

.drip-tab .iti__flag.iti__fo {
    height: 15px;
    background-position: -1709px 0px;
  }

.drip-tab .iti__flag.iti__fr {
    height: 14px;
    background-position: -1731px 0px;
  }

.drip-tab .iti__flag.iti__ga {
    height: 15px;
    background-position: -1753px 0px;
  }

.drip-tab .iti__flag.iti__gb {
    height: 10px;
    background-position: -1775px 0px;
  }

.drip-tab .iti__flag.iti__gd {
    height: 12px;
    background-position: -1797px 0px;
  }

.drip-tab .iti__flag.iti__ge {
    height: 14px;
    background-position: -1819px 0px;
  }

.drip-tab .iti__flag.iti__gf {
    height: 14px;
    background-position: -1841px 0px;
  }

.drip-tab .iti__flag.iti__gg {
    height: 14px;
    background-position: -1863px 0px;
  }

.drip-tab .iti__flag.iti__gh {
    height: 14px;
    background-position: -1885px 0px;
  }

.drip-tab .iti__flag.iti__gi {
    height: 10px;
    background-position: -1907px 0px;
  }

.drip-tab .iti__flag.iti__gl {
    height: 14px;
    background-position: -1929px 0px;
  }

.drip-tab .iti__flag.iti__gm {
    height: 14px;
    background-position: -1951px 0px;
  }

.drip-tab .iti__flag.iti__gn {
    height: 14px;
    background-position: -1973px 0px;
  }

.drip-tab .iti__flag.iti__gp {
    height: 14px;
    background-position: -1995px 0px;
  }

.drip-tab .iti__flag.iti__gq {
    height: 14px;
    background-position: -2017px 0px;
  }

.drip-tab .iti__flag.iti__gr {
    height: 14px;
    background-position: -2039px 0px;
  }

.drip-tab .iti__flag.iti__gs {
    height: 10px;
    background-position: -2061px 0px;
  }

.drip-tab .iti__flag.iti__gt {
    height: 13px;
    background-position: -2083px 0px;
  }

.drip-tab .iti__flag.iti__gu {
    height: 11px;
    background-position: -2105px 0px;
  }

.drip-tab .iti__flag.iti__gw {
    height: 10px;
    background-position: -2127px 0px;
  }

.drip-tab .iti__flag.iti__gy {
    height: 12px;
    background-position: -2149px 0px;
  }

.drip-tab .iti__flag.iti__hk {
    height: 14px;
    background-position: -2171px 0px;
  }

.drip-tab .iti__flag.iti__hm {
    height: 10px;
    background-position: -2193px 0px;
  }

.drip-tab .iti__flag.iti__hn {
    height: 10px;
    background-position: -2215px 0px;
  }

.drip-tab .iti__flag.iti__hr {
    height: 10px;
    background-position: -2237px 0px;
  }

.drip-tab .iti__flag.iti__ht {
    height: 12px;
    background-position: -2259px 0px;
  }

.drip-tab .iti__flag.iti__hu {
    height: 10px;
    background-position: -2281px 0px;
  }

.drip-tab .iti__flag.iti__ic {
    height: 14px;
    background-position: -2303px 0px;
  }

.drip-tab .iti__flag.iti__id {
    height: 14px;
    background-position: -2325px 0px;
  }

.drip-tab .iti__flag.iti__ie {
    height: 10px;
    background-position: -2347px 0px;
  }

.drip-tab .iti__flag.iti__il {
    height: 15px;
    background-position: -2369px 0px;
  }

.drip-tab .iti__flag.iti__im {
    height: 10px;
    background-position: -2391px 0px;
  }

.drip-tab .iti__flag.iti__in {
    height: 14px;
    background-position: -2413px 0px;
  }

.drip-tab .iti__flag.iti__io {
    height: 10px;
    background-position: -2435px 0px;
  }

.drip-tab .iti__flag.iti__iq {
    height: 14px;
    background-position: -2457px 0px;
  }

.drip-tab .iti__flag.iti__ir {
    height: 12px;
    background-position: -2479px 0px;
  }

.drip-tab .iti__flag.iti__is {
    height: 15px;
    background-position: -2501px 0px;
  }

.drip-tab .iti__flag.iti__it {
    height: 14px;
    background-position: -2523px 0px;
  }

.drip-tab .iti__flag.iti__je {
    height: 12px;
    background-position: -2545px 0px;
  }

.drip-tab .iti__flag.iti__jm {
    height: 10px;
    background-position: -2567px 0px;
  }

.drip-tab .iti__flag.iti__jo {
    height: 10px;
    background-position: -2589px 0px;
  }

.drip-tab .iti__flag.iti__jp {
    height: 14px;
    background-position: -2611px 0px;
  }

.drip-tab .iti__flag.iti__ke {
    height: 14px;
    background-position: -2633px 0px;
  }

.drip-tab .iti__flag.iti__kg {
    height: 12px;
    background-position: -2655px 0px;
  }

.drip-tab .iti__flag.iti__kh {
    height: 13px;
    background-position: -2677px 0px;
  }

.drip-tab .iti__flag.iti__ki {
    height: 10px;
    background-position: -2699px 0px;
  }

.drip-tab .iti__flag.iti__km {
    height: 12px;
    background-position: -2721px 0px;
  }

.drip-tab .iti__flag.iti__kn {
    height: 14px;
    background-position: -2743px 0px;
  }

.drip-tab .iti__flag.iti__kp {
    height: 10px;
    background-position: -2765px 0px;
  }

.drip-tab .iti__flag.iti__kr {
    height: 14px;
    background-position: -2787px 0px;
  }

.drip-tab .iti__flag.iti__kw {
    height: 10px;
    background-position: -2809px 0px;
  }

.drip-tab .iti__flag.iti__ky {
    height: 10px;
    background-position: -2831px 0px;
  }

.drip-tab .iti__flag.iti__kz {
    height: 10px;
    background-position: -2853px 0px;
  }

.drip-tab .iti__flag.iti__la {
    height: 14px;
    background-position: -2875px 0px;
  }

.drip-tab .iti__flag.iti__lb {
    height: 14px;
    background-position: -2897px 0px;
  }

.drip-tab .iti__flag.iti__lc {
    height: 10px;
    background-position: -2919px 0px;
  }

.drip-tab .iti__flag.iti__li {
    height: 12px;
    background-position: -2941px 0px;
  }

.drip-tab .iti__flag.iti__lk {
    height: 10px;
    background-position: -2963px 0px;
  }

.drip-tab .iti__flag.iti__lr {
    height: 11px;
    background-position: -2985px 0px;
  }

.drip-tab .iti__flag.iti__ls {
    height: 14px;
    background-position: -3007px 0px;
  }

.drip-tab .iti__flag.iti__lt {
    height: 12px;
    background-position: -3029px 0px;
  }

.drip-tab .iti__flag.iti__lu {
    height: 12px;
    background-position: -3051px 0px;
  }

.drip-tab .iti__flag.iti__lv {
    height: 10px;
    background-position: -3073px 0px;
  }

.drip-tab .iti__flag.iti__ly {
    height: 10px;
    background-position: -3095px 0px;
  }

.drip-tab .iti__flag.iti__ma {
    height: 14px;
    background-position: -3117px 0px;
  }

.drip-tab .iti__flag.iti__mc {
    height: 15px;
    background-position: -3139px 0px;
  }

.drip-tab .iti__flag.iti__md {
    height: 10px;
    background-position: -3160px 0px;
  }

.drip-tab .iti__flag.iti__me {
    height: 10px;
    background-position: -3182px 0px;
  }

.drip-tab .iti__flag.iti__mf {
    height: 14px;
    background-position: -3204px 0px;
  }

.drip-tab .iti__flag.iti__mg {
    height: 14px;
    background-position: -3226px 0px;
  }

.drip-tab .iti__flag.iti__mh {
    height: 11px;
    background-position: -3248px 0px;
  }

.drip-tab .iti__flag.iti__mk {
    height: 10px;
    background-position: -3270px 0px;
  }

.drip-tab .iti__flag.iti__ml {
    height: 14px;
    background-position: -3292px 0px;
  }

.drip-tab .iti__flag.iti__mm {
    height: 14px;
    background-position: -3314px 0px;
  }

.drip-tab .iti__flag.iti__mn {
    height: 10px;
    background-position: -3336px 0px;
  }

.drip-tab .iti__flag.iti__mo {
    height: 14px;
    background-position: -3358px 0px;
  }

.drip-tab .iti__flag.iti__mp {
    height: 10px;
    background-position: -3380px 0px;
  }

.drip-tab .iti__flag.iti__mq {
    height: 14px;
    background-position: -3402px 0px;
  }

.drip-tab .iti__flag.iti__mr {
    height: 14px;
    background-position: -3424px 0px;
  }

.drip-tab .iti__flag.iti__ms {
    height: 10px;
    background-position: -3446px 0px;
  }

.drip-tab .iti__flag.iti__mt {
    height: 14px;
    background-position: -3468px 0px;
  }

.drip-tab .iti__flag.iti__mu {
    height: 14px;
    background-position: -3490px 0px;
  }

.drip-tab .iti__flag.iti__mv {
    height: 14px;
    background-position: -3512px 0px;
  }

.drip-tab .iti__flag.iti__mw {
    height: 14px;
    background-position: -3534px 0px;
  }

.drip-tab .iti__flag.iti__mx {
    height: 12px;
    background-position: -3556px 0px;
  }

.drip-tab .iti__flag.iti__my {
    height: 10px;
    background-position: -3578px 0px;
  }

.drip-tab .iti__flag.iti__mz {
    height: 14px;
    background-position: -3600px 0px;
  }

.drip-tab .iti__flag.iti__na {
    height: 14px;
    background-position: -3622px 0px;
  }

.drip-tab .iti__flag.iti__nc {
    height: 10px;
    background-position: -3644px 0px;
  }

.drip-tab .iti__flag.iti__ne {
    height: 15px;
    background-position: -3666px 0px;
  }

.drip-tab .iti__flag.iti__nf {
    height: 10px;
    background-position: -3686px 0px;
  }

.drip-tab .iti__flag.iti__ng {
    height: 10px;
    background-position: -3708px 0px;
  }

.drip-tab .iti__flag.iti__ni {
    height: 12px;
    background-position: -3730px 0px;
  }

.drip-tab .iti__flag.iti__nl {
    height: 14px;
    background-position: -3752px 0px;
  }

.drip-tab .iti__flag.iti__no {
    height: 15px;
    background-position: -3774px 0px;
  }

.drip-tab .iti__flag.iti__np {
    height: 15px;
    background-position: -3796px 0px;
  }

.drip-tab .iti__flag.iti__nr {
    height: 10px;
    background-position: -3811px 0px;
  }

.drip-tab .iti__flag.iti__nu {
    height: 10px;
    background-position: -3833px 0px;
  }

.drip-tab .iti__flag.iti__nz {
    height: 10px;
    background-position: -3855px 0px;
  }

.drip-tab .iti__flag.iti__om {
    height: 10px;
    background-position: -3877px 0px;
  }

.drip-tab .iti__flag.iti__pa {
    height: 14px;
    background-position: -3899px 0px;
  }

.drip-tab .iti__flag.iti__pe {
    height: 14px;
    background-position: -3921px 0px;
  }

.drip-tab .iti__flag.iti__pf {
    height: 14px;
    background-position: -3943px 0px;
  }

.drip-tab .iti__flag.iti__pg {
    height: 15px;
    background-position: -3965px 0px;
  }

.drip-tab .iti__flag.iti__ph {
    height: 10px;
    background-position: -3987px 0px;
  }

.drip-tab .iti__flag.iti__pk {
    height: 14px;
    background-position: -4009px 0px;
  }

.drip-tab .iti__flag.iti__pl {
    height: 13px;
    background-position: -4031px 0px;
  }

.drip-tab .iti__flag.iti__pm {
    height: 14px;
    background-position: -4053px 0px;
  }

.drip-tab .iti__flag.iti__pn {
    height: 10px;
    background-position: -4075px 0px;
  }

.drip-tab .iti__flag.iti__pr {
    height: 14px;
    background-position: -4097px 0px;
  }

.drip-tab .iti__flag.iti__ps {
    height: 10px;
    background-position: -4119px 0px;
  }

.drip-tab .iti__flag.iti__pt {
    height: 14px;
    background-position: -4141px 0px;
  }

.drip-tab .iti__flag.iti__pw {
    height: 13px;
    background-position: -4163px 0px;
  }

.drip-tab .iti__flag.iti__py {
    height: 11px;
    background-position: -4185px 0px;
  }

.drip-tab .iti__flag.iti__qa {
    height: 8px;
    background-position: -4207px 0px;
  }

.drip-tab .iti__flag.iti__re {
    height: 14px;
    background-position: -4229px 0px;
  }

.drip-tab .iti__flag.iti__ro {
    height: 14px;
    background-position: -4251px 0px;
  }

.drip-tab .iti__flag.iti__rs {
    height: 14px;
    background-position: -4273px 0px;
  }

.drip-tab .iti__flag.iti__ru {
    height: 14px;
    background-position: -4295px 0px;
  }

.drip-tab .iti__flag.iti__rw {
    height: 14px;
    background-position: -4317px 0px;
  }

.drip-tab .iti__flag.iti__sa {
    height: 14px;
    background-position: -4339px 0px;
  }

.drip-tab .iti__flag.iti__sb {
    height: 10px;
    background-position: -4361px 0px;
  }

.drip-tab .iti__flag.iti__sc {
    height: 10px;
    background-position: -4383px 0px;
  }

.drip-tab .iti__flag.iti__sd {
    height: 10px;
    background-position: -4405px 0px;
  }

.drip-tab .iti__flag.iti__se {
    height: 13px;
    background-position: -4427px 0px;
  }

.drip-tab .iti__flag.iti__sg {
    height: 14px;
    background-position: -4449px 0px;
  }

.drip-tab .iti__flag.iti__sh {
    height: 10px;
    background-position: -4471px 0px;
  }

.drip-tab .iti__flag.iti__si {
    height: 10px;
    background-position: -4493px 0px;
  }

.drip-tab .iti__flag.iti__sj {
    height: 15px;
    background-position: -4515px 0px;
  }

.drip-tab .iti__flag.iti__sk {
    height: 14px;
    background-position: -4537px 0px;
  }

.drip-tab .iti__flag.iti__sl {
    height: 14px;
    background-position: -4559px 0px;
  }

.drip-tab .iti__flag.iti__sm {
    height: 15px;
    background-position: -4581px 0px;
  }

.drip-tab .iti__flag.iti__sn {
    height: 14px;
    background-position: -4603px 0px;
  }

.drip-tab .iti__flag.iti__so {
    height: 14px;
    background-position: -4625px 0px;
  }

.drip-tab .iti__flag.iti__sr {
    height: 14px;
    background-position: -4647px 0px;
  }

.drip-tab .iti__flag.iti__ss {
    height: 10px;
    background-position: -4669px 0px;
  }

.drip-tab .iti__flag.iti__st {
    height: 10px;
    background-position: -4691px 0px;
  }

.drip-tab .iti__flag.iti__sv {
    height: 12px;
    background-position: -4713px 0px;
  }

.drip-tab .iti__flag.iti__sx {
    height: 14px;
    background-position: -4735px 0px;
  }

.drip-tab .iti__flag.iti__sy {
    height: 14px;
    background-position: -4757px 0px;
  }

.drip-tab .iti__flag.iti__sz {
    height: 14px;
    background-position: -4779px 0px;
  }

.drip-tab .iti__flag.iti__ta {
    height: 10px;
    background-position: -4801px 0px;
  }

.drip-tab .iti__flag.iti__tc {
    height: 10px;
    background-position: -4823px 0px;
  }

.drip-tab .iti__flag.iti__td {
    height: 14px;
    background-position: -4845px 0px;
  }

.drip-tab .iti__flag.iti__tf {
    height: 14px;
    background-position: -4867px 0px;
  }

.drip-tab .iti__flag.iti__tg {
    height: 13px;
    background-position: -4889px 0px;
  }

.drip-tab .iti__flag.iti__th {
    height: 14px;
    background-position: -4911px 0px;
  }

.drip-tab .iti__flag.iti__tj {
    height: 10px;
    background-position: -4933px 0px;
  }

.drip-tab .iti__flag.iti__tk {
    height: 10px;
    background-position: -4955px 0px;
  }

.drip-tab .iti__flag.iti__tl {
    height: 10px;
    background-position: -4977px 0px;
  }

.drip-tab .iti__flag.iti__tm {
    height: 14px;
    background-position: -4999px 0px;
  }

.drip-tab .iti__flag.iti__tn {
    height: 14px;
    background-position: -5021px 0px;
  }

.drip-tab .iti__flag.iti__to {
    height: 10px;
    background-position: -5043px 0px;
  }

.drip-tab .iti__flag.iti__tr {
    height: 14px;
    background-position: -5065px 0px;
  }

.drip-tab .iti__flag.iti__tt {
    height: 12px;
    background-position: -5087px 0px;
  }

.drip-tab .iti__flag.iti__tv {
    height: 10px;
    background-position: -5109px 0px;
  }

.drip-tab .iti__flag.iti__tw {
    height: 14px;
    background-position: -5131px 0px;
  }

.drip-tab .iti__flag.iti__tz {
    height: 14px;
    background-position: -5153px 0px;
  }

.drip-tab .iti__flag.iti__ua {
    height: 14px;
    background-position: -5175px 0px;
  }

.drip-tab .iti__flag.iti__ug {
    height: 14px;
    background-position: -5197px 0px;
  }

.drip-tab .iti__flag.iti__um {
    height: 11px;
    background-position: -5219px 0px;
  }

.drip-tab .iti__flag.iti__un {
    height: 14px;
    background-position: -5241px 0px;
  }

.drip-tab .iti__flag.iti__us {
    height: 11px;
    background-position: -5263px 0px;
  }

.drip-tab .iti__flag.iti__uy {
    height: 14px;
    background-position: -5285px 0px;
  }

.drip-tab .iti__flag.iti__uz {
    height: 10px;
    background-position: -5307px 0px;
  }

.drip-tab .iti__flag.iti__va {
    height: 15px;
    background-position: -5329px 0px;
  }

.drip-tab .iti__flag.iti__vc {
    height: 14px;
    background-position: -5346px 0px;
  }

.drip-tab .iti__flag.iti__ve {
    height: 14px;
    background-position: -5368px 0px;
  }

.drip-tab .iti__flag.iti__vg {
    height: 10px;
    background-position: -5390px 0px;
  }

.drip-tab .iti__flag.iti__vi {
    height: 14px;
    background-position: -5412px 0px;
  }

.drip-tab .iti__flag.iti__vn {
    height: 14px;
    background-position: -5434px 0px;
  }

.drip-tab .iti__flag.iti__vu {
    height: 12px;
    background-position: -5456px 0px;
  }

.drip-tab .iti__flag.iti__wf {
    height: 14px;
    background-position: -5478px 0px;
  }

.drip-tab .iti__flag.iti__ws {
    height: 10px;
    background-position: -5500px 0px;
  }

.drip-tab .iti__flag.iti__xk {
    height: 15px;
    background-position: -5522px 0px;
  }

.drip-tab .iti__flag.iti__ye {
    height: 14px;
    background-position: -5544px 0px;
  }

.drip-tab .iti__flag.iti__yt {
    height: 14px;
    background-position: -5566px 0px;
  }

.drip-tab .iti__flag.iti__za {
    height: 14px;
    background-position: -5588px 0px;
  }

.drip-tab .iti__flag.iti__zm {
    height: 14px;
    background-position: -5610px 0px;
  }

.drip-tab .iti__flag.iti__zw {
    height: 10px;
    background-position: -5632px 0px;
  }

.drip-tab .iti__flag {
    height: 15px;
    box-shadow: 0px 0px 1px 0px #888;
    background-image: url("flags.png");
    background-repeat: no-repeat;
    background-position: 20px 0;
  }

.drip-tab .iti__flag.iti__np {
  background-color: transparent;
}

.drip-tab .iti__flag {
  background-image: url("https://d14jnfavjicsbe.cloudfront.net/images/client/flags.png");
};

@media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
  .drip-tab .iti__flag {
    background-image: url("https://d14jnfavjicsbe.cloudfront.net/images/client/flags@2x.png");
  }
}

/* stylelint-enable */


  /* preview settings */
  body.after-submit-preview .drip-panel:not(.drip-success) {
    display: none !important;
  }
  body.after-submit-preview .drip-success {
    display: block !important;
  }

  /* stylelint-enable */

</style><style id="fit-vids-style">.fluid-width-video-wrapper{width:100%;position:relative;padding:0;}.fluid-width-video-wrapper iframe,.fluid-width-video-wrapper object,.fluid-width-video-wrapper embed {position:absolute;top:0;left:0;width:100%;height:100%;}</style><link rel="stylesheet" type="text/css" href="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/twitcount.css" media="all"></head>
<body class="post-template-default single single-post postid-3349 single-format-standard chrome alt-style-default two-col-left width-960 two-col-left-960" data-new-gr-c-s-check-loaded="14.1001.0" data-gr-ext-installed="">
<div id="wrapper">

	<div id="inner-wrapper">

	<h3 class="nav-toggle icon"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#navigation">Navigation</a></h3>

	<header id="header" class="col-full">

		<div id="logo">
<a href="https://machinelearningmastery.com/" title="Making developers awesome at machine learning"><img width="480" height="80" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/Header_smaller_text_better-1.webp" alt="Machine Learning Mastery"></a>
<span class="site-title"><a href="https://machinelearningmastery.com/">Machine Learning Mastery</a></span>
<span class="site-description">Making developers awesome at machine learning</span>
</div>
	    <div class="header-widget">
	        <div id="custom_html-26" class="widget_text widget widget_custom_html"><div class="textwidget custom-html-widget"><div style="text-align: right;">
	<a href="https://machinelearningmastery.lpages.co/machine-learning-resource-guide/">Click to Take the FREE Crash-Course</a>
</div></div></div><div id="search-4" class="widget widget_search"><div class="search_main">
    <form method="get" class="searchform" action="https://machinelearningmastery.com/">
        <input type="text" class="field s" name="s" value="Search..." onfocus="if (!window.__cfRLUnblockHandlers) return false; if (this.value == &#39;Search...&#39;) {this.value = &#39;&#39;;}" onblur="if (!window.__cfRLUnblockHandlers) return false; if (this.value == &#39;&#39;) {this.value = &#39;Search...&#39;;}">
		<input type="hidden" name="post_type" value="post">
        <button type="submit" class="fa fa-search submit" name="submit" value="Search"></button>
    </form>
    <div class="fix"></div>
</div></div>	    </div>
	
	</header>
	<nav id="navigation" class="col-full" role="navigation">

	
	<section class="menus">

		<a href="https://machinelearningmastery.com/" class="nav-home"><span>Home</span></a>

	<h3>Main Menu</h3><ul id="main-nav" class="nav fl"><li id="menu-item-6503" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6503"><a href="https://machinelearningmastery.com/start-here/">Get Started</a></li>
<li id="menu-item-6501" class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-6501"><a href="https://machinelearningmastery.com/blog/">Blog</a></li>
<li id="menu-item-6506" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-6506 parent"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#">Topics</a>
<ul class="sub-menu">
	<li id="menu-item-6508" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6508"><a href="https://machinelearningmastery.com/category/deep-learning/">Deep Learning (keras)</a></li>
	<li id="menu-item-7921" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-7921"><a href="https://machinelearningmastery.com/category/deep-learning-for-computer-vision/">Computer Vision</a></li>
	<li id="menu-item-6509" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6509"><a href="https://machinelearningmastery.com/category/deep-learning-time-series/">Neural Net Time Series</a></li>
	<li id="menu-item-6515" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6515"><a href="https://machinelearningmastery.com/category/natural-language-processing/">NLP (Text)</a></li>
	<li id="menu-item-8576" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-8576"><a href="https://machinelearningmastery.com/category/generative-adversarial-networks/">GANs</a></li>
	<li id="menu-item-6511" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6511"><a href="https://machinelearningmastery.com/category/lstm/">LSTMs</a></li>
	<li id="menu-item-7106" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-7106"><a href="https://machinelearningmastery.com/category/better-deep-learning/">Better Deep Learning</a></li>
	<li id="menu-item-6512" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6512"><a href="https://machinelearningmastery.com/category/machine-learning-algorithms/">Intro to Algorithms</a></li>
	<li id="menu-item-6507" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-6507"><a href="https://machinelearningmastery.com/category/algorithms-from-scratch/">Code Algorithms</a></li>
	<li id="menu-item-6520" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6520"><a href="https://machinelearningmastery.com/category/time-series/">Intro to Time Series</a></li>
	<li id="menu-item-6516" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6516"><a href="https://machinelearningmastery.com/category/python-machine-learning/">Python (scikit-learn)</a></li>
	<li id="menu-item-11055" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-11055"><a href="https://machinelearningmastery.com/category/ensemble-learning/">Ensemble Learning</a></li>
	<li id="menu-item-9966" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-9966"><a href="https://machinelearningmastery.com/category/imbalanced-classification/">Imbalanced Learning</a></li>
	<li id="menu-item-10674" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-10674"><a href="https://machinelearningmastery.com/category/data-preparation/">Data Preparation</a></li>
	<li id="menu-item-6517" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6517"><a href="https://machinelearningmastery.com/category/r-machine-learning/">R (caret)</a></li>
	<li id="menu-item-6522" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6522"><a href="https://machinelearningmastery.com/category/weka-machine-learning/">Weka (no code)</a></li>
	<li id="menu-item-6510" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6510"><a href="https://machinelearningmastery.com/category/linear-algebra/">Linear Algebra</a></li>
	<li id="menu-item-6519" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6519"><a href="https://machinelearningmastery.com/category/statistical-methods/">Statistics</a></li>
	<li id="menu-item-8989" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-8989"><a href="https://machinelearningmastery.com/category/probability/">Probability</a></li>
	<li id="menu-item-6523" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6523"><a href="https://machinelearningmastery.com/category/xgboost/">XGBoost</a></li>
</ul>
</li>
<li id="menu-item-6502" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6502"><a href="https://machinelearningmastery.com/products/">EBooks</a></li>
<li id="menu-item-6500" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6500"><a href="https://machinelearningmastery.com/faq/">FAQ</a></li>
<li id="menu-item-6504" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6504"><a href="https://machinelearningmastery.com/about/">About</a></li>
<li id="menu-item-6505" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6505"><a href="https://machinelearningmastery.com/contact/">Contact</a></li>
</ul>	<div class="side-nav">
		</div><!-- /#side-nav -->

	</section><!-- /.menus -->

	<a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#top" class="nav-close"><span>Return to Content</span></a>

</nav>
       
    <!-- #content Starts -->
	    <div id="content" class="col-full">
    
    	<div id="main-sidebar-container">    

            <!-- #main Starts -->
                        <section id="main">                       
<article class="post-3349 post type-post status-publish format-standard has-post-thumbnail hentry category-algorithms-from-scratch">
	<header>
	<h1 class="title entry-title">How to Code a Neural Network with Backpropagation In Python (from scratch)</h1>	</header>
<div class="post-meta"><span class="small">By</span> <span class="author vcard"><span class="fn"><a href="https://machinelearningmastery.com/author/jasonb/" title="Posts by Jason Brownlee" rel="author">Jason Brownlee</a></span></span> <span class="small">on</span> <abbr class="date time published updated" title="2016-11-07T05:00:52+1100">November 7, 2016</abbr>  <span class="small">in</span> <span class="categories"><a href="https://machinelearningmastery.com/category/algorithms-from-scratch/" title="View all items in Code Algorithms From Scratch">Code Algorithms From Scratch</a></span>  </div>
	<section class="entry">
<div class="simplesocialbuttons simplesocial-simple-icons simplesocialbuttons_inline simplesocialbuttons-align-left post-3349 post simplesocialbuttons-inline-no-animation simplesocialbuttons-inline-in">
<button class="ssb_tweet-icon" data-href="https://twitter.com/share?text=How+to+Code+a+Neural+Network+with+Backpropagation+In+Python+%28from+scratch%29&amp;url=https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/" rel="nofollow" onclick="if (!window.__cfRLUnblockHandlers) return false; javascript:window.open(this.dataset.href, &#39;&#39;, &#39;menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600&#39;);return false;">
						<span class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 72 72"><path fill="none" d="M0 0h72v72H0z"></path><path class="icon" fill="#fff" d="M68.812 15.14c-2.348 1.04-4.87 1.744-7.52 2.06 2.704-1.62 4.78-4.186 5.757-7.243-2.53 1.5-5.33 2.592-8.314 3.176C56.35 10.59 52.948 9 49.182 9c-7.23 0-13.092 5.86-13.092 13.093 0 1.026.118 2.02.338 2.98C25.543 24.527 15.9 19.318 9.44 11.396c-1.125 1.936-1.77 4.184-1.77 6.58 0 4.543 2.312 8.552 5.824 10.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163 0 6.345 4.513 11.638 10.504 12.84-1.1.298-2.256.457-3.45.457-.845 0-1.666-.078-2.464-.23 1.667 5.2 6.5 8.985 12.23 9.09-4.482 3.51-10.13 5.605-16.26 5.605-1.055 0-2.096-.06-3.122-.184 5.794 3.717 12.676 5.882 20.067 5.882 24.083 0 37.25-19.95 37.25-37.25 0-.565-.013-1.133-.038-1.693 2.558-1.847 4.778-4.15 6.532-6.774z"></path></svg></span><i class="simplesocialtxt">Tweet </i></button>
		<button class="ssb_fbshare-icon" target="_blank" data-href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/" onclick="if (!window.__cfRLUnblockHandlers) return false; javascript:window.open(this.dataset.href, &#39;&#39;, &#39;menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600&#39;);return false;">
						<span class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" class="_1pbq" color="#ffffff"><path fill="#ffffff" fill-rule="evenodd" class="icon" d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z"></path></svg></span>
						<span class="simplesocialtxt">Share </span> </button>
<button class="ssb_linkedin-icon" data-href="https://www.linkedin.com/cws/share?url=https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/" onclick="if (!window.__cfRLUnblockHandlers) return false; javascript:window.open(this.dataset.href, &#39;&#39;, &#39;menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600&#39;);return false;">
						<span class="icon"> <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="15px" height="14.1px" viewBox="-301.4 387.5 15 14.1" enable-background="new -301.4 387.5 15 14.1" xml:space="preserve"> <g id="XMLID_398_"> <path id="XMLID_399_" fill="#FFFFFF" d="M-296.2,401.6c0-3.2,0-6.3,0-9.5h0.1c1,0,2,0,2.9,0c0.1,0,0.1,0,0.1,0.1c0,0.4,0,0.8,0,1.2 c0.1-0.1,0.2-0.3,0.3-0.4c0.5-0.7,1.2-1,2.1-1.1c0.8-0.1,1.5,0,2.2,0.3c0.7,0.4,1.2,0.8,1.5,1.4c0.4,0.8,0.6,1.7,0.6,2.5 c0,1.8,0,3.6,0,5.4v0.1c-1.1,0-2.1,0-3.2,0c0-0.1,0-0.1,0-0.2c0-1.6,0-3.2,0-4.8c0-0.4,0-0.8-0.2-1.2c-0.2-0.7-0.8-1-1.6-1 c-0.8,0.1-1.3,0.5-1.6,1.2c-0.1,0.2-0.1,0.5-0.1,0.8c0,1.7,0,3.4,0,5.1c0,0.2,0,0.2-0.2,0.2c-1,0-1.9,0-2.9,0 C-296.1,401.6-296.2,401.6-296.2,401.6z"></path> <path id="XMLID_400_" fill="#FFFFFF" d="M-298,401.6L-298,401.6c-1.1,0-2.1,0-3,0c-0.1,0-0.1,0-0.1-0.1c0-3.1,0-6.1,0-9.2 c0-0.1,0-0.1,0.1-0.1c1,0,2,0,2.9,0h0.1C-298,395.3-298,398.5-298,401.6z"></path> <path id="XMLID_401_" fill="#FFFFFF" d="M-299.6,390.9c-0.7-0.1-1.2-0.3-1.6-0.8c-0.5-0.8-0.2-2.1,1-2.4c0.6-0.2,1.2-0.1,1.8,0.2 c0.5,0.4,0.7,0.9,0.6,1.5c-0.1,0.7-0.5,1.1-1.1,1.3C-299.1,390.8-299.4,390.8-299.6,390.9L-299.6,390.9z"></path> </g> </svg> </span>
						<span class="simplesocialtxt">Share</span> </button>
</div>
<p id="last-modified-info">Last Updated on December 1, 2019</p>
<p>The backpropagation algorithm is used in the classical feed-forward artificial neural network.</p>
<p>It is the technique still used to train large <a href="https://machinelearningmastery.com/what-is-deep-learning/">deep learning</a> networks.</p>
<p>In this tutorial, you will discover how to implement the backpropagation algorithm for a neural network from scratch with Python.</p>
<p>After completing this tutorial, you will know:</p>
<ul>
<li>How to forward-propagate an input to calculate an output.</li>
<li>How to back-propagate error and train a network.</li>
<li>How to apply the backpropagation algorithm to a real-world predictive modeling problem.</li>
</ul>
<p><strong>Kick-start your project</strong> with my new book <a href="https://machinelearningmastery.com/machine-learning-algorithms-from-scratch/">Machine Learning Algorithms From Scratch</a>, including <em>step-by-step tutorials</em> and the <em>Python source code</em> files for all examples.</p>
<p>Let’s get started.</p>
<ul>
<li><strong>Update Nov/2016</strong>: Fixed a bug in the activate() function. Thanks Alex!</li>
<li><strong>Update Jan/2017</strong>: Fixes issues with Python 3.</li>
<li><strong>Update Jan/2017</strong>: Updated small bug in update_weights(). Thanks Tomasz!</li>
<li><strong>Update Apr/2018</strong>: Added direct link to CSV dataset.</li>
<li><strong>Update Aug/2018</strong>: Tested and updated to work with Python 3.6.</li>
<li><strong>Update Sep/2019</strong>: Updated <a href="https://raw.githubusercontent.com/jbrownlee/Datasets/master/wheat-seeds.csv">wheat-seeds.csv</a> to fix formatting issues.</li>
</ul>
<div id="attachment_3350" style="width: 650px" class="wp-caption aligncenter"><img aria-describedby="caption-attachment-3350" loading="lazy" class="size-full wp-image-3350" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/How-to-Implement-the-Backpropagation-Algorithm-From-Scratch-In-Pyt.jpg" alt="How to Implement the Backpropagation Algorithm From Scratch In Python" width="640" height="512" srcset="https://machinelearningmastery.com/wp-content/uploads/2016/11/How-to-Implement-the-Backpropagation-Algorithm-From-Scratch-In-Python.jpg 640w, https://machinelearningmastery.com/wp-content/uploads/2016/11/How-to-Implement-the-Backpropagation-Algorithm-From-Scratch-In-Python-300x240.jpg 300w" sizes="(max-width: 640px) 100vw, 640px"><p id="caption-attachment-3350" class="wp-caption-text">How to Implement the Backpropagation Algorithm From Scratch In Python<br>Photo by <a href="https://www.flickr.com/photos/nichd/21086425615/">NICHD</a>, some rights reserved.</p></div>
<h2>Description</h2>
<p>This section provides a brief introduction to the Backpropagation Algorithm and the Wheat Seeds dataset that we will be using in this tutorial.</p>
<h3>Backpropagation Algorithm</h3>
<p>The Backpropagation algorithm is a supervised learning method for multilayer feed-forward networks from the field of Artificial Neural Networks.</p>
<p>Feed-forward neural networks are inspired by the information processing of one or more neural cells, called a neuron. A neuron accepts input signals via its dendrites, which pass the electrical signal down to the cell body. The axon carries the signal out to synapses, which are the connections of a cell’s axon to other cell’s dendrites.</p>
<p>The principle of the backpropagation approach is to model a given function by modifying internal weightings of input signals to produce an expected output signal. The system is trained using a supervised learning method, where the error between the system’s output and a known expected output is presented to the system and used to modify its internal state.</p>
<p>Technically, the backpropagation algorithm is a method for training the weights in a multilayer feed-forward neural network. As such, it requires a network structure to be defined of one or more layers where one layer is fully connected to the next layer. A standard network structure is one input layer, one hidden layer, and one output layer.</p>
<p>Backpropagation can be used for both classification and regression problems, but we will focus on classification in this tutorial.</p>
<p>In classification problems, best results are achieved when the network has one neuron in the output layer for each class value. For example, a 2-class or binary classification problem with the class values of A and B. These expected outputs would have to be transformed into binary vectors with one column for each class value. Such as [1, 0] and [0, 1] for A and B respectively. This is called a one hot encoding.</p>
<h3>Wheat Seeds Dataset</h3>
<p>The seeds dataset involves the prediction of species given measurements seeds from different varieties of wheat.</p>
<p>There are 201 records and 7 numerical input variables. It is a classification problem with 3 output classes. The scale for each numeric input value vary, so some data normalization may be required for use with algorithms that weight inputs like the backpropagation algorithm.</p>
<p>Below is a sample of the first 5 rows of the dataset.</p>
		<div id="urvanov-syntax-highlighter-6060ca9c63b74772759744" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18.9915px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">15.26,14.84,0.871,5.763,3.312,2.221,5.22,1
14.88,14.57,0.8811,5.554,3.333,1.018,4.956,1
14.29,14.09,0.905,5.291,3.337,2.699,4.825,1
13.84,13.94,0.8955,5.324,3.379,2.259,4.805,1
16.14,14.99,0.9034,5.658,3.562,1.355,5.175,1</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b74772759744-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b74772759744-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b74772759744-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b74772759744-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b74772759744-5">5</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b74772759744-1">15.26,14.84,0.871,5.763,3.312,2.221,5.22,1</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b74772759744-2">14.88,14.57,0.8811,5.554,3.333,1.018,4.956,1</div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b74772759744-3">14.29,14.09,0.905,5.291,3.337,2.699,4.825,1</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b74772759744-4">13.84,13.94,0.8955,5.324,3.379,2.259,4.805,1</div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b74772759744-5">16.14,14.99,0.9034,5.658,3.562,1.355,5.175,1</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Using the Zero Rule algorithm that predicts the most common class value, the baseline accuracy for the problem is 28.095%.</p>
<p>You can learn more and download the seeds dataset from the <a href="https://archive.ics.uci.edu/ml/datasets/seeds">UCI Machine Learning Repository</a>.</p>
<p>Download the seeds dataset and place it into your current working directory with the filename <strong>seeds_dataset.csv</strong>.</p>
<p>The dataset is in tab-separated format, so you must convert it to CSV using a text editor or a spreadsheet program.</p>
<p>Update, download the dataset in CSV format directly:</p>
<ul>
<li><a href="https://raw.githubusercontent.com/jbrownlee/Datasets/master/wheat-seeds.csv">Download Wheat Seeds Dataset</a></li>
</ul>
<h2>Tutorial</h2>
<p>This tutorial is broken down into 6 parts:</p>
<ol>
<li>Initialize Network.</li>
<li>Forward Propagate.</li>
<li>Back Propagate Error.</li>
<li>Train Network.</li>
<li>Predict.</li>
<li>Seeds Dataset Case Study.</li>
</ol>
<p>These steps will provide the foundation that you need to implement the backpropagation algorithm from scratch and apply it to your own predictive modeling problems.</p>
<h3>1. Initialize Network</h3>
<p>Let’s start with something easy, the creation of a new network ready for training.</p>
<p>Each neuron has a set of weights that need to be maintained. One weight for each input connection and an additional weight for the bias. We will need to store additional properties for a neuron during training, therefore we will use a dictionary to represent each neuron and store properties by names such as ‘<strong>weights</strong>‘ for the weights.</p>
<p>A network is organized into layers. The input layer is really just a row from our training dataset. The first real layer is the hidden layer. This is followed by the output layer that has one neuron for each class value.</p>
<p>We will organize layers as arrays of dictionaries and treat the whole network as an array of layers.</p>
<p>It is good practice to initialize the network weights to small random numbers. In this case, will we use random numbers in the range of 0 to 1.</p>
<p>Below is a function named <strong>initialize_network()</strong> that creates a new neural network ready for training. It accepts three parameters, the number of inputs, the number of neurons to have in the hidden layer and the number of outputs.</p>
<p>You can see that for the hidden layer we create <strong>n_hidden</strong> neurons and each neuron in the hidden layer has <strong>n_inputs + 1</strong> weights, one for each input column in a dataset and an additional one for the bias.</p>
<p>You can also see that the output layer that connects to the hidden layer has <strong>n_outputs</strong> neurons, each with <strong>n_hidden + 1</strong> weights. This means that each neuron in the output layer connects to (has a weight for) each neuron in the hidden layer.</p>
		<div id="urvanov-syntax-highlighter-6060ca9c63b79706043208" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18.9915px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># Initialize a network
def initialize_network(n_inputs, n_hidden, n_outputs):
	network = list()
	hidden_layer = [{'weights':[random() for i in range(n_inputs + 1)]} for i in range(n_hidden)]
	network.append(hidden_layer)
	output_layer = [{'weights':[random() for i in range(n_hidden + 1)]} for i in range(n_outputs)]
	network.append(output_layer)
	return network</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b79706043208-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b79706043208-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b79706043208-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b79706043208-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b79706043208-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b79706043208-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b79706043208-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b79706043208-8">8</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b79706043208-1"><span class="crayon-p"># Initialize a network</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b79706043208-2"><span class="crayon-e">def </span><span class="crayon-e">initialize_network</span><span class="crayon-sy">(</span><span class="crayon-v">n_inputs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_hidden</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_outputs</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b79706043208-3"><span class="crayon-h">	</span><span class="crayon-v">network</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b79706043208-4"><span class="crayon-h">	</span><span class="crayon-v">hidden_layer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">{</span><span class="crayon-s">'weights'</span><span class="crayon-o">:</span><span class="crayon-sy">[</span><span class="crayon-e">random</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_inputs</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_hidden</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b79706043208-5"><span class="crayon-h">	</span><span class="crayon-v">network</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">hidden_layer</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b79706043208-6"><span class="crayon-h">	</span><span class="crayon-v">output_layer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">{</span><span class="crayon-s">'weights'</span><span class="crayon-o">:</span><span class="crayon-sy">[</span><span class="crayon-e">random</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_hidden</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_outputs</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b79706043208-7"><span class="crayon-h">	</span><span class="crayon-v">network</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">output_layer</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b79706043208-8"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">network</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Let’s test out this function. Below is a complete example that creates a small network.</p>
		<div id="urvanov-syntax-highlighter-6060ca9c63b7a436605642" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18.9915px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">from random import seed
from random import random

# Initialize a network
def initialize_network(n_inputs, n_hidden, n_outputs):
	network = list()
	hidden_layer = [{'weights':[random() for i in range(n_inputs + 1)]} for i in range(n_hidden)]
	network.append(hidden_layer)
	output_layer = [{'weights':[random() for i in range(n_hidden + 1)]} for i in range(n_outputs)]
	network.append(output_layer)
	return network

seed(1)
network = initialize_network(2, 1, 2)
for layer in network:
	print(layer)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b7a436605642-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b7a436605642-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b7a436605642-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b7a436605642-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b7a436605642-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b7a436605642-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b7a436605642-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b7a436605642-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b7a436605642-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b7a436605642-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b7a436605642-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b7a436605642-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b7a436605642-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b7a436605642-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b7a436605642-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b7a436605642-16">16</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b7a436605642-1"><span class="crayon-e">from </span><span class="crayon-e">random </span><span class="crayon-e">import </span><span class="crayon-e">seed</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b7a436605642-2"><span class="crayon-e">from </span><span class="crayon-e">random </span><span class="crayon-e">import </span><span class="crayon-i">random</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b7a436605642-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b7a436605642-4"><span class="crayon-p"># Initialize a network</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b7a436605642-5"><span class="crayon-e">def </span><span class="crayon-e">initialize_network</span><span class="crayon-sy">(</span><span class="crayon-v">n_inputs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_hidden</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_outputs</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b7a436605642-6"><span class="crayon-h">	</span><span class="crayon-v">network</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b7a436605642-7"><span class="crayon-h">	</span><span class="crayon-v">hidden_layer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">{</span><span class="crayon-s">'weights'</span><span class="crayon-o">:</span><span class="crayon-sy">[</span><span class="crayon-e">random</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_inputs</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_hidden</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b7a436605642-8"><span class="crayon-h">	</span><span class="crayon-v">network</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">hidden_layer</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b7a436605642-9"><span class="crayon-h">	</span><span class="crayon-v">output_layer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">{</span><span class="crayon-s">'weights'</span><span class="crayon-o">:</span><span class="crayon-sy">[</span><span class="crayon-e">random</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_hidden</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_outputs</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b7a436605642-10"><span class="crayon-h">	</span><span class="crayon-v">network</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">output_layer</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b7a436605642-11"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">network</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b7a436605642-12">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b7a436605642-13"><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b7a436605642-14"><span class="crayon-v">network</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">initialize_network</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b7a436605642-15"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">layer </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b7a436605642-16"><span class="crayon-h">	</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">layer</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Running the example, you can see that the code prints out each layer one by one. You can see the hidden layer has one neuron with 2 input weights plus the bias. The output layer has 2 neurons, each with 1 weight plus the bias.</p>
		<div id="urvanov-syntax-highlighter-6060ca9c63b7b202154139" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18.9915px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">[{'weights': [0.13436424411240122, 0.8474337369372327, 0.763774618976614]}]
[{'weights': [0.2550690257394217, 0.49543508709194095]}, {'weights': [0.4494910647887381, 0.651592972722763]}]</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b7b202154139-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b7b202154139-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b7b202154139-1">[{'weights': [0.13436424411240122, 0.8474337369372327, 0.763774618976614]}]</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b7b202154139-2">[{'weights': [0.2550690257394217, 0.49543508709194095]}, {'weights': [0.4494910647887381, 0.651592972722763]}]</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Now that we know how to create and initialize a network, let’s see how we can use it to calculate an output.</p>
<h3>2. Forward Propagate</h3>
<p>We can calculate an output from a neural network by propagating an input signal through each layer until the output layer outputs its values.</p>
<p>We call this forward-propagation.</p>
<p>It is the technique we will need to generate predictions during training that will need to be corrected, and it is the method we will need after the network is trained to make predictions on new data.</p>
<p>We can break forward propagation down into three parts:</p>
<ol>
<li>Neuron Activation.</li>
<li>Neuron Transfer.</li>
<li>Forward Propagation.</li>
</ol>
<h4>2.1. Neuron Activation</h4>
<p>The first step is to calculate the activation of one neuron given an input.</p>
<p>The input could be a row from our training dataset, as in the case of the hidden layer. It may also be the outputs from each neuron in the hidden layer, in the case of the output layer.</p>
<p>Neuron activation is calculated as the weighted sum of the inputs. Much like linear regression.</p>
		<div id="urvanov-syntax-highlighter-6060ca9c63b7c549650458" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18.9915px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">activation = sum(weight_i * input_i) + bias</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b7c549650458-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b7c549650458-1">activation = sum(weight_i * input_i) + bias</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Where <strong>weight</strong> is a network weight, <strong>input</strong> is an input, <strong>i</strong> is the index of a weight or an input and <strong>bias</strong> is a special weight that has no input to multiply with (or you can think of the input as always being 1.0).</p>
<p>Below is an implementation of this in a function named <strong>activate()</strong>. You can see that the function assumes that the bias is the last weight in the list of weights. This helps here and later to make the code easier to read.</p>
		<div id="urvanov-syntax-highlighter-6060ca9c63b7d205234122" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18.9915px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># Calculate neuron activation for an input
def activate(weights, inputs):
	activation = weights[-1]
	for i in range(len(weights)-1):
		activation += weights[i] * inputs[i]
	return activation</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b7d205234122-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b7d205234122-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b7d205234122-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b7d205234122-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b7d205234122-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b7d205234122-6">6</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b7d205234122-1"><span class="crayon-p"># Calculate neuron activation for an input</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b7d205234122-2"><span class="crayon-e">def </span><span class="crayon-e">activate</span><span class="crayon-sy">(</span><span class="crayon-v">weights</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b7d205234122-3"><span class="crayon-h">	</span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">weights</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b7d205234122-4"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">weights</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b7d205234122-5"><span class="crayon-h">		</span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-v">weights</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b7d205234122-6"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">activation</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Now, let’s see how to use the neuron activation.</p>
<h4>2.2. Neuron Transfer</h4>
<p>Once a neuron is activated, we need to transfer the activation to see what the neuron output actually is.</p>
<p>Different transfer functions can be used. It is traditional to use the <a href="https://en.wikipedia.org/wiki/Sigmoid_function">sigmoid activation function</a>, but you can also use the tanh (<a href="https://en.wikipedia.org/wiki/Hyperbolic_function">hyperbolic tangent</a>) function to transfer outputs. More recently, the <a href="https://en.wikipedia.org/wiki/Rectifier_(neural_networks)">rectifier transfer function</a> has been popular with large deep learning networks.</p>
<p>The sigmoid activation function looks like an S shape, it’s also called the logistic function. It can take any input value and produce a number between 0 and 1 on an S-curve. It is also a function of which we can easily calculate the derivative (slope) that we will need later when backpropagating error.</p>
<p>We can transfer an activation function using the sigmoid function as follows:</p>
		<div id="urvanov-syntax-highlighter-6060ca9c63b7e810429663" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18.9915px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">output = 1 / (1 + e^(-activation))</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b7e810429663-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b7e810429663-1">output = 1 / (1 + e^(-activation))</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Where <strong>e</strong> is the base of the natural logarithms (<a href="https://en.wikipedia.org/wiki/E_(mathematical_constant)">Euler’s number</a>).</p>
<p>Below is a function named <strong>transfer()</strong> that implements the sigmoid equation.</p>
		<div id="urvanov-syntax-highlighter-6060ca9c63b7f691557771" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18.9915px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># Transfer neuron activation
def transfer(activation):
	return 1.0 / (1.0 + exp(-activation))</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b7f691557771-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b7f691557771-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b7f691557771-3">3</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b7f691557771-1"><span class="crayon-p"># Transfer neuron activation</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b7f691557771-2"><span class="crayon-e">def </span><span class="crayon-e">transfer</span><span class="crayon-sy">(</span><span class="crayon-v">activation</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b7f691557771-3"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-cn">1.0</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1.0</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">exp</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-v">activation</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Now that we have the pieces, let’s see how they are used.</p>
<h4>2.3. Forward Propagation</h4>
<p>Forward propagating an input is straightforward.</p>
<p>We work through each layer of our network calculating the outputs for each neuron. All of the outputs from one layer become inputs to the neurons on the next layer.</p>
<p>Below is a function named <strong>forward_propagate()</strong> that implements the forward propagation for a row of data from our dataset with our neural network.</p>
<p>You can see that a neuron’s output value is stored in the neuron with the name ‘<strong>output</strong>‘. You can also see that we collect the outputs for a layer in an array named <strong>new_inputs</strong> that becomes the array <strong>inputs</strong> and is used as inputs for the following layer.</p>
<p>The function returns the outputs from the last layer also called the output layer.</p>
		<div id="urvanov-syntax-highlighter-6060ca9c63b80131963730" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18.9915px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># Forward propagate input to a network output
def forward_propagate(network, row):
	inputs = row
	for layer in network:
		new_inputs = []
		for neuron in layer:
			activation = activate(neuron['weights'], inputs)
			neuron['output'] = transfer(activation)
			new_inputs.append(neuron['output'])
		inputs = new_inputs
	return inputs</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b80131963730-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b80131963730-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b80131963730-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b80131963730-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b80131963730-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b80131963730-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b80131963730-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b80131963730-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b80131963730-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b80131963730-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b80131963730-11">11</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b80131963730-1"><span class="crayon-p"># Forward propagate input to a network output</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b80131963730-2"><span class="crayon-e">def </span><span class="crayon-e">forward_propagate</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b80131963730-3"><span class="crayon-h">	</span><span class="crayon-v">inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">row</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b80131963730-4"><span class="crayon-e">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">layer </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b80131963730-5"><span class="crayon-h">		</span><span class="crayon-v">new_inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b80131963730-6"><span class="crayon-h">		</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">neuron </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">layer</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b80131963730-7"><span class="crayon-h">			</span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">activate</span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'weights'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b80131963730-8"><span class="crayon-h">			</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">transfer</span><span class="crayon-sy">(</span><span class="crayon-v">activation</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b80131963730-9"><span class="crayon-h">			</span><span class="crayon-v">new_inputs</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b80131963730-10"><span class="crayon-h">		</span><span class="crayon-v">inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">new_inputs</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b80131963730-11"><span class="crayon-e">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Let’s put all of these pieces together and test out the forward propagation of our network.</p>
<p>We define our network inline with one hidden neuron that expects 2 input values and an output layer with two neurons.</p>
		<div id="urvanov-syntax-highlighter-6060ca9c63b81828497842" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18.9915px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">from math import exp

# Calculate neuron activation for an input
def activate(weights, inputs):
	activation = weights[-1]
	for i in range(len(weights)-1):
		activation += weights[i] * inputs[i]
	return activation

# Transfer neuron activation
def transfer(activation):
	return 1.0 / (1.0 + exp(-activation))

# Forward propagate input to a network output
def forward_propagate(network, row):
	inputs = row
	for layer in network:
		new_inputs = []
		for neuron in layer:
			activation = activate(neuron['weights'], inputs)
			neuron['output'] = transfer(activation)
			new_inputs.append(neuron['output'])
		inputs = new_inputs
	return inputs

# test forward propagation
network = [[{'weights': [0.13436424411240122, 0.8474337369372327, 0.763774618976614]}],
		[{'weights': [0.2550690257394217, 0.49543508709194095]}, {'weights': [0.4494910647887381, 0.651592972722763]}]]
row = [1, 0, None]
output = forward_propagate(network, row)
print(output)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b81828497842-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b81828497842-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b81828497842-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b81828497842-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b81828497842-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b81828497842-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b81828497842-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b81828497842-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b81828497842-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b81828497842-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b81828497842-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b81828497842-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b81828497842-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b81828497842-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b81828497842-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b81828497842-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b81828497842-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b81828497842-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b81828497842-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b81828497842-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b81828497842-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b81828497842-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b81828497842-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b81828497842-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b81828497842-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b81828497842-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b81828497842-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b81828497842-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b81828497842-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b81828497842-30">30</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b81828497842-31">31</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b81828497842-1"><span class="crayon-e">from </span><span class="crayon-e">math </span><span class="crayon-e">import </span><span class="crayon-i">exp</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b81828497842-2">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b81828497842-3"><span class="crayon-p"># Calculate neuron activation for an input</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b81828497842-4"><span class="crayon-e">def </span><span class="crayon-e">activate</span><span class="crayon-sy">(</span><span class="crayon-v">weights</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b81828497842-5"><span class="crayon-h">	</span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">weights</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b81828497842-6"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">weights</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b81828497842-7"><span class="crayon-h">		</span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-v">weights</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b81828497842-8"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">activation</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b81828497842-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b81828497842-10"><span class="crayon-p"># Transfer neuron activation</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b81828497842-11"><span class="crayon-e">def </span><span class="crayon-e">transfer</span><span class="crayon-sy">(</span><span class="crayon-v">activation</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b81828497842-12"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-cn">1.0</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1.0</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">exp</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-v">activation</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b81828497842-13">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b81828497842-14"><span class="crayon-p"># Forward propagate input to a network output</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b81828497842-15"><span class="crayon-e">def </span><span class="crayon-e">forward_propagate</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b81828497842-16"><span class="crayon-h">	</span><span class="crayon-v">inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">row</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b81828497842-17"><span class="crayon-e">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">layer </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b81828497842-18"><span class="crayon-h">		</span><span class="crayon-v">new_inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b81828497842-19"><span class="crayon-h">		</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">neuron </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">layer</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b81828497842-20"><span class="crayon-h">			</span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">activate</span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'weights'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b81828497842-21"><span class="crayon-h">			</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">transfer</span><span class="crayon-sy">(</span><span class="crayon-v">activation</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b81828497842-22"><span class="crayon-h">			</span><span class="crayon-v">new_inputs</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b81828497842-23"><span class="crayon-h">		</span><span class="crayon-v">inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">new_inputs</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b81828497842-24"><span class="crayon-e">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">inputs</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b81828497842-25">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b81828497842-26"><span class="crayon-p"># test forward propagation</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b81828497842-27"><span class="crayon-v">network</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-sy">{</span><span class="crayon-s">'weights'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.13436424411240122</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.8474337369372327</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.763774618976614</span><span class="crayon-sy">]</span><span class="crayon-sy">}</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b81828497842-28"><span class="crayon-h">		</span><span class="crayon-sy">[</span><span class="crayon-sy">{</span><span class="crayon-s">'weights'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.2550690257394217</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.49543508709194095</span><span class="crayon-sy">]</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-s">'weights'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.4494910647887381</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.651592972722763</span><span class="crayon-sy">]</span><span class="crayon-sy">}</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b81828497842-29"><span class="crayon-v">row</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">None</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b81828497842-30"><span class="crayon-v">output</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">forward_propagate</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b81828497842-31"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">output</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Running the example propagates the input pattern [1, 0] and produces an output value that is printed. Because the output layer has two neurons, we get a list of two numbers as output.</p>
<p>The actual output values are just nonsense for now, but next, we will start to learn how to make the weights in the neurons more useful.</p>
		<div id="urvanov-syntax-highlighter-6060ca9c63b82320944282" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18.9915px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">[0.6629970129852887, 0.7253160725279748]</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b82320944282-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b82320944282-1">[0.6629970129852887, 0.7253160725279748]</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p></p>
<h3>3. Back Propagate Error</h3>
<p>The backpropagation algorithm is named for the way in which weights are trained.</p>
<p>Error is calculated between the expected outputs and the outputs forward propagated from the network. These errors are then propagated backward through the network from the output layer to the hidden layer, assigning blame for the error and updating weights as they go.</p>
<p>The math for backpropagating error is rooted in calculus, but we will remain high level in this section and focus on what is calculated and how rather than why the calculations take this particular form.</p>
<p>This part is broken down into two sections.</p>
<ol>
<li>Transfer Derivative.</li>
<li>Error Backpropagation.</li>
</ol>
<h4>3.1. Transfer Derivative</h4>
<p>Given an output value from a neuron, we need to calculate it’s slope.</p>
<p>We are using the sigmoid transfer function, the derivative of which can be calculated as follows:</p>
		<div id="urvanov-syntax-highlighter-6060ca9c63b83876661278" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18.9915px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">derivative = output * (1.0 - output)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b83876661278-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b83876661278-1">derivative = output * (1.0 - output)</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Below is a function named <strong>transfer_derivative()</strong> that implements this equation.</p>
		<div id="urvanov-syntax-highlighter-6060ca9c63b84226242762" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18.9915px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># Calculate the derivative of an neuron output
def transfer_derivative(output):
	return output * (1.0 - output)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b84226242762-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b84226242762-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b84226242762-3">3</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b84226242762-1"><span class="crayon-p"># Calculate the derivative of an neuron output</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b84226242762-2"><span class="crayon-e">def </span><span class="crayon-e">transfer_derivative</span><span class="crayon-sy">(</span><span class="crayon-v">output</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b84226242762-3"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e ">output *</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1.0</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">output</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Now, let’s see how this can be used.</p>
<h4>3.2. Error Backpropagation</h4>
<p>The first step is to calculate the error for each output neuron, this will give us our error signal (input) to propagate backwards through the network.</p>
<p>The error for a given neuron can be calculated as follows:</p>
		<div id="urvanov-syntax-highlighter-6060ca9c63b85076230376" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18.9915px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">error = (expected - output) * transfer_derivative(output)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b85076230376-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b85076230376-1">error = (expected - output) * transfer_derivative(output)</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Where <strong>expected</strong> is the expected output value for the neuron, <strong>output</strong> is the output value for the neuron and <strong>transfer_derivative()</strong>&nbsp;calculates the slope of the neuron’s output value, as shown above.</p>
<p>This error calculation is used for neurons in the output layer. The expected value is the class value itself. In the hidden layer, things are a little more complicated.</p>
<p>The error signal for a neuron in the hidden layer is calculated as the weighted error of each neuron in the output layer. Think of the error traveling back along the weights of the output layer to the neurons in the hidden layer.</p>
<p>The back-propagated error signal is accumulated and then used to&nbsp;determine the error for the neuron in the hidden layer, as follows:</p>
		<div id="urvanov-syntax-highlighter-6060ca9c63b86302786325" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18.9915px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">error = (weight_k * error_j) * transfer_derivative(output)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b86302786325-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b86302786325-1">error = (weight_k * error_j) * transfer_derivative(output)</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Where <strong>error_j</strong> is the error signal from the <strong>j</strong>th neuron in the output layer, <strong>weight_k</strong> is the weight that connects the <strong>k</strong>th neuron to the current neuron and output is the output for the current neuron.</p>
<p>Below is a function named <strong>backward_propagate_error()</strong> that implements this procedure.</p>
<p>You can see that the error signal calculated for each neuron is stored with the name ‘delta’. You can see that the layers of the network are iterated in reverse order, starting at the output and working backwards. This ensures that the neurons in the output layer have ‘delta’ values calculated first that neurons in the hidden layer can use in the subsequent iteration. I chose the name ‘delta’ to reflect the change the error implies on the neuron (e.g. the weight delta).</p>
<p>You can see that the error signal for neurons in the hidden layer is accumulated from neurons in the output layer where the hidden neuron number <strong>j</strong> is also the index of the neuron’s weight in the output layer <strong>neuron[‘weights’][j]</strong>.</p>
		<div id="urvanov-syntax-highlighter-6060ca9c63b87060209648" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18.9915px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># Backpropagate error and store in neurons
def backward_propagate_error(network, expected):
	for i in reversed(range(len(network))):
		layer = network[i]
		errors = list()
		if i != len(network)-1:
			for j in range(len(layer)):
				error = 0.0
				for neuron in network[i + 1]:
					error += (neuron['weights'][j] * neuron['delta'])
				errors.append(error)
		else:
			for j in range(len(layer)):
				neuron = layer[j]
				errors.append(expected[j] - neuron['output'])
		for j in range(len(layer)):
			neuron = layer[j]
			neuron['delta'] = errors[j] * transfer_derivative(neuron['output'])</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b87060209648-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b87060209648-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b87060209648-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b87060209648-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b87060209648-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b87060209648-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b87060209648-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b87060209648-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b87060209648-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b87060209648-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b87060209648-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b87060209648-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b87060209648-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b87060209648-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b87060209648-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b87060209648-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b87060209648-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b87060209648-18">18</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b87060209648-1"><span class="crayon-p"># Backpropagate error and store in neurons</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b87060209648-2"><span class="crayon-e">def </span><span class="crayon-e">backward_propagate_error</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">expected</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b87060209648-3"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">reversed</span><span class="crayon-sy">(</span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b87060209648-4"><span class="crayon-h">		</span><span class="crayon-v">layer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b87060209648-5"><span class="crayon-h">		</span><span class="crayon-v">errors</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b87060209648-6"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b87060209648-7"><span class="crayon-h">			</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">layer</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b87060209648-8"><span class="crayon-h">				</span><span class="crayon-v">error</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.0</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b87060209648-9"><span class="crayon-h">				</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">neuron </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b87060209648-10"><span class="crayon-h">					</span><span class="crayon-v">error</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'weights'</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'delta'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b87060209648-11"><span class="crayon-h">				</span><span class="crayon-v">errors</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">error</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b87060209648-12"><span class="crayon-h">		</span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b87060209648-13"><span class="crayon-h">			</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">layer</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b87060209648-14"><span class="crayon-h">				</span><span class="crayon-v">neuron</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">layer</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b87060209648-15"><span class="crayon-h">				</span><span class="crayon-v">errors</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">expected</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b87060209648-16"><span class="crayon-h">		</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">layer</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b87060209648-17"><span class="crayon-h">			</span><span class="crayon-v">neuron</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">layer</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b87060209648-18"><span class="crayon-h">			</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'delta'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">errors</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-e">transfer_derivative</span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Let’s put all of the pieces together and see how it works.</p>
<p>We define a fixed neural network with output values and backpropagate an expected output pattern. The complete example is listed below.</p>
		<div id="urvanov-syntax-highlighter-6060ca9c63b88033622260" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18.9915px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># Calculate the derivative of an neuron output
def transfer_derivative(output):
	return output * (1.0 - output)

# Backpropagate error and store in neurons
def backward_propagate_error(network, expected):
	for i in reversed(range(len(network))):
		layer = network[i]
		errors = list()
		if i != len(network)-1:
			for j in range(len(layer)):
				error = 0.0
				for neuron in network[i + 1]:
					error += (neuron['weights'][j] * neuron['delta'])
				errors.append(error)
		else:
			for j in range(len(layer)):
				neuron = layer[j]
				errors.append(expected[j] - neuron['output'])
		for j in range(len(layer)):
			neuron = layer[j]
			neuron['delta'] = errors[j] * transfer_derivative(neuron['output'])

# test backpropagation of error
network = [[{'output': 0.7105668883115941, 'weights': [0.13436424411240122, 0.8474337369372327, 0.763774618976614]}],
		[{'output': 0.6213859615555266, 'weights': [0.2550690257394217, 0.49543508709194095]}, {'output': 0.6573693455986976, 'weights': [0.4494910647887381, 0.651592972722763]}]]
expected = [0, 1]
backward_propagate_error(network, expected)
for layer in network:
	print(layer)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b88033622260-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b88033622260-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b88033622260-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b88033622260-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b88033622260-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b88033622260-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b88033622260-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b88033622260-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b88033622260-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b88033622260-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b88033622260-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b88033622260-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b88033622260-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b88033622260-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b88033622260-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b88033622260-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b88033622260-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b88033622260-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b88033622260-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b88033622260-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b88033622260-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b88033622260-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b88033622260-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b88033622260-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b88033622260-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b88033622260-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b88033622260-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b88033622260-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b88033622260-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b88033622260-30">30</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b88033622260-1"><span class="crayon-p"># Calculate the derivative of an neuron output</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b88033622260-2"><span class="crayon-e">def </span><span class="crayon-e">transfer_derivative</span><span class="crayon-sy">(</span><span class="crayon-v">output</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b88033622260-3"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e ">output *</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1.0</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">output</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b88033622260-4">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b88033622260-5"><span class="crayon-p"># Backpropagate error and store in neurons</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b88033622260-6"><span class="crayon-e">def </span><span class="crayon-e">backward_propagate_error</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">expected</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b88033622260-7"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">reversed</span><span class="crayon-sy">(</span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b88033622260-8"><span class="crayon-h">		</span><span class="crayon-v">layer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b88033622260-9"><span class="crayon-h">		</span><span class="crayon-v">errors</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b88033622260-10"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b88033622260-11"><span class="crayon-h">			</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">layer</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b88033622260-12"><span class="crayon-h">				</span><span class="crayon-v">error</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.0</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b88033622260-13"><span class="crayon-h">				</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">neuron </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b88033622260-14"><span class="crayon-h">					</span><span class="crayon-v">error</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'weights'</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'delta'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b88033622260-15"><span class="crayon-h">				</span><span class="crayon-v">errors</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">error</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b88033622260-16"><span class="crayon-h">		</span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b88033622260-17"><span class="crayon-h">			</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">layer</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b88033622260-18"><span class="crayon-h">				</span><span class="crayon-v">neuron</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">layer</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b88033622260-19"><span class="crayon-h">				</span><span class="crayon-v">errors</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">expected</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b88033622260-20"><span class="crayon-h">		</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">layer</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b88033622260-21"><span class="crayon-h">			</span><span class="crayon-v">neuron</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">layer</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b88033622260-22"><span class="crayon-h">			</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'delta'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">errors</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-e">transfer_derivative</span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b88033622260-23">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b88033622260-24"><span class="crayon-p"># test backpropagation of error</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b88033622260-25"><span class="crayon-v">network</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-sy">{</span><span class="crayon-s">'output'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.7105668883115941</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'weights'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.13436424411240122</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.8474337369372327</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.763774618976614</span><span class="crayon-sy">]</span><span class="crayon-sy">}</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b88033622260-26"><span class="crayon-h">		</span><span class="crayon-sy">[</span><span class="crayon-sy">{</span><span class="crayon-s">'output'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.6213859615555266</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'weights'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.2550690257394217</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.49543508709194095</span><span class="crayon-sy">]</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-s">'output'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.6573693455986976</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'weights'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.4494910647887381</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.651592972722763</span><span class="crayon-sy">]</span><span class="crayon-sy">}</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b88033622260-27"><span class="crayon-v">expected</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b88033622260-28"><span class="crayon-e">backward_propagate_error</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">expected</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b88033622260-29"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">layer </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b88033622260-30"><span class="crayon-h">	</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">layer</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Running the example prints the network after the backpropagation of error is complete. You can see that error values are calculated and stored in the neurons for the output layer and the hidden layer.</p>
		<div id="urvanov-syntax-highlighter-6060ca9c63b89284070538" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18.9915px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">[{'output': 0.7105668883115941, 'weights': [0.13436424411240122, 0.8474337369372327, 0.763774618976614], 'delta': -0.0005348048046610517}]
[{'output': 0.6213859615555266, 'weights': [0.2550690257394217, 0.49543508709194095], 'delta': -0.14619064683582808}, {'output': 0.6573693455986976, 'weights': [0.4494910647887381, 0.651592972722763], 'delta': 0.0771723774346327}]</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b89284070538-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b89284070538-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b89284070538-1">[{'output': 0.7105668883115941, 'weights': [0.13436424411240122, 0.8474337369372327, 0.763774618976614], 'delta': -0.0005348048046610517}]</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b89284070538-2">[{'output': 0.6213859615555266, 'weights': [0.2550690257394217, 0.49543508709194095], 'delta': -0.14619064683582808}, {'output': 0.6573693455986976, 'weights': [0.4494910647887381, 0.651592972722763], 'delta': 0.0771723774346327}]</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Now let’s use the backpropagation of error to train the network.</p>
<h3>4. Train Network</h3>
<p>The network is trained using stochastic gradient descent.</p>
<p>This involves multiple iterations of exposing a training dataset to the network and for each row of data forward propagating the inputs, backpropagating the error and updating the network weights.</p>
<p>This part is broken down into two sections:</p>
<ol>
<li>Update Weights.</li>
<li>Train Network.</li>
</ol>
<h4>4.1. Update Weights</h4>
<p>Once errors are calculated for each neuron in the network via the back propagation method above, they can be used to update weights.</p>
<p>Network weights are updated as follows:</p>
		<div id="urvanov-syntax-highlighter-6060ca9c63b8a648939205" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18.9915px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">weight = weight + learning_rate * error * input</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b8a648939205-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b8a648939205-1">weight = weight + learning_rate * error * input</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Where <strong>weight</strong> is a given weight, <strong>learning_rate</strong> is a parameter that you must specify, <strong>error</strong> is the error calculated by the backpropagation procedure for the neuron and <strong>input</strong> is the input value that caused the error.</p>
<p>The same procedure can be used for updating the bias weight, except there is no input term, or input is the fixed value of 1.0.</p>
<p>Learning rate controls how much to change the weight to correct for the error. For example, a value of 0.1 will update the weight 10% of the amount that it possibly could be updated. Small learning rates are preferred that cause slower learning over a large number of training iterations. This increases the likelihood of the network finding a good set of weights across all layers rather than the fastest set of weights that minimize error (called premature convergence).</p>
<p>Below is a function named <strong>update_weights()</strong> that updates the weights for a network given an input row of data, a learning rate and assume that a forward and backward propagation have already been performed.</p>
<p>Remember that the input for the output layer is a collection of outputs from the hidden layer.</p>
		<div id="urvanov-syntax-highlighter-6060ca9c63b8b021657061" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18.9915px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># Update network weights with error
def update_weights(network, row, l_rate):
	for i in range(len(network)):
		inputs = row[:-1]
		if i != 0:
			inputs = [neuron['output'] for neuron in network[i - 1]]
		for neuron in network[i]:
			for j in range(len(inputs)):
				neuron['weights'][j] += l_rate * neuron['delta'] * inputs[j]
			neuron['weights'][-1] += l_rate * neuron['delta']</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b8b021657061-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b8b021657061-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b8b021657061-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b8b021657061-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b8b021657061-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b8b021657061-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b8b021657061-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b8b021657061-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b8b021657061-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b8b021657061-10">10</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b8b021657061-1"><span class="crayon-p"># Update network weights with error</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b8b021657061-2"><span class="crayon-e">def </span><span class="crayon-e">update_weights</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">l_rate</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b8b021657061-3"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b8b021657061-4"><span class="crayon-h">		</span><span class="crayon-v">inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b8b021657061-5"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b8b021657061-6"><span class="crayon-h">			</span><span class="crayon-v">inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">neuron </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b8b021657061-7"><span class="crayon-h">		</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">neuron </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b8b021657061-8"><span class="crayon-h">			</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">inputs</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b8b021657061-9"><span class="crayon-h">				</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'weights'</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-e ">l_rate *</span><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'delta'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b8b021657061-10"><span class="crayon-h">			</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'weights'</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-e ">l_rate *</span><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'delta'</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Now we know how to update network weights, let’s see how we can do it repeatedly.</p>
<h4>4.2. Train Network</h4>
<p>As mentioned, the network is updated using stochastic gradient descent.</p>
<p>This involves first looping for a fixed number of epochs and within each epoch updating the network for each row in the training dataset.</p>
<p>Because updates are made for each training pattern, this type of learning is called online learning. If errors were accumulated across an epoch before updating the weights, this is called batch learning or batch gradient descent.</p>
<p>Below is a function that implements the training of an already initialized neural network with a given training dataset, learning rate, fixed number of epochs and an expected number of output values.</p>
<p>The expected number of output values is used to transform class values in the training data into a one hot encoding. That is a binary vector with one column for each class value to match the output of the network. This is required to calculate the error for the output layer.</p>
<p>You can also see that the sum squared error between the expected output and the network output is accumulated each epoch and printed. This is helpful to create a trace of how much the network is learning and improving each epoch.</p>
		<div id="urvanov-syntax-highlighter-6060ca9c63b8c138269543" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18.9915px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># Train a network for a fixed number of epochs
def train_network(network, train, l_rate, n_epoch, n_outputs):
	for epoch in range(n_epoch):
		sum_error = 0
		for row in train:
			outputs = forward_propagate(network, row)
			expected = [0 for i in range(n_outputs)]
			expected[row[-1]] = 1
			sum_error += sum([(expected[i]-outputs[i])**2 for i in range(len(expected))])
			backward_propagate_error(network, expected)
			update_weights(network, row, l_rate)
		print('&gt;epoch=%d, lrate=%.3f, error=%.3f' % (epoch, l_rate, sum_error))</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b8c138269543-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b8c138269543-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b8c138269543-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b8c138269543-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b8c138269543-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b8c138269543-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b8c138269543-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b8c138269543-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b8c138269543-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b8c138269543-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b8c138269543-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b8c138269543-12">12</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b8c138269543-1"><span class="crayon-p"># Train a network for a fixed number of epochs</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b8c138269543-2"><span class="crayon-e">def </span><span class="crayon-e">train_network</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">l_rate</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_epoch</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_outputs</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b8c138269543-3"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">epoch </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_epoch</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b8c138269543-4"><span class="crayon-h">		</span><span class="crayon-v">sum_error</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b8c138269543-5"><span class="crayon-h">		</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b8c138269543-6"><span class="crayon-h">			</span><span class="crayon-v">outputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">forward_propagate</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b8c138269543-7"><span class="crayon-h">			</span><span class="crayon-v">expected</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_outputs</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b8c138269543-8"><span class="crayon-h">			</span><span class="crayon-v">expected</span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b8c138269543-9"><span class="crayon-h">			</span><span class="crayon-v">sum_error</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-e">sum</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-v">expected</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-o">-</span><span class="crayon-v">outputs</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">expected</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b8c138269543-10"><span class="crayon-h">			</span><span class="crayon-e">backward_propagate_error</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">expected</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b8c138269543-11"><span class="crayon-h">			</span><span class="crayon-e">update_weights</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">l_rate</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b8c138269543-12"><span class="crayon-h">		</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'&gt;epoch=%d, lrate=%.3f, error=%.3f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">epoch</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">l_rate</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">sum_error</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>We now have all of the pieces to train the network. We can put together an example that includes everything we’ve seen so far including network initialization and train a network on a small dataset.</p>
<p>Below is a small contrived dataset that we can use&nbsp;to test out training our neural network.</p>
		<div id="urvanov-syntax-highlighter-6060ca9c63b8d848670200" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18.9915px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">X1			X2			Y
2.7810836		2.550537003		0
1.465489372		2.362125076		0
3.396561688		4.400293529		0
1.38807019		1.850220317		0
3.06407232		3.005305973		0
7.627531214		2.759262235		1
5.332441248		2.088626775		1
6.922596716		1.77106367		1
8.675418651		-0.242068655		1
7.673756466		3.508563011		1</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b8d848670200-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b8d848670200-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b8d848670200-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b8d848670200-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b8d848670200-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b8d848670200-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b8d848670200-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b8d848670200-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b8d848670200-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b8d848670200-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b8d848670200-11">11</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b8d848670200-1">X1			X2			Y</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b8d848670200-2">2.7810836		2.550537003		0</div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b8d848670200-3">1.465489372		2.362125076		0</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b8d848670200-4">3.396561688		4.400293529		0</div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b8d848670200-5">1.38807019		1.850220317		0</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b8d848670200-6">3.06407232		3.005305973		0</div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b8d848670200-7">7.627531214		2.759262235		1</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b8d848670200-8">5.332441248		2.088626775		1</div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b8d848670200-9">6.922596716		1.77106367		1</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b8d848670200-10">8.675418651		-0.242068655		1</div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b8d848670200-11">7.673756466		3.508563011		1</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Below is the complete example. We will use 2 neurons in the hidden layer. It is a binary classification problem (2 classes) so there will be two neurons in the output layer. The network will be trained for 20 epochs with a learning rate of 0.5, which is high because we are training for so few iterations.</p>
		<div id="urvanov-syntax-highlighter-6060ca9c63b92697299466" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18.9915px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">from math import exp
from random import seed
from random import random

# Initialize a network
def initialize_network(n_inputs, n_hidden, n_outputs):
	network = list()
	hidden_layer = [{'weights':[random() for i in range(n_inputs + 1)]} for i in range(n_hidden)]
	network.append(hidden_layer)
	output_layer = [{'weights':[random() for i in range(n_hidden + 1)]} for i in range(n_outputs)]
	network.append(output_layer)
	return network

# Calculate neuron activation for an input
def activate(weights, inputs):
	activation = weights[-1]
	for i in range(len(weights)-1):
		activation += weights[i] * inputs[i]
	return activation

# Transfer neuron activation
def transfer(activation):
	return 1.0 / (1.0 + exp(-activation))

# Forward propagate input to a network output
def forward_propagate(network, row):
	inputs = row
	for layer in network:
		new_inputs = []
		for neuron in layer:
			activation = activate(neuron['weights'], inputs)
			neuron['output'] = transfer(activation)
			new_inputs.append(neuron['output'])
		inputs = new_inputs
	return inputs

# Calculate the derivative of an neuron output
def transfer_derivative(output):
	return output * (1.0 - output)

# Backpropagate error and store in neurons
def backward_propagate_error(network, expected):
	for i in reversed(range(len(network))):
		layer = network[i]
		errors = list()
		if i != len(network)-1:
			for j in range(len(layer)):
				error = 0.0
				for neuron in network[i + 1]:
					error += (neuron['weights'][j] * neuron['delta'])
				errors.append(error)
		else:
			for j in range(len(layer)):
				neuron = layer[j]
				errors.append(expected[j] - neuron['output'])
		for j in range(len(layer)):
			neuron = layer[j]
			neuron['delta'] = errors[j] * transfer_derivative(neuron['output'])

# Update network weights with error
def update_weights(network, row, l_rate):
	for i in range(len(network)):
		inputs = row[:-1]
		if i != 0:
			inputs = [neuron['output'] for neuron in network[i - 1]]
		for neuron in network[i]:
			for j in range(len(inputs)):
				neuron['weights'][j] += l_rate * neuron['delta'] * inputs[j]
			neuron['weights'][-1] += l_rate * neuron['delta']

# Train a network for a fixed number of epochs
def train_network(network, train, l_rate, n_epoch, n_outputs):
	for epoch in range(n_epoch):
		sum_error = 0
		for row in train:
			outputs = forward_propagate(network, row)
			expected = [0 for i in range(n_outputs)]
			expected[row[-1]] = 1
			sum_error += sum([(expected[i]-outputs[i])**2 for i in range(len(expected))])
			backward_propagate_error(network, expected)
			update_weights(network, row, l_rate)
		print('&gt;epoch=%d, lrate=%.3f, error=%.3f' % (epoch, l_rate, sum_error))

# Test training backprop algorithm
seed(1)
dataset = [[2.7810836,2.550537003,0],
	[1.465489372,2.362125076,0],
	[3.396561688,4.400293529,0],
	[1.38807019,1.850220317,0],
	[3.06407232,3.005305973,0],
	[7.627531214,2.759262235,1],
	[5.332441248,2.088626775,1],
	[6.922596716,1.77106367,1],
	[8.675418651,-0.242068655,1],
	[7.673756466,3.508563011,1]]
n_inputs = len(dataset[0]) - 1
n_outputs = len(set([row[-1] for row in dataset]))
network = initialize_network(n_inputs, 2, n_outputs)
train_network(network, dataset, 0.5, 20, n_outputs)
for layer in network:
	print(layer)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-30">30</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-31">31</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-32">32</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-33">33</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-34">34</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-35">35</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-36">36</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-37">37</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-38">38</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-39">39</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-40">40</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-41">41</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-42">42</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-43">43</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-44">44</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-45">45</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-46">46</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-47">47</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-48">48</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-49">49</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-50">50</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-51">51</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-52">52</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-53">53</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-54">54</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-55">55</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-56">56</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-57">57</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-58">58</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-59">59</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-60">60</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-61">61</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-62">62</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-63">63</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-64">64</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-65">65</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-66">66</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-67">67</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-68">68</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-69">69</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-70">70</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-71">71</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-72">72</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-73">73</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-74">74</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-75">75</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-76">76</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-77">77</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-78">78</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-79">79</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-80">80</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-81">81</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-82">82</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-83">83</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-84">84</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-85">85</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-86">86</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-87">87</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-88">88</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-89">89</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-90">90</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-91">91</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-92">92</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-93">93</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-94">94</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-95">95</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-96">96</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-97">97</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-98">98</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-99">99</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-100">100</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b92697299466-101">101</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-1"><span class="crayon-e">from </span><span class="crayon-e">math </span><span class="crayon-e">import </span><span class="crayon-e">exp</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-2"><span class="crayon-e">from </span><span class="crayon-e">random </span><span class="crayon-e">import </span><span class="crayon-e">seed</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-3"><span class="crayon-e">from </span><span class="crayon-e">random </span><span class="crayon-e">import </span><span class="crayon-i">random</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-4">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-5"><span class="crayon-p"># Initialize a network</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-6"><span class="crayon-e">def </span><span class="crayon-e">initialize_network</span><span class="crayon-sy">(</span><span class="crayon-v">n_inputs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_hidden</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_outputs</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-7"><span class="crayon-h">	</span><span class="crayon-v">network</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-8"><span class="crayon-h">	</span><span class="crayon-v">hidden_layer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">{</span><span class="crayon-s">'weights'</span><span class="crayon-o">:</span><span class="crayon-sy">[</span><span class="crayon-e">random</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_inputs</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_hidden</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-9"><span class="crayon-h">	</span><span class="crayon-v">network</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">hidden_layer</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-10"><span class="crayon-h">	</span><span class="crayon-v">output_layer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">{</span><span class="crayon-s">'weights'</span><span class="crayon-o">:</span><span class="crayon-sy">[</span><span class="crayon-e">random</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_hidden</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_outputs</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-11"><span class="crayon-h">	</span><span class="crayon-v">network</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">output_layer</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-12"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">network</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-13">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-14"><span class="crayon-p"># Calculate neuron activation for an input</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-15"><span class="crayon-e">def </span><span class="crayon-e">activate</span><span class="crayon-sy">(</span><span class="crayon-v">weights</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-16"><span class="crayon-h">	</span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">weights</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-17"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">weights</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-18"><span class="crayon-h">		</span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-v">weights</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-19"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">activation</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-20">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-21"><span class="crayon-p"># Transfer neuron activation</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-22"><span class="crayon-e">def </span><span class="crayon-e">transfer</span><span class="crayon-sy">(</span><span class="crayon-v">activation</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-23"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-cn">1.0</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1.0</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">exp</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-v">activation</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-24">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-25"><span class="crayon-p"># Forward propagate input to a network output</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-26"><span class="crayon-e">def </span><span class="crayon-e">forward_propagate</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-27"><span class="crayon-h">	</span><span class="crayon-v">inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">row</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-28"><span class="crayon-e">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">layer </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-29"><span class="crayon-h">		</span><span class="crayon-v">new_inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-30"><span class="crayon-h">		</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">neuron </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">layer</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-31"><span class="crayon-h">			</span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">activate</span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'weights'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-32"><span class="crayon-h">			</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">transfer</span><span class="crayon-sy">(</span><span class="crayon-v">activation</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-33"><span class="crayon-h">			</span><span class="crayon-v">new_inputs</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-34"><span class="crayon-h">		</span><span class="crayon-v">inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">new_inputs</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-35"><span class="crayon-e">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">inputs</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-36">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-37"><span class="crayon-p"># Calculate the derivative of an neuron output</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-38"><span class="crayon-e">def </span><span class="crayon-e">transfer_derivative</span><span class="crayon-sy">(</span><span class="crayon-v">output</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-39"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e ">output *</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1.0</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">output</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-40">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-41"><span class="crayon-p"># Backpropagate error and store in neurons</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-42"><span class="crayon-e">def </span><span class="crayon-e">backward_propagate_error</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">expected</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-43"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">reversed</span><span class="crayon-sy">(</span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-44"><span class="crayon-h">		</span><span class="crayon-v">layer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-45"><span class="crayon-h">		</span><span class="crayon-v">errors</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-46"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-47"><span class="crayon-h">			</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">layer</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-48"><span class="crayon-h">				</span><span class="crayon-v">error</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.0</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-49"><span class="crayon-h">				</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">neuron </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-50"><span class="crayon-h">					</span><span class="crayon-v">error</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'weights'</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'delta'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-51"><span class="crayon-h">				</span><span class="crayon-v">errors</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">error</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-52"><span class="crayon-h">		</span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-53"><span class="crayon-h">			</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">layer</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-54"><span class="crayon-h">				</span><span class="crayon-v">neuron</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">layer</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-55"><span class="crayon-h">				</span><span class="crayon-v">errors</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">expected</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-56"><span class="crayon-h">		</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">layer</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-57"><span class="crayon-h">			</span><span class="crayon-v">neuron</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">layer</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-58"><span class="crayon-h">			</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'delta'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">errors</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-e">transfer_derivative</span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-59">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-60"><span class="crayon-p"># Update network weights with error</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-61"><span class="crayon-e">def </span><span class="crayon-e">update_weights</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">l_rate</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-62"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-63"><span class="crayon-h">		</span><span class="crayon-v">inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-64"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-65"><span class="crayon-h">			</span><span class="crayon-v">inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">neuron </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-66"><span class="crayon-h">		</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">neuron </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-67"><span class="crayon-h">			</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">inputs</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-68"><span class="crayon-h">				</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'weights'</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-e ">l_rate *</span><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'delta'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-69"><span class="crayon-h">			</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'weights'</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-e ">l_rate *</span><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'delta'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-70">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-71"><span class="crayon-p"># Train a network for a fixed number of epochs</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-72"><span class="crayon-e">def </span><span class="crayon-e">train_network</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">l_rate</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_epoch</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_outputs</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-73"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">epoch </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_epoch</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-74"><span class="crayon-h">		</span><span class="crayon-v">sum_error</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-75"><span class="crayon-h">		</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-76"><span class="crayon-h">			</span><span class="crayon-v">outputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">forward_propagate</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-77"><span class="crayon-h">			</span><span class="crayon-v">expected</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_outputs</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-78"><span class="crayon-h">			</span><span class="crayon-v">expected</span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-79"><span class="crayon-h">			</span><span class="crayon-v">sum_error</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-e">sum</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-v">expected</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-o">-</span><span class="crayon-v">outputs</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">expected</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-80"><span class="crayon-h">			</span><span class="crayon-e">backward_propagate_error</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">expected</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-81"><span class="crayon-h">			</span><span class="crayon-e">update_weights</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">l_rate</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-82"><span class="crayon-h">		</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'&gt;epoch=%d, lrate=%.3f, error=%.3f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">epoch</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">l_rate</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">sum_error</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-83">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-84"><span class="crayon-p"># Test training backprop algorithm</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-85"><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-86"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-cn">2.7810836</span><span class="crayon-sy">,</span><span class="crayon-cn">2.550537003</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-87"><span class="crayon-h">	</span><span class="crayon-sy">[</span><span class="crayon-cn">1.465489372</span><span class="crayon-sy">,</span><span class="crayon-cn">2.362125076</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-88"><span class="crayon-h">	</span><span class="crayon-sy">[</span><span class="crayon-cn">3.396561688</span><span class="crayon-sy">,</span><span class="crayon-cn">4.400293529</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-89"><span class="crayon-h">	</span><span class="crayon-sy">[</span><span class="crayon-cn">1.38807019</span><span class="crayon-sy">,</span><span class="crayon-cn">1.850220317</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-90"><span class="crayon-h">	</span><span class="crayon-sy">[</span><span class="crayon-cn">3.06407232</span><span class="crayon-sy">,</span><span class="crayon-cn">3.005305973</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-91"><span class="crayon-h">	</span><span class="crayon-sy">[</span><span class="crayon-cn">7.627531214</span><span class="crayon-sy">,</span><span class="crayon-cn">2.759262235</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-92"><span class="crayon-h">	</span><span class="crayon-sy">[</span><span class="crayon-cn">5.332441248</span><span class="crayon-sy">,</span><span class="crayon-cn">2.088626775</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-93"><span class="crayon-h">	</span><span class="crayon-sy">[</span><span class="crayon-cn">6.922596716</span><span class="crayon-sy">,</span><span class="crayon-cn">1.77106367</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-94"><span class="crayon-h">	</span><span class="crayon-sy">[</span><span class="crayon-cn">8.675418651</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-cn">0.242068655</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-95"><span class="crayon-h">	</span><span class="crayon-sy">[</span><span class="crayon-cn">7.673756466</span><span class="crayon-sy">,</span><span class="crayon-cn">3.508563011</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-96"><span class="crayon-v">n_inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-97"><span class="crayon-v">n_outputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-e">set</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-98"><span class="crayon-v">network</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">initialize_network</span><span class="crayon-sy">(</span><span class="crayon-v">n_inputs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_outputs</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-99"><span class="crayon-e">train_network</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_outputs</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-100"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">layer </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b92697299466-101"><span class="crayon-h">	</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">layer</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Running the example first prints the sum squared error each training epoch. We can see a trend of this error decreasing with each epoch.</p>
<p>Once trained, the network is printed, showing the learned weights. Also still in the network are output and delta values that can be ignored. We could update our training function to delete these data if we wanted.</p>
		<div id="urvanov-syntax-highlighter-6060ca9c63b94013147369" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18.9915px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">&gt;epoch=0, lrate=0.500, error=6.350
&gt;epoch=1, lrate=0.500, error=5.531
&gt;epoch=2, lrate=0.500, error=5.221
&gt;epoch=3, lrate=0.500, error=4.951
&gt;epoch=4, lrate=0.500, error=4.519
&gt;epoch=5, lrate=0.500, error=4.173
&gt;epoch=6, lrate=0.500, error=3.835
&gt;epoch=7, lrate=0.500, error=3.506
&gt;epoch=8, lrate=0.500, error=3.192
&gt;epoch=9, lrate=0.500, error=2.898
&gt;epoch=10, lrate=0.500, error=2.626
&gt;epoch=11, lrate=0.500, error=2.377
&gt;epoch=12, lrate=0.500, error=2.153
&gt;epoch=13, lrate=0.500, error=1.953
&gt;epoch=14, lrate=0.500, error=1.774
&gt;epoch=15, lrate=0.500, error=1.614
&gt;epoch=16, lrate=0.500, error=1.472
&gt;epoch=17, lrate=0.500, error=1.346
&gt;epoch=18, lrate=0.500, error=1.233
&gt;epoch=19, lrate=0.500, error=1.132
[{'weights': [-1.4688375095432327, 1.850887325439514, 1.0858178629550297], 'output': 0.029980305604426185, 'delta': -0.0059546604162323625}, {'weights': [0.37711098142462157, -0.0625909894552989, 0.2765123702642716], 'output': 0.9456229000211323, 'delta': 0.0026279652850863837}]
[{'weights': [2.515394649397849, -0.3391927502445985, -0.9671565426390275], 'output': 0.23648794202357587, 'delta': -0.04270059278364587}, {'weights': [-2.5584149848484263, 1.0036422106209202, 0.42383086467582715], 'output': 0.7790535202438367, 'delta': 0.03803132596437354}]</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b94013147369-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b94013147369-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b94013147369-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b94013147369-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b94013147369-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b94013147369-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b94013147369-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b94013147369-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b94013147369-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b94013147369-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b94013147369-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b94013147369-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b94013147369-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b94013147369-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b94013147369-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b94013147369-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b94013147369-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b94013147369-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b94013147369-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b94013147369-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b94013147369-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b94013147369-22">22</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b94013147369-1">&gt;epoch=0, lrate=0.500, error=6.350</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b94013147369-2">&gt;epoch=1, lrate=0.500, error=5.531</div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b94013147369-3">&gt;epoch=2, lrate=0.500, error=5.221</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b94013147369-4">&gt;epoch=3, lrate=0.500, error=4.951</div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b94013147369-5">&gt;epoch=4, lrate=0.500, error=4.519</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b94013147369-6">&gt;epoch=5, lrate=0.500, error=4.173</div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b94013147369-7">&gt;epoch=6, lrate=0.500, error=3.835</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b94013147369-8">&gt;epoch=7, lrate=0.500, error=3.506</div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b94013147369-9">&gt;epoch=8, lrate=0.500, error=3.192</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b94013147369-10">&gt;epoch=9, lrate=0.500, error=2.898</div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b94013147369-11">&gt;epoch=10, lrate=0.500, error=2.626</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b94013147369-12">&gt;epoch=11, lrate=0.500, error=2.377</div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b94013147369-13">&gt;epoch=12, lrate=0.500, error=2.153</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b94013147369-14">&gt;epoch=13, lrate=0.500, error=1.953</div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b94013147369-15">&gt;epoch=14, lrate=0.500, error=1.774</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b94013147369-16">&gt;epoch=15, lrate=0.500, error=1.614</div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b94013147369-17">&gt;epoch=16, lrate=0.500, error=1.472</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b94013147369-18">&gt;epoch=17, lrate=0.500, error=1.346</div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b94013147369-19">&gt;epoch=18, lrate=0.500, error=1.233</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b94013147369-20">&gt;epoch=19, lrate=0.500, error=1.132</div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b94013147369-21">[{'weights': [-1.4688375095432327, 1.850887325439514, 1.0858178629550297], 'output': 0.029980305604426185, 'delta': -0.0059546604162323625}, {'weights': [0.37711098142462157, -0.0625909894552989, 0.2765123702642716], 'output': 0.9456229000211323, 'delta': 0.0026279652850863837}]</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b94013147369-22">[{'weights': [2.515394649397849, -0.3391927502445985, -0.9671565426390275], 'output': 0.23648794202357587, 'delta': -0.04270059278364587}, {'weights': [-2.5584149848484263, 1.0036422106209202, 0.42383086467582715], 'output': 0.7790535202438367, 'delta': 0.03803132596437354}]</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Once a network is trained, we need to use it to make predictions.</p>
<h3>5. Predict</h3>
<p>Making predictions with a trained neural network is easy enough.</p>
<p>We have already seen how to forward-propagate an input pattern to get an output. This is all we need to do to make a prediction. We can use the output values themselves directly as the probability of a pattern belonging to each output class.</p>
<p>It may be more useful to turn this output back into a crisp class prediction. We can do this by selecting the class value with the larger probability. This is also called the <a href="https://en.wikipedia.org/wiki/Arg_max">arg max function</a>.</p>
<p>Below is a function named <strong>predict()</strong> that implements this procedure. It returns the index in the network output that has the largest probability. It assumes that class values have been converted to integers starting at 0.</p>
		<div id="urvanov-syntax-highlighter-6060ca9c63b96905549490" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18.9915px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># Make a prediction with a network
def predict(network, row):
	outputs = forward_propagate(network, row)
	return outputs.index(max(outputs))</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b96905549490-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b96905549490-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b96905549490-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b96905549490-4">4</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b96905549490-1"><span class="crayon-p"># Make a prediction with a network</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b96905549490-2"><span class="crayon-e">def </span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b96905549490-3"><span class="crayon-h">	</span><span class="crayon-v">outputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">forward_propagate</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b96905549490-4"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">outputs</span><span class="crayon-sy">.</span><span class="crayon-e">index</span><span class="crayon-sy">(</span><span class="crayon-e">max</span><span class="crayon-sy">(</span><span class="crayon-v">outputs</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>We can put this together with our code above for forward propagating input and with our small contrived dataset to test making predictions with an already-trained network. The example hardcodes a network trained from the previous step.</p>
<p>The complete example is listed below.</p>
		<div id="urvanov-syntax-highlighter-6060ca9c63b97662448565" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18.9915px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">from math import exp

# Calculate neuron activation for an input
def activate(weights, inputs):
	activation = weights[-1]
	for i in range(len(weights)-1):
		activation += weights[i] * inputs[i]
	return activation

# Transfer neuron activation
def transfer(activation):
	return 1.0 / (1.0 + exp(-activation))

# Forward propagate input to a network output
def forward_propagate(network, row):
	inputs = row
	for layer in network:
		new_inputs = []
		for neuron in layer:
			activation = activate(neuron['weights'], inputs)
			neuron['output'] = transfer(activation)
			new_inputs.append(neuron['output'])
		inputs = new_inputs
	return inputs

# Make a prediction with a network
def predict(network, row):
	outputs = forward_propagate(network, row)
	return outputs.index(max(outputs))

# Test making predictions with the network
dataset = [[2.7810836,2.550537003,0],
	[1.465489372,2.362125076,0],
	[3.396561688,4.400293529,0],
	[1.38807019,1.850220317,0],
	[3.06407232,3.005305973,0],
	[7.627531214,2.759262235,1],
	[5.332441248,2.088626775,1],
	[6.922596716,1.77106367,1],
	[8.675418651,-0.242068655,1],
	[7.673756466,3.508563011,1]]
network = [[{'weights': [-1.482313569067226, 1.8308790073202204, 1.078381922048799]}, {'weights': [0.23244990332399884, 0.3621998343835864, 0.40289821191094327]}],
	[{'weights': [2.5001872433501404, 0.7887233511355132, -1.1026649757805829]}, {'weights': [-2.429350576245497, 0.8357651039198697, 1.0699217181280656]}]]
for row in dataset:
	prediction = predict(network, row)
	print('Expected=%d, Got=%d' % (row[-1], prediction))</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b97662448565-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b97662448565-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b97662448565-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b97662448565-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b97662448565-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b97662448565-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b97662448565-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b97662448565-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b97662448565-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b97662448565-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b97662448565-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b97662448565-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b97662448565-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b97662448565-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b97662448565-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b97662448565-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b97662448565-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b97662448565-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b97662448565-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b97662448565-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b97662448565-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b97662448565-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b97662448565-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b97662448565-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b97662448565-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b97662448565-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b97662448565-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b97662448565-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b97662448565-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b97662448565-30">30</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b97662448565-31">31</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b97662448565-32">32</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b97662448565-33">33</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b97662448565-34">34</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b97662448565-35">35</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b97662448565-36">36</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b97662448565-37">37</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b97662448565-38">38</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b97662448565-39">39</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b97662448565-40">40</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b97662448565-41">41</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b97662448565-42">42</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b97662448565-43">43</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b97662448565-44">44</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b97662448565-45">45</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b97662448565-46">46</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b97662448565-1"><span class="crayon-e">from </span><span class="crayon-e">math </span><span class="crayon-e">import </span><span class="crayon-i">exp</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b97662448565-2">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b97662448565-3"><span class="crayon-p"># Calculate neuron activation for an input</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b97662448565-4"><span class="crayon-e">def </span><span class="crayon-e">activate</span><span class="crayon-sy">(</span><span class="crayon-v">weights</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b97662448565-5"><span class="crayon-h">	</span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">weights</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b97662448565-6"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">weights</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b97662448565-7"><span class="crayon-h">		</span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-v">weights</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b97662448565-8"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">activation</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b97662448565-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b97662448565-10"><span class="crayon-p"># Transfer neuron activation</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b97662448565-11"><span class="crayon-e">def </span><span class="crayon-e">transfer</span><span class="crayon-sy">(</span><span class="crayon-v">activation</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b97662448565-12"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-cn">1.0</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1.0</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">exp</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-v">activation</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b97662448565-13">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b97662448565-14"><span class="crayon-p"># Forward propagate input to a network output</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b97662448565-15"><span class="crayon-e">def </span><span class="crayon-e">forward_propagate</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b97662448565-16"><span class="crayon-h">	</span><span class="crayon-v">inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">row</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b97662448565-17"><span class="crayon-e">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">layer </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b97662448565-18"><span class="crayon-h">		</span><span class="crayon-v">new_inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b97662448565-19"><span class="crayon-h">		</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">neuron </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">layer</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b97662448565-20"><span class="crayon-h">			</span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">activate</span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'weights'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b97662448565-21"><span class="crayon-h">			</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">transfer</span><span class="crayon-sy">(</span><span class="crayon-v">activation</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b97662448565-22"><span class="crayon-h">			</span><span class="crayon-v">new_inputs</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b97662448565-23"><span class="crayon-h">		</span><span class="crayon-v">inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">new_inputs</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b97662448565-24"><span class="crayon-e">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">inputs</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b97662448565-25">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b97662448565-26"><span class="crayon-p"># Make a prediction with a network</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b97662448565-27"><span class="crayon-e">def </span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b97662448565-28"><span class="crayon-h">	</span><span class="crayon-v">outputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">forward_propagate</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b97662448565-29"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">outputs</span><span class="crayon-sy">.</span><span class="crayon-e">index</span><span class="crayon-sy">(</span><span class="crayon-e">max</span><span class="crayon-sy">(</span><span class="crayon-v">outputs</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b97662448565-30">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b97662448565-31"><span class="crayon-p"># Test making predictions with the network</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b97662448565-32"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-cn">2.7810836</span><span class="crayon-sy">,</span><span class="crayon-cn">2.550537003</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b97662448565-33"><span class="crayon-h">	</span><span class="crayon-sy">[</span><span class="crayon-cn">1.465489372</span><span class="crayon-sy">,</span><span class="crayon-cn">2.362125076</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b97662448565-34"><span class="crayon-h">	</span><span class="crayon-sy">[</span><span class="crayon-cn">3.396561688</span><span class="crayon-sy">,</span><span class="crayon-cn">4.400293529</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b97662448565-35"><span class="crayon-h">	</span><span class="crayon-sy">[</span><span class="crayon-cn">1.38807019</span><span class="crayon-sy">,</span><span class="crayon-cn">1.850220317</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b97662448565-36"><span class="crayon-h">	</span><span class="crayon-sy">[</span><span class="crayon-cn">3.06407232</span><span class="crayon-sy">,</span><span class="crayon-cn">3.005305973</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b97662448565-37"><span class="crayon-h">	</span><span class="crayon-sy">[</span><span class="crayon-cn">7.627531214</span><span class="crayon-sy">,</span><span class="crayon-cn">2.759262235</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b97662448565-38"><span class="crayon-h">	</span><span class="crayon-sy">[</span><span class="crayon-cn">5.332441248</span><span class="crayon-sy">,</span><span class="crayon-cn">2.088626775</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b97662448565-39"><span class="crayon-h">	</span><span class="crayon-sy">[</span><span class="crayon-cn">6.922596716</span><span class="crayon-sy">,</span><span class="crayon-cn">1.77106367</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b97662448565-40"><span class="crayon-h">	</span><span class="crayon-sy">[</span><span class="crayon-cn">8.675418651</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-cn">0.242068655</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b97662448565-41"><span class="crayon-h">	</span><span class="crayon-sy">[</span><span class="crayon-cn">7.673756466</span><span class="crayon-sy">,</span><span class="crayon-cn">3.508563011</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b97662448565-42"><span class="crayon-v">network</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-sy">{</span><span class="crayon-s">'weights'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1.482313569067226</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.8308790073202204</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.078381922048799</span><span class="crayon-sy">]</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-s">'weights'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.23244990332399884</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.3621998343835864</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.40289821191094327</span><span class="crayon-sy">]</span><span class="crayon-sy">}</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b97662448565-43"><span class="crayon-h">	</span><span class="crayon-sy">[</span><span class="crayon-sy">{</span><span class="crayon-s">'weights'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">2.5001872433501404</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.7887233511355132</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1.1026649757805829</span><span class="crayon-sy">]</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-s">'weights'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">2.429350576245497</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.8357651039198697</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.0699217181280656</span><span class="crayon-sy">]</span><span class="crayon-sy">}</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b97662448565-44"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b97662448565-45"><span class="crayon-h">	</span><span class="crayon-v">prediction</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b97662448565-46"><span class="crayon-h">	</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Expected=%d, Got=%d'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">prediction</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Running the example prints the expected output for each record in the training dataset, followed by the crisp prediction made by the network.</p>
<p>It shows that the network achieves 100% accuracy on this small dataset.</p>
		<div id="urvanov-syntax-highlighter-6060ca9c63b98398451881" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18.9915px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">Expected=0, Got=0
Expected=0, Got=0
Expected=0, Got=0
Expected=0, Got=0
Expected=0, Got=0
Expected=1, Got=1
Expected=1, Got=1
Expected=1, Got=1
Expected=1, Got=1
Expected=1, Got=1</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b98398451881-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b98398451881-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b98398451881-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b98398451881-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b98398451881-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b98398451881-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b98398451881-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b98398451881-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b98398451881-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b98398451881-10">10</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b98398451881-1">Expected=0, Got=0</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b98398451881-2">Expected=0, Got=0</div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b98398451881-3">Expected=0, Got=0</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b98398451881-4">Expected=0, Got=0</div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b98398451881-5">Expected=0, Got=0</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b98398451881-6">Expected=1, Got=1</div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b98398451881-7">Expected=1, Got=1</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b98398451881-8">Expected=1, Got=1</div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b98398451881-9">Expected=1, Got=1</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b98398451881-10">Expected=1, Got=1</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Now we are ready to apply our backpropagation algorithm to a real world dataset.</p>
<h3>6. Wheat Seeds Dataset</h3>
<p>This section applies the Backpropagation algorithm to the wheat seeds dataset.</p>
<p>The first step is to load the dataset and convert the loaded data to numbers that we can use in our neural network. For this we will use the helper function <strong>load_csv()</strong> to load the file, <strong>str_column_to_float()</strong> to convert string numbers to floats and <strong>str_column_to_int()</strong> to convert the class column to integer values.</p>
<p>Input values vary in scale and need to be normalized to the range of 0 and 1. It is generally good practice to normalize input values to the range of the chosen transfer function, in this case, the sigmoid function that outputs values between 0 and 1. The <strong>dataset_minmax()</strong> and <strong>normalize_dataset()</strong> helper functions were used to normalize&nbsp;the input values.</p>
<p>We will evaluate the algorithm using k-fold cross-validation with 5 folds. This means that 201/5=40.2 or 40 records will be in each fold. We will use the helper functions <strong>evaluate_algorithm()</strong> to evaluate the algorithm with cross-validation and <strong>accuracy_metric()</strong> to calculate the accuracy of predictions.</p>
<p>A new function named <strong>back_propagation()</strong> was developed to manage the application of the Backpropagation algorithm, first initializing a network, training it on the training dataset and then using the trained network to make predictions on a test dataset.</p>
<p>The complete example is listed below.</p>
		<div id="urvanov-syntax-highlighter-6060ca9c63b99222917490" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18.9915px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># Backprop on the Seeds Dataset
from random import seed
from random import randrange
from random import random
from csv import reader
from math import exp

# Load a CSV file
def load_csv(filename):
	dataset = list()
	with open(filename, 'r') as file:
		csv_reader = reader(file)
		for row in csv_reader:
			if not row:
				continue
			dataset.append(row)
	return dataset

# Convert string column to float
def str_column_to_float(dataset, column):
	for row in dataset:
		row[column] = float(row[column].strip())

# Convert string column to integer
def str_column_to_int(dataset, column):
	class_values = [row[column] for row in dataset]
	unique = set(class_values)
	lookup = dict()
	for i, value in enumerate(unique):
		lookup[value] = i
	for row in dataset:
		row[column] = lookup[row[column]]
	return lookup

# Find the min and max values for each column
def dataset_minmax(dataset):
	minmax = list()
	stats = [[min(column), max(column)] for column in zip(*dataset)]
	return stats

# Rescale dataset columns to the range 0-1
def normalize_dataset(dataset, minmax):
	for row in dataset:
		for i in range(len(row)-1):
			row[i] = (row[i] - minmax[i][0]) / (minmax[i][1] - minmax[i][0])

# Split a dataset into k folds
def cross_validation_split(dataset, n_folds):
	dataset_split = list()
	dataset_copy = list(dataset)
	fold_size = int(len(dataset) / n_folds)
	for i in range(n_folds):
		fold = list()
		while len(fold) &lt; fold_size:
			index = randrange(len(dataset_copy))
			fold.append(dataset_copy.pop(index))
		dataset_split.append(fold)
	return dataset_split

# Calculate accuracy percentage
def accuracy_metric(actual, predicted):
	correct = 0
	for i in range(len(actual)):
		if actual[i] == predicted[i]:
			correct += 1
	return correct / float(len(actual)) * 100.0

# Evaluate an algorithm using a cross validation split
def evaluate_algorithm(dataset, algorithm, n_folds, *args):
	folds = cross_validation_split(dataset, n_folds)
	scores = list()
	for fold in folds:
		train_set = list(folds)
		train_set.remove(fold)
		train_set = sum(train_set, [])
		test_set = list()
		for row in fold:
			row_copy = list(row)
			test_set.append(row_copy)
			row_copy[-1] = None
		predicted = algorithm(train_set, test_set, *args)
		actual = [row[-1] for row in fold]
		accuracy = accuracy_metric(actual, predicted)
		scores.append(accuracy)
	return scores

# Calculate neuron activation for an input
def activate(weights, inputs):
	activation = weights[-1]
	for i in range(len(weights)-1):
		activation += weights[i] * inputs[i]
	return activation

# Transfer neuron activation
def transfer(activation):
	return 1.0 / (1.0 + exp(-activation))

# Forward propagate input to a network output
def forward_propagate(network, row):
	inputs = row
	for layer in network:
		new_inputs = []
		for neuron in layer:
			activation = activate(neuron['weights'], inputs)
			neuron['output'] = transfer(activation)
			new_inputs.append(neuron['output'])
		inputs = new_inputs
	return inputs

# Calculate the derivative of an neuron output
def transfer_derivative(output):
	return output * (1.0 - output)

# Backpropagate error and store in neurons
def backward_propagate_error(network, expected):
	for i in reversed(range(len(network))):
		layer = network[i]
		errors = list()
		if i != len(network)-1:
			for j in range(len(layer)):
				error = 0.0
				for neuron in network[i + 1]:
					error += (neuron['weights'][j] * neuron['delta'])
				errors.append(error)
		else:
			for j in range(len(layer)):
				neuron = layer[j]
				errors.append(expected[j] - neuron['output'])
		for j in range(len(layer)):
			neuron = layer[j]
			neuron['delta'] = errors[j] * transfer_derivative(neuron['output'])

# Update network weights with error
def update_weights(network, row, l_rate):
	for i in range(len(network)):
		inputs = row[:-1]
		if i != 0:
			inputs = [neuron['output'] for neuron in network[i - 1]]
		for neuron in network[i]:
			for j in range(len(inputs)):
				neuron['weights'][j] += l_rate * neuron['delta'] * inputs[j]
			neuron['weights'][-1] += l_rate * neuron['delta']

# Train a network for a fixed number of epochs
def train_network(network, train, l_rate, n_epoch, n_outputs):
	for epoch in range(n_epoch):
		for row in train:
			outputs = forward_propagate(network, row)
			expected = [0 for i in range(n_outputs)]
			expected[row[-1]] = 1
			backward_propagate_error(network, expected)
			update_weights(network, row, l_rate)

# Initialize a network
def initialize_network(n_inputs, n_hidden, n_outputs):
	network = list()
	hidden_layer = [{'weights':[random() for i in range(n_inputs + 1)]} for i in range(n_hidden)]
	network.append(hidden_layer)
	output_layer = [{'weights':[random() for i in range(n_hidden + 1)]} for i in range(n_outputs)]
	network.append(output_layer)
	return network

# Make a prediction with a network
def predict(network, row):
	outputs = forward_propagate(network, row)
	return outputs.index(max(outputs))

# Backpropagation Algorithm With Stochastic Gradient Descent
def back_propagation(train, test, l_rate, n_epoch, n_hidden):
	n_inputs = len(train[0]) - 1
	n_outputs = len(set([row[-1] for row in train]))
	network = initialize_network(n_inputs, n_hidden, n_outputs)
	train_network(network, train, l_rate, n_epoch, n_outputs)
	predictions = list()
	for row in test:
		prediction = predict(network, row)
		predictions.append(prediction)
	return(predictions)

# Test Backprop on Seeds dataset
seed(1)
# load and prepare data
filename = 'seeds_dataset.csv'
dataset = load_csv(filename)
for i in range(len(dataset[0])-1):
	str_column_to_float(dataset, i)
# convert class column to integers
str_column_to_int(dataset, len(dataset[0])-1)
# normalize input variables
minmax = dataset_minmax(dataset)
normalize_dataset(dataset, minmax)
# evaluate algorithm
n_folds = 5
l_rate = 0.3
n_epoch = 500
n_hidden = 5
scores = evaluate_algorithm(dataset, back_propagation, n_folds, l_rate, n_epoch, n_hidden)
print('Scores: %s' % scores)
print('Mean Accuracy: %.3f%%' % (sum(scores)/float(len(scores))))</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-30">30</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-31">31</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-32">32</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-33">33</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-34">34</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-35">35</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-36">36</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-37">37</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-38">38</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-39">39</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-40">40</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-41">41</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-42">42</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-43">43</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-44">44</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-45">45</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-46">46</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-47">47</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-48">48</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-49">49</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-50">50</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-51">51</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-52">52</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-53">53</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-54">54</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-55">55</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-56">56</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-57">57</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-58">58</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-59">59</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-60">60</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-61">61</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-62">62</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-63">63</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-64">64</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-65">65</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-66">66</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-67">67</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-68">68</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-69">69</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-70">70</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-71">71</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-72">72</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-73">73</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-74">74</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-75">75</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-76">76</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-77">77</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-78">78</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-79">79</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-80">80</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-81">81</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-82">82</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-83">83</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-84">84</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-85">85</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-86">86</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-87">87</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-88">88</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-89">89</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-90">90</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-91">91</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-92">92</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-93">93</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-94">94</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-95">95</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-96">96</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-97">97</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-98">98</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-99">99</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-100">100</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-101">101</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-102">102</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-103">103</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-104">104</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-105">105</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-106">106</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-107">107</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-108">108</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-109">109</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-110">110</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-111">111</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-112">112</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-113">113</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-114">114</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-115">115</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-116">116</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-117">117</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-118">118</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-119">119</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-120">120</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-121">121</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-122">122</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-123">123</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-124">124</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-125">125</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-126">126</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-127">127</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-128">128</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-129">129</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-130">130</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-131">131</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-132">132</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-133">133</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-134">134</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-135">135</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-136">136</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-137">137</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-138">138</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-139">139</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-140">140</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-141">141</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-142">142</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-143">143</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-144">144</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-145">145</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-146">146</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-147">147</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-148">148</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-149">149</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-150">150</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-151">151</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-152">152</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-153">153</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-154">154</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-155">155</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-156">156</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-157">157</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-158">158</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-159">159</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-160">160</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-161">161</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-162">162</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-163">163</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-164">164</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-165">165</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-166">166</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-167">167</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-168">168</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-169">169</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-170">170</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-171">171</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-172">172</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-173">173</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-174">174</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-175">175</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-176">176</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-177">177</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-178">178</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-179">179</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-180">180</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-181">181</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-182">182</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-183">183</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-184">184</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-185">185</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-186">186</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-187">187</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-188">188</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-189">189</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-190">190</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-191">191</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-192">192</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-193">193</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-194">194</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-195">195</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-196">196</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-197">197</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-198">198</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b99222917490-199">199</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-1"><span class="crayon-p"># Backprop on the Seeds Dataset</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-2"><span class="crayon-e">from </span><span class="crayon-e">random </span><span class="crayon-e">import </span><span class="crayon-e">seed</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-3"><span class="crayon-e">from </span><span class="crayon-e">random </span><span class="crayon-e">import </span><span class="crayon-e">randrange</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-4"><span class="crayon-e">from </span><span class="crayon-e">random </span><span class="crayon-e">import </span><span class="crayon-e">random</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-5"><span class="crayon-e">from </span><span class="crayon-e">csv </span><span class="crayon-e">import </span><span class="crayon-e">reader</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-6"><span class="crayon-e">from </span><span class="crayon-e">math </span><span class="crayon-e">import </span><span class="crayon-i">exp</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-8"><span class="crayon-p"># Load a CSV file</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-9"><span class="crayon-e">def </span><span class="crayon-e">load_csv</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-10"><span class="crayon-h">	</span><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-11"><span class="crayon-h">	</span><span class="crayon-e">with </span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'r'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-v">file</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-12"><span class="crayon-h">		</span><span class="crayon-v">csv_reader</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">reader</span><span class="crayon-sy">(</span><span class="crayon-v">file</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-13"><span class="crayon-h">		</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">csv_reader</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-14"><span class="crayon-h">			</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-15"><span class="crayon-h">				</span><span class="crayon-st">continue</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-16"><span class="crayon-h">			</span><span class="crayon-v">dataset</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-17"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">dataset</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-18">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-19"><span class="crayon-p"># Convert string column to float</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-20"><span class="crayon-e">def </span><span class="crayon-e">str_column_to_float</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">column</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-21"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-22"><span class="crayon-h">		</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">column</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">column</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">strip</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-23">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-24"><span class="crayon-p"># Convert string column to integer</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-25"><span class="crayon-e">def </span><span class="crayon-e">str_column_to_int</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">column</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-26"><span class="crayon-h">	</span><span class="crayon-v">class_values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">column</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-27"><span class="crayon-h">	</span><span class="crayon-v">unique</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">set</span><span class="crayon-sy">(</span><span class="crayon-v">class_values</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-28"><span class="crayon-h">	</span><span class="crayon-v">lookup</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">dict</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-29"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">value </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">enumerate</span><span class="crayon-sy">(</span><span class="crayon-v">unique</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-30"><span class="crayon-h">		</span><span class="crayon-v">lookup</span><span class="crayon-sy">[</span><span class="crayon-v">value</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-i">i</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-31"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-32"><span class="crayon-h">		</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">column</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">lookup</span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">column</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-33"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">lookup</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-34">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-35"><span class="crayon-p"># Find the min and max values for each column</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-36"><span class="crayon-e">def </span><span class="crayon-e">dataset_minmax</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-37"><span class="crayon-h">	</span><span class="crayon-v">minmax</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-38"><span class="crayon-h">	</span><span class="crayon-v">stats</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-e">min</span><span class="crayon-sy">(</span><span class="crayon-v">column</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">max</span><span class="crayon-sy">(</span><span class="crayon-v">column</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">column </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">zip</span><span class="crayon-sy">(</span><span class="crayon-o">*</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-39"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">stats</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-40">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-41"><span class="crayon-p"># Rescale dataset columns to the range 0-1</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-42"><span class="crayon-e">def </span><span class="crayon-e">normalize_dataset</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">minmax</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-43"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-44"><span class="crayon-h">		</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">row</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-45"><span class="crayon-h">			</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">minmax</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">minmax</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">minmax</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-46">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-47"><span class="crayon-p"># Split a dataset into k folds</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-48"><span class="crayon-e">def </span><span class="crayon-e">cross_validation_split</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_folds</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-49"><span class="crayon-h">	</span><span class="crayon-v">dataset_split</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-50"><span class="crayon-h">	</span><span class="crayon-v">dataset_copy</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-51"><span class="crayon-h">	</span><span class="crayon-v">fold_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-v">n_folds</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-52"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_folds</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-53"><span class="crayon-h">		</span><span class="crayon-v">fold</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-54"><span class="crayon-h">		</span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">fold</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">fold_size</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-55"><span class="crayon-h">			</span><span class="crayon-v">index</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">randrange</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset_copy</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-56"><span class="crayon-h">			</span><span class="crayon-v">fold</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">dataset_copy</span><span class="crayon-sy">.</span><span class="crayon-e">pop</span><span class="crayon-sy">(</span><span class="crayon-v">index</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-57"><span class="crayon-h">		</span><span class="crayon-v">dataset_split</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">fold</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-58"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">_</span>split</div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-59">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-60"><span class="crayon-p"># Calculate accuracy percentage</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-61"><span class="crayon-e">def </span><span class="crayon-e">accuracy_metric</span><span class="crayon-sy">(</span><span class="crayon-v">actual</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">predicted</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-62"><span class="crayon-h">	</span><span class="crayon-v">correct</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-63"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">actual</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-64"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">actual</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-v">predicted</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-65"><span class="crayon-h">			</span><span class="crayon-v">correct</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-66"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">correct</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">actual</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">100.0</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-67">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-68"><span class="crayon-p"># Evaluate an algorithm using a cross validation split</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-69"><span class="crayon-e">def </span><span class="crayon-e">evaluate_algorithm</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">algorithm</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_folds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-v">args</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-70"><span class="crayon-h">	</span><span class="crayon-v">folds</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">cross_validation_split</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_folds</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-71"><span class="crayon-h">	</span><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-72"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">fold </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">folds</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-73"><span class="crayon-h">		</span><span class="crayon-v">train_set</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-v">folds</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-74"><span class="crayon-h">		</span><span class="crayon-v">train_set</span><span class="crayon-sy">.</span><span class="crayon-e">remove</span><span class="crayon-sy">(</span><span class="crayon-v">fold</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-75"><span class="crayon-h">		</span><span class="crayon-v">train_set</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">sum</span><span class="crayon-sy">(</span><span class="crayon-v">train_set</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-76"><span class="crayon-h">		</span><span class="crayon-v">test_set</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-77"><span class="crayon-h">		</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">fold</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-78"><span class="crayon-h">			</span><span class="crayon-v">row_copy</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-79"><span class="crayon-h">			</span><span class="crayon-v">test_set</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">row_copy</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-80"><span class="crayon-h">			</span><span class="crayon-v">row_copy</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">None</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-81"><span class="crayon-e">		</span><span class="crayon-v">predicted</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">algorithm</span><span class="crayon-sy">(</span><span class="crayon-v">train_set</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_set</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-v">args</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-82"><span class="crayon-h">		</span><span class="crayon-v">actual</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">fold</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-83"><span class="crayon-h">		</span><span class="crayon-v">accuracy</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">accuracy_metric</span><span class="crayon-sy">(</span><span class="crayon-v">actual</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">predicted</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-84"><span class="crayon-h">		</span><span class="crayon-v">scores</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">accuracy</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-85"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">scores</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-86">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-87"><span class="crayon-p"># Calculate neuron activation for an input</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-88"><span class="crayon-e">def </span><span class="crayon-e">activate</span><span class="crayon-sy">(</span><span class="crayon-v">weights</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-89"><span class="crayon-h">	</span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">weights</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-90"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">weights</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-91"><span class="crayon-h">		</span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-v">weights</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-92"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">activation</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-93">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-94"><span class="crayon-p"># Transfer neuron activation</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-95"><span class="crayon-e">def </span><span class="crayon-e">transfer</span><span class="crayon-sy">(</span><span class="crayon-v">activation</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-96"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-cn">1.0</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1.0</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">exp</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-v">activation</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-97">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-98"><span class="crayon-p"># Forward propagate input to a network output</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-99"><span class="crayon-e">def </span><span class="crayon-e">forward_propagate</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-100"><span class="crayon-h">	</span><span class="crayon-v">inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">row</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-101"><span class="crayon-e">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">layer </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-102"><span class="crayon-h">		</span><span class="crayon-v">new_inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-103"><span class="crayon-h">		</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">neuron </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">layer</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-104"><span class="crayon-h">			</span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">activate</span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'weights'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-105"><span class="crayon-h">			</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">transfer</span><span class="crayon-sy">(</span><span class="crayon-v">activation</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-106"><span class="crayon-h">			</span><span class="crayon-v">new_inputs</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-107"><span class="crayon-h">		</span><span class="crayon-v">inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">new_inputs</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-108"><span class="crayon-e">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">inputs</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-109">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-110"><span class="crayon-p"># Calculate the derivative of an neuron output</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-111"><span class="crayon-e">def </span><span class="crayon-e">transfer_derivative</span><span class="crayon-sy">(</span><span class="crayon-v">output</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-112"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e ">output *</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1.0</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">output</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-113">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-114"><span class="crayon-p"># Backpropagate error and store in neurons</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-115"><span class="crayon-e">def </span><span class="crayon-e">backward_propagate_error</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">expected</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-116"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">reversed</span><span class="crayon-sy">(</span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-117"><span class="crayon-h">		</span><span class="crayon-v">layer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-118"><span class="crayon-h">		</span><span class="crayon-v">errors</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-119"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-120"><span class="crayon-h">			</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">layer</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-121"><span class="crayon-h">				</span><span class="crayon-v">error</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.0</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-122"><span class="crayon-h">				</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">neuron </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-123"><span class="crayon-h">					</span><span class="crayon-v">error</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'weights'</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'delta'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-124"><span class="crayon-h">				</span><span class="crayon-v">errors</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">error</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-125"><span class="crayon-h">		</span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-126"><span class="crayon-h">			</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">layer</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-127"><span class="crayon-h">				</span><span class="crayon-v">neuron</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">layer</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-128"><span class="crayon-h">				</span><span class="crayon-v">errors</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">expected</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-129"><span class="crayon-h">		</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">layer</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-130"><span class="crayon-h">			</span><span class="crayon-v">neuron</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">layer</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-131"><span class="crayon-h">			</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'delta'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">errors</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-e">transfer_derivative</span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-132">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-133"><span class="crayon-p"># Update network weights with error</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-134"><span class="crayon-e">def </span><span class="crayon-e">update_weights</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">l_rate</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-135"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-136"><span class="crayon-h">		</span><span class="crayon-v">inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-137"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-138"><span class="crayon-h">			</span><span class="crayon-v">inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">neuron </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-139"><span class="crayon-h">		</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">neuron </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-140"><span class="crayon-h">			</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">inputs</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-141"><span class="crayon-h">				</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'weights'</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-e ">l_rate *</span><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'delta'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-142"><span class="crayon-h">			</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'weights'</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-e ">l_rate *</span><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'delta'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-143">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-144"><span class="crayon-p"># Train a network for a fixed number of epochs</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-145"><span class="crayon-e">def </span><span class="crayon-e">train_network</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">l_rate</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_epoch</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_outputs</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-146"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">epoch </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_epoch</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-147"><span class="crayon-h">		</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-148"><span class="crayon-h">			</span><span class="crayon-v">outputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">forward_propagate</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-149"><span class="crayon-h">			</span><span class="crayon-v">expected</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_outputs</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-150"><span class="crayon-h">			</span><span class="crayon-v">expected</span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-151"><span class="crayon-h">			</span><span class="crayon-e">backward_propagate_error</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">expected</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-152"><span class="crayon-h">			</span><span class="crayon-e">update_weights</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">l_rate</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-153">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-154"><span class="crayon-p"># Initialize a network</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-155"><span class="crayon-e">def </span><span class="crayon-e">initialize_network</span><span class="crayon-sy">(</span><span class="crayon-v">n_inputs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_hidden</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_outputs</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-156"><span class="crayon-h">	</span><span class="crayon-v">network</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-157"><span class="crayon-h">	</span><span class="crayon-v">hidden_layer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">{</span><span class="crayon-s">'weights'</span><span class="crayon-o">:</span><span class="crayon-sy">[</span><span class="crayon-e">random</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_inputs</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_hidden</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-158"><span class="crayon-h">	</span><span class="crayon-v">network</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">hidden_layer</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-159"><span class="crayon-h">	</span><span class="crayon-v">output_layer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">{</span><span class="crayon-s">'weights'</span><span class="crayon-o">:</span><span class="crayon-sy">[</span><span class="crayon-e">random</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_hidden</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_outputs</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-160"><span class="crayon-h">	</span><span class="crayon-v">network</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">output_layer</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-161"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">network</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-162">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-163"><span class="crayon-p"># Make a prediction with a network</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-164"><span class="crayon-e">def </span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-165"><span class="crayon-h">	</span><span class="crayon-v">outputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">forward_propagate</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-166"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">outputs</span><span class="crayon-sy">.</span><span class="crayon-e">index</span><span class="crayon-sy">(</span><span class="crayon-e">max</span><span class="crayon-sy">(</span><span class="crayon-v">outputs</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-167">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-168"><span class="crayon-p"># Backpropagation Algorithm With Stochastic Gradient Descent</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-169"><span class="crayon-e">def </span><span class="crayon-e">back_propagation</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">l_rate</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_epoch</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_hidden</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-170"><span class="crayon-h">	</span><span class="crayon-v">n_inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-171"><span class="crayon-h">	</span><span class="crayon-v">n_outputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-e">set</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-172"><span class="crayon-h">	</span><span class="crayon-v">network</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">initialize_network</span><span class="crayon-sy">(</span><span class="crayon-v">n_inputs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_hidden</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_outputs</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-173"><span class="crayon-h">	</span><span class="crayon-e">train_network</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">l_rate</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_epoch</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_outputs</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-174"><span class="crayon-h">	</span><span class="crayon-v">predictions</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-175"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-176"><span class="crayon-h">		</span><span class="crayon-v">prediction</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-177"><span class="crayon-h">		</span><span class="crayon-v">predictions</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">prediction</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-178"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-sy">(</span><span class="crayon-v">predictions</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-179">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-180"><span class="crayon-p"># Test Backprop on Seeds dataset</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-181"><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-182"><span class="crayon-p"># load and prepare data</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-183"><span class="crayon-v">filename</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'seeds_dataset.csv'</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-184"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_csv</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-185"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-186"><span class="crayon-h">	</span><span class="crayon-e">str_column_to_float</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-187"><span class="crayon-p"># convert class column to integers</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-188"><span class="crayon-e">str_column_to_int</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-189"><span class="crayon-p"># normalize input variables</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-190"><span class="crayon-v">minmax</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">dataset_minmax</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-191"><span class="crayon-e">normalize_dataset</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">minmax</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-192"><span class="crayon-p"># evaluate algorithm</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-193"><span class="crayon-v">n_folds</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">5</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-194"><span class="crayon-v">l_rate</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.3</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-195"><span class="crayon-v">n_epoch</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">500</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-196"><span class="crayon-v">n_hidden</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">5</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-197"><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">evaluate_algorithm</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">back_propagation</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_folds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">l_rate</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_epoch</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_hidden</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-198"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Scores: %s'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b99222917490-199"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Mean Accuracy: %.3f%%'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">sum</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span><span class="crayon-o">/</span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>A network with 5 neurons in the hidden layer and 3 neurons in the output layer was constructed. The network was trained for 500 epochs with a learning rate of 0.3. These parameters were found with a little trial and error, but you may be able to do much better.</p>
<p>Running the example prints the average classification accuracy on each fold as well as the average performance across all folds.</p>
<p>You can see that backpropagation and the chosen configuration achieved a mean classification accuracy of about 93% which is dramatically better than the Zero Rule algorithm that did slightly better than 28% accuracy.</p>
		<div id="urvanov-syntax-highlighter-6060ca9c63b9c592803046" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18.9915px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">Scores: [92.85714285714286, 92.85714285714286, 97.61904761904762, 92.85714285714286, 90.47619047619048]
Mean Accuracy: 93.333%</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c63b9c592803046-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c63b9c592803046-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c63b9c592803046-1">Scores: [92.85714285714286, 92.85714285714286, 97.61904761904762, 92.85714285714286, 90.47619047619048]</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c63b9c592803046-2">Mean Accuracy: 93.333%</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p></p>
<h2>Extensions</h2>
<p>This section lists extensions to the tutorial that you may wish to explore.</p>
<ul>
<li><strong>Tune Algorithm Parameters</strong>. Try larger or smaller networks trained for longer or shorter. See if you can get better performance on the seeds dataset.</li>
<li><strong>Additional Methods</strong>. Experiment with different weight initialization techniques (such as small random numbers) and different transfer functions (such as tanh).</li>
<li><strong>More Layers</strong>. Add support for more hidden layers, trained in just the same way as the one hidden layer used in this tutorial.</li>
<li><strong>Regression</strong>. Change the network so that there is only one neuron in the output layer and that a real value is predicted. Pick a regression dataset to practice on. A linear transfer function could be used for neurons in the output layer, or the output values of the chosen dataset could be scaled to values between 0 and 1.</li>
<li><strong>Batch Gradient Descent</strong>. Change the training procedure from online to batch gradient descent and update the weights only at the end of each epoch.</li>
</ul>
<p style="text-align: center;"><strong>Did you try any of these extensions?</strong><br>
Share your experiences in the comments below.</p>
<h2>Review</h2>
<p>In this tutorial, you discovered how to implement the Backpropagation algorithm from scratch.</p>
<p>Specifically, you learned:</p>
<ul>
<li>How to forward propagate an input to calculate a network output.</li>
<li>How to back propagate error and update network weights.</li>
<li>How to apply the backpropagation algorithm to a real world dataset.</li>
</ul>
<p style="text-align: center;"><strong>Do you have any questions?</strong><br>
Ask your questions in the comments below and I will do my best to answer.</p>
<p style="text-align: left;"><!-- Shortcode does not match the conditions --></p>
<div class="widget_text awac-wrapper" id="custom_html-77"><div class="widget_text awac widget custom_html-77"><div class="textwidget custom-html-widget"><div style="text-align: center;">
<div class="woo-sc-hr"></div>
<h2 style="text-align: center;">Discover How to Code Algorithms From Scratch!</h2>
<a href="https://machinelearningmastery.com/machine-learning-algorithms-from-scratch/" rel="nofollow"><img width="220" height="311" style="border: 0;" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/MachineLearningAlgorithmsFromScratch-220.webp" alt="Machine Learning Algorithms From Scratch" align="left"></a>
<h4>No Libraries, Just Python Code.</h4>

<p>...with step-by-step tutorials on real-world&nbsp;datasets</p>

<p>Discover how in my new Ebook:<br>
<a href="https://machinelearningmastery.com/machine-learning-algorithms-from-scratch/" rel="nofollow">Machine Learning Algorithms From Scratch</a></p>

<p>It covers <strong>18&nbsp;tutorials</strong> with all the code for <strong>12 top algorithms</strong>, like:<br>
Linear Regression, k-Nearest Neighbors, Stochastic Gradient Descent and much more...</p>

<h4>Finally, Pull Back the Curtain on<br>
Machine Learning Algorithms</h4>

<p>Skip the Academics. Just Results.</p>

<a href="https://machinelearningmastery.com/machine-learning-algorithms-from-scratch/" class="woo-sc-button  red"><span class="woo-">See What's Inside</span></a>

<div class="woo-sc-hr"></div>
</div></div></div></div><div class="simplesocialbuttons simplesocial-simple-icons simplesocialbuttons_inline simplesocialbuttons-align-left post-3349 post simplesocialbuttons-inline-no-animation simplesocialbuttons-inline-in">
<button class="ssb_tweet-icon" data-href="https://twitter.com/share?text=How+to+Code+a+Neural+Network+with+Backpropagation+In+Python+%28from+scratch%29&amp;url=https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/" rel="nofollow" onclick="if (!window.__cfRLUnblockHandlers) return false; javascript:window.open(this.dataset.href, &#39;&#39;, &#39;menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600&#39;);return false;">
						<span class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 72 72"><path fill="none" d="M0 0h72v72H0z"></path><path class="icon" fill="#fff" d="M68.812 15.14c-2.348 1.04-4.87 1.744-7.52 2.06 2.704-1.62 4.78-4.186 5.757-7.243-2.53 1.5-5.33 2.592-8.314 3.176C56.35 10.59 52.948 9 49.182 9c-7.23 0-13.092 5.86-13.092 13.093 0 1.026.118 2.02.338 2.98C25.543 24.527 15.9 19.318 9.44 11.396c-1.125 1.936-1.77 4.184-1.77 6.58 0 4.543 2.312 8.552 5.824 10.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163 0 6.345 4.513 11.638 10.504 12.84-1.1.298-2.256.457-3.45.457-.845 0-1.666-.078-2.464-.23 1.667 5.2 6.5 8.985 12.23 9.09-4.482 3.51-10.13 5.605-16.26 5.605-1.055 0-2.096-.06-3.122-.184 5.794 3.717 12.676 5.882 20.067 5.882 24.083 0 37.25-19.95 37.25-37.25 0-.565-.013-1.133-.038-1.693 2.558-1.847 4.778-4.15 6.532-6.774z"></path></svg></span><i class="simplesocialtxt">Tweet </i></button>
		<button class="ssb_fbshare-icon" target="_blank" data-href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/" onclick="if (!window.__cfRLUnblockHandlers) return false; javascript:window.open(this.dataset.href, &#39;&#39;, &#39;menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600&#39;);return false;">
						<span class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" class="_1pbq" color="#ffffff"><path fill="#ffffff" fill-rule="evenodd" class="icon" d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z"></path></svg></span>
						<span class="simplesocialtxt">Share </span> </button>
<button class="ssb_linkedin-icon" data-href="https://www.linkedin.com/cws/share?url=https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/" onclick="if (!window.__cfRLUnblockHandlers) return false; javascript:window.open(this.dataset.href, &#39;&#39;, &#39;menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600&#39;);return false;">
						<span class="icon"> <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="15px" height="14.1px" viewBox="-301.4 387.5 15 14.1" enable-background="new -301.4 387.5 15 14.1" xml:space="preserve"> <g id="XMLID_398_"> <path id="XMLID_399_" fill="#FFFFFF" d="M-296.2,401.6c0-3.2,0-6.3,0-9.5h0.1c1,0,2,0,2.9,0c0.1,0,0.1,0,0.1,0.1c0,0.4,0,0.8,0,1.2 c0.1-0.1,0.2-0.3,0.3-0.4c0.5-0.7,1.2-1,2.1-1.1c0.8-0.1,1.5,0,2.2,0.3c0.7,0.4,1.2,0.8,1.5,1.4c0.4,0.8,0.6,1.7,0.6,2.5 c0,1.8,0,3.6,0,5.4v0.1c-1.1,0-2.1,0-3.2,0c0-0.1,0-0.1,0-0.2c0-1.6,0-3.2,0-4.8c0-0.4,0-0.8-0.2-1.2c-0.2-0.7-0.8-1-1.6-1 c-0.8,0.1-1.3,0.5-1.6,1.2c-0.1,0.2-0.1,0.5-0.1,0.8c0,1.7,0,3.4,0,5.1c0,0.2,0,0.2-0.2,0.2c-1,0-1.9,0-2.9,0 C-296.1,401.6-296.2,401.6-296.2,401.6z"></path> <path id="XMLID_400_" fill="#FFFFFF" d="M-298,401.6L-298,401.6c-1.1,0-2.1,0-3,0c-0.1,0-0.1,0-0.1-0.1c0-3.1,0-6.1,0-9.2 c0-0.1,0-0.1,0.1-0.1c1,0,2,0,2.9,0h0.1C-298,395.3-298,398.5-298,401.6z"></path> <path id="XMLID_401_" fill="#FFFFFF" d="M-299.6,390.9c-0.7-0.1-1.2-0.3-1.6-0.8c-0.5-0.8-0.2-2.1,1-2.4c0.6-0.2,1.2-0.1,1.8,0.2 c0.5,0.4,0.7,0.9,0.6,1.5c-0.1,0.7-0.5,1.1-1.1,1.3C-299.1,390.8-299.4,390.8-299.6,390.9L-299.6,390.9z"></path> </g> </svg> </span>
						<span class="simplesocialtxt">Share</span> </button>
</div>
	</section><!-- /.entry -->
	<div class="fix"></div>
<aside id="post-author">
	<div class="profile-image"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a.png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=160&amp;d=mm&amp;r=g 2x" class="avatar avatar-80 photo" height="80" width="80" loading="lazy"></div>
	<div class="profile-content">
		<h4>About Jason Brownlee</h4>
		Jason Brownlee, PhD is a machine learning specialist who teaches developers how to get results with modern machine learning methods via hands-on tutorials.				<div class="profile-link">
			<a href="https://machinelearningmastery.com/author/jasonb/">
				View all posts by Jason Brownlee <span class="meta-nav">→</span>			</a>
		</div><!--#profile-link-->
			</div>
	<div class="fix"></div>
</aside>
<div class="post-utility"></div>
</article><!-- /.post -->
	        <div class="post-entries">
	            <div class="nav-prev fl"><a href="https://machinelearningmastery.com/implement-learning-vector-quantization-scratch-python/" rel="prev"><i class="fa fa-angle-left"></i> How To Implement Learning Vector Quantization (LVQ) From Scratch With Python</a></div>
	            <div class="nav-next fr"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/" rel="next">How To Implement The Decision Tree Algorithm From Scratch In Python <i class="fa fa-angle-right"></i></a></div>
	            <div class="fix"></div>
	        </div>

		<div id="comments">		 	<h3 id="comments-title">730 Responses to <em>How to Code a Neural Network with Backpropagation In Python (from scratch)</em></h3>
		 	<ol class="commentlist">
				
		<li id="comment-369793" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-369793" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a7f661305b54a2c0f68f8faa81007e23.png" srcset="https://secure.gravatar.com/avatar/a7f661305b54a2c0f68f8faa81007e23?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://www.facebook.com/talkdatatome/" rel="external nofollow ugc" class="url">Talk Data To Me</a></span>
	                <span class="date">November 7, 2016 at 9:28 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-369793" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>That’s what I was looking for. Write a neural network without any libraries (scikit, keras etc.) Thnak you very much!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-369793" data-commentid="369793" data-postid="3349" data-belowelement="comment-369793" data-respondelement="respond" data-replyto="Reply to Talk Data To Me" aria-label="Reply to Talk Data To Me">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-369865" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-369865" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">November 8, 2016 at 9:51 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-369865" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I’m glad to hear it!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-369865" data-commentid="369865" data-postid="3349" data-belowelement="comment-369865" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-496972" class="comment even depth-3 parent">

	      	<div id="li-comment-496972" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/409f1e16162ea4233a4af5d38d7158e3.png" srcset="https://secure.gravatar.com/avatar/409f1e16162ea4233a4af5d38d7158e3?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://saridewi.web.ugm.ac.id/" rel="external nofollow ugc" class="url">sari dewi</a></span>
	                <span class="date">August 16, 2019 at 11:55 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-496972" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hy Mr. jason , i try your code to make a neural network with backpropagation method, I using jupyter notebook anaconda  and pyhton 3.7 64 bit, when i try this code</p>
<p>seed(1)<br>
# load and prepare data<br>
filename =’datalatih.csv’<br>
dataset = load_csv(filename)<br>
for i in range(len(dataset[0])-1):<br>
    str_column_to_float(dataset, i)<br>
# convert class column to integers<br>
str_column_to_int(dataset, len(dataset[0])-1)<br>
# normalize input variables<br>
minmax = dataset_minmax(dataset)<br>
normalize_dataset(dataset, minmax)<br>
# evaluate algorithm<br>
n_folds =5<br>
l_rate =0.3<br>
n_epoch =500<br>
n_hidden =5<br>
scores = evaluate_algorithm(dataset, back_propagation, n_folds, l_rate, n_epoch, n_hidden)</p>
<p>print (‘Scores: %s’ % scores)<br>
print (‘Mean Accuracy: %.3f%%’ % (sum(scores)/float(len(scores))))</p>
<p>but I get error message</p>
<p>IndexError                                Traceback (most recent call last)<br>
 in<br>
    196 n_epoch =500<br>
    197 n_hidden =5<br>
–&gt; 198 scores = evaluate_algorithm(dataset, back_propagation, n_folds, l_rate, n_epoch, n_hidden)<br>
    199<br>
    200 print (‘Scores: %s’ % scores)</p>
<p> in evaluate_algorithm(dataset, algorithm, n_folds, *args)<br>
     79             test_set.append(row_copy)<br>
     80             row_copy[-1] = None<br>
—&gt; 81         predicted = algorithm(train_set, test_set, *args)<br>
     82         actual = [row[-1] for row in fold]<br>
     83         accuracy = accuracy_metric(actual, predicted)</p>
<p> in back_propagation(train, test, l_rate, n_epoch, n_hidden)<br>
    171     n_outputs = len(set([row[-1] for row in train]))<br>
    172     network = initialize_network(n_inputs, n_hidden, n_outputs)<br>
–&gt; 173     train_network(network, train, l_rate, n_epoch, n_outputs)<br>
    174     predictions = list()<br>
    175     for row in test:</p>
<p> in train_network(network, train, l_rate, n_epoch, n_outputs)<br>
    148             outputs = forward_propagate(network, row)<br>
    149             expected = [0 for i in range(n_outputs)]<br>
–&gt; 150             expected[row[-1]] = 1<br>
    151             backward_propagate_error(network, expected)<br>
    152             update_weights(network, row, l_rate)</p>
<p>IndexError: list assignment index out of range</p>
<p>what my mistake? is there missing code? thankyou</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-496972" data-commentid="496972" data-postid="3349" data-belowelement="comment-496972" data-respondelement="respond" data-replyto="Reply to sari dewi" aria-label="Reply to sari dewi">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-496988" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-496988" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">August 16, 2019 at 2:11 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-496988" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry to hear that you are having trouble, I have some suggestions for you here:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-496988" data-commentid="496988" data-postid="3349" data-belowelement="comment-496988" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-509358" class="comment even depth-4">

	      	<div id="li-comment-509358" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/1159039d8205d6dc0f361d1296ddc0d3.png" srcset="https://secure.gravatar.com/avatar/1159039d8205d6dc0f361d1296ddc0d3?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">steven</span>
	                <span class="date">November 9, 2019 at 1:35 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-509358" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>this is the exact problem I face to. Do you have any suggestion? Thank you so much</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-509358" data-commentid="509358" data-postid="3349" data-belowelement="comment-509358" data-respondelement="respond" data-replyto="Reply to steven" aria-label="Reply to steven">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-511941" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-511941" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a9b07c89a2a900ffbb38675df5504a36.jpeg" srcset="https://secure.gravatar.com/avatar/a9b07c89a2a900ffbb38675df5504a36?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://not%20yet/" rel="external nofollow ugc" class="url">Febry Triyadi</a></span>
	                <span class="date">November 22, 2019 at 6:53 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-511941" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Mr.Jason i have trouble with your code. Please check it, i not understand with expected[row[-1]] = 1</p>
<p>IndexError                                Traceback (most recent call last)<br>
 in ()<br>
     13 n_epoch = 500<br>
     14 n_hidden = 5<br>
—&gt; 15 scores = evaluate_algorithm(dataset, back_propagation, n_folds, l_rate, n_epoch, n_hidden)<br>
     16 print(‘Scores: %s’ % scores)<br>
     17 print(‘Mean Accuracy: %.3f%%’ % (sum(scores)/float(len(scores))))</p>
<p>2 frames<br>
 in train_network(network, train, l_rate, n_epoch, n_outputs)<br>
     50                         outputs = forward_propagate(network, row)<br>
     51                         expected = [0 for i in range(n_outputs)]<br>
—&gt; 52                         expected[row[-1]] = 1<br>
     53                         backward_propagate_error(network, expected)<br>
     54                         update_weights(network, row, l_rate)</p>
<p>IndexError: list assignment index out of range</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-511941" data-commentid="511941" data-postid="3349" data-belowelement="comment-511941" data-respondelement="respond" data-replyto="Reply to Febry Triyadi" aria-label="Reply to Febry Triyadi">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-511987" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-511987" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">November 23, 2019 at 6:50 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-511987" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry to hear that, I have some suggestions here:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-511987" data-commentid="511987" data-postid="3349" data-belowelement="comment-511987" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-430007" class="comment odd alt depth-2 parent">

	      	<div id="li-comment-430007" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/160276a64f3bab346f10267d5323c222.png" srcset="https://secure.gravatar.com/avatar/160276a64f3bab346f10267d5323c222?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/" rel="external nofollow ugc" class="url">WB</a></span>
	                <span class="date">February 20, 2018 at 3:07 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-430007" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I experienced the following applying the  Backpropagation algorithm to the wheat seeds dataset. I am wondering how to resolve the errors? Thank you<br>
—————————————————————————<br>
ValueError                                Traceback (most recent call last)<br>
 in ()<br>
    184 dataset = load_csv(filename)<br>
    185 for i in range(len(dataset[0])-1):<br>
–&gt; 186         str_column_to_float(dataset, i)<br>
    187 # convert class column to integers<br>
    188 str_column_to_int(dataset, len(dataset[0])-1)</p>
<p> in str_column_to_float(dataset, column)<br>
     20 def str_column_to_float(dataset, column):<br>
     21         for row in dataset:<br>
—&gt; 22                 row[column] = float(row[column].strip())<br>
     23<br>
     24 # Convert string column to integer</p>
<p>ValueError: could not convert string to float:</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-430007" data-commentid="430007" data-postid="3349" data-belowelement="comment-430007" data-respondelement="respond" data-replyto="Reply to WB" aria-label="Reply to WB">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-430095" class="comment byuser comment-author-jasonb bypostauthor even depth-3 parent">

	      	<div id="li-comment-430095" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">February 21, 2018 at 6:35 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-430095" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Are you using Python 2?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-430095" data-commentid="430095" data-postid="3349" data-belowelement="comment-430095" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-430134" class="comment odd alt depth-4">

	      	<div id="li-comment-430134" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/160276a64f3bab346f10267d5323c222.png" srcset="https://secure.gravatar.com/avatar/160276a64f3bab346f10267d5323c222?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-430007" rel="external nofollow ugc" class="url">wb</a></span>
	                <span class="date">February 21, 2018 at 2:51 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-430134" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes  I am</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-430134" data-commentid="430134" data-postid="3349" data-belowelement="comment-430134" data-respondelement="respond" data-replyto="Reply to wb" aria-label="Reply to wb">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-450776" class="comment even depth-4">

	      	<div id="li-comment-450776" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/c8592a34514876fd1e4a747c2d2ff0de.png" srcset="https://secure.gravatar.com/avatar/c8592a34514876fd1e4a747c2d2ff0de?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">harshith</span>
	                <span class="date">October 5, 2018 at 8:28 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-450776" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>hi bro whass up</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-450776" data-commentid="450776" data-postid="3349" data-belowelement="comment-450776" data-respondelement="respond" data-replyto="Reply to harshith" aria-label="Reply to harshith">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-431188" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-431188" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/128f0d1c2cd29ed12d2a69135d5021dc.png" srcset="https://secure.gravatar.com/avatar/128f0d1c2cd29ed12d2a69135d5021dc?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Mike Harney</span>
	                <span class="date">March 5, 2018 at 9:53 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-431188" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi wb, I’m on 3.6 and I found the same issue. Maybe you can answer this Jason, but it looks like the some of the data is misaligned in the sample. When opened in Excel, there are many open spaces followed by data jutted out to an extra column. I assume this is unintentional, and when I corrected the spacing, it appeared to work for me.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-431188" data-commentid="431188" data-postid="3349" data-belowelement="comment-431188" data-respondelement="respond" data-replyto="Reply to Mike Harney" aria-label="Reply to Mike Harney">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-431265" class="comment byuser comment-author-jasonb bypostauthor even depth-4 parent">

	      	<div id="li-comment-431265" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 6, 2018 at 6:08 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-431265" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The code was written and tested with Python 2.7.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-431265" data-commentid="431265" data-postid="3349" data-belowelement="comment-431265" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-435683" class="comment odd alt depth-5">

	      	<div id="li-comment-435683" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/4d520b60a75d799c5f7699e1e4e547c0.png" srcset="https://secure.gravatar.com/avatar/4d520b60a75d799c5f7699e1e4e547c0?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">JU</span>
	                <span class="date">April 23, 2018 at 7:24 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-435683" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Mike is right – the dataset from the UCI website is slightly defective: It has two tabs in some places where there should be only one. This needs to be corrected during the conversion to CSV. In Excel the easiest way is to use the text importer and then click the “Treat consecutive delimiters as one” checkbox.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-435685" class="comment byuser comment-author-jasonb bypostauthor even depth-5">

	      	<div id="li-comment-435685" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 23, 2018 at 7:37 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-435685" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Here is the dataset ready to use:<br>
<a href="https://raw.githubusercontent.com/jbrownlee/Datasets/master/wheat-seeds.csv" rel="nofollow ugc">https://raw.githubusercontent.com/jbrownlee/Datasets/master/wheat-seeds.csv</a></p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-447163" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-447163" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/7e7d2c532c3bc706ec0bf6a3fec85c6b.png" srcset="https://secure.gravatar.com/avatar/7e7d2c532c3bc706ec0bf6a3fec85c6b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Alexis Batyk</span>
	                <span class="date">August 29, 2018 at 6:22 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-447163" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>[SOLVED]<br>
i have the same issue with </p>
<p><a href="https://raw.githubusercontent.com/jbrownlee/Datasets/master/wheat-seeds.csv" rel="nofollow ugc">https://raw.githubusercontent.com/jbrownlee/Datasets/master/wheat-seeds.csv</a></p>
<p>there is still dirty that csv</p>
<p>use a text editor -&gt; select search and replace tool -&gt; search ‘,,’ replace ‘,’ and it works</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-447163" data-commentid="447163" data-postid="3349" data-belowelement="comment-447163" data-respondelement="respond" data-replyto="Reply to Alexis Batyk" aria-label="Reply to Alexis Batyk">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-447193" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-447193" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">August 29, 2018 at 8:16 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-447193" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I don’t have such problems on Py 3.6.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-447193" data-commentid="447193" data-postid="3349" data-belowelement="comment-447193" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-450367" class="comment odd alt depth-4 parent">

	      	<div id="li-comment-450367" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/3f1abfb9722fe725edc0c5ae14598ec1.png" srcset="https://secure.gravatar.com/avatar/3f1abfb9722fe725edc0c5ae14598ec1?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://jacksonscott.net/" rel="external nofollow ugc" class="url">Jackson Scott</a></span>
	                <span class="date">October 1, 2018 at 9:08 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-450367" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>thanks, this worked for me as well. The csv file had some tabbed over and others correct.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-450367" data-commentid="450367" data-postid="3349" data-belowelement="comment-450367" data-respondelement="respond" data-replyto="Reply to Jackson Scott" aria-label="Reply to Jackson Scott">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-499531" class="comment even depth-5">

	      	<div id="li-comment-499531" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/e245d5b2b397841eaf0696d86f4cc2fc.png" srcset="https://secure.gravatar.com/avatar/e245d5b2b397841eaf0696d86f4cc2fc?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Dharmendra Kumar</span>
	                <span class="date">September 3, 2019 at 7:38 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-499531" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-499593" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-499593" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">September 4, 2019 at 5:56 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-499593" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You’re welcome.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-451606" class="comment even depth-3">

	      	<div id="li-comment-451606" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/cfa744c359c19540478c6b25cae782b5.png" srcset="https://secure.gravatar.com/avatar/cfa744c359c19540478c6b25cae782b5?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Deng</span>
	                <span class="date">October 14, 2018 at 5:50 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-451606" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The data in the seeds_dataset file contains the backspace key, and it is ok to reset the data</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-451606" data-commentid="451606" data-postid="3349" data-belowelement="comment-451606" data-respondelement="respond" data-replyto="Reply to Deng" aria-label="Reply to Deng">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-485046" class="comment odd alt depth-2 parent">

	      	<div id="li-comment-485046" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/6ad22b6536cb84358edae639909a6704.png" srcset="https://secure.gravatar.com/avatar/6ad22b6536cb84358edae639909a6704?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://homeschoolworld.co.uk/" rel="external nofollow ugc" class="url">George Dong</a></span>
	                <span class="date">May 12, 2019 at 6:14 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-485046" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I echo that too!</p>
<p>Just one question please! In your code below, I could not understand why multiplication is used instead of division in the last line. Though division caused divide by zero problem.</p>
<p></p>
		<div id="urvanov-syntax-highlighter-6060ca9c6dd43141299513" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18.9915px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># Backpropagate error and store in neurons
def backward_propagate_error(network, expected):
    for i in reversed(range(len(network))):
        layer = network[i]
        errors = list()
        if i != len(network)-1:
            for j in range(len(layer)):
                error = 0.0
                for neuron in network[i + 1]:
                    error += (neuron['weights'][j] * neuron['delta'])
                
                errors.append(error)
            for j in range(len(layer)):
                layer[j]['error'] = errors[j]
        else:
            for j in range(len(layer)):
                neuron = layer[j]
                errors.append(expected[j] - neuron['output'])
                neuron['error']=expected[j] - neuron['output']
        for j in range(len(layer)):
            neuron = layer[j]
            neuron['delta'] = errors[j] * transfer_derivative(neuron['output'])
##            neuron['delta'] = errors[j] / transfer_derivative(neuron['output'])</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c6dd43141299513-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c6dd43141299513-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c6dd43141299513-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c6dd43141299513-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c6dd43141299513-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c6dd43141299513-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c6dd43141299513-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c6dd43141299513-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c6dd43141299513-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c6dd43141299513-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c6dd43141299513-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c6dd43141299513-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c6dd43141299513-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c6dd43141299513-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c6dd43141299513-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c6dd43141299513-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c6dd43141299513-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c6dd43141299513-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c6dd43141299513-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c6dd43141299513-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c6dd43141299513-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c6dd43141299513-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c6dd43141299513-23">23</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c6dd43141299513-1"><span class="crayon-p"># Backpropagate error and store in neurons</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c6dd43141299513-2"><span class="crayon-e">def </span><span class="crayon-e">backward_propagate_error</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">expected</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c6dd43141299513-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">reversed</span><span class="crayon-sy">(</span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c6dd43141299513-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">layer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c6dd43141299513-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">errors</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c6dd43141299513-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c6dd43141299513-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">layer</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c6dd43141299513-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">error</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.0</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c6dd43141299513-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">neuron </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c6dd43141299513-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">error</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'weights'</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'delta'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c6dd43141299513-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c6dd43141299513-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">errors</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">error</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c6dd43141299513-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">layer</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c6dd43141299513-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">layer</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-s">'error'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">errors</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c6dd43141299513-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c6dd43141299513-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">layer</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c6dd43141299513-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">neuron</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">layer</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c6dd43141299513-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">errors</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">expected</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c6dd43141299513-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'error'</span><span class="crayon-sy">]</span><span class="crayon-o">=</span><span class="crayon-v">expected</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c6dd43141299513-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">layer</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c6dd43141299513-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">neuron</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">layer</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c6dd43141299513-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'delta'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">errors</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-e">transfer_derivative</span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c6dd43141299513-23"><span class="crayon-p">##&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;neuron['delta'] = errors[j] / transfer_derivative(neuron['output'])</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p></p>
<p>My understanding is gradient = dError / dWeights. Therefore, dWeights = dError / gradient<br>
i.e. delta = errors[j] / derivative</p>
<p>Did we somehow make changes here, for calculation reasons, to use arctan instead of tan for gradient?</p>
<p>I’d be grateful if you could help.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-485046" data-commentid="485046" data-postid="3349" data-belowelement="comment-485046" data-respondelement="respond" data-replyto="Reply to George Dong" aria-label="Reply to George Dong">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-577359" class="comment even depth-3">

	      	<div id="li-comment-577359" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/98a6abcd6e891415ad98b3ae1b9b1d35.png" srcset="https://secure.gravatar.com/avatar/98a6abcd6e891415ad98b3ae1b9b1d35?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Dhaila</span>
	                <span class="date">November 22, 2020 at 12:36 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-577359" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Dong,</p>
<p>I was looking into the code. And have the same ques as you raised above. That why we are multiplying.  Can I please ask you if you get any understanding of that?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-577359" data-commentid="577359" data-postid="3349" data-belowelement="comment-577359" data-respondelement="respond" data-replyto="Reply to Dhaila" aria-label="Reply to Dhaila">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-517755" class="comment odd alt depth-2 parent">

	      	<div id="li-comment-517755" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/f2c022b65cb5bbb84bb221e3c75c3b46.png" srcset="https://secure.gravatar.com/avatar/f2c022b65cb5bbb84bb221e3c75c3b46?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Maria</span>
	                <span class="date">January 12, 2020 at 5:28 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-517755" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason ,I need code of back propagation artificial neural network for predicting population dynamics of insects pests.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-517755" data-commentid="517755" data-postid="3349" data-belowelement="comment-517755" data-respondelement="respond" data-replyto="Reply to Maria" aria-label="Reply to Maria">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-517804" class="comment byuser comment-author-jasonb bypostauthor even depth-3">

	      	<div id="li-comment-517804" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">January 13, 2020 at 8:19 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-517804" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sounds like a great project. Perhaps start here:<br>
<a href="https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/" rel="nofollow ugc">https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-517804" data-commentid="517804" data-postid="3349" data-belowelement="comment-517804" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-369860" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-369860" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/da4244fdf35bb00ddf81b5953121443a.png" srcset="https://secure.gravatar.com/avatar/da4244fdf35bb00ddf81b5953121443a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">MO</span>
	                <span class="date">November 8, 2016 at 9:26 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-369860" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>where can i see your data set, i want to see how it looked like</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-369860" data-commentid="369860" data-postid="3349" data-belowelement="comment-369860" data-respondelement="respond" data-replyto="Reply to MO" aria-label="Reply to MO">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-369876" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-369876" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">November 8, 2016 at 10:01 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-369876" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi MO.</p>
<p>The small contrived dataset used for testing is listed inline in the post in section 4.2</p>
<p>The dataset used for the full example is on the UCI ML repository, linked in the section titled “Wheat Seeds Dataset”. Here is the direct link:<br>
<a href="https://archive.ics.uci.edu/ml/datasets/seeds" rel="nofollow ugc">http://archive.ics.uci.edu/ml/datasets/seeds</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-369876" data-commentid="369876" data-postid="3349" data-belowelement="comment-369876" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-370232" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-370232" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/aa64e188d54ba89fd88ee384a0591548.png" srcset="https://secure.gravatar.com/avatar/aa64e188d54ba89fd88ee384a0591548?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">prakash</span>
	                <span class="date">November 11, 2016 at 12:40 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-370232" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>in two class classification for 0 the expected value is [1,0] for 1 its is [0,1].<br>
how will be the output vectors for more than two class??</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-370232" data-commentid="370232" data-postid="3349" data-belowelement="comment-370232" data-respondelement="respond" data-replyto="Reply to prakash" aria-label="Reply to prakash">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-370268" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-370268" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">November 11, 2016 at 10:02 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-370268" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi prakash,</p>
<p>For multi-class classification, we can extend the one hot encoding.</p>
<p>Three class values for “red”, “green” “blue” can be represented as an output vector like:<br>
1, 0, 0 for red<br>
0, 1, 0 for green<br>
0, 0, 1 for blue</p>
<p>I hope that helps.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-370268" data-commentid="370268" data-postid="3349" data-belowelement="comment-370268" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-370436" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-370436" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/05d3a6b3db274552359f0329beacfeb6.png" srcset="https://secure.gravatar.com/avatar/05d3a6b3db274552359f0329beacfeb6?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Rakesh</span>
	                <span class="date">November 13, 2016 at 3:41 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-370436" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, Jason.<br>
You’ve mentioned that there are 3 output classes.<br>
How do we check the values which come under the 3 classes / clusters?<br>
Could we print the data which fall under each class?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-370436" data-commentid="370436" data-postid="3349" data-belowelement="comment-370436" data-respondelement="respond" data-replyto="Reply to Rakesh" aria-label="Reply to Rakesh">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-370498" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-370498" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">November 14, 2016 at 7:35 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-370498" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Rakesh,</p>
<p>The data does belong to 3 classes. We can check the skill of our model by comparing the predicted classes to the actual/expected classes and calculate an accuracy measure.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-370498" data-commentid="370498" data-postid="3349" data-belowelement="comment-370498" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-370823" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-370823" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/ed861268a75ff080493e6b72509b409a.png" srcset="https://secure.gravatar.com/avatar/ed861268a75ff080493e6b72509b409a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Alex</span>
	                <span class="date">November 16, 2016 at 12:35 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-370823" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I’m confused why the activation method iterates from 0 to len(inputs) – 1 instead of from 0 to len(weights) – 1. Am I missing something?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-370823" data-commentid="370823" data-postid="3349" data-belowelement="comment-370823" data-respondelement="respond" data-replyto="Reply to Alex" aria-label="Reply to Alex">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-370925" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-370925" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">November 17, 2016 at 9:47 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-370925" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Alex,</p>
<p>The length of weights is the length of the input + 1 (to accommodate the bias term).</p>
<p>We add the bias term first, then we add the weighted inputs. This is why we iterate over input values.</p>
<p>Does that help?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-370925" data-commentid="370925" data-postid="3349" data-belowelement="comment-370925" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-370953" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-370953" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/ed861268a75ff080493e6b72509b409a.png" srcset="https://secure.gravatar.com/avatar/ed861268a75ff080493e6b72509b409a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Alex</span>
	                <span class="date">November 17, 2016 at 12:29 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-370953" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>When I step through the code above for the ‘forward_propagate’ test case, I see the code correctly generate the output for the single hidden node but that output doesn’t get correctly processed when determining the outputs for the output layer. As written above in the activate function ‘for i in range(len(inputs)-1):’, when the calculation gets to the activate function for the output node for class=0, since ‘inputs’ has a single element in it (the output from the single hidden node), ‘len(inputs) – 1’ equals 0 so the for loop never executes. I’m assuming the code is supposed to read ‘for i in range(len(weights) -1):’ Does that make sense?</p>
<p>I’m just trying to make sure I don’t fundamentally misunderstand something and improve this post for other readers. This site has been really, really helpful for me.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-370953" data-commentid="370953" data-postid="3349" data-belowelement="comment-370953" data-respondelement="respond" data-replyto="Reply to Alex" aria-label="Reply to Alex">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-371044" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-371044" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">November 18, 2016 at 8:27 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-371044" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I’m with you now, thanks for helping me catch-up. </p>
<p>Nice spot. I’ll fix up the tutorial.</p>
<p>Update: Fixed. Thanks again mate!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-371044" data-commentid="371044" data-postid="3349" data-belowelement="comment-371044" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-371350" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-371350" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/41fb215d5b7d2713aa491dbb1f07063c.png" srcset="https://secure.gravatar.com/avatar/41fb215d5b7d2713aa491dbb1f07063c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Tomasz Panek</span>
	                <span class="date">November 21, 2016 at 1:23 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-371350" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p># Update network weights with error<br>
def update_weights(network, row, l_rate):<br>
	for i in range(len(network)):<br>
		inputs = row<br>
		if i != 0:<br>
			inputs = [neuron[‘output’] for neuron in network[i – 1]]<br>
		for neuron in network[i]:<br>
			for j in range(len(inputs)-1):<br>
				neuron[‘weights’][j] += l_rate * neuron[‘delta’] * inputs[j]<br>
			neuron[‘weights’][-1] += l_rate * neuron[‘delta’]</p>
<p>In this fragment:<br>
			for j in range(len(inputs)-1):<br>
				neuron[‘weights’][j] += l_rate * neuron[‘delta’] * inputs[j]<br>
			neuron[‘weights’][-1] += l_rate * neuron[‘delta’]</p>
<p>If inputs length = 1, you are not updating weights, it’s correct? You are updating only bias, because in hidden layer is only one neuron.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-371350" data-commentid="371350" data-postid="3349" data-belowelement="comment-371350" data-respondelement="respond" data-replyto="Reply to Tomasz Panek" aria-label="Reply to Tomasz Panek">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-371352" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-371352" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/41fb215d5b7d2713aa491dbb1f07063c.png" srcset="https://secure.gravatar.com/avatar/41fb215d5b7d2713aa491dbb1f07063c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Tomasz</span>
	                <span class="date">November 21, 2016 at 1:34 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-371352" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello. In method update_weight you are doing for j in range(len(inputs) – 1). If inputs lenght = 1, you aren’t updating weights. It’s correct? Hidden layer have one neuron so in output layer weights aren’t updated</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-371352" data-commentid="371352" data-postid="3349" data-belowelement="comment-371352" data-respondelement="respond" data-replyto="Reply to Tomasz" aria-label="Reply to Tomasz">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-371489" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-371489" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">November 22, 2016 at 6:54 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-371489" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Tomasz, </p>
<p>The assumption here is that the input vector always contains at least one input value and an output value, even if the output is set to None.</p>
<p>You may have found a bug though when updating the layers. I’ll investigate and get back to you.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-371489" data-commentid="371489" data-postid="3349" data-belowelement="comment-371489" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-379663" class="comment byuser comment-author-jasonb bypostauthor even depth-3 parent">

	      	<div id="li-comment-379663" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">January 3, 2017 at 10:17 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-379663" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Tomasz, this was indeed a bug.</p>
<p>I have updated the update_weights() function in the above code examples.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-379663" data-commentid="379663" data-postid="3349" data-belowelement="comment-379663" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-451747" class="comment odd alt depth-4 parent">

	      	<div id="li-comment-451747" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/7dbaf4305bc8adde504dcf56e6a05050.png" srcset="https://secure.gravatar.com/avatar/7dbaf4305bc8adde504dcf56e6a05050?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jerry Jones</span>
	                <span class="date">October 16, 2018 at 8:18 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-451747" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I don’t understand how update_weights updates the NN. There is no global variable or return from the function. What am I missing?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-451747" data-commentid="451747" data-postid="3349" data-belowelement="comment-451747" data-respondelement="respond" data-replyto="Reply to Jerry Jones" aria-label="Reply to Jerry Jones">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-451765" class="comment byuser comment-author-jasonb bypostauthor even depth-5">

	      	<div id="li-comment-451765" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">October 16, 2018 at 2:33 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-451765" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The weights are passed in by reference and modified in place.</p>
<p>This is an advanced tutorial, I’d recommend using Keras for beginners.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-374990" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-374990" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/eed34e11c4d514f087562dae06a92d93.jpeg" srcset="https://secure.gravatar.com/avatar/eed34e11c4d514f087562dae06a92d93?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Michael</span>
	                <span class="date">December 13, 2016 at 4:15 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-374990" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, Thanks for the tutorial, I’m doing a backpropagation project at the moment so its been really useful. </p>
<p>I was a little confused on the back-propagation error calculation function. Does “if i != len(network)-1:” mean that if the current layer isn’t the output layer then this following code is run or does it mean that the current layer is an output layer?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-374990" data-commentid="374990" data-postid="3349" data-belowelement="comment-374990" data-respondelement="respond" data-replyto="Reply to Michael" aria-label="Reply to Michael">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-375013" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-375013" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">December 13, 2016 at 8:08 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-375013" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Glad to hear it Michael.</p>
<p>The line means if the index i is not equal to the index of the last layer of the network (the output layer), then run code inside the block.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-375013" data-commentid="375013" data-postid="3349" data-belowelement="comment-375013" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-380227" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-380227" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/eed34e11c4d514f087562dae06a92d93.jpeg" srcset="https://secure.gravatar.com/avatar/eed34e11c4d514f087562dae06a92d93?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Michael</span>
	                <span class="date">January 5, 2017 at 7:53 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-380227" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have another question.<br>
Would it be possible to extend the code from this tutorial and create a network that trains using the MNIST handwritten digit set? using a input unit to represent each pixel in the image. I’m also not sure whether/how I could use feature extractors for the images.</p>
<p>I have a project where I have to implement the Backpropagation algorithm with possibly the MNIST handwritten digit training set. </p>
<p>I hope my question makes sense!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-380227" data-commentid="380227" data-postid="3349" data-belowelement="comment-380227" data-respondelement="respond" data-replyto="Reply to Michael" aria-label="Reply to Michael">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-380268" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-380268" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">January 5, 2017 at 9:42 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-380268" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sure Michael, but I would recommend using a library like Keras instead as this code is not written for performance.</p>
<p>Load an image as a long list of pixel integer values, convert to floats and away you go. No feature extraction needed for a simple MLP implementation. You should get performance above 90%.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-380268" data-commentid="380268" data-postid="3349" data-belowelement="comment-380268" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-380650" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-380650" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/1d674e92bd259cc3ea6cc30daeed0b2d.jpeg" srcset="https://secure.gravatar.com/avatar/1d674e92bd259cc3ea6cc30daeed0b2d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Calin</span>
	                <span class="date">January 6, 2017 at 10:40 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-380650" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Great post!</p>
<p>I have a concern though:</p>
<p>In train_network method there are these two lines of code:</p>
<p>expected = [0 for i in range(n_outputs)]<br>
expected[row[-1]] = 1</p>
<p>Couldn’t be the case that expected[row[-1]] = 1 will throw IndexError, as n_outputs is the size of the training set which is a subset of the dataset and row basically contains values from the whole dataset?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-380650" data-commentid="380650" data-postid="3349" data-belowelement="comment-380650" data-respondelement="respond" data-replyto="Reply to Calin" aria-label="Reply to Calin">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-380745" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-380745" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">January 7, 2017 at 8:37 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-380745" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Calin,</p>
<p>If I understand you correctly, No. The n_outputs var is the length of the number of possible output values.</p>
<p>Maybe put some print() statements in to help you better understand what values variables have.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-380745" data-commentid="380745" data-postid="3349" data-belowelement="comment-380745" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-380871" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-380871" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/1d674e92bd259cc3ea6cc30daeed0b2d.jpeg" srcset="https://secure.gravatar.com/avatar/1d674e92bd259cc3ea6cc30daeed0b2d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Calin</span>
	                <span class="date">January 7, 2017 at 9:48 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-380871" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hmm..I ran the entire code (with the csv file downloaded from <a href="https://archive.ics.uci.edu/ml/datasets/seeds" rel="nofollow ugc">http://archive.ics.uci.edu/ml/datasets/seeds</a>), added some breakpoints and this is what I got after a few iterations:</p>
<p>n_outputs  = 168<br>
row[-1] = 201</p>
<p>which is causing IndexError: list assignment index out of range.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-380871" data-commentid="380871" data-postid="3349" data-belowelement="comment-380871" data-respondelement="respond" data-replyto="Reply to Calin" aria-label="Reply to Calin">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-381390" class="comment even depth-4 parent">

	      	<div id="li-comment-381390" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/d10ca8d11301c2f4993ac2279ce4b930.png" srcset="https://secure.gravatar.com/avatar/d10ca8d11301c2f4993ac2279ce4b930?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Adriaan</span>
	                <span class="date">January 11, 2017 at 4:27 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-381390" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I’ve got the same error, That my list assignment index is out of range</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-381390" data-commentid="381390" data-postid="3349" data-belowelement="comment-381390" data-respondelement="respond" data-replyto="Reply to Adriaan" aria-label="Reply to Adriaan">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-381425" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-381425" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">January 11, 2017 at 9:29 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-381425" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry to hear that, did you try running the updated code?</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-382373" class="comment even depth-5">

	      	<div id="li-comment-382373" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/c75c4ffacd0596bbc93dfd651e247031.png" srcset="https://secure.gravatar.com/avatar/c75c4ffacd0596bbc93dfd651e247031?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ivan</span>
	                <span class="date">January 16, 2017 at 10:28 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-382373" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This is error of csv read. Try to reformat it with commas. For me it worked</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-382386" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-382386" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">January 16, 2017 at 10:45 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-382386" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>What was the problem and fix exactly Ivan?</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-386073" class="comment even depth-5">

	      	<div id="li-comment-386073" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/c5f1007e2bd7d86e697779ce73d978fd.png" srcset="https://secure.gravatar.com/avatar/c5f1007e2bd7d86e697779ce73d978fd?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Bob</span>
	                <span class="date">February 5, 2017 at 10:59 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-386073" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The data file (<a href="https://archive.ics.uci.edu/ml/machine-learning-databases/00236/seeds_dataset.txt" rel="nofollow ugc">http://archive.ics.uci.edu/ml/machine-learning-databases/00236/seeds_dataset.txt</a>) has a few lines with double tabs (\t\t) as the delimiter — removing the double tabs and changing tabs to commas fixed it.</p>
<p>Thanks for the good article.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-386187" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-386187" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">February 6, 2017 at 9:42 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-386187" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for the note Bob.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-452204" class="comment even depth-5">

	      	<div id="li-comment-452204" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/63b157dcb852e58e4acd7c93a8bf8d2d.jpeg" srcset="https://secure.gravatar.com/avatar/63b157dcb852e58e4acd7c93a8bf8d2d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://www.hit.ac.ze/" rel="external nofollow ugc" class="url">Rowen Bruce</a></span>
	                <span class="date">October 20, 2018 at 8:52 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-452204" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>updated code</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-381397" class="comment odd alt depth-2">

	      	<div id="li-comment-381397" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/d10ca8d11301c2f4993ac2279ce4b930.png" srcset="https://secure.gravatar.com/avatar/d10ca8d11301c2f4993ac2279ce4b930?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Adriaan</span>
	                <span class="date">January 11, 2017 at 5:50 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-381397" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I’ve had the same error at the ‘train_network’ function. Is your dataset fine? I’ve had some problems because the CSV file wasn’t loaded correctly due to my regional windows settings. I’ve had to adjust my settings and everything worked out alright. </p>
<p><a href="https://superuser.com/questions/783060/excel-save-as-csv-options-possible-to-change-comma-to-pipe-or-tab-instead" rel="nofollow ugc">http://superuser.com/questions/783060/excel-save-as-csv-options-possible-to-change-comma-to-pipe-or-tab-instead</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-381397" data-commentid="381397" data-postid="3349" data-belowelement="comment-381397" data-respondelement="respond" data-replyto="Reply to Adriaan" aria-label="Reply to Adriaan">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-381009" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-381009" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/fa1374086d343aae43a869f23438e00d.png" srcset="https://secure.gravatar.com/avatar/fa1374086d343aae43a869f23438e00d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Stanley</span>
	                <span class="date">January 8, 2017 at 3:15 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-381009" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for such a good article. </p>
<p>Just one question: in the equation “weight = weight + learning_rate * error * input”, why there is an “input”? IMO it should be: “weight = weight + learning_rate * error”?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-381009" data-commentid="381009" data-postid="3349" data-belowelement="comment-381009" data-respondelement="respond" data-replyto="Reply to Stanley" aria-label="Reply to Stanley">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-381130" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-381130" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">January 9, 2017 at 7:47 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-381130" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The var names and explanation are correct.</p>
<p>The update equation is:</p>
<p></p>
		<div id="urvanov-syntax-highlighter-6060ca9c701d0776673130" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18.9915px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">weight = weight + learning_rate * error * input</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c701d0776673130-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c701d0776673130-1"><span class="crayon-v">weight</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">weight</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e ">learning_rate *</span><span class="crayon-h"> </span><span class="crayon-e ">error *</span><span class="crayon-h"> </span><span class="crayon-v">input</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p></p>
<p>For the input layer the input are the input data, for hidden layers the input is the output of the prior layer.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-381130" data-commentid="381130" data-postid="3349" data-belowelement="comment-381130" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-381762" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-381762" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/b6aa4516178a87bb39c050f8b940057c.png" srcset="https://secure.gravatar.com/avatar/b6aa4516178a87bb39c050f8b940057c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Madwadasa</span>
	                <span class="date">January 13, 2017 at 3:31 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-381762" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Jason,</p>
<p>           Thanks for the code and post.<br>
Why is “expected”  in expected = [0 for i in range(n_outputs)]  initialized to  [0,0] ?<br>
Should not the o/p values be taken as expected when training the model ?<br>
i.e for example in case of Xor should not 1 be taken as the expected ?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-381762" data-commentid="381762" data-postid="3349" data-belowelement="comment-381762" data-respondelement="respond" data-replyto="Reply to Madwadasa" aria-label="Reply to Madwadasa">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-381810" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-381810" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">January 13, 2017 at 9:16 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-381810" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Madwadasa,</p>
<p>Expected is a one-hot encoding. All classes are “0” expect the actual class for the row which is marked as a “1” on the next line.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-381810" data-commentid="381810" data-postid="3349" data-belowelement="comment-381810" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-382858" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-382858" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/eed34e11c4d514f087562dae06a92d93.jpeg" srcset="https://secure.gravatar.com/avatar/eed34e11c4d514f087562dae06a92d93?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Michael</span>
	                <span class="date">January 19, 2017 at 3:44 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-382858" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello, I have a couple more questions. When training the network with a dataset, does the error at each epoch indicate the distance between the predicted outcomes and the expected outcomes together for the whole dataset? Also when the mean accuracy is given in my case being 13% when I used the MNIST digit set, does this mean that the network will be correct 13% of the time and would have an error rate of 87%?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-382858" data-commentid="382858" data-postid="3349" data-belowelement="comment-382858" data-respondelement="respond" data-replyto="Reply to Michael" aria-label="Reply to Michael">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-382900" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-382900" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">January 19, 2017 at 7:38 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-382900" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Michael,</p>
<p>The epoch error does capture how wrong the algorithm is on all training data. This may or may not be a distance depending on the error measure used. RMSE is technically not a distance measure, you could use Euclidean distance if you like, but I would not recommend it.</p>
<p>Yes, in generally when the model makes predictions your understanding is correct.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-382900" data-commentid="382900" data-postid="3349" data-belowelement="comment-382900" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-383717" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-383717" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/9840a8441afca615aaa5f7234692111b.jpeg" srcset="https://secure.gravatar.com/avatar/9840a8441afca615aaa5f7234692111b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Bernardo Galvão</span>
	                <span class="date">January 24, 2017 at 3:51 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-383717" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>in the excerpt regarding error of a neuron in a hidden layer:</p>
<p>“Where error_j is the error signal from the jth neuron in the output layer, weight_k is the weight that connects the kth neuron to the current neuron and output is the output for the current neuron.”</p>
<p>is the k-th neuron a neuron in the output layer or a neuron in the hidden layer we’re “on”? What about the current neuron, are you referring to the neuron in the output layer? Sorry, english is not my native tongue.</p>
<p>Appreciate your work!</p>
<p>Bernardo</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-383717" data-commentid="383717" data-postid="3349" data-belowelement="comment-383717" data-respondelement="respond" data-replyto="Reply to Bernardo Galvão" aria-label="Reply to Bernardo Galvão">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-385291" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-385291" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/403b88a973dc51dc9ef64bbae6c0e28e.png" srcset="https://secure.gravatar.com/avatar/403b88a973dc51dc9ef64bbae6c0e28e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">anonymous</span>
	                <span class="date">February 1, 2017 at 1:42 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-385291" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It would have been better if recall and precision were printed. Can somebody tell me how to print them in the above code.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-385291" data-commentid="385291" data-postid="3349" data-belowelement="comment-385291" data-respondelement="respond" data-replyto="Reply to anonymous" aria-label="Reply to anonymous">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-385423" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-385423" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">February 1, 2017 at 10:51 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-385423" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can learn more about precision and recall here:<br>
<a href="https://en.wikipedia.org/wiki/Precision_and_recall" rel="nofollow ugc">https://en.wikipedia.org/wiki/Precision_and_recall</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-385423" data-commentid="385423" data-postid="3349" data-belowelement="comment-385423" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-386259" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-386259" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/7592c1dd8cb9f45f6b1d89412534feb5.png" srcset="https://secure.gravatar.com/avatar/7592c1dd8cb9f45f6b1d89412534feb5?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">kehinde kolade</span>
	                <span class="date">February 6, 2017 at 8:29 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-386259" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason, great tutorial, I am developer and I do not really know much about this machine learning thing but I need to extend this your code to incorporate the Momentum aspect to the training, can you please explain how I can achieve this extension?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-386259" data-commentid="386259" data-postid="3349" data-belowelement="comment-386259" data-respondelement="respond" data-replyto="Reply to kehinde kolade" aria-label="Reply to kehinde kolade">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-386365" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-386365" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">February 7, 2017 at 10:14 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-386365" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I don’t have the capacity to write or spell out this change for you.</p>
<p>My advice would be to read a good book on the topic, such as Neural Smithing: <a href="https://amzn.to/2ld9ds0" rel="nofollow ugc">http://amzn.to/2ld9ds0</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-386365" data-commentid="386365" data-postid="3349" data-belowelement="comment-386365" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-388719" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-388719" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/8aa40a517f98cb5534e0e6dc6f83cc0b.png" srcset="https://secure.gravatar.com/avatar/8aa40a517f98cb5534e0e6dc6f83cc0b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">ibrahim</span>
	                <span class="date">February 18, 2017 at 2:21 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-388719" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
I have my own code written in C++, which works similar to your code. My intention is to extend my code to convolutional deep neural nets, and i have actually written the convolution, Relu and pooling functions however i could not begin to apply the backpropagation i have used in my shallow neural net, to the convolutional deep net, cause i really cant imagine the transition of the backpropagation calculation between the convolutional layers and the standard shallow layers existing in the same system. I hoped to find a source for this issue however i always come to the point that there is a standard backpropagation algorithm given for shallow nets that i applied already. Can you please guide me on this problem?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-388719" data-commentid="388719" data-postid="3349" data-belowelement="comment-388719" data-respondelement="respond" data-replyto="Reply to ibrahim" aria-label="Reply to ibrahim">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-388796" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-388796" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">February 18, 2017 at 8:42 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-388796" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I”d love to guide you but I don’t have my own from scratch implementation of CNNs, sorry. I’m not best placed to help at the moment.</p>
<p>I’d recommend reading code from existing open source implementations.</p>
<p>Good luck with your project.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-388796" data-commentid="388796" data-postid="3349" data-belowelement="comment-388796" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-389517" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-389517" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/e12ea245a7de8e243d4972c06c1df332.png" srcset="https://secure.gravatar.com/avatar/e12ea245a7de8e243d4972c06c1df332?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://cingkleung.com/" rel="external nofollow ugc" class="url">matias</a></span>
	                <span class="date">February 22, 2017 at 3:34 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-389517" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you, I was looking for exactly this kind of ann algorith. A simple thank won’t be enough tho lol</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-389517" data-commentid="389517" data-postid="3349" data-belowelement="comment-389517" data-respondelement="respond" data-replyto="Reply to matias" aria-label="Reply to matias">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-389639" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-389639" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">February 23, 2017 at 8:52 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-389639" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I’m glad it helped.</p>
<p>The best way to help is to share the post with other people, or maybe purchase one of my books to support my ongoing work:<br>
<a href="https://machinelearningmastery.com/products" rel="nofollow ugc">http://machinelearningmastery.com/products</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-389639" data-commentid="389639" data-postid="3349" data-belowelement="comment-389639" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-390209" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-390209" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/e773dcb70a26a8cfad75d659427f30c5.png" srcset="https://secure.gravatar.com/avatar/e773dcb70a26a8cfad75d659427f30c5?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Manohar Katam</span>
	                <span class="date">February 26, 2017 at 3:40 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-390209" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great one! .. I have one doubt .. the dataset seeds contains missing features/fields for some rows.. how you are handling that …</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-390209" data-commentid="390209" data-postid="3349" data-belowelement="comment-390209" data-respondelement="respond" data-replyto="Reply to Manohar Katam" aria-label="Reply to Manohar Katam">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-390313" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-390313" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">February 27, 2017 at 5:49 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-390313" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You could set the missing values to 0, you could remove the rows with missing values, you could impute the missing values with mean column values, etc.</p>
<p>Try a few different methods and see what results in the best performing models.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-390313" data-commentid="390313" data-postid="3349" data-belowelement="comment-390313" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-390756" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-390756" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/e773dcb70a26a8cfad75d659427f30c5.png" srcset="https://secure.gravatar.com/avatar/e773dcb70a26a8cfad75d659427f30c5?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Manohar Katam</span>
	                <span class="date">March 1, 2017 at 2:59 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-390756" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>What if I have canonical forms like “male” or “female” in my dataset… Will this program work even with string data..</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-390756" data-commentid="390756" data-postid="3349" data-belowelement="comment-390756" data-respondelement="respond" data-replyto="Reply to Manohar Katam" aria-label="Reply to Manohar Katam">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-390866" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-390866" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 2, 2017 at 8:11 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-390866" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Manohar,</p>
<p>No, you will need to convert them to integers (integer encoding) or similar.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-390866" data-commentid="390866" data-postid="3349" data-belowelement="comment-390866" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-390434" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-390434" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/fa831d998404b4907410de6085d69ba2.png" srcset="https://secure.gravatar.com/avatar/fa831d998404b4907410de6085d69ba2?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Wissal ARGOUBI</span>
	                <span class="date">February 27, 2017 at 11:12 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-390434" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great job! this is what i was looking for ! thank you very much .<br>
However i already have a data base and i didn’t know how to make it work with this code how can i adapt it on my data<br>
Thank you</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-390434" data-commentid="390434" data-postid="3349" data-belowelement="comment-390434" data-respondelement="respond" data-replyto="Reply to Wissal ARGOUBI" aria-label="Reply to Wissal ARGOUBI">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-390485" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-390485" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">February 28, 2017 at 8:10 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-390485" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This process will help you work through your predictive modeling problem:<br>
<a href="https://machinelearningmastery.com/start-here/#process" rel="nofollow ugc">http://machinelearningmastery.com/start-here/#process</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-390485" data-commentid="390485" data-postid="3349" data-belowelement="comment-390485" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-391271" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-391271" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/bbdf9cfbf33951aaf35751f379d1fd84.png" srcset="https://secure.gravatar.com/avatar/bbdf9cfbf33951aaf35751f379d1fd84?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Shweta Gupta</span>
	                <span class="date">March 5, 2017 at 4:37 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-391271" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for such a great article..<br>
I have one question, in update_weights why you have used weight=weight+l_rate*delta*input rather than weight=weight+l_rate*delta?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-391271" data-commentid="391271" data-postid="3349" data-belowelement="comment-391271" data-respondelement="respond" data-replyto="Reply to Shweta Gupta" aria-label="Reply to Shweta Gupta">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-391461" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-391461" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 6, 2017 at 10:55 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-391461" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can learn more about the math in the book on the topic. </p>
<p>I recommend Neural Smithing: <a href="https://amzn.to/2ld9ds0" rel="nofollow ugc">http://amzn.to/2ld9ds0</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-391461" data-commentid="391461" data-postid="3349" data-belowelement="comment-391461" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-392458" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-392458" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a025e68c7374439da69e52541bef6625.png" srcset="https://secure.gravatar.com/avatar/a025e68c7374439da69e52541bef6625?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sittha</span>
	                <span class="date">March 13, 2017 at 1:23 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-392458" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for a good tutorial.<br>
I have some  IndexError: list assignment index out of range. And I cannot fix it with comma or full-stop separator.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-392458" data-commentid="392458" data-postid="3349" data-belowelement="comment-392458" data-respondelement="respond" data-replyto="Reply to Sittha" aria-label="Reply to Sittha">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-392571" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-392571" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 14, 2017 at 8:11 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-392571" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>What is the full error you are getting?</p>
<p>Did you copy-paste the full final example and run it on the same dataset?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-392571" data-commentid="392571" data-postid="3349" data-belowelement="comment-392571" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-393944" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-393944" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/6c2a8dcd39c95bf5660785a37f988adc.png" srcset="https://secure.gravatar.com/avatar/6c2a8dcd39c95bf5660785a37f988adc?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sittha</span>
	                <span class="date">March 24, 2017 at 3:36 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-393944" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>line 151 :<br>
expected[row[-1]] = 1<br>
IndexError : list assignment  index out of range</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-393944" data-commentid="393944" data-postid="3349" data-belowelement="comment-393944" data-respondelement="respond" data-replyto="Reply to Sittha" aria-label="Reply to Sittha">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-393980" class="comment byuser comment-author-jasonb bypostauthor even depth-4 parent">

	      	<div id="li-comment-393980" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 24, 2017 at 8:00 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-393980" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Is this with a different dataset?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-393980" data-commentid="393980" data-postid="3349" data-belowelement="comment-393980" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-399327" class="comment odd alt depth-5">

	      	<div id="li-comment-399327" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/92af1d38e899cd89b71d01c566b67cd0.png" srcset="https://secure.gravatar.com/avatar/92af1d38e899cd89b71d01c566b67cd0?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Benji Weiss</span>
	                <span class="date">May 11, 2017 at 5:31 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-399327" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>if it is a different dataset, what do i need to do to not get this error</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-392903" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-392903" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/4e5b3376ce0c57b1bc53d9888bf86024.png" srcset="https://secure.gravatar.com/avatar/4e5b3376ce0c57b1bc53d9888bf86024?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Karan</span>
	                <span class="date">March 16, 2017 at 6:26 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-392903" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The dataset that was given was for training the network. Now how do we test the network by providing the 7 features without giving the class label(1,2 or 3) ?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-392903" data-commentid="392903" data-postid="3349" data-belowelement="comment-392903" data-respondelement="respond" data-replyto="Reply to Karan" aria-label="Reply to Karan">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-392984" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-392984" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 17, 2017 at 8:27 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-392984" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You will have to adapt the example to fit the model on all of the training data, then you can call predict() to make predictions on new data.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-392984" data-commentid="392984" data-postid="3349" data-belowelement="comment-392984" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-393320" class="comment even depth-3">

	      	<div id="li-comment-393320" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/4e5b3376ce0c57b1bc53d9888bf86024.png" srcset="https://secure.gravatar.com/avatar/4e5b3376ce0c57b1bc53d9888bf86024?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Karan</span>
	                <span class="date">March 19, 2017 at 7:43 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-393320" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Ok Jason, i’ll try that and get back to you! Thank you!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-393320" data-commentid="393320" data-postid="3349" data-belowelement="comment-393320" data-respondelement="respond" data-replyto="Reply to Karan" aria-label="Reply to Karan">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-393321" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-393321" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/4e5b3376ce0c57b1bc53d9888bf86024.png" srcset="https://secure.gravatar.com/avatar/4e5b3376ce0c57b1bc53d9888bf86024?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Karan</span>
	                <span class="date">March 19, 2017 at 7:48 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-393321" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Just a suggestion for the people who would be using their own dataset(not the seeds_dataset) for training their network, make sure you add an IF loop as follows before the 45th line :<br>
if minmax[i][1]!=minmax[i][0]</p>
<p>This is because your own dataset might contain same values in the same column and that might cause a divide by zero error.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-393321" data-commentid="393321" data-postid="3349" data-belowelement="comment-393321" data-respondelement="respond" data-replyto="Reply to Karan" aria-label="Reply to Karan">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-393371" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-393371" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 20, 2017 at 8:16 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-393371" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for the tip Karan.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-393371" data-commentid="393371" data-postid="3349" data-belowelement="comment-393371" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-394130" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-394130" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/c667ecfa99fb8309df749867ae729ffc.jpeg" srcset="https://secure.gravatar.com/avatar/c667ecfa99fb8309df749867ae729ffc?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://liquntang.wordpress.com/" rel="external nofollow ugc" class="url">Li Qun</a></span>
	                <span class="date">March 25, 2017 at 5:45 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-394130" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks jason for the amazing posts of your from scratch pyhton implementations! i have learned so much from you!</p>
<p>I have followed through both your naive bayes and backprop posts, and I have a (perhaps quite naive) question: </p>
<p>what is the relationship between the two? did backprop actually implement bayesian inference (after all, what i understand is that bayesian = weights being updated every cycle) already? perhaps just non-gaussian? so.. are non-gaussian PDF weight updates not bayesian inference?</p>
<p>i guess to put it simply : is backpropagation essentially a bayesian inference loop for an n number of epochs?</p>
<p>I came from the naive bayes tutorial wanting to implement backpropagation together with your naive bayes implementation but got a bit lost along the way.</p>
<p>sorry if i was going around in circles, i sincerely hope someone would be able to at least point me on the right direction.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-394130" data-commentid="394130" data-postid="3349" data-belowelement="comment-394130" data-respondelement="respond" data-replyto="Reply to Li Qun" aria-label="Reply to Li Qun">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-394185" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-394185" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 26, 2017 at 6:11 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-394185" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great question.</p>
<p>No, they are both very different. Naive bayes is a direct use of the probabilities and bayes theorem. The neural net is approximating a mapping function from inputs and outputs – a very different approach that does not directly use the joint probability.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-394185" data-commentid="394185" data-postid="3349" data-belowelement="comment-394185" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-394245" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-394245" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/80c8454bf99969c638d56da27d2e546c.png" srcset="https://secure.gravatar.com/avatar/80c8454bf99969c638d56da27d2e546c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Chiraag</span>
	                <span class="date">March 26, 2017 at 10:10 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-394245" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>How did you decide that the number of folds will be 5 ? Could you please explain the significance of this number. Thank You.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-394245" data-commentid="394245" data-postid="3349" data-belowelement="comment-394245" data-respondelement="respond" data-replyto="Reply to Chiraag" aria-label="Reply to Chiraag">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-394290" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-394290" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 27, 2017 at 7:54 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-394290" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>In this case, it was pretty arbitary.</p>
<p>Generally, you want to split the data so that each fold is representative of the dataset. The objective measure is how closely the mean performance reflect the actual performance of the model on unseen data. We can only estimate this in practice (standard error?).</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-394290" data-commentid="394290" data-postid="3349" data-belowelement="comment-394290" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-394355" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-394355" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/c667ecfa99fb8309df749867ae729ffc.jpeg" srcset="https://secure.gravatar.com/avatar/c667ecfa99fb8309df749867ae729ffc?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://liquntang.wordpress.com/" rel="external nofollow ugc" class="url">Li Qun</a></span>
	                <span class="date">March 27, 2017 at 10:19 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-394355" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dear Jason,</p>
<p>thank you for the reply! I read up a bit more about the differences between Naive Bayes (or Bayesian Nets in general) and Neural Networks and found this Quora answer that i thought was very clear. I’ll put it up here to give other readers a good point to go from: </p>
<p><a href="https://www.quora.com/What-is-the-difference-between-a-Bayesian-network-and-an-artificial-neural-network" rel="nofollow ugc">https://www.quora.com/What-is-the-difference-between-a-Bayesian-network-and-an-artificial-neural-network</a></p>
<p>TL:DR :<br>
– they look the same, but every node in a Bayesian Network has meaning, in that you can read a Bayesian network structure (like a mind map) and see what’s happening where and why.<br>
– a Neural Network structure doesn’t have explicit meaning, its just dots that link previous dots.<br>
– there are more reasons, but the above two highlighted the biggest difference.</p>
<p>Just a quick guess after playing around with backpropagation a little: the way NB and backprop NN would work together is by running Naive Bayes to get a good ‘first guess’ of initial weights that are then run through and Neural Network and Backpropagated?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-394355" data-commentid="394355" data-postid="3349" data-belowelement="comment-394355" data-respondelement="respond" data-replyto="Reply to Li Qun" aria-label="Reply to Li Qun">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-394407" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-394407" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 28, 2017 at 8:23 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-394407" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Please note that a Bayesian network and naive bayes are very different algorithms.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-394407" data-commentid="394407" data-postid="3349" data-belowelement="comment-394407" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-394359" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-394359" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/b4b45a1d938fb70c1fc592ac66f9c849.png" srcset="https://secure.gravatar.com/avatar/b4b45a1d938fb70c1fc592ac66f9c849?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Melissa</span>
	                <span class="date">March 27, 2017 at 10:54 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-394359" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
Further to this update:</p>
<p> Update Jan/2017: Changed the calculation of fold_size in cross_validation_split() to always be an integer. Fixes issues with Python 3.</p>
<p>I’m still having this same problem whilst using python 3, on both the seeds data set and my own. It returns an error at line 75 saying ‘list object has no attribute ‘sum” and also saying than ‘an integer is required.’</p>
<p>Any help would be very much appreciated.<br>
Overall this code is very helpful. Thank you!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-394359" data-commentid="394359" data-postid="3349" data-belowelement="comment-394359" data-respondelement="respond" data-replyto="Reply to Melissa" aria-label="Reply to Melissa">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-394408" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-394408" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 28, 2017 at 8:24 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-394408" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry to hear that, did you try copy-paste the complete working example from the end of the post and run it on the same dataset from the command line?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-394408" data-commentid="394408" data-postid="3349" data-belowelement="comment-394408" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-394418" class="comment odd alt depth-3">

	      	<div id="li-comment-394418" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/b4b45a1d938fb70c1fc592ac66f9c849.png" srcset="https://secure.gravatar.com/avatar/b4b45a1d938fb70c1fc592ac66f9c849?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Melissa</span>
	                <span class="date">March 28, 2017 at 9:29 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-394418" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes I’ve done that, but still the same problem!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-394418" data-commentid="394418" data-postid="3349" data-belowelement="comment-394418" data-respondelement="respond" data-replyto="Reply to Melissa" aria-label="Reply to Melissa">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-394538" class="comment even thread-even depth-1">

	      	<div id="li-comment-394538" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/38ac56634f0c251e5dbf113ab668fb35.png" srcset="https://secure.gravatar.com/avatar/38ac56634f0c251e5dbf113ab668fb35?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">david</span>
	                <span class="date">March 29, 2017 at 6:16 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-394538" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello jason,</p>
<p>please i need help on how to pass the output of the trained network into a fuzzy logic system if possible a code or link which can help understand better. Thank you</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-394538" data-commentid="394538" data-postid="3349" data-belowelement="comment-394538" data-respondelement="respond" data-replyto="Reply to david" aria-label="Reply to david">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-395134" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-395134" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/27234cc290919180762b7218c7be4893.png" srcset="https://secure.gravatar.com/avatar/27234cc290919180762b7218c7be4893?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Aditya</span>
	                <span class="date">April 2, 2017 at 3:57 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-395134" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Awesome Explanation</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-395134" data-commentid="395134" data-postid="3349" data-belowelement="comment-395134" data-respondelement="respond" data-replyto="Reply to Aditya" aria-label="Reply to Aditya">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-395321" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-395321" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 4, 2017 at 9:05 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-395321" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-395321" data-commentid="395321" data-postid="3349" data-belowelement="comment-395321" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-395516" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-395516" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/6e2a3c6d3d507b984c6c32865cfa727f.png" srcset="https://secure.gravatar.com/avatar/6e2a3c6d3d507b984c6c32865cfa727f?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Raunak Jain</span>
	                <span class="date">April 6, 2017 at 5:20 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-395516" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason<br>
I m getting list assignment index out or range error. How to handle this error?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-395516" data-commentid="395516" data-postid="3349" data-belowelement="comment-395516" data-respondelement="respond" data-replyto="Reply to Raunak Jain" aria-label="Reply to Raunak Jain">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-395789" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-395789" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 9, 2017 at 2:37 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-395789" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The example was developed for Python 2, perhaps this is Python version issue?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-395789" data-commentid="395789" data-postid="3349" data-belowelement="comment-395789" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-395538" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-395538" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/51ffefd98dda8a19c7c8196cb75be6fb.png" srcset="https://secure.gravatar.com/avatar/51ffefd98dda8a19c7c8196cb75be6fb?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Marco</span>
	                <span class="date">April 6, 2017 at 9:37 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-395538" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks but I think python is not a good choice…</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-395538" data-commentid="395538" data-postid="3349" data-belowelement="comment-395538" data-respondelement="respond" data-replyto="Reply to Marco" aria-label="Reply to Marco">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-395796" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-395796" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 9, 2017 at 2:40 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-395796" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I think it is a good choice for learning how backprop works.</p>
<p>What would be a better choice?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-395796" data-commentid="395796" data-postid="3349" data-belowelement="comment-395796" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-395539" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-395539" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/110197b76f8099b9dff15e9c0a0db52a.png" srcset="https://secure.gravatar.com/avatar/110197b76f8099b9dff15e9c0a0db52a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Agrawal</span>
	                <span class="date">April 6, 2017 at 9:38 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-395539" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hey, Jason Thanks for this wonderful lecture on Neural Network.</p>
<p>As I am working on Iris Recognition, I have extracted the features of each eye and store it in .csv file, Can u suggest how further can I build my Backpropagation code.<br>
As when I run your code I am getting many errors.<br>
Thank you</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-395539" data-commentid="395539" data-postid="3349" data-belowelement="comment-395539" data-respondelement="respond" data-replyto="Reply to Agrawal" aria-label="Reply to Agrawal">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-395797" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-395797" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 9, 2017 at 2:40 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-395797" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This process will help you work through your modeling problem:<br>
<a href="https://machinelearningmastery.com/start-here/#process" rel="nofollow ugc">http://machinelearningmastery.com/start-here/#process</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-395797" data-commentid="395797" data-postid="3349" data-belowelement="comment-395797" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-395606" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-395606" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/63bd4d0145d8be1d9218724edb89cbfa.png" srcset="https://secure.gravatar.com/avatar/63bd4d0145d8be1d9218724edb89cbfa?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jack</span>
	                <span class="date">April 7, 2017 at 3:42 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-395606" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Could you please convert this iterative implementation into matrix implementation?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-395606" data-commentid="395606" data-postid="3349" data-belowelement="comment-395606" data-respondelement="respond" data-replyto="Reply to Jack" aria-label="Reply to Jack">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-395815" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-395815" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 9, 2017 at 2:52 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-395815" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps in the future Jack.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-395815" data-commentid="395815" data-postid="3349" data-belowelement="comment-395815" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-396152" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-396152" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/53cfc782eb381c8a336270c9cdafd6f2.png" srcset="https://secure.gravatar.com/avatar/53cfc782eb381c8a336270c9cdafd6f2?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jk</span>
	                <span class="date">April 12, 2017 at 5:04 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-396152" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, </p>
<p>In section 4.1 , may you please explain why you used ###  inputs = row[:-1] ###  ?</p>
<p>Thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-396152" data-commentid="396152" data-postid="3349" data-belowelement="comment-396152" data-respondelement="respond" data-replyto="Reply to Jk" aria-label="Reply to Jk">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-396174" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-396174" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 12, 2017 at 7:58 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-396174" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes. By default we are back-propagating the error of the expected output vs the network output (inputs = row[:-1]), but if we are not the output layer, propagate the error from the previous layer in the network (inputs = [neuron[‘output’] for neuron in network[i – 1]]).</p>
<p>I hope that helps.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-396174" data-commentid="396174" data-postid="3349" data-belowelement="comment-396174" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-396257" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-396257" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/53cfc782eb381c8a336270c9cdafd6f2.png" srcset="https://secure.gravatar.com/avatar/53cfc782eb381c8a336270c9cdafd6f2?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">JK</span>
	                <span class="date">April 13, 2017 at 3:59 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-396257" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for your respond. I understand what you said , the part I am no understanding is the [:-1] . why eliminating the last list item ?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-396257" data-commentid="396257" data-postid="3349" data-belowelement="comment-396257" data-respondelement="respond" data-replyto="Reply to JK" aria-label="Reply to JK">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-396295" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-396295" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 13, 2017 at 10:10 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-396295" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It is a range from 0 to the second last item in the list, e.g. (0 to n-1)</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-396295" data-commentid="396295" data-postid="3349" data-belowelement="comment-396295" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-434281" class="comment odd alt depth-4">

	      	<div id="li-comment-434281" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/97bdacc4e384dbde42c88a223aee9565.jpeg" srcset="https://secure.gravatar.com/avatar/97bdacc4e384dbde42c88a223aee9565?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Amer</span>
	                <span class="date">April 6, 2018 at 7:22 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-434281" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Because the last Item in the weights array is the biass</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-434281" data-commentid="434281" data-postid="3349" data-belowelement="comment-434281" data-respondelement="respond" data-replyto="Reply to Amer" aria-label="Reply to Amer">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-396220" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-396220" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/3d2465e5513171420e78195269e8e2a4.png" srcset="https://secure.gravatar.com/avatar/3d2465e5513171420e78195269e8e2a4?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Prem Puri</span>
	                <span class="date">April 12, 2017 at 8:18 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-396220" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>In function call, def backward_propagate_error(network, expected):<br>
 how much i understand is , it sequentially pass upto<br>
if i != len(network)-1:<br>
			for j in range(len(layer)):<br>
				error = 0.0<br>
				for neuron in network[i + 1]:<br>
					error += (neuron[‘weights’][j] * neuron[‘delta’])<br>
My question is which value is used in neuron[‘delta’]</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-396220" data-commentid="396220" data-postid="3349" data-belowelement="comment-396220" data-respondelement="respond" data-replyto="Reply to Prem Puri" aria-label="Reply to Prem Puri">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-396284" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-396284" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 13, 2017 at 10:01 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-396284" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>delta is set in the previous code block. It is the error signal that is being propagated backward.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-396284" data-commentid="396284" data-postid="3349" data-belowelement="comment-396284" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-433169" class="comment even depth-3">

	      	<div id="li-comment-433169" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/848284904bbf3451793c2ce1889ab2d9.png" srcset="https://secure.gravatar.com/avatar/848284904bbf3451793c2ce1889ab2d9?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Nishu</span>
	                <span class="date">March 25, 2018 at 11:32 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-433169" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I’m sorry, but I still can’t find the location where delta is set and hence, the code gives error.<br>
Where is the delta set for the first time?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-433169" data-commentid="433169" data-postid="3349" data-belowelement="comment-433169" data-respondelement="respond" data-replyto="Reply to Nishu" aria-label="Reply to Nishu">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-396366" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-396366" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/3d2465e5513171420e78195269e8e2a4.png" srcset="https://secure.gravatar.com/avatar/3d2465e5513171420e78195269e8e2a4?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Prem Puri</span>
	                <span class="date">April 14, 2017 at 3:20 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-396366" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks very much!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-396366" data-commentid="396366" data-postid="3349" data-belowelement="comment-396366" data-respondelement="respond" data-replyto="Reply to Prem Puri" aria-label="Reply to Prem Puri">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-396395" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-396395" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 14, 2017 at 8:54 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-396395" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You’re welcome.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-396395" data-commentid="396395" data-postid="3349" data-belowelement="comment-396395" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-397669" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-397669" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/c7d7f80d684360f62cd958e52da04972.png" srcset="https://secure.gravatar.com/avatar/c7d7f80d684360f62cd958e52da04972?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">youssef oumate</span>
	                <span class="date">April 26, 2017 at 4:53 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-397669" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason </p>
<p>Thank you very much for this awesome implementation of neural network,<br>
I have a question for you : I want to replace the activation function from Sigmoid<br>
to RELU . So, what are the changes that I should perform in order to get<br>
correct predictions?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-397669" data-commentid="397669" data-postid="3349" data-belowelement="comment-397669" data-respondelement="respond" data-replyto="Reply to youssef oumate" aria-label="Reply to youssef oumate">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-397730" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-397730" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 27, 2017 at 8:34 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-397730" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I think just a change to the transfer() and transfer_derivative() functions will do the trick.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-397730" data-commentid="397730" data-postid="3349" data-belowelement="comment-397730" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-397752" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-397752" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/c7d7f80d684360f62cd958e52da04972.png" srcset="https://secure.gravatar.com/avatar/c7d7f80d684360f62cd958e52da04972?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">youssef oumate</span>
	                <span class="date">April 27, 2017 at 10:17 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-397752" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Awesome !</p>
<p>Thank you so much</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-397752" data-commentid="397752" data-postid="3349" data-belowelement="comment-397752" data-respondelement="respond" data-replyto="Reply to youssef oumate" aria-label="Reply to youssef oumate">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-397833" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-397833" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 28, 2017 at 7:26 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-397833" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You’re welcome.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-397833" data-commentid="397833" data-postid="3349" data-belowelement="comment-397833" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-529638" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-529638" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/ecb86436e868fc53fa343a2bf8fe9ce7.png" srcset="https://secure.gravatar.com/avatar/ecb86436e868fc53fa343a2bf8fe9ce7?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">audrey</span>
	                <span class="date">April 14, 2020 at 5:40 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-529638" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>how? please</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-529638" data-commentid="529638" data-postid="3349" data-belowelement="comment-529638" data-respondelement="respond" data-replyto="Reply to audrey" aria-label="Reply to audrey">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-529674" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-529674" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 14, 2020 at 6:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-529674" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>If you need help coding relu, see this:<br>
<a href="https://machinelearningmastery.com/rectified-linear-activation-function-for-deep-learning-neural-networks/" rel="nofollow ugc">https://machinelearningmastery.com/rectified-linear-activation-function-for-deep-learning-neural-networks/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-529674" data-commentid="529674" data-postid="3349" data-belowelement="comment-529674" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-398019" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-398019" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/f9e3c410ecbc0f82435e2ea3f632e06a.png" srcset="https://secure.gravatar.com/avatar/f9e3c410ecbc0f82435e2ea3f632e06a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Yahya Alaa</span>
	                <span class="date">April 30, 2017 at 2:38 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-398019" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
Thank you very much for this wonderful implementation of Neural Network, it really helped me a lot to understand neural networks concept,</p>
<p>n_inputs = len(dataset[0]) – 1<br>
n_outputs = len(set([row[-1] for row in dataset]))<br>
network = initialize_network(n_inputs, 2, n_outputs)<br>
train_network(network, dataset, 0.5, 20, n_outputs)</p>
<p>What do n_inputs and n_outputs refer to? According to the small dataset used in this section, is n_inputs only 2 and n_outputs only 2 (0 or 1) or I am missing something?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-398019" data-commentid="398019" data-postid="3349" data-belowelement="comment-398019" data-respondelement="respond" data-replyto="Reply to Yahya Alaa" aria-label="Reply to Yahya Alaa">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-398039" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-398039" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 30, 2017 at 5:31 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-398039" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Input/outputs refers to the number of input and output features (columns) in your data.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-398039" data-commentid="398039" data-postid="3349" data-belowelement="comment-398039" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-398392" class="comment odd alt depth-2 parent">

	      	<div id="li-comment-398392" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/f9e3c410ecbc0f82435e2ea3f632e06a.png" srcset="https://secure.gravatar.com/avatar/f9e3c410ecbc0f82435e2ea3f632e06a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Yahya Alaa</span>
	                <span class="date">May 3, 2017 at 1:42 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-398392" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Is the program training the network for 500 epochs for each one of the k-folds and then testing the network with the testing data set?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-398392" data-commentid="398392" data-postid="3349" data-belowelement="comment-398392" data-respondelement="respond" data-replyto="Reply to Yahya Alaa" aria-label="Reply to Yahya Alaa">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-398484" class="comment byuser comment-author-jasonb bypostauthor even depth-3 parent">

	      	<div id="li-comment-398484" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">May 4, 2017 at 8:02 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-398484" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Yahya,</p>
<p>5-fold cross validation is used.</p>
<p>That means that 5 models are fit and evaluated on 5 different hold out sets. Each model is trained for 500 epochs.</p>
<p>I hope that makes things clearer Yahya.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-398484" data-commentid="398484" data-postid="3349" data-belowelement="comment-398484" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-398496" class="comment odd alt depth-4 parent">

	      	<div id="li-comment-398496" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/f9e3c410ecbc0f82435e2ea3f632e06a.png" srcset="https://secure.gravatar.com/avatar/f9e3c410ecbc0f82435e2ea3f632e06a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Yahya Alaa</span>
	                <span class="date">May 4, 2017 at 8:17 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-398496" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes you made things clear to me, Thank you.<br>
I have two other questions,<br>
How to know when to stop training the network to avoid overfitting?<br>
How to choose the number of neurons in the hidden layer?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-398496" data-commentid="398496" data-postid="3349" data-belowelement="comment-398496" data-respondelement="respond" data-replyto="Reply to Yahya Alaa" aria-label="Reply to Yahya Alaa">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-398571" class="comment byuser comment-author-jasonb bypostauthor even depth-5">

	      	<div id="li-comment-398571" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">May 5, 2017 at 7:27 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-398571" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can use early stopping, to save network weights when the skill on a validation set stops improving.</p>
<p>The number of neurons can be found through trial and error.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-398753" class="comment odd alt depth-5">

	      	<div id="li-comment-398753" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/f9e3c410ecbc0f82435e2ea3f632e06a.png" srcset="https://secure.gravatar.com/avatar/f9e3c410ecbc0f82435e2ea3f632e06a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Yahya Alaa</span>
	                <span class="date">May 6, 2017 at 8:48 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-398753" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I am working on a program that recognizes handwritten digits, the dataset is consisting of pictures (45*45) pixels each, which is 2025 input neurons, this causes me a problem in the activation function, the summation of (weight[i] * input[i]) is big, then it gives me always a result of (0.99 -&gt; 1) after putting the value of the activation function in the Sigmoid function, any suggestions?</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-398864" class="comment byuser comment-author-jasonb bypostauthor even depth-5">

	      	<div id="li-comment-398864" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">May 7, 2017 at 5:31 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-398864" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I would recommend using a Convolutional Neural Network rather than a Multilayer Perceptron.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-398029" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-398029" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/92bd7933f25006410472c346379b36d5.png" srcset="https://secure.gravatar.com/avatar/92bd7933f25006410472c346379b36d5?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">morok</span>
	                <span class="date">April 30, 2017 at 3:56 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-398029" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>In section 3.2. Error Backpropagation, where did output numbers came from for testing backpropagation</p>
<p>‘output’: 0.7105668883115941<br>
‘output’: 0.6213859615555266<br>
‘output’: 0.6573693455986976</p>
<p>Perhaps from outputs on test forward propagation [0.6629970129852887, 0.7253160725279748] taking dd -&gt; derivative = output * (1.0 – output), problem is they don’t match, so I’m a bit lost here…</p>
<p>thanks!</p>
<p>Awesome article!!!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-398029" data-commentid="398029" data-postid="3349" data-belowelement="comment-398029" data-respondelement="respond" data-replyto="Reply to morok" aria-label="Reply to morok">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-398041" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-398041" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 30, 2017 at 5:34 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-398041" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>In that example, the output and weights were contrived to test back propagation of error. Note the “delta” in those outputs.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-398041" data-commentid="398041" data-postid="3349" data-belowelement="comment-398041" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-421124" class="comment odd alt depth-2 parent">

	      	<div id="li-comment-421124" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/e96ad5cc29e1bb6da950048d42fbd32d.png" srcset="https://secure.gravatar.com/avatar/e96ad5cc29e1bb6da950048d42fbd32d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Massa</span>
	                <span class="date">November 25, 2017 at 7:36 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-421124" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>hello Dr Jason…</p>
<p>I was wondering …</p>
<p>n_outputs = len(set([row[-1] for row in dataset]))</p>
<p>this line, how does it give the number of output features?<br>
when I print it gives the number of the dataset(number of rows, not columns)</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-421124" data-commentid="421124" data-postid="3349" data-belowelement="comment-421124" data-respondelement="respond" data-replyto="Reply to Massa" aria-label="Reply to Massa">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-421146" class="comment byuser comment-author-jasonb bypostauthor even depth-3 parent">

	      	<div id="li-comment-421146" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">November 25, 2017 at 10:25 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-421146" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The length of the set of values in the final column.</p>
<p>Perhaps this post will help with Python syntax:<br>
<a href="https://machinelearningmastery.com/index-slice-reshape-numpy-arrays-machine-learning-python/" rel="nofollow ugc">https://machinelearningmastery.com/index-slice-reshape-numpy-arrays-machine-learning-python/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-421146" data-commentid="421146" data-postid="3349" data-belowelement="comment-421146" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-421189" class="comment odd alt depth-4 parent">

	      	<div id="li-comment-421189" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/e96ad5cc29e1bb6da950048d42fbd32d.png" srcset="https://secure.gravatar.com/avatar/e96ad5cc29e1bb6da950048d42fbd32d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Massa</span>
	                <span class="date">November 26, 2017 at 4:02 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-421189" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>but I thought it gives the number of outputs…I mean the number of neurons in the output layer.</p>
<p>here it’s giving the number of the dataset ….if I have 200 input/output pairs it prints 200</p>
<p>so I am confused…how would it be?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-421189" data-commentid="421189" data-postid="3349" data-belowelement="comment-421189" data-respondelement="respond" data-replyto="Reply to Massa" aria-label="Reply to Massa">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-421205" class="comment byuser comment-author-jasonb bypostauthor even depth-5">

	      	<div id="li-comment-421205" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">November 26, 2017 at 7:35 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-421205" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>If there are two class values, it should print 2. It should not print the number of examples.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-399034" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-399034" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/bf0ef567a0b7edfe1a2924da1068804a.png" srcset="https://secure.gravatar.com/avatar/bf0ef567a0b7edfe1a2924da1068804a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Umamaheswaran</span>
	                <span class="date">May 8, 2017 at 9:49 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-399034" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p> I am using the MNIST data set to implement a handwritten digit classifier. How many training examples will be needed to get a perfomance above 90%.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-399034" data-commentid="399034" data-postid="3349" data-belowelement="comment-399034" data-respondelement="respond" data-replyto="Reply to Umamaheswaran" aria-label="Reply to Umamaheswaran">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-399092" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-399092" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">May 9, 2017 at 7:42 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-399092" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I would recommend using a CNN on MNIST. See this tutorial:<br>
<a href="https://machinelearningmastery.com/handwritten-digit-recognition-using-convolutional-neural-networks-python-keras/" rel="nofollow ugc">http://machinelearningmastery.com/handwritten-digit-recognition-using-convolutional-neural-networks-python-keras/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-399092" data-commentid="399092" data-postid="3349" data-belowelement="comment-399092" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-399149" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-399149" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/0138f6e24db7f665b7680a4faf1d0b28.png" srcset="https://secure.gravatar.com/avatar/0138f6e24db7f665b7680a4faf1d0b28?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Huyen</span>
	                <span class="date">May 9, 2017 at 6:32 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-399149" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Your blog is totally awesome not only by this post but also for the whole series about neural network. Some of them explained so much useful thing than others on Internet. They help me a lot to understand the core of network instead of applying directly Keras or Tensorflow.</p>
<p>Just one question, if I would like to change the result from classification to regression, which part in back propagation I need to change and how?</p>
<p>Thank you in advance for your answer</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-399149" data-commentid="399149" data-postid="3349" data-belowelement="comment-399149" data-respondelement="respond" data-replyto="Reply to Huyen" aria-label="Reply to Huyen">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-399253" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-399253" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">May 10, 2017 at 8:46 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-399253" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Huyen.</p>
<p>You would change the activation function in the output layer to linear (e.g. no transform).</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-399253" data-commentid="399253" data-postid="3349" data-belowelement="comment-399253" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-399412" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-399412" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/9bdbeeeaf0542e8d50c5e867c44074a2.png" srcset="https://secure.gravatar.com/avatar/9bdbeeeaf0542e8d50c5e867c44074a2?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">TGoritsky</span>
	                <span class="date">May 12, 2017 at 12:41 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-399412" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>I am playing around with your code to better understand how the ANN works. Right now I am trying to do predictions with a NN, that is trained on my own dataset, but the program returns me one class label for all rows in a test dataset. I understand, that normalizing dataset should help, but it doesn`t work (I am using your minmax and normalize_dataset functions). Also, is there a way to return prediction for one-dimensional dataset?<br>
Here is the code (sorry for lack of formatting):<br>
def make_predictions():<br>
    dataset = [[29,46,107,324,56,44,121,35,1],<br>
            [29,46,109,327,51,37,123,38,1],<br>
            [28,42,107,309,55,32,124,38,1],<br>
            [40,112,287,59,35,121,36,1],<br>
            [27,43,129,306,75,41,107,38,1],<br>
            [28,38,127,289,79,40,109,37,1],<br>
            [29,37,126,292,77,35,100,34,1],<br>
            [30,40,87,48,77,51,272,80,2],<br>
            [26,37,88,47,84,44,250,80,2],<br>
            [29,39,91,47,84,46,247,79,2],<br>
            [28,38,85,45,80,47,249,78,2],<br>
            [28,36,81,43,76,50,337,83,2],<br>
            [28,34,75,41,83,52,344,81,2],<br>
            [30,38,80,46,71,53,347,92,2],<br>
            [28,35,72,45,64,47,360,101,2]]<br>
    network = [[{‘weights’: [0.09640510259345969, 0.37923370996257266, 0.5476265202749506, 0.9144446394025773, 0.837692750149296, 0.5343300438262426, 0.7679511829130964, 0.5325204151469501, 0.06532276962299033]}],<br>
            [{‘weights’: [0.040400453542770665, 0.13301701225112483]}, {‘weights’: [0.1665525504275246, 0.5382087395561351]}, {‘weights’: [0.26800994395551214, 0.3322334781304659]}]]<br>
#    minmax = dataset_minmax(dataset)<br>
 #   normalize_dataset(dataset, minmax)<br>
    for row in dataset:<br>
        prediction = predict(network, row)<br>
        print(‘Expected=%d, Got=%d’ % (row[-1], prediction))</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-399412" data-commentid="399412" data-postid="3349" data-belowelement="comment-399412" data-respondelement="respond" data-replyto="Reply to TGoritsky" aria-label="Reply to TGoritsky">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-399443" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-399443" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">May 12, 2017 at 7:43 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-399443" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I would suggest exploring your problem with the Keras framework:<br>
<a href="https://machinelearningmastery.com/start-here/#deeplearning" rel="nofollow ugc">http://machinelearningmastery.com/start-here/#deeplearning</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-399443" data-commentid="399443" data-postid="3349" data-belowelement="comment-399443" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-399961" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-399961" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/2c4015dec2450cccdd3df863dd23040f.png" srcset="https://secure.gravatar.com/avatar/2c4015dec2450cccdd3df863dd23040f?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Tomo</span>
	                <span class="date">May 18, 2017 at 6:22 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-399961" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason!<br>
In the function “backward_propagate_error”, when you do this:</p>
<p>		neuron[‘delta’] = errors[j] * transfer_derivative(neuron[‘output’])</p>
<p>The derivative should be applied on the activation of that neuron, not to the output . Am I right??</p>
<p>		neuron[‘delta’] = errors[j] * transfer_derivative(activate(neuron[‘weights’], inputs))</p>
<p>And inputs is:<br>
		inputs = row[-1]<br>
		if i != 0:<br>
			inputs = [neuron[‘output’] for neuron in self.network[i-1]]</p>
<p>Thank you! The post was really helpful!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-399961" data-commentid="399961" data-postid="3349" data-belowelement="comment-399961" data-respondelement="respond" data-replyto="Reply to Tomo" aria-label="Reply to Tomo">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-595899" class="comment even depth-2">

	      	<div id="li-comment-595899" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/7236305857050dafa10d9c02be42edfc.jpeg" srcset="https://secure.gravatar.com/avatar/7236305857050dafa10d9c02be42edfc?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Adika</span>
	                <span class="date">February 2, 2021 at 2:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-595899" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I think you are right but not sure.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-595899" data-commentid="595899" data-postid="3349" data-belowelement="comment-595899" data-respondelement="respond" data-replyto="Reply to Adika" aria-label="Reply to Adika">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-400540" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-400540" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/b49655a25d156960f928a2b25430b9ef.png" srcset="https://secure.gravatar.com/avatar/b49655a25d156960f928a2b25430b9ef?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Tina</span>
	                <span class="date">May 26, 2017 at 3:49 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-400540" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason!</p>
<p>This is a very interesting contribution to the community 🙂<br>
Have you tried using the algorithm with other activation functions?<br>
I tried with Gaussian, tanh and sinx, but the accuracy was not that high, so I think that I omitted something. What I altered were the activation functions and the derivatives. Is there something else that needs to be changed?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-400540" data-commentid="400540" data-postid="3349" data-belowelement="comment-400540" data-respondelement="respond" data-replyto="Reply to Tina" aria-label="Reply to Tina">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-401137" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-401137" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">June 2, 2017 at 11:49 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-401137" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sigmoid was the defacto standard for many years because it performs well on many different problems. </p>
<p>Now the defacto standard is ReLU.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-401137" data-commentid="401137" data-postid="3349" data-belowelement="comment-401137" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-401683" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-401683" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/2ef3dc8d91143cd1650d052b9d0d975d.png" srcset="https://secure.gravatar.com/avatar/2ef3dc8d91143cd1650d052b9d0d975d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Manu</span>
	                <span class="date">June 6, 2017 at 8:50 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-401683" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sigmoid and ReLU are transfer functions right ?<br>
Activation function is just the sum of all weights and inputs</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-401683" data-commentid="401683" data-postid="3349" data-belowelement="comment-401683" data-respondelement="respond" data-replyto="Reply to Manu" aria-label="Reply to Manu">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-401731" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-401731" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">June 7, 2017 at 7:12 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-401731" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You are correct, but in some frameworks, transfer functions are called activation functions:<br>
<a href="https://keras.io/activations/" rel="nofollow ugc">https://keras.io/activations/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-401731" data-commentid="401731" data-postid="3349" data-belowelement="comment-401731" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-400644" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-400644" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/4d7d7c7ad00661e8f45b9a5be551e31f.jpeg" srcset="https://secure.gravatar.com/avatar/4d7d7c7ad00661e8f45b9a5be551e31f?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">vishwanathan</span>
	                <span class="date">May 27, 2017 at 8:08 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-400644" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for the great post. Here is some observation that I am not able to understand. In the back ward propagate you are not taking all the weights and only considering the jth. Can you kindly help understand. I was under the impression that the delta from output is applied across all the weights,<br>
				for neuron in network[i + 1]:<br>
					error += (neuron[‘weights’][j] * neuron[‘delta’])</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-400644" data-commentid="400644" data-postid="3349" data-belowelement="comment-400644" data-respondelement="respond" data-replyto="Reply to vishwanathan" aria-label="Reply to vishwanathan">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-400645" class="comment even depth-2">

	      	<div id="li-comment-400645" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/4d7d7c7ad00661e8f45b9a5be551e31f.jpeg" srcset="https://secure.gravatar.com/avatar/4d7d7c7ad00661e8f45b9a5be551e31f?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">vishwanathan</span>
	                <span class="date">May 27, 2017 at 8:14 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-400645" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I understand you do not want to take in the bias weight hence the exclusion of the last weight in neuron. I kind of get stumped on bias.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-400645" data-commentid="400645" data-postid="3349" data-belowelement="comment-400645" data-respondelement="respond" data-replyto="Reply to vishwanathan" aria-label="Reply to vishwanathan">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-400646" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-400646" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/4d7d7c7ad00661e8f45b9a5be551e31f.jpeg" srcset="https://secure.gravatar.com/avatar/4d7d7c7ad00661e8f45b9a5be551e31f?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">vishwanathan</span>
	                <span class="date">May 27, 2017 at 9:12 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-400646" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for the great article. In the backward propagate, the delta value is applied for each weight across the neuron and the error is summed. I am curious why is the delta not applied to individual weights of the neuron and the error summed for that neuron. Can you please clarify?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-400646" data-commentid="400646" data-postid="3349" data-belowelement="comment-400646" data-respondelement="respond" data-replyto="Reply to vishwanathan" aria-label="Reply to vishwanathan">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-400706" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-400706" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/0707154c61049f645af6783bec2b9725.png" srcset="https://secure.gravatar.com/avatar/0707154c61049f645af6783bec2b9725?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://jgjgjh/" rel="external nofollow ugc" class="url">Josue</a></span>
	                <span class="date">May 29, 2017 at 3:12 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-400706" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Why don’t you split the data into TrainData and TestData, like 80% of the dataset for training and 20% for testing, because if you train with 100% of rows of the dataset and then test some rows of the dataset the accuracy will be good . But if you put new data on the seeds.csv the model will work with less accuracy, Right?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-400706" data-commentid="400706" data-postid="3349" data-belowelement="comment-400706" data-respondelement="respond" data-replyto="Reply to Josue" aria-label="Reply to Josue">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-401170" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-401170" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">June 2, 2017 at 12:16 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-401170" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can, k-fold cross validation generally gives a better estimate of model performance.</p>
<p>Once we have the estimate and choose our model, we can fit the final model on all available data and make predictions on new data:<br>
<a href="https://machinelearningmastery.com/train-final-machine-learning-model/" rel="nofollow ugc">http://machinelearningmastery.com/train-final-machine-learning-model/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-401170" data-commentid="401170" data-postid="3349" data-belowelement="comment-401170" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-400727" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-400727" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/67d241041014f0f5d9ebdcc9debacf33.png" srcset="https://secure.gravatar.com/avatar/67d241041014f0f5d9ebdcc9debacf33?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://donthave/" rel="external nofollow ugc" class="url">Josue</a></span>
	                <span class="date">May 29, 2017 at 11:08 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-400727" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for the post! I have a question about cross-validation. The dataset of seeds is perfect for 5 folds but for a dataset of 211? I’ll have uniformly sized subset right? (211/5) Can you give me a suggestion how I could handle that ?<br>
Thanks in advanced.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-400727" data-commentid="400727" data-postid="3349" data-belowelement="comment-400727" data-respondelement="respond" data-replyto="Reply to Josue" aria-label="Reply to Josue">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-401176" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-401176" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">June 2, 2017 at 12:20 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-401176" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>One way is that some records can be discarded to give even sized groups.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-401176" data-commentid="401176" data-postid="3349" data-belowelement="comment-401176" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-400803" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-400803" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/c5bf824ed810d04fcbe552afbc0768ac.png" srcset="https://secure.gravatar.com/avatar/c5bf824ed810d04fcbe552afbc0768ac?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sebastián</span>
	                <span class="date">May 30, 2017 at 9:35 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-400803" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks so much for the tutorial. It was really helpful!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-400803" data-commentid="400803" data-postid="3349" data-belowelement="comment-400803" data-respondelement="respond" data-replyto="Reply to Sebastián" aria-label="Reply to Sebastián">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-401194" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-401194" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">June 2, 2017 at 12:31 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-401194" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I’m glad it helped.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-401194" data-commentid="401194" data-postid="3349" data-belowelement="comment-401194" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-402132" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-402132" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/2ef3dc8d91143cd1650d052b9d0d975d.png" srcset="https://secure.gravatar.com/avatar/2ef3dc8d91143cd1650d052b9d0d975d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Manu</span>
	                <span class="date">June 10, 2017 at 9:00 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-402132" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason,</p>
<p>any advice on how to handle multi-classifier problems when the classes have high cardinality ?<br>
I’m thinking about input data of search engines linked to choosen urls.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-402132" data-commentid="402132" data-postid="3349" data-belowelement="comment-402132" data-respondelement="respond" data-replyto="Reply to Manu" aria-label="Reply to Manu">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-402178" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-402178" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">June 11, 2017 at 8:25 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-402178" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Ouch, consider modeling it as regression instead (e.g. a rating or recommender system).</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-402178" data-commentid="402178" data-postid="3349" data-belowelement="comment-402178" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-402304" class="comment even depth-3 parent">

	      	<div id="li-comment-402304" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/2ef3dc8d91143cd1650d052b9d0d975d.png" srcset="https://secure.gravatar.com/avatar/2ef3dc8d91143cd1650d052b9d0d975d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Manuel</span>
	                <span class="date">June 13, 2017 at 1:17 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-402304" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Ok thank you very much Jason.<br>
But it wont work with searches unseen by the algorithm.<br>
I red something in the books “Programming collective intelligence” about a neural net from scratch for this king of problem but I don’t understang how it works for the moments…</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-402304" data-commentid="402304" data-postid="3349" data-belowelement="comment-402304" data-respondelement="respond" data-replyto="Reply to Manuel" aria-label="Reply to Manuel">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-402350" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-402350" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">June 13, 2017 at 8:23 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-402350" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Consider focusing on one measure/metric that really matters in your domain, then try a suite of framings of the problem and different algorithms to get a feeling for what might work best.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-402350" data-commentid="402350" data-postid="3349" data-belowelement="comment-402350" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-402977" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-402977" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/959d5fe77a415801a0e4749065d2d60f.png" srcset="https://secure.gravatar.com/avatar/959d5fe77a415801a0e4749065d2d60f?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Yash</span>
	                <span class="date">June 18, 2017 at 6:21 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-402977" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I am not able to understand the above code.So, I request you to explain me the above code</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-402977" data-commentid="402977" data-postid="3349" data-belowelement="comment-402977" data-respondelement="respond" data-replyto="Reply to Yash" aria-label="Reply to Yash">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-403024" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-403024" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">June 19, 2017 at 8:43 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-403024" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Which part do you not understand exactly?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-403024" data-commentid="403024" data-postid="3349" data-belowelement="comment-403024" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-403300" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-403300" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/cce0b8ebf653dba6ba6c64769cf1417c.png" srcset="https://secure.gravatar.com/avatar/cce0b8ebf653dba6ba6c64769cf1417c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Tathagat</span>
	                <span class="date">June 21, 2017 at 3:20 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-403300" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hey Jason..am a novice in machine learning..have a small question…how can I track the timesteps involved in the algorithm with accordance with the code?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-403300" data-commentid="403300" data-postid="3349" data-belowelement="comment-403300" data-respondelement="respond" data-replyto="Reply to Tathagat" aria-label="Reply to Tathagat">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-403364" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-403364" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">June 22, 2017 at 6:04 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-403364" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>What do you mean by time steps?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-403364" data-commentid="403364" data-postid="3349" data-belowelement="comment-403364" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-404185" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-404185" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/194495195e7bc8c0f21b8cc71273be40.png" srcset="https://secure.gravatar.com/avatar/194495195e7bc8c0f21b8cc71273be40?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">bazooka</span>
	                <span class="date">June 29, 2017 at 6:52 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-404185" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, Jason. I am so confused, in the result, why there are 4 set of [output,weight,delta]</p>
<p>like this:<br>
[{‘output’: 0.9999930495852168, ‘weights’: [0.9315463130784808, 1.0639526745114607, 0.9274685127907779], ‘delta’: -4.508489650980804e-09}, {‘output’: 0.9992087809233077, ‘weights’: [-2.4595353900551125, 5.153506472345162, -0.5778256160239431], ‘delta’: 1.940550145482836e-06}]<br>
[{‘output’: 0.01193860966265472, ‘weights’: [2.3512725698865053, -8.719060612965613, 1.944330467290268], ‘delta’: -0.0001408287858584854}, {‘output’: 0.988067899681387, ‘weights’: [-2.2568526798573116, 8.720113230271012, -2.0392501730513253], ‘delta’: 0.0001406761850156443}]</p>
<p>after the backpropagation we find the optimal weights to get minimum error, what does these 4 group means?<br>
E</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-404185" data-commentid="404185" data-postid="3349" data-belowelement="comment-404185" data-respondelement="respond" data-replyto="Reply to bazooka" aria-label="Reply to bazooka">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-404190" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-404190" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">June 29, 2017 at 7:48 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-404190" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>That is the internal state of the whole trained network.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-404190" data-commentid="404190" data-postid="3349" data-belowelement="comment-404190" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-404189" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-404189" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/e1242e2b42e73cede3549da144ed6d57.png" srcset="https://secure.gravatar.com/avatar/e1242e2b42e73cede3549da144ed6d57?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">hassan</span>
	                <span class="date">June 29, 2017 at 7:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-404189" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>hi Jason<br>
thanks for your code and good description here, i like it so much.<br>
i run your  example code and encounter with an error same others whom left note here<br>
 the error is:<br>
expected[row[-1]] = 1<br>
IndexError: list assignment index out of range</p>
<p>how i can fix this error?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-404189" data-commentid="404189" data-postid="3349" data-belowelement="comment-404189" data-respondelement="respond" data-replyto="Reply to hassan" aria-label="Reply to hassan">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-404193" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-404193" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">June 29, 2017 at 7:49 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-404193" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The code was written for Python 2.7, confirm that this is your Python version.</p>
<p>Also confirm that you have copied the code exactly.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-404193" data-commentid="404193" data-postid="3349" data-belowelement="comment-404193" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-404812" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-404812" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/c135376b695ae35d060f01a1151c43d6.jpeg" srcset="https://secure.gravatar.com/avatar/c135376b695ae35d060f01a1151c43d6?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jerome</span>
	                <span class="date">July 5, 2017 at 9:20 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-404812" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dear Jason,</p>
<p>i have this question about Back Propagate Error</p>
<p>1- derivative sigmoid  = output * (1.0 – output)<br>
That is ok </p>
<p>2- error = (expected – output) * transfer_derivative(output)<br>
Ok but it also means that error == 0 for output = 1 whatever the expected is because transfer_derivative(1) ==0</p>
<p>So, whatever the expected , error is nil if output is 1 …<br>
Is there something rotten here?</p>
<p>Thanks</p>
<p>Jerome</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-404812" data-commentid="404812" data-postid="3349" data-belowelement="comment-404812" data-respondelement="respond" data-replyto="Reply to Jerome" aria-label="Reply to Jerome">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-405420" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-405420" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/75cf6d43b9e8929ba9253a185be4c699.png" srcset="https://secure.gravatar.com/avatar/75cf6d43b9e8929ba9253a185be4c699?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">wddddds</span>
	                <span class="date">July 10, 2017 at 10:01 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-405420" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you Jason, It’s a great tutorial and really helpful for me! </p>
<p>But I have to say that trying to reimplement your code strongly increased my ability of debugging 🙂</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-405420" data-commentid="405420" data-postid="3349" data-belowelement="comment-405420" data-respondelement="respond" data-replyto="Reply to wddddds" aria-label="Reply to wddddds">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-405483" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-405483" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">July 11, 2017 at 10:32 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-405483" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-405483" data-commentid="405483" data-postid="3349" data-belowelement="comment-405483" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-406233" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-406233" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/c5e8ae78e24da1f52dbb9029073c4be6.jpeg" srcset="https://secure.gravatar.com/avatar/c5e8ae78e24da1f52dbb9029073c4be6?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Victor</span>
	                <span class="date">July 17, 2017 at 7:50 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-406233" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, </p>
<p>Thanks for sharing your code. I’m a PhD candidate in machine learning, and I have a doubt about the weights update in section 4.1:</p>
<p>weight = weight + learning_rate * error * input</p>
<p>Should not it be as follows?</p>
<p>weight = weight – learning_rate * error * input</p>
<p>Thanks again for sharing this.</p>
<p>Regards,<br>
Victor.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-406233" data-commentid="406233" data-postid="3349" data-belowelement="comment-406233" data-respondelement="respond" data-replyto="Reply to Victor" aria-label="Reply to Victor">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-408545" class="comment even depth-2">

	      	<div id="li-comment-408545" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/c5e8ae78e24da1f52dbb9029073c4be6.jpeg" srcset="https://secure.gravatar.com/avatar/c5e8ae78e24da1f52dbb9029073c4be6?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Víctor</span>
	                <span class="date">August 4, 2017 at 11:07 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-408545" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I didn’t say anything, my mistake in understanding.</p>
<p>Thanks again for sharing your work.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-408545" data-commentid="408545" data-postid="3349" data-belowelement="comment-408545" data-respondelement="respond" data-replyto="Reply to Víctor" aria-label="Reply to Víctor">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-406881" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-406881" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/785810a6e8dfb52098803fb3dede7578.png" srcset="https://secure.gravatar.com/avatar/785810a6e8dfb52098803fb3dede7578?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">vishnu priya</span>
	                <span class="date">July 22, 2017 at 4:26 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-406881" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi..<br>
Thanks for ur coding. It was too helpful. can u suggest me how to use this code for classifying tamil characters. i have tried in cnn and now i need to compare the result with bpn. can u pls suggest me.</p>
<p>thank you</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-406881" data-commentid="406881" data-postid="3349" data-belowelement="comment-406881" data-respondelement="respond" data-replyto="Reply to vishnu priya" aria-label="Reply to vishnu priya">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-406962" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-406962" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">July 23, 2017 at 6:20 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-406962" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps this tutorial on classifying with a CNN would be more useful to you:<br>
<a href="https://machinelearningmastery.com/handwritten-digit-recognition-using-convolutional-neural-networks-python-keras/" rel="nofollow ugc">http://machinelearningmastery.com/handwritten-digit-recognition-using-convolutional-neural-networks-python-keras/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-406962" data-commentid="406962" data-postid="3349" data-belowelement="comment-406962" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-407012" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-407012" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/785810a6e8dfb52098803fb3dede7578.png" srcset="https://secure.gravatar.com/avatar/785810a6e8dfb52098803fb3dede7578?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">vishnu priya</span>
	                <span class="date">July 23, 2017 at 4:06 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-407012" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you sir.  With this tutorial i have implemented cnn sir. but for BPN i am getting error rate 687.203 sir. i dnt know what to do sir. can u help me sir.</p>
<p>Thank you</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-407012" data-commentid="407012" data-postid="3349" data-belowelement="comment-407012" data-respondelement="respond" data-replyto="Reply to vishnu priya" aria-label="Reply to vishnu priya">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-407079" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-407079" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">July 24, 2017 at 6:49 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-407079" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>What is the problem exactly?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-407079" data-commentid="407079" data-postid="3349" data-belowelement="comment-407079" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-407137" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-407137" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/785810a6e8dfb52098803fb3dede7578.png" srcset="https://secure.gravatar.com/avatar/785810a6e8dfb52098803fb3dede7578?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Vishnupriya</span>
	                <span class="date">July 24, 2017 at 4:53 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-407137" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Classification of Tamil characters sir. I have 144 different classes. I have taken 7 glcm features of each character and I need to train this features in backpropagation and predict the character to which class it belongs.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-407137" data-commentid="407137" data-postid="3349" data-belowelement="comment-407137" data-respondelement="respond" data-replyto="Reply to Vishnupriya" aria-label="Reply to Vishnupriya">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-407218" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-407218" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">July 25, 2017 at 9:34 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-407218" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sound like a great project!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-407218" data-commentid="407218" data-postid="3349" data-belowelement="comment-407218" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-407398" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-407398" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/ca5c626a48952b317f06e7d65d0706cb.png" srcset="https://secure.gravatar.com/avatar/ca5c626a48952b317f06e7d65d0706cb?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">codeo</span>
	                <span class="date">July 26, 2017 at 5:37 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-407398" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, so I wasn’t following this tutorial when implementing my neural network from scratch, and mine is in JavaScript. I just need help with the theory. How do I calculate the error for each node in the net so that I can incrementally change the weights? Great tutorial btw</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-407398" data-commentid="407398" data-postid="3349" data-belowelement="comment-407398" data-respondelement="respond" data-replyto="Reply to codeo" aria-label="Reply to codeo">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-407408" class="comment even depth-2 parent">

	      	<div id="li-comment-407408" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/ca5c626a48952b317f06e7d65d0706cb.png" srcset="https://secure.gravatar.com/avatar/ca5c626a48952b317f06e7d65d0706cb?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">codeo</span>
	                <span class="date">July 26, 2017 at 6:38 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-407408" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hahaha nevermind, it was my code<br>
Multidimensional arrays and stuff boggle the mind hah</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-407408" data-commentid="407408" data-postid="3349" data-belowelement="comment-407408" data-respondelement="respond" data-replyto="Reply to codeo" aria-label="Reply to codeo">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-407476" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-3">

	      	<div id="li-comment-407476" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">July 27, 2017 at 7:56 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-407476" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Glad to hear you worked it out.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-407476" data-commentid="407476" data-postid="3349" data-belowelement="comment-407476" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-408006" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-408006" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/ab3ef00b2d5371febe545e3e31cc17f3.png" srcset="https://secure.gravatar.com/avatar/ab3ef00b2d5371febe545e3e31cc17f3?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">PRABHAKARAN M</span>
	                <span class="date">July 31, 2017 at 4:31 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-408006" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>[ 6.38491205	5.333345	4.81565798	5.43552204	9.96445304	2.57268919	4.07671018	1.5258789	6.19728301	0	1	]<br>
Dear sir,<br>
the above mentioned numerical values are extracted from the dental x-ray image using gray level co occurrence matrix [10 inputs and 1 output]. This dataset is used as a input for BPN classifier. whether the same data set as[.csv] file can be used as the input for DEEP Convolutional Neural Network technique ? and can i get the output as image ? for example if i give the dental x ray images as numerical values i have to get the caries affected teeth as the output for the given dataset.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-408006" data-commentid="408006" data-postid="3349" data-belowelement="comment-408006" data-respondelement="respond" data-replyto="Reply to PRABHAKARAN M" aria-label="Reply to PRABHAKARAN M">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-408079" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-408079" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">August 1, 2017 at 7:51 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-408079" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>That sounds like a great problem. It may be possible.</p>
<p>I would recommend using deep CNNs.</p>
<p>Perhaps this tutorial will give you some ideas on how to get started:<br>
<a href="https://machinelearningmastery.com/handwritten-digit-recognition-using-convolutional-neural-networks-python-keras/" rel="nofollow ugc">http://machinelearningmastery.com/handwritten-digit-recognition-using-convolutional-neural-networks-python-keras/</a></p>
<p>You may want to look at some papers on object localization in images. I don’t have material on it sorry.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-408079" data-commentid="408079" data-postid="3349" data-belowelement="comment-408079" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-408007" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-408007" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/ab3ef00b2d5371febe545e3e31cc17f3.png" srcset="https://secure.gravatar.com/avatar/ab3ef00b2d5371febe545e3e31cc17f3?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">PRABHAKARAN M</span>
	                <span class="date">July 31, 2017 at 4:32 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-408007" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>can i get the example code for dental caries detection using deep Convolutional Neural Network for the given dataset as x ray images.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-408007" data-commentid="408007" data-postid="3349" data-belowelement="comment-408007" data-respondelement="respond" data-replyto="Reply to PRABHAKARAN M" aria-label="Reply to PRABHAKARAN M">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-408080" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-408080" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">August 1, 2017 at 7:52 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-408080" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I do not have sample code for this problem, sorry.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-408080" data-commentid="408080" data-postid="3349" data-belowelement="comment-408080" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-408057" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-408057" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/b795467df2464d8a9f719fbfec9cd564.png" srcset="https://secure.gravatar.com/avatar/b795467df2464d8a9f719fbfec9cd564?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">John</span>
	                <span class="date">August 1, 2017 at 3:26 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-408057" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Very nice explanation, thank you.<br>
I have some questions.</p>
<p>1) weight = weight + learning_rate * error * input</p>
<p>Do I really need to multiply it with input ? For example here <a href="http://home.agh.edu.pl/~vlsi/AI/backp_t_en/backprop.html" rel="nofollow ugc">http://home.agh.edu.pl/~vlsi/AI/backp_t_en/backprop.html</a> they dont it multiply it with input. At least, I think that…</p>
<p>2) Is your method same as in <a href="http://home.agh.edu.pl/~vlsi/AI/backp_t_en/backprop.html" rel="nofollow ugc">http://home.agh.edu.pl/~vlsi/AI/backp_t_en/backprop.html</a>?<br>
i think yes, but again, Im not sure and Im confused by that input multiplication. </p>
<p>3) What is exactly loss function in your example (I usually found some derivations of loss (cost ?) function (in other explanations), not transfer function derivation)? Im actually very confused by notation which I find around …</p>
<p>4) momentum and weight decay. In  your example, you can implement them that you substract calculated decay and add calculated momentum (to weight update) ? Again, I found forms which substract both and weight update as w + deltaW, so again I’m mega confused by notation for backpropagation which I found…</p>
<p>Sorry for dumb questions, … math is not my strong side, so many things which can be inferred by math sense are simply hidden for me.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-408057" data-commentid="408057" data-postid="3349" data-belowelement="comment-408057" data-respondelement="respond" data-replyto="Reply to John" aria-label="Reply to John">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-408058" class="comment odd alt depth-2 parent">

	      	<div id="li-comment-408058" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/b795467df2464d8a9f719fbfec9cd564.png" srcset="https://secure.gravatar.com/avatar/b795467df2464d8a9f719fbfec9cd564?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">John</span>
	                <span class="date">August 1, 2017 at 3:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-408058" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>*substract both and weight update as w + deltaW, so again</p>
<p>I found above sentence as nonsense, must be side effect of my confusion …</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-408058" data-commentid="408058" data-postid="3349" data-belowelement="comment-408058" data-respondelement="respond" data-replyto="Reply to John" aria-label="Reply to John">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-408096" class="comment byuser comment-author-jasonb bypostauthor even depth-3">

	      	<div id="li-comment-408096" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">August 1, 2017 at 8:12 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-408096" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hang in there. </p>
<p>Pick one tutorial and focus on it. Jumping from place to place will make things worse for sure.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-408096" data-commentid="408096" data-postid="3349" data-belowelement="comment-408096" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-408094" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-408094" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">August 1, 2017 at 8:10 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-408094" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi John, good questions.</p>
<p>According to my textbook, yes.<br>
I can’t speak for random sites on the internet sorry.</p>
<p>Loss is prediction error. You can change this to other forms like MAE or MSE.</p>
<p>No decay or momentum in this example. Easy to add if you want. There are many ways to dial in the learning process. No hard and fast rules, just some norms that people reuse.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-408094" data-commentid="408094" data-postid="3349" data-belowelement="comment-408094" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-408748" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-408748" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a11dc1ca672ffee4c876eee33b7ac7ca.png" srcset="https://secure.gravatar.com/avatar/a11dc1ca672ffee4c876eee33b7ac7ca?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Parminder Kaur</span>
	                <span class="date">August 6, 2017 at 7:50 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-408748" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>A VERY GOOD TUTORIAL SIR…<br>
Sir i am implementing remote sensed image classification using BPN neural network using IDL.<br>
I am not finding good resources on constructing features for input dataset and also number of hidden layers and number of neurons in hidden layer.<br>
Any resources you know, can help me?</p>
<p>Thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-408748" data-commentid="408748" data-postid="3349" data-belowelement="comment-408748" data-respondelement="respond" data-replyto="Reply to Parminder Kaur" aria-label="Reply to Parminder Kaur">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-408800" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-408800" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">August 7, 2017 at 8:41 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-408800" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The CNN will perform feature extraction automatically, you could explore using different filters on the data to see if it helps the network.</p>
<p>The number of layers and neurons/filters per layer must be found using trial and error. It is common to copy the designs from other papers as a starting point.</p>
<p>I hope that helps.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-408800" data-commentid="408800" data-postid="3349" data-belowelement="comment-408800" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-409003" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-409003" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/1268ae50179722425c7c57aaa5984486.png" srcset="https://secure.gravatar.com/avatar/1268ae50179722425c7c57aaa5984486?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">pero</span>
	                <span class="date">August 9, 2017 at 1:11 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-409003" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Nice tutorial, very clean and readable code. =)  thank you!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-409003" data-commentid="409003" data-postid="3349" data-belowelement="comment-409003" data-respondelement="respond" data-replyto="Reply to pero" aria-label="Reply to pero">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-409043" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-409043" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">August 9, 2017 at 6:37 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-409043" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks pero.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-409043" data-commentid="409043" data-postid="3349" data-belowelement="comment-409043" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-409615" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-409615" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/f50075a51189a6ad3ba2f2e313965e54.png" srcset="https://secure.gravatar.com/avatar/f50075a51189a6ad3ba2f2e313965e54?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Vatandas</span>
	                <span class="date">August 15, 2017 at 3:28 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-409615" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>1. I expect that this code is deep learning (many hidden layer) but not. One sentence is easy (“you can add more hidden layer as explained”) but to do is not as easy as you said.</p>
<p>2. I think your code is wrong.<br>
neuron[‘delta’] = errors[j] * transfer_derivative(neuron[‘output’])<br>
but<br>
Error = Target – ActivatedOutputNode<br>
Delta = Error * Derivative(NONActivatedOutputNode)</p>
<p>I mean you use the same ‘output’ variable both error and delta. But in error it must be activated one, in delta it must be NONactivated one.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-409615" data-commentid="409615" data-postid="3349" data-belowelement="comment-409615" data-respondelement="respond" data-replyto="Reply to Vatandas" aria-label="Reply to Vatandas">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-483645" class="comment odd alt depth-2">

	      	<div id="li-comment-483645" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/83cd5a8c14f892c6d2f527eabf75607d.png" srcset="https://secure.gravatar.com/avatar/83cd5a8c14f892c6d2f527eabf75607d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">A Researcher</span>
	                <span class="date">May 2, 2019 at 3:10 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-483645" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Exactly, this article is completely misleading :S</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-483645" data-commentid="483645" data-postid="3349" data-belowelement="comment-483645" data-respondelement="respond" data-replyto="Reply to A Researcher" aria-label="Reply to A Researcher">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-410043" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-410043" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/1a4213d34804626d852f6e053ff42e98.png" srcset="https://secure.gravatar.com/avatar/1a4213d34804626d852f6e053ff42e98?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">8CG_256</span>
	                <span class="date">August 18, 2017 at 9:02 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-410043" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Nice tutorial, very clean code and beginner-friendly. Thank you very much!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-410043" data-commentid="410043" data-postid="3349" data-belowelement="comment-410043" data-respondelement="respond" data-replyto="Reply to 8CG_256" aria-label="Reply to 8CG_256">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-410090" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-410090" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">August 18, 2017 at 4:36 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-410090" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks, I’m glad you found it useful!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-410090" data-commentid="410090" data-postid="3349" data-belowelement="comment-410090" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-410125" class="comment even depth-2 parent">

	      	<div id="li-comment-410125" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/1a4213d34804626d852f6e053ff42e98.png" srcset="https://secure.gravatar.com/avatar/1a4213d34804626d852f6e053ff42e98?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">8CG_256</span>
	                <span class="date">August 18, 2017 at 9:26 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-410125" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I only have one slight issue: I implemented this in Ruby and I tried to train it using the IRIS dataset, keeping the network simple (1 input layer, 1 hidden layer, 1 output layer) and after decreasing for a while the error rate keeps increasing. I tried lowering the learning rate, even making it dynamic so it decreases whenever the error increases but it doesn’t seem to help. Could you give me some advice? P.S sorry for my bad English</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-410125" data-commentid="410125" data-postid="3349" data-belowelement="comment-410125" data-respondelement="respond" data-replyto="Reply to 8CG_256" aria-label="Reply to 8CG_256">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-410183" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-3">

	      	<div id="li-comment-410183" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">August 19, 2017 at 6:19 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-410183" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Here is an example of backprop I developed in Ruby:<br>
<a href="http://cleveralgorithms.com/nature-inspired/neural/backpropagation.html" rel="nofollow ugc">http://cleveralgorithms.com/nature-inspired/neural/backpropagation.html</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-410183" data-commentid="410183" data-postid="3349" data-belowelement="comment-410183" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-410592" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-410592" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/26b98e129350b612628d7ba5094429dd.png" srcset="https://secure.gravatar.com/avatar/26b98e129350b612628d7ba5094429dd?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Derek Martins</span>
	                <span class="date">August 22, 2017 at 9:22 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-410592" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, I enjoy so much your tutorials. Can you do a tutorial implementing BackPropagation Through Time? Thanks man.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-410592" data-commentid="410592" data-postid="3349" data-belowelement="comment-410592" data-respondelement="respond" data-replyto="Reply to Derek Martins" aria-label="Reply to Derek Martins">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-410658" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-410658" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">August 23, 2017 at 6:50 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-410658" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for the suggestion.</p>
<p>I have a few posts on the general topic, for example:<br>
<a href="https://machinelearningmastery.com/gentle-introduction-backpropagation-time/" rel="nofollow ugc">https://machinelearningmastery.com/gentle-introduction-backpropagation-time/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-410658" data-commentid="410658" data-postid="3349" data-belowelement="comment-410658" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-410863" class="comment even thread-even depth-1">

	      	<div id="li-comment-410863" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a7cb65695fb2f8b52ea5917dca40d2d4.jpeg" srcset="https://secure.gravatar.com/avatar/a7cb65695fb2f8b52ea5917dca40d2d4?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://xprilion.com/" rel="external nofollow ugc" class="url">Anubhav Singh</a></span>
	                <span class="date">August 24, 2017 at 1:08 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-410863" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason,</p>
<p>Thank you for the great tutorial!</p>
<p>I would like to know how I can obtain the weight*input for every single neuron in the network…</p>
<p>I’ve been trying these lines – </p>
<p>for layer in network:<br>
		new_inputs = []<br>
		for neuron in layer:<br>
			activation = activate(neuron[‘weights’], inputs)<br>
			neuron[‘output’] = transfer(activation)<br>
			new_inputs.append(neuron[‘output’])</p>
<p>but the activation variable here is a single value…what I understand is that if I have set n_hidden = 5 (number of hidden layers), I should get N*5 (N = number of features in the dataset) outputs if I print the activation…</p>
<p>Kindly help 🙂</p>
<p>Thank you!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-410863" data-commentid="410863" data-postid="3349" data-belowelement="comment-410863" data-respondelement="respond" data-replyto="Reply to Anubhav Singh" aria-label="Reply to Anubhav Singh">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-411028" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-411028" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/3cc61772448f5917d23ae1e3487635f1.png" srcset="https://secure.gravatar.com/avatar/3cc61772448f5917d23ae1e3487635f1?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jose Panakkel</span>
	                <span class="date">August 25, 2017 at 10:45 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-411028" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dear Jason,</p>
<p>I have a question on the delta calculation at the output layer, where<br>
the primary value is the difference between the neuron output and<br>
the expected output. And we are then multiplying this difference<br>
with the transfer_derivative. where transfer_derivative is a function<br>
of neuron’s output.</p>
<p>My question is, is it correct to find the difference between the<br>
neuron’s output and the expected output?</p>
<p>In this case of the example, you have chosen digital outputs [0,1]<br>
and hence it may not have come up .. but my point is…<br>
one is already subjected to a transfer function, and one is not.</p>
<p>The neuron’s output is always subjected to a transfer function and<br>
hence will be in a specific range, say -.5 to +.5 or something..<br>
But the expected output is the user’s choice .. isnt it?<br>
user can have an expected value of say 488.34, for some stock price<br>
learning.. then is it still correct to find this primary difference<br>
between the expected output and the neuron output, at the output<br>
layer delta calculation?</p>
<p>shoulnt the expected output also be subjected to the same transfer<br>
function before finding the difference? Or the otherway, like<br>
shoulnt the neuron ouptut be subjected to a reverse transfer function<br>
before comparing with the expected output directly?</p>
<p>Thanks and Regards,<br>
Jose Panakkel</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-411028" data-commentid="411028" data-postid="3349" data-belowelement="comment-411028" data-respondelement="respond" data-replyto="Reply to Jose Panakkel" aria-label="Reply to Jose Panakkel">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-412837" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-412837" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/d6508606fe9489601d669f5cdc283d7b.png" srcset="https://secure.gravatar.com/avatar/d6508606fe9489601d669f5cdc283d7b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">RealUser404</span>
	                <span class="date">September 6, 2017 at 1:36 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-412837" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason, great tutorial that helped me a lot!</p>
<p>I have a question concerning the back-propagation : what if instead of having an error function I only have a desired gradient for the output (in the case of an actor-critic model for example)?<br>
How can I change your backprop function to make it work? Or can I just use the gradient as the error?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-412837" data-commentid="412837" data-postid="3349" data-belowelement="comment-412837" data-respondelement="respond" data-replyto="Reply to RealUser404" aria-label="Reply to RealUser404">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-412962" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-412962" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">September 7, 2017 at 12:49 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-412962" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I don’t follow, perhaps you can restate your question with an example?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-412962" data-commentid="412962" data-postid="3349" data-belowelement="comment-412962" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-413123" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-413123" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/6225bd61d073fc6ba733e76c0b6499bd.png" srcset="https://secure.gravatar.com/avatar/6225bd61d073fc6ba733e76c0b6499bd?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">user28</span>
	                <span class="date">September 8, 2017 at 9:26 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-413123" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason , thank you for providing this tutorial. I’m confused  of how can I implement the same backpropagation algorithm with output not binary. Since I noticed that your example has binary output. Like predicting for stock price given the  open, high, low and close values. Regards.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-413123" data-commentid="413123" data-postid="3349" data-belowelement="comment-413123" data-respondelement="respond" data-replyto="Reply to user28" aria-label="Reply to user28">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-413225" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-413225" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">September 9, 2017 at 11:55 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-413225" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Use a library like Keras. Start here:<br>
<a href="https://machinelearningmastery.com/start-here/#deeplearning" rel="nofollow ugc">https://machinelearningmastery.com/start-here/#deeplearning</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-413225" data-commentid="413225" data-postid="3349" data-belowelement="comment-413225" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-413386" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-413386" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/8283c11827ba7552e4edc668aa74e2c3.png" srcset="https://secure.gravatar.com/avatar/8283c11827ba7552e4edc668aa74e2c3?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://na/" rel="external nofollow ugc" class="url">Lewis</a></span>
	                <span class="date">September 11, 2017 at 2:11 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-413386" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>great article. I have an interest in NN but I am not that good at python. </p>
<p>Want I wanted to try was to withhold say 5 rows from the dataset and have the trained network predict the results for those rows. these is is different from what I think the example does which is rolling predictions with the learning. Removing 5 rows from the dataset is of course easy but my pitiful attempts at predicting with unseen data like below fail ((I guess network is not in scope at the end): any help appreciated!</p>
<p># predict unseen data<br>
unseendataset = [[12.37,13.47,0.8567,5.204,2.96,3.919,5.001],<br>
[12.19,13.2,0.8783,5.137,2.981,3.631,4.87],<br>
[11.23,12.88,0.8511,5.14,2.795,4.325,5.003],<br>
[13.2,13.66,0.8883,5.236,3.232,8.315,5.056],<br>
[11.84,13.21,0.8521,5.175,2.836,3.598,5.044],<br>
[12.3,13.34,0.8684,5.243,2.974,5.637,5.063]]</p>
<p>for row in unseendataset:<br>
    prediction2 = predict(network, row)<br>
    print(‘Predicted=%d’ % (prediction2))</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-413386" data-commentid="413386" data-postid="3349" data-belowelement="comment-413386" data-respondelement="respond" data-replyto="Reply to Lewis" aria-label="Reply to Lewis">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-413434" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-413434" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">September 11, 2017 at 12:08 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-413434" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I would recommend starting with Keras rather than coding the algorithm from scratch.</p>
<p>Start here:<br>
<a href="https://machinelearningmastery.com/start-here/#deeplearning" rel="nofollow ugc">https://machinelearningmastery.com/start-here/#deeplearning</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-413434" data-commentid="413434" data-postid="3349" data-belowelement="comment-413434" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-413775" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-413775" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/ce124181d0a03bb5edf4f647f95b9fad.jpeg" srcset="https://secure.gravatar.com/avatar/ce124181d0a03bb5edf4f647f95b9fad?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://www.linkedin.com/in/kmagdy/" rel="external nofollow ugc" class="url">Karim</a></span>
	                <span class="date">September 14, 2017 at 1:27 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-413775" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, I am trying to generalize your implementation to work with a variable number of layers and nodes. However, whenever I try to increase the number of nodes too much it stops working (the network freezes at one error rate and all output nodes are active, i.e. giving 1). Although the code would work if I decreased the layers and the errors will go down.<br>
Is there something I am missing when using too many layers? The concepts should be the same. </p>
<p>I trained a network with 4 layers: [14,10,10,4] and it worked.<br>
I trained a network with 4 layers [14,100,40,4] and it is stuck. Same dataset. </p>
<p>My code is here if you are looking in more details:<br>
<a href="https://github.com/KariMagdy/Implementing-a-neural-network" rel="nofollow ugc">https://github.com/KariMagdy/Implementing-a-neural-network</a></p>
<p>Thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-413775" data-commentid="413775" data-postid="3349" data-belowelement="comment-413775" data-respondelement="respond" data-replyto="Reply to Karim" aria-label="Reply to Karim">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-413891" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-413891" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">September 15, 2017 at 12:10 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-413891" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>What problem do you get exactly?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-413891" data-commentid="413891" data-postid="3349" data-belowelement="comment-413891" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-415614" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-415614" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/bc803c364515901e16bbc203c53d3ca2.png" srcset="https://secure.gravatar.com/avatar/bc803c364515901e16bbc203c53d3ca2?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Laksh</span>
	                <span class="date">October 4, 2017 at 11:11 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-415614" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, Jason Brownlee,<br>
can we extend this code for 2 or more hidden layers ?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-415614" data-commentid="415614" data-postid="3349" data-belowelement="comment-415614" data-respondelement="respond" data-replyto="Reply to Laksh" aria-label="Reply to Laksh">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-415653" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-415653" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">October 5, 2017 at 5:24 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-415653" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sure.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-415653" data-commentid="415653" data-postid="3349" data-belowelement="comment-415653" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-416085" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-416085" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a17ed90fdc8633fa31b3787ed44a65d8.png" srcset="https://secure.gravatar.com/avatar/a17ed90fdc8633fa31b3787ed44a65d8?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">dsliver33</span>
	                <span class="date">October 9, 2017 at 1:52 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-416085" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dear Mr. Brownlee,</p>
<p>I’m trying to alter the code to represent a regression problem (sigmoid on hidden layer, linear on output layer). As far as I know, the main part of the code that would have to be modified is the FF algorithm. I’ve rewritten the code as below:</p>
<p></p>
		<div id="urvanov-syntax-highlighter-6060ca9c6f492681917639" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18.9915px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># Forward propagate input to a network output
def forward_propagate_regression(network, row):
    inputs = row
    new_inputs = []
    #gets the 1st layer, applies sigmoid activation
    hiddenlayer = network[0]
    for neuron in hiddenlayer:
        activation = activate(neuron['weights'], inputs)
        neuron['output'] = transfer(activation)
        new_inputs.append(neuron['output'])
    inputs = new_inputs
    #gets the last layer, applies linear activation
    outputlayer = network[-1]
    for neuron in outputlayer:
            activation = activate(neuron['weights'], inputs)
            neuron['output'] = activation
            new_inputs.append(neuron['output'])
    inputs = new_inputs
    return inputs</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c6f492681917639-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c6f492681917639-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c6f492681917639-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c6f492681917639-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c6f492681917639-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c6f492681917639-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c6f492681917639-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c6f492681917639-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c6f492681917639-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c6f492681917639-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c6f492681917639-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c6f492681917639-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c6f492681917639-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c6f492681917639-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c6f492681917639-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c6f492681917639-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c6f492681917639-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c6f492681917639-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c6f492681917639-19">19</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c6f492681917639-1"><span class="crayon-p"># Forward propagate input to a network output</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c6f492681917639-2"><span class="crayon-e">def </span><span class="crayon-e">forward_propagate_regression</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c6f492681917639-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">row</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c6f492681917639-4"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">new_inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c6f492681917639-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-p">#gets the 1st layer, applies sigmoid activation</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c6f492681917639-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">hiddenlayer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c6f492681917639-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">neuron </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">hiddenlayer</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c6f492681917639-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">activate</span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'weights'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c6f492681917639-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">transfer</span><span class="crayon-sy">(</span><span class="crayon-v">activation</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c6f492681917639-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">new_inputs</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c6f492681917639-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">new</span><span class="crayon-sy">_</span>inputs</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c6f492681917639-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-p">#gets the last layer, applies linear activation</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c6f492681917639-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">outputlayer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c6f492681917639-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">neuron </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">outputlayer</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c6f492681917639-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">activate</span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'weights'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c6f492681917639-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">activation</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c6f492681917639-17"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">new_inputs</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c6f492681917639-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">new_inputs</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c6f492681917639-19"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p></p>
<p>With this code, I’m getting an “OverflowError: (34, ‘Result too large’)” error. Could you please tell what I’m doing wrong? All the other parts of the code are as you’ve written.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-416085" data-commentid="416085" data-postid="3349" data-belowelement="comment-416085" data-respondelement="respond" data-replyto="Reply to dsliver33" aria-label="Reply to dsliver33">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-416100" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-416100" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">October 9, 2017 at 4:47 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-416100" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>What did you change exactly? Can you highlight the change for me?</p>
<p>Also, try using pre tags.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-416100" data-commentid="416100" data-postid="3349" data-belowelement="comment-416100" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-416157" class="comment even depth-3 parent">

	      	<div id="li-comment-416157" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a17ed90fdc8633fa31b3787ed44a65d8.png" srcset="https://secure.gravatar.com/avatar/a17ed90fdc8633fa31b3787ed44a65d8?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">dsliver33</span>
	                <span class="date">October 10, 2017 at 4:08 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-416157" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>(I don’t know how to highlight the change, sorry!)</p>
<p>I got the hidden layer (network[0]), and I applied your algorithm (calculate activation, transfer the activation to the output, append that to a new list called “new_inputs”). </p>
<p>After that, I get the output layer (network[-1]), I calculate the activation with the “new_inputs”, but I do NOT apply the sigmoid transfer function (so, the outputs should be linear). The results are appended to a new list, which is set to be the return of the function. </p>
<p>Would that be the best way to remove the sigmoid function from the output layer, making the code a regression, instead of a classification?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-416157" data-commentid="416157" data-postid="3349" data-belowelement="comment-416157" data-respondelement="respond" data-replyto="Reply to dsliver33" aria-label="Reply to dsliver33">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-416186" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-416186" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">October 10, 2017 at 7:52 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-416186" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sounds good. I don’t have any good ideas, I’d recommend stepping through some calculations to help spot where it is going wrong.</p>
<p>You may want to consider moving to an open source neural net library, such as Keras:<br>
<a href="https://machinelearningmastery.com/start-here/#deeplearning" rel="nofollow ugc">https://machinelearningmastery.com/start-here/#deeplearning</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-416186" data-commentid="416186" data-postid="3349" data-belowelement="comment-416186" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-417956" class="comment even depth-2">

	      	<div id="li-comment-417956" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/3a9e36841e2b4afcd9389ccb5e46c1df.png" srcset="https://secure.gravatar.com/avatar/3a9e36841e2b4afcd9389ccb5e46c1df?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Liam McGoldrick</span>
	                <span class="date">October 26, 2017 at 5:23 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-417956" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I am having the same issue with mine. i made alterations and they are just the same as yours. Did you find a solution?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-417956" data-commentid="417956" data-postid="3349" data-belowelement="comment-417956" data-respondelement="respond" data-replyto="Reply to Liam McGoldrick" aria-label="Reply to Liam McGoldrick">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-417963" class="comment odd alt depth-2 parent">

	      	<div id="li-comment-417963" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/3a9e36841e2b4afcd9389ccb5e46c1df.png" srcset="https://secure.gravatar.com/avatar/3a9e36841e2b4afcd9389ccb5e46c1df?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Liam McGoldrick</span>
	                <span class="date">October 26, 2017 at 5:27 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-417963" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I GOT IT TO WORK!!! You have to normalize your output data. Then you can apply the transfer function to the output layer just the same! After that it will work!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-417963" data-commentid="417963" data-postid="3349" data-belowelement="comment-417963" data-respondelement="respond" data-replyto="Reply to Liam McGoldrick" aria-label="Reply to Liam McGoldrick">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-497537" class="comment even depth-3">

	      	<div id="li-comment-497537" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/fb16057ba6ede283d132da3c53cb9622.png" srcset="https://secure.gravatar.com/avatar/fb16057ba6ede283d132da3c53cb9622?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Steven</span>
	                <span class="date">August 20, 2019 at 8:40 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-497537" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>But didn’t you changed the function ‘train_network’ ???</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-497537" data-commentid="497537" data-postid="3349" data-belowelement="comment-497537" data-respondelement="respond" data-replyto="Reply to Steven" aria-label="Reply to Steven">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-600592" class="comment odd alt depth-3">

	      	<div id="li-comment-600592" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/d53a5a55acc542f3bd1cd0e030d61923.png" srcset="https://secure.gravatar.com/avatar/d53a5a55acc542f3bd1cd0e030d61923?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Urvi Deole</span>
	                <span class="date">March 12, 2021 at 2:21 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-600592" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Could you please mention the functions you made changes to to get the code to work for regression?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-600592" data-commentid="600592" data-postid="3349" data-belowelement="comment-600592" data-respondelement="respond" data-replyto="Reply to Urvi Deole" aria-label="Reply to Urvi Deole">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-416406" class="comment even thread-even depth-1">

	      	<div id="li-comment-416406" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/19ad03bc88f93977eb58a0a21c943632.png" srcset="https://secure.gravatar.com/avatar/19ad03bc88f93977eb58a0a21c943632?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Chris</span>
	                <span class="date">October 12, 2017 at 11:27 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-416406" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, nice posting and it really helps a lot<br>
for j in range(len(layer)):<br>
	neuron = layer[j]<br>
	neuron[‘delta’] = errors[j] * transfer_derivative(neuron[‘output’])<br>
Should the neuron[‘output’] be the output of the activation function instead of the transfer function here?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-416406" data-commentid="416406" data-postid="3349" data-belowelement="comment-416406" data-respondelement="respond" data-replyto="Reply to Chris" aria-label="Reply to Chris">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-416652" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-416652" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/7c8460bc85f0bdaa6278488d56b20510.png" srcset="https://secure.gravatar.com/avatar/7c8460bc85f0bdaa6278488d56b20510?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Asad</span>
	                <span class="date">October 14, 2017 at 3:24 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-416652" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>hi jason, nice post its really helps alot.</p>
<p>please tell me how we can change the neuron in hidden layer and in output layer?<br>
and what will be the result when we change the neuron in hidden layer and in output layer?<br>
in this tutorial u take one hidden layer,so can we use more than one hidden layer? and how?</p>
<p>please tell me i m waiting</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-416652" data-commentid="416652" data-postid="3349" data-belowelement="comment-416652" data-respondelement="respond" data-replyto="Reply to Asad" aria-label="Reply to Asad">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-416721" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-416721" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">October 15, 2017 at 5:19 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-416721" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps you would be better served by starting with a neural network library such as Keras:<br>
<a href="https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/" rel="nofollow ugc">https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-416721" data-commentid="416721" data-postid="3349" data-belowelement="comment-416721" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-416872" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-416872" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a17ed90fdc8633fa31b3787ed44a65d8.png" srcset="https://secure.gravatar.com/avatar/a17ed90fdc8633fa31b3787ed44a65d8?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">dsliver33</span>
	                <span class="date">October 16, 2017 at 2:27 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-416872" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dear Mr. Brownlee,</p>
<p>I’m trying to adapt the code to support many hidden layers. I’ve adapted the code as below, with a new input called “n_layers”, to insert N hidden layers in the network. </p>
<p># Initialize a network with “n_layers” hidden layers<br>
def initialize_network3(n_inputs, n_hidden, n_layers, n_outputs):<br>
    network = list()<br>
    for i in range(n_layers):<br>
        hidden_layer = [{‘weights’:[random() for i in range(n_inputs + 1)]} for i in range(n_hidden)]<br>
        network.append(hidden_layer)<br>
    output_layer = [{‘weights’:[random() for i in range(n_hidden)]} for i in range(n_outputs)]<br>
    network.append(output_layer)<br>
    return network</p>
<p>When I try to run the code, it shows the error below. Do you have any idea why?</p>
<p> in backward_propagate_error(network, expected)<br>
     78                 error = 0.0<br>
     79                 for neuron in network[i + 1]:<br>
—&gt; 80                     error += (neuron[‘weights’][j] * neuron[‘delta’])<br>
     81                 errors.append(error)<br>
     82         else:</p>
<p>IndexError: list index out of range</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-416872" data-commentid="416872" data-postid="3349" data-belowelement="comment-416872" data-respondelement="respond" data-replyto="Reply to dsliver33" aria-label="Reply to dsliver33">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-428308" class="comment even depth-2">

	      	<div id="li-comment-428308" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/e809fd1c87b28b52bf163c33a16ce0fc.png" srcset="https://secure.gravatar.com/avatar/e809fd1c87b28b52bf163c33a16ce0fc?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">dna_remaps</span>
	                <span class="date">February 3, 2018 at 10:43 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-428308" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This took me a minute to figure out myself.</p>
<p>You need to add a conditional after your first layer to make sure your subsequent hidden layer weights have the proper dimensions (n_hidden+1, n_hidden)</p>
<p>for i in range(n_layers):<br>
hidden_layer = [{‘weights’:[random() for i in range(n_inputs + 1)]} for i in range(n_hidden)]<br>
if i &gt; 0:<br>
hidden_layer = [[{‘weights’:[random() for i in range(n_hidden + 1)]} for i in range(n_hidden)]<br>
network.append(hidden_layer)</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-428308" data-commentid="428308" data-postid="3349" data-belowelement="comment-428308" data-respondelement="respond" data-replyto="Reply to dna_remaps" aria-label="Reply to dna_remaps">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-416944" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-416944" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/7218da6c248a3829926f473bf0c9905c.png" srcset="https://secure.gravatar.com/avatar/7218da6c248a3829926f473bf0c9905c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Arijit Mukherjee</span>
	                <span class="date">October 17, 2017 at 1:40 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-416944" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, </p>
<p>In the output/last layer when we are calculating the backprop error why are we multiplying  with the transfer derivative with the (expected-output)?? transfer derivative is already canceled out for the the last layer , the update should be only (expected-output)*previous_layer_input , ???<br>
Thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-416944" data-commentid="416944" data-postid="3349" data-belowelement="comment-416944" data-respondelement="respond" data-replyto="Reply to Arijit Mukherjee" aria-label="Reply to Arijit Mukherjee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-417112" class="comment even thread-even depth-1">

	      	<div id="li-comment-417112" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/b451c3e1b17fc81e5bf84cc05b98ffb0.png" srcset="https://secure.gravatar.com/avatar/b451c3e1b17fc81e5bf84cc05b98ffb0?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Tanoh Henry</span>
	                <span class="date">October 18, 2017 at 8:54 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-417112" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Really good article. Thanks a lot.<br>
Need a little bit of clarification.<br>
For backward propagation starting at the output layer,<br>
you get the error by appending to errors expected[j] – neuron[‘output’].<br>
Isn’t  Error = 0.5 * sum(errors)?<br>
and then using this sum of errors for back-propagation?<br>
Thanks.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-417112" data-commentid="417112" data-postid="3349" data-belowelement="comment-417112" data-respondelement="respond" data-replyto="Reply to Tanoh Henry" aria-label="Reply to Tanoh Henry">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-417341" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-417341" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/3a9e36841e2b4afcd9389ccb5e46c1df.png" srcset="https://secure.gravatar.com/avatar/3a9e36841e2b4afcd9389ccb5e46c1df?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Liam</span>
	                <span class="date">October 21, 2017 at 5:41 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-417341" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for the tutorial! I am trying to modify your code to do a regression  model and I am stuck. I have an input data set (4 columns and many rows) and a single variable output data set (in range of tens of thousands). I fed them into the train procedure and I get an error when it reaches “expected = [0 for i in range(n_outputs)]” in the train portion. The error reads “only length-1 arrays can be converted to Python scalar”. Now I understand this is because of the intended purpose for the code was a categorization problem but I am wondering what I would need to modify to get this to work? Any help would go a long way as I have been stuck on this issue for some time now.</p>
<p>Thanks, and again wonderful tutorial!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-417341" data-commentid="417341" data-postid="3349" data-belowelement="comment-417341" data-respondelement="respond" data-replyto="Reply to Liam" aria-label="Reply to Liam">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-417348" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-417348" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">October 21, 2017 at 5:45 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-417348" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps start with Keras, it will be much easier for you:<br>
<a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/" rel="nofollow ugc">https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-417348" data-commentid="417348" data-postid="3349" data-belowelement="comment-417348" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-418032" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-418032" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/33f8d2acc9ddf62eb3c18d23d372b459.png" srcset="https://secure.gravatar.com/avatar/33f8d2acc9ddf62eb3c18d23d372b459?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sam</span>
	                <span class="date">October 26, 2017 at 11:15 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-418032" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi<br>
I am implementing a 2 layer neural network with 100 hidden units in the first layer and 50<br>
in the next using your code. Implement sigmoid activation function in each layer. Train/test your<br>
model on the MNIST dataset subset.<br>
But it is always giving same prediction.<br>
[0.99999999986772, 0.99999999994584]<br>
Expected=0, Got=1<br>
[0.99999999986772, 0.99999999994584]<br>
Expected=1, Got=1<br>
[0.99999999986772, 0.99999999994584]<br>
Expected=1, Got=1<br>
[0.99999999986772, 0.99999999994584]<br>
Expected=1, Got=1<br>
[0.99999999986772, 0.99999999994584]<br>
Expected=1, Got=1<br>
[0.99999999986772, 0.99999999994584]<br>
Expected=0, Got=1<br>
[0.99999999986772, 0.99999999994584]<br>
Expected=0, Got=1<br>
[0.99999999986772, 0.99999999994584]<br>
Expected=1, Got=1<br>
[0.99999999986772, 0.99999999994584]<br>
Expected=0, Got=1<br>
[0.99999999986772, 0.99999999994584]<br>
Expected=0, Got=1<br>
[0.99999999986772, 0.99999999994584]<br>
Expected=0, Got=1<br>
[0.99999999986772, 0.99999999994584]<br>
Expected=0, Got=1</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-418032" data-commentid="418032" data-postid="3349" data-belowelement="comment-418032" data-respondelement="respond" data-replyto="Reply to Sam" aria-label="Reply to Sam">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-418053" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-418053" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">October 27, 2017 at 5:20 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-418053" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I would recommend using a framework like Keras:<br>
<a href="https://machinelearningmastery.com/handwritten-digit-recognition-using-convolutional-neural-networks-python-keras/" rel="nofollow ugc">https://machinelearningmastery.com/handwritten-digit-recognition-using-convolutional-neural-networks-python-keras/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-418053" data-commentid="418053" data-postid="3349" data-belowelement="comment-418053" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-435029" class="comment odd alt depth-2">

	      	<div id="li-comment-435029" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/5ae8bc3b70b383b5d06c0caa0b7b7f5f.png" srcset="https://secure.gravatar.com/avatar/5ae8bc3b70b383b5d06c0caa0b7b7f5f?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Matthias</span>
	                <span class="date">April 15, 2018 at 2:57 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-435029" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Weights should be initialized with normally distributed random values. Try using random.gauss for weight initialization.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-435029" data-commentid="435029" data-postid="3349" data-belowelement="comment-435029" data-respondelement="respond" data-replyto="Reply to Matthias" aria-label="Reply to Matthias">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-418240" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-418240" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/f8452cbd8c2a63adc828d8146220a2b0.png" srcset="https://secure.gravatar.com/avatar/f8452cbd8c2a63adc828d8146220a2b0?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">John</span>
	                <span class="date">October 28, 2017 at 6:52 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-418240" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>help, I dont know why i got this error.</p>
<p>Traceback (most recent call last):<br>
  File “a.py”, line 185, in<br>
    for i in range(len(dataset[0])-1):<br>
TypeError: ‘NoneType’ object has no attribute ‘__getitem__’</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-418240" data-commentid="418240" data-postid="3349" data-belowelement="comment-418240" data-respondelement="respond" data-replyto="Reply to John" aria-label="Reply to John">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-418288" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-418288" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">October 29, 2017 at 5:52 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-418288" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You cannot have the “-1” within the call to len()</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-418288" data-commentid="418288" data-postid="3349" data-belowelement="comment-418288" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-419811" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-419811" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a192ed79ebd87633f7b3f4b422175e4d.png" srcset="https://secure.gravatar.com/avatar/a192ed79ebd87633f7b3f4b422175e4d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">João Costa</span>
	                <span class="date">November 12, 2017 at 12:46 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-419811" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hey Jason, thanks for your post!</p>
<p>This is helping me a lot with a college work. But in this NN, how can I set manually not the number of input neuros, the input values? </p>
<p>For example, if I have 1 input neuro, I wan’t to set this value to 0.485.</p>
<p>Best regards!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-419811" data-commentid="419811" data-postid="3349" data-belowelement="comment-419811" data-respondelement="respond" data-replyto="Reply to João Costa" aria-label="Reply to João Costa">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-419867" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-419867" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">November 13, 2017 at 10:11 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-419867" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I don’t follow.</p>
<p>Perhaps you’d be better off using a library like Keras:<br>
<a href="https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/" rel="nofollow ugc">https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-419867" data-commentid="419867" data-postid="3349" data-belowelement="comment-419867" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-420277" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-420277" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/2de5bbda17e93bc53aa17350c13f6837.png" srcset="https://secure.gravatar.com/avatar/2de5bbda17e93bc53aa17350c13f6837?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">yesta</span>
	                <span class="date">November 17, 2017 at 8:21 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-420277" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, Jason<br>
Thank you for this amazing tutorial!</p>
<p>I have a question that may be out of the topic. How do you call models or type of DL models where you feed a model with new test data in order to make the model adaptive to the environment?</p>
<p>Thank you.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-420277" data-commentid="420277" data-postid="3349" data-belowelement="comment-420277" data-respondelement="respond" data-replyto="Reply to yesta" aria-label="Reply to yesta">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-420299" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-420299" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">November 17, 2017 at 9:31 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-420299" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, you can update a model after it has been trained.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-420299" data-commentid="420299" data-postid="3349" data-belowelement="comment-420299" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-422285" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-422285" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/b7d93b68858e06c3ddd8e40665260f03.png" srcset="https://secure.gravatar.com/avatar/b7d93b68858e06c3ddd8e40665260f03?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Nil</span>
	                <span class="date">December 6, 2017 at 7:47 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-422285" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, Dr. Jason,</p>
<p>I have been studying how to develop a neural network from scratch and this tutorial is the main one I have been following because it is helping me so much.<br>
I have a doubt: When I study the theory I see the neural network scheme carrying only the weights and bias. And here in practice I see that the network is also carrying the output values and the delta i.e (weights, bias, output and delta). Will the final model be saved like this? with the latter (weights, bias, output and delta)? would this be the rule in practice?</p>
<p>I would appreciate it if you could help with this issue so that I could get out of where I left off.</p>
<p>Your posts are really very good there is where I find my way in to learning in Machine Learning.</p>
<p>Best Regards</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-422285" data-commentid="422285" data-postid="3349" data-belowelement="comment-422285" data-respondelement="respond" data-replyto="Reply to Nil" aria-label="Reply to Nil">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-422347" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-422347" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">December 7, 2017 at 7:51 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-422347" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The final model (e.g. trained) only needs to perform the forward pass.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-422347" data-commentid="422347" data-postid="3349" data-belowelement="comment-422347" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-422467" class="comment even depth-3">

	      	<div id="li-comment-422467" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/b7d93b68858e06c3ddd8e40665260f03.png" srcset="https://secure.gravatar.com/avatar/b7d93b68858e06c3ddd8e40665260f03?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Nil</span>
	                <span class="date">December 8, 2017 at 5:50 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-422467" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Understood.<br>
Thank you Dr. Jason</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-422467" data-commentid="422467" data-postid="3349" data-belowelement="comment-422467" data-respondelement="respond" data-replyto="Reply to Nil" aria-label="Reply to Nil">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-422514" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-422514" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/774946826d1ae794b3e0ceaf4e03f0bb.png" srcset="https://secure.gravatar.com/avatar/774946826d1ae794b3e0ceaf4e03f0bb?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">MohamedElshazly</span>
	                <span class="date">December 8, 2017 at 9:30 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-422514" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi , there’s something i don’t understand  : </p>
<p></p>
		<div id="urvanov-syntax-highlighter-6060ca9c6f1e3577554819" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18.9915px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">for i in reversed(range(len(network))):
		layer = network[i]
		errors = list()
		if i != len(network)-1:
			for j in range(len(layer)):
				error = 0.0
				for neuron in network[i + 1]:</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c6f1e3577554819-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c6f1e3577554819-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c6f1e3577554819-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c6f1e3577554819-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c6f1e3577554819-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c6f1e3577554819-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c6f1e3577554819-7">7</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c6f1e3577554819-1"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">reversed</span><span class="crayon-sy">(</span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c6f1e3577554819-2"><span class="crayon-h">		</span><span class="crayon-v">layer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c6f1e3577554819-3"><span class="crayon-h">		</span><span class="crayon-v">errors</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c6f1e3577554819-4"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c6f1e3577554819-5"><span class="crayon-h">			</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">layer</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c6f1e3577554819-6"><span class="crayon-h">				</span><span class="crayon-v">error</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.0</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c6f1e3577554819-7"><span class="crayon-h">				</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">neuron </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p></p>
<p>wouldn’t the last line be out of range because  the current ‘ i ‘ is the last one and i can’t go beyond it by 1  ?  thanks in advance</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-422514" data-commentid="422514" data-postid="3349" data-belowelement="comment-422514" data-respondelement="respond" data-replyto="Reply to MohamedElshazly" aria-label="Reply to MohamedElshazly">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-422538" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-422538" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">December 9, 2017 at 5:41 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-422538" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>No, because of the “if” check on the 4th line down.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-422538" data-commentid="422538" data-postid="3349" data-belowelement="comment-422538" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-422524" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-422524" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/48a04ab0dabb1c812bbaa5d89d889f2d.png" srcset="https://secure.gravatar.com/avatar/48a04ab0dabb1c812bbaa5d89d889f2d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Olu</span>
	                <span class="date">December 9, 2017 at 3:17 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-422524" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Mr Brownlee,</p>
<p>Thank you for your tutorial. The training for the example worked however when I try to implement the code for the Wheat Seeds Dataset I get an error from my line 210:</p>
<p>for i in range(len(dataset[0]) – 1):<br>
    str_column_to_float(dataset, i)</p>
<p>The error is: IndexError: list index out of range</p>
<p>Can you please explain why it is (dataset[0])? Does (dataset[0]) means the 1st column in the dataset?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-422524" data-commentid="422524" data-postid="3349" data-belowelement="comment-422524" data-respondelement="respond" data-replyto="Reply to Olu" aria-label="Reply to Olu">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-422544" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-422544" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">December 9, 2017 at 5:45 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-422544" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, I recommend learning more about Python arrays here:<br>
<a href="https://machinelearningmastery.com/index-slice-reshape-numpy-arrays-machine-learning-python/" rel="nofollow ugc">https://machinelearningmastery.com/index-slice-reshape-numpy-arrays-machine-learning-python/</a></p>
<p>The example was written for Python 2.7, confirm your Python version.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-422544" data-commentid="422544" data-postid="3349" data-belowelement="comment-422544" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-422862" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-422862" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/8a063be39857787086c58ac99ea0e076.png" srcset="https://secure.gravatar.com/avatar/8a063be39857787086c58ac99ea0e076?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://optimistic.ninja/" rel="external nofollow ugc" class="url">Jonesy</a></span>
	                <span class="date">December 12, 2017 at 3:17 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-422862" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason,</p>
<p>Fantastic stuff here. I had a question about the network configuration. This 2 input, 2 hidden and 2 output seems a bit odd to me. I’m used to seeing 2, 2, 1 for XOR – can you explain why you have two output nodes and how they work with the max function? I think it would better explain this line for me in train():</p>
<p>expected[row[-1]] = 1</p>
<p>And lastly, why would one choose this configuration over a 2, 2, 1.</p>
<p>Thanks!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-422862" data-commentid="422862" data-postid="3349" data-belowelement="comment-422862" data-respondelement="respond" data-replyto="Reply to Jonesy" aria-label="Reply to Jonesy">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-422877" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-422877" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">December 12, 2017 at 4:12 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-422877" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The final model has the shape [7, 5, 3]. Perhaps check the tutorial again? It has 3 outputs, one for each of the 3 classes in the dataset.</p>
<p>Configuration was chosen via trial and error. There is no analytical way to choose a configuration for a neural network.</p>
<p>Finally, you can learn more about array indexing in Python here:<br>
<a href="https://machinelearningmastery.com/index-slice-reshape-numpy-arrays-machine-learning-python/" rel="nofollow ugc">https://machinelearningmastery.com/index-slice-reshape-numpy-arrays-machine-learning-python/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-422877" data-commentid="422877" data-postid="3349" data-belowelement="comment-422877" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-423629" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-423629" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/774946826d1ae794b3e0ceaf4e03f0bb.png" srcset="https://secure.gravatar.com/avatar/774946826d1ae794b3e0ceaf4e03f0bb?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Mohamed Elshazly</span>
	                <span class="date">December 17, 2017 at 9:34 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-423629" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason  </p>
<p>In the tain_network function  the line “expected[row[-1]] = 1”  what i understand is that you take the Y value of every row (which is either 0 or 1 ) and use it as an index in the expected array and you change the value at that index to 1   ,First i don’t know if i understand that correctly in the first place or not  but if so, Wouldn’t the modification to the expected array be locked down to just only the first and second index because “expected[row[-1]] = 1” would only be expected[0] or expected[1] ? and how would that help in our algorithm . </p>
<p>looking forward to your response   and thanks for the Great Tutorial</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-423629" data-commentid="423629" data-postid="3349" data-belowelement="comment-423629" data-respondelement="respond" data-replyto="Reply to Mohamed Elshazly" aria-label="Reply to Mohamed Elshazly">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-423671" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-423671" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">December 18, 2017 at 5:22 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-423671" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>We are one hot encoding the variable.</p>
<p>Learn more about it here:<br>
<a href="https://machinelearningmastery.com/why-one-hot-encode-data-in-machine-learning/" rel="nofollow ugc">https://machinelearningmastery.com/why-one-hot-encode-data-in-machine-learning/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-423671" data-commentid="423671" data-postid="3349" data-belowelement="comment-423671" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-423734" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-423734" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/774946826d1ae794b3e0ceaf4e03f0bb.png" srcset="https://secure.gravatar.com/avatar/774946826d1ae794b3e0ceaf4e03f0bb?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">MohamedElshazly</span>
	                <span class="date">December 18, 2017 at 4:55 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-423734" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>HI again Jason </p>
<p>  If I’m implementing this algorithm in python 3 what should i change in expected[row[-1]]=1  in order for it to work because I’m having this error : list assignment index out of range<br>
thanks in advance</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-423734" data-commentid="423734" data-postid="3349" data-belowelement="comment-423734" data-respondelement="respond" data-replyto="Reply to MohamedElshazly" aria-label="Reply to MohamedElshazly">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-423779" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-423779" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">December 19, 2017 at 5:15 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-423779" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I don’t know off the cuff, I will look into porting the example to Py3 in the new year.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-423779" data-commentid="423779" data-postid="3349" data-belowelement="comment-423779" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-423941" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-423941" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/aa6eacd3b9c219f3f48252f7a13e8d47.png" srcset="https://secure.gravatar.com/avatar/aa6eacd3b9c219f3f48252f7a13e8d47?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://www.tusharahuja.in/" rel="external nofollow ugc" class="url">Tushar</a></span>
	                <span class="date">December 19, 2017 at 5:29 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-423941" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You are just awesome Jason. You are adding more value to people’s ML skills than most average graduate schools do in the US.</p>
<p>Thanks a ton!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-423941" data-commentid="423941" data-postid="3349" data-belowelement="comment-423941" data-respondelement="respond" data-replyto="Reply to Tushar" aria-label="Reply to Tushar">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-424039" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-424039" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">December 20, 2017 at 5:39 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-424039" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Tushar.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-424039" data-commentid="424039" data-postid="3349" data-belowelement="comment-424039" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-425739" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-425739" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/e2571da49a2941dc5744d8a97012e700.png" srcset="https://secure.gravatar.com/avatar/e2571da49a2941dc5744d8a97012e700?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://n.a/" rel="external nofollow ugc" class="url">mark</a></span>
	                <span class="date">January 6, 2018 at 3:29 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-425739" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Wow, thanks for your codes. I have a question, what if I want to add regularisation term like L2 during back propagation, what should i do?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-425739" data-commentid="425739" data-postid="3349" data-belowelement="comment-425739" data-respondelement="respond" data-replyto="Reply to mark" aria-label="Reply to mark">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-425753" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-425753" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">January 6, 2018 at 5:55 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-425753" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I would recommend moving to a platform like Keras:<br>
<a href="https://machinelearningmastery.com/start-here/#deeplearning" rel="nofollow ugc">https://machinelearningmastery.com/start-here/#deeplearning</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-425753" data-commentid="425753" data-postid="3349" data-belowelement="comment-425753" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-425829" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-425829" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/e2571da49a2941dc5744d8a97012e700.png" srcset="https://secure.gravatar.com/avatar/e2571da49a2941dc5744d8a97012e700?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">mark</span>
	                <span class="date">January 7, 2018 at 5:12 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-425829" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for replying. I know the keras and have been using keras for a while. But in the problem I am focusing on, I need to make changes on the back propagation. That’s why I didn’t use keras.<br>
So let’s go back to my original question, is the error term the cost function? Thanks.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-425829" data-commentid="425829" data-postid="3349" data-belowelement="comment-425829" data-respondelement="respond" data-replyto="Reply to mark" aria-label="Reply to mark">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-425849" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-425849" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">January 8, 2018 at 5:42 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-425849" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I cannot work-through adding regularization to this tutorial for you.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-425849" data-commentid="425849" data-postid="3349" data-belowelement="comment-425849" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-427014" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-427014" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/9c7233c5e89a1b54b71d5d7c1dfbb874.png" srcset="https://secure.gravatar.com/avatar/9c7233c5e89a1b54b71d5d7c1dfbb874?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Mojo</span>
	                <span class="date">January 20, 2018 at 7:04 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-427014" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jeson,<br>
Thanks for the informative tutorial. I have a question.<br>
if i want to change the error equation and as well as the equation between input with hidden and hidden with output layer. How can i change it?<br>
Hope you will reply in a short time.</p>
<p>Regards,<br>
Mojo</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-427014" data-commentid="427014" data-postid="3349" data-belowelement="comment-427014" data-respondelement="respond" data-replyto="Reply to Mojo" aria-label="Reply to Mojo">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-427048" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-427048" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">January 21, 2018 at 9:08 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-427048" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I would recommend using a library instead, it will be much easier for you.</p>
<p>Here’s how to get started with Keras:<br>
<a href="https://machinelearningmastery.com/start-here/#deeplearning" rel="nofollow ugc">https://machinelearningmastery.com/start-here/#deeplearning</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-427048" data-commentid="427048" data-postid="3349" data-belowelement="comment-427048" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-429705" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-429705" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/735373561f6c85beb7025792afd12d08.png" srcset="https://secure.gravatar.com/avatar/735373561f6c85beb7025792afd12d08?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Aliya Anil</span>
	                <span class="date">February 16, 2018 at 9:04 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-429705" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>It was indeed a very informative tutorial. Could you please explain the need for seed(1) in the code?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-429705" data-commentid="429705" data-postid="3349" data-belowelement="comment-429705" data-respondelement="respond" data-replyto="Reply to Aliya Anil" aria-label="Reply to Aliya Anil">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-429751" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-429751" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">February 17, 2018 at 8:44 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-429751" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I am trying to tie down the random number generator so that you get the same results as me.</p>
<p>Learn more here:<br>
<a href="https://machinelearningmastery.com/randomness-in-machine-learning/" rel="nofollow ugc">https://machinelearningmastery.com/randomness-in-machine-learning/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-429751" data-commentid="429751" data-postid="3349" data-belowelement="comment-429751" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-429886" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-429886" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/05e9480f976efcbc71cff41646c0a515.png" srcset="https://secure.gravatar.com/avatar/05e9480f976efcbc71cff41646c0a515?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Raj</span>
	                <span class="date">February 19, 2018 at 7:10 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-429886" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hey there,<br>
Been following your tutorial and I’m having problems with using my dataset with it. The outputs of the hidden neurons appear to only be exactly 1 constantly. I’m not sure what’s wrong exactly or how to fix it but its resulting in the network not learning at all. Please let me know if you can help.<br>
Thanks,<br>
Raj</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-429886" data-commentid="429886" data-postid="3349" data-belowelement="comment-429886" data-respondelement="respond" data-replyto="Reply to Raj" aria-label="Reply to Raj">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-429909" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-429909" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">February 19, 2018 at 9:10 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-429909" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps try to get the code and data in the tutorial working first and use that as a starting point for your own problem.</p>
<p>Generally, I would recommend using a library like Keras for your own projects and only code methods from scratch as a learning exercise.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-429909" data-commentid="429909" data-postid="3349" data-belowelement="comment-429909" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-430009" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-430009" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/735373561f6c85beb7025792afd12d08.png" srcset="https://secure.gravatar.com/avatar/735373561f6c85beb7025792afd12d08?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Aliya Anil</span>
	                <span class="date">February 20, 2018 at 4:37 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-430009" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi,</p>
<p>I tried the first code in the tutorial with 4-parameter dataset, but it is not predicting like the 2-parameter set. Could you explain the reason?</p>
<p>Thanks,<br>
Aliya</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-430009" data-commentid="430009" data-postid="3349" data-belowelement="comment-430009" data-respondelement="respond" data-replyto="Reply to Aliya Anil" aria-label="Reply to Aliya Anil">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-430097" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-430097" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">February 21, 2018 at 6:36 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-430097" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>If you are looking to develop a neural network for your own data, I would recommend the Keras library:<br>
<a href="https://machinelearningmastery.com/start-here/#deeplearning" rel="nofollow ugc">https://machinelearningmastery.com/start-here/#deeplearning</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-430097" data-commentid="430097" data-postid="3349" data-belowelement="comment-430097" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-430881" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-430881" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/7504348e9916ae45e70974b27d0649fc.png" srcset="https://secure.gravatar.com/avatar/7504348e9916ae45e70974b27d0649fc?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Nik</span>
	                <span class="date">March 2, 2018 at 1:54 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-430881" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dear Jason,</p>
<p>Can I use the codes for handwritten digits recognition? If yes, are there any special recommendations what to change in the codes or I can use them with no changes?</p>
<p>Thanks,<br>
Nik</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-430881" data-commentid="430881" data-postid="3349" data-belowelement="comment-430881" data-respondelement="respond" data-replyto="Reply to Nik" aria-label="Reply to Nik">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-430894" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-430894" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 2, 2018 at 3:25 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-430894" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I would recommend this tutorial:<br>
<a href="https://machinelearningmastery.com/handwritten-digit-recognition-using-convolutional-neural-networks-python-keras/" rel="nofollow ugc">https://machinelearningmastery.com/handwritten-digit-recognition-using-convolutional-neural-networks-python-keras/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-430894" data-commentid="430894" data-postid="3349" data-belowelement="comment-430894" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-430908" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-430908" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/7504348e9916ae45e70974b27d0649fc.png" srcset="https://secure.gravatar.com/avatar/7504348e9916ae45e70974b27d0649fc?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Nik</span>
	                <span class="date">March 2, 2018 at 7:51 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-430908" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, I have seen that tutorial. But is there any way to use the codes from this tutorial? I just would like to understand why they work so well for seeds and do not work for handwritten digits…</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-430908" data-commentid="430908" data-postid="3349" data-belowelement="comment-430908" data-respondelement="respond" data-replyto="Reply to Nik" aria-label="Reply to Nik">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-430959" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-430959" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 3, 2018 at 8:10 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-430959" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, you can. You can develop a model with all pixels as inputs.</p>
<p>I cannot write the modification for you, sorry, I just don’t have the capacity.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-430959" data-commentid="430959" data-postid="3349" data-belowelement="comment-430959" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-431046" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-431046" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/bcb6fe38adcb6de87380acd8ee463024.png" srcset="https://secure.gravatar.com/avatar/bcb6fe38adcb6de87380acd8ee463024?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Filoingko</span>
	                <span class="date">March 4, 2018 at 2:58 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-431046" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, </p>
<p>How can I use this trained network to predict another data set. </p>
<p>Thank you.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-431046" data-commentid="431046" data-postid="3349" data-belowelement="comment-431046" data-respondelement="respond" data-replyto="Reply to Filoingko" aria-label="Reply to Filoingko">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-431076" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-431076" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 4, 2018 at 6:04 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-431076" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The code in this tutorial is to teach you about backprop, not for use on real problems. If you are working through a problem, I’d recommend using Keras.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-431076" data-commentid="431076" data-postid="3349" data-belowelement="comment-431076" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-431224" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-431224" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/f95f9040f79b6ca828fc515c45d81f58.png" srcset="https://secure.gravatar.com/avatar/f95f9040f79b6ca828fc515c45d81f58?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://www.info.univ-angers.fr/~richer/" rel="external nofollow ugc" class="url">Jean-Michel Richer</a></span>
	                <span class="date">March 5, 2018 at 9:27 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-431224" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dear Jason,<br>
  I have tried to use your code on a simple XOR example but get a result of [0, 0, 1, 1] instead of [0,1,1,0]<br>
Scores: [0.0]<br>
Mean Accuracy: 0.000%</p>
<p>The input xor.csv file is<br>
0,0,0<br>
0,1,1<br>
1,0,1<br>
1,1,0</p>
<p>For this I have modified the evaluate_algorithm function to:<br>
def evaluate_algorithm_no_fold(dataset, algorithm, *args):<br>
	scores = list()<br>
	predicted = algorithm(dataset, dataset, *args)<br>
	print(predicted)<br>
	accuracy = accuracy_metric(dataset, predicted)<br>
	scores.append(accuracy)<br>
	return scores</p>
<p>and call the function like this:<br>
scores = evaluate_algorithm_no_fold(dataset, back_propagation, 0.1, 500, 4)</p>
<p>Would you have some explanation because I can not figure out why it is not working ?<br>
Best regards,<br>
JM</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-431224" data-commentid="431224" data-postid="3349" data-belowelement="comment-431224" data-respondelement="respond" data-replyto="Reply to Jean-Michel Richer" aria-label="Reply to Jean-Michel Richer">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-431276" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-431276" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 6, 2018 at 6:12 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-431276" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps the model requires tuning to your new dataset.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-431276" data-commentid="431276" data-postid="3349" data-belowelement="comment-431276" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-431225" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-431225" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/8214979f8112bba72d66508128d32af6.png" srcset="https://secure.gravatar.com/avatar/8214979f8112bba72d66508128d32af6?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Tanveer</span>
	                <span class="date">March 5, 2018 at 9:29 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-431225" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank You So Much Jason !! Wonderful Tutorial. THANKS Much !!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-431225" data-commentid="431225" data-postid="3349" data-belowelement="comment-431225" data-respondelement="respond" data-replyto="Reply to Tanveer" aria-label="Reply to Tanveer">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-431277" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-431277" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 6, 2018 at 6:12 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-431277" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You’re welcome.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-431277" data-commentid="431277" data-postid="3349" data-belowelement="comment-431277" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-431697" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-431697" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/9c7233c5e89a1b54b71d5d7c1dfbb874.png" srcset="https://secure.gravatar.com/avatar/9c7233c5e89a1b54b71d5d7c1dfbb874?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Mojo</span>
	                <span class="date">March 9, 2018 at 10:06 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-431697" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>If i want to calculate the training accuracy and F-measure and want to change the activation function, how i can do it?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-431697" data-commentid="431697" data-postid="3349" data-belowelement="comment-431697" data-respondelement="respond" data-replyto="Reply to Mojo" aria-label="Reply to Mojo">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-431742" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-431742" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 10, 2018 at 6:28 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-431742" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps you would be better off using scikit-learn and Keras instead.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-431742" data-commentid="431742" data-postid="3349" data-belowelement="comment-431742" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-431941" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-431941" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/22ba6318aedec7368b6fb6c0a3f84d5e.png" srcset="https://secure.gravatar.com/avatar/22ba6318aedec7368b6fb6c0a3f84d5e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Fahad</span>
	                <span class="date">March 12, 2018 at 8:03 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-431941" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Is there something wrong with this code in case of using MINIST data? I tried to change the structured of the data to be compatible with the code, but it gave me a huge error and the error did not decrees during all training steps</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-431941" data-commentid="431941" data-postid="3349" data-belowelement="comment-431941" data-respondelement="respond" data-replyto="Reply to Fahad" aria-label="Reply to Fahad">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-431970" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-431970" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 13, 2018 at 6:25 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-431970" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The code was not developed for MNIST. Here is an example of working with MNIST:<br>
<a href="https://machinelearningmastery.com/handwritten-digit-recognition-using-convolutional-neural-networks-python-keras/" rel="nofollow ugc">http://machinelearningmastery.com/handwritten-digit-recognition-using-convolutional-neural-networks-python-keras/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-431970" data-commentid="431970" data-postid="3349" data-belowelement="comment-431970" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-432017" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-432017" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/22ba6318aedec7368b6fb6c0a3f84d5e.png" srcset="https://secure.gravatar.com/avatar/22ba6318aedec7368b6fb6c0a3f84d5e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Fahad</span>
	                <span class="date">March 13, 2018 at 4:06 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-432017" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Jason for your response. I want to apply the code without keras. I tried to change the structure of the data to be each row as a vector of 784 pixel followed by a class label, but as I said it gave a huge error and does not decrees at all. </p>
<p>I am trying to develop some algorithm for enhancing of learning, hence, I need to deal with the procedure as step by step. So keras or any other library does not help.</p>
<p>Thanks again Jason</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-432017" data-commentid="432017" data-postid="3349" data-belowelement="comment-432017" data-respondelement="respond" data-replyto="Reply to Fahad" aria-label="Reply to Fahad">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-432092" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-432092" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 14, 2018 at 6:17 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-432092" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps update the code to use numpy, it will be much faster.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-432092" data-commentid="432092" data-postid="3349" data-belowelement="comment-432092" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-432155" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-432155" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/0ae4b21a9cd4b9e4654236d18cf8df39.png" srcset="https://secure.gravatar.com/avatar/0ae4b21a9cd4b9e4654236d18cf8df39?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">kelvin</span>
	                <span class="date">March 15, 2018 at 2:39 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-432155" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Mr Brownlee,</p>
<p>Can you teach me how to plot the errors per epochs (validation error) and accuracy for both training and validation in your scratch network?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-432155" data-commentid="432155" data-postid="3349" data-belowelement="comment-432155" data-respondelement="respond" data-replyto="Reply to kelvin" aria-label="Reply to kelvin">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-432157" class="comment even depth-2">

	      	<div id="li-comment-432157" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/0ae4b21a9cd4b9e4654236d18cf8df39.png" srcset="https://secure.gravatar.com/avatar/0ae4b21a9cd4b9e4654236d18cf8df39?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">kelvin</span>
	                <span class="date">March 15, 2018 at 2:44 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-432157" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I only can find the training error but not validation error in the code. For the accuracy, I plot a graph have a straight line only.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-432157" data-commentid="432157" data-postid="3349" data-belowelement="comment-432157" data-respondelement="respond" data-replyto="Reply to kelvin" aria-label="Reply to kelvin">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-432177" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-432177" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 15, 2018 at 6:33 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-432177" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, you can do it easily in Keras here:<br>
<a href="https://machinelearningmastery.com/display-deep-learning-model-training-history-in-keras/" rel="nofollow ugc">https://machinelearningmastery.com/display-deep-learning-model-training-history-in-keras/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-432177" data-commentid="432177" data-postid="3349" data-belowelement="comment-432177" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-432204" class="comment even depth-3 parent">

	      	<div id="li-comment-432204" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/0ae4b21a9cd4b9e4654236d18cf8df39.png" srcset="https://secure.gravatar.com/avatar/0ae4b21a9cd4b9e4654236d18cf8df39?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">kelvin</span>
	                <span class="date">March 15, 2018 at 12:19 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-432204" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Is there any possible way to do it on your scratch network? for example which part of the code save the training error, validation error, training accuracy and validation accuracy? So I can plot the graph myself since your scratch model does not have “model” for me to save the history.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-432204" data-commentid="432204" data-postid="3349" data-belowelement="comment-432204" data-respondelement="respond" data-replyto="Reply to kelvin" aria-label="Reply to kelvin">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-432223" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-432223" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 15, 2018 at 2:50 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-432223" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, perhaps change it from CV to a single/train test, then evaluate the model skill on each dataset at the end of each epoch. Save the results in a list and return the lists.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-432223" data-commentid="432223" data-postid="3349" data-belowelement="comment-432223" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-484198" class="comment even depth-3 parent">

	      	<div id="li-comment-484198" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/b6f21963e4c0624a84c599adb50397e9.jpeg" srcset="https://secure.gravatar.com/avatar/b6f21963e4c0624a84c599adb50397e9?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Zahra</span>
	                <span class="date">May 6, 2019 at 9:37 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-484198" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello, I’m so confuse..<br>
I try to run this code in command prompt. But, I use my dataset (not Wheat Seeds dataset).</p>
<p>And why this happened? What’s wrong? What should I do? What should I change?<br>
Please, help me! 🙏🏻🙏🏻</p>
<p>Traceback (most recent call last):<br>
File “journal.py”, line 197, in<br>
scores = evaluate_algorithm(dataset, back_propagation, n_folds, l_rate, n_epoch, n_hidden)<br>
File “journal.py”, line 81, in evaluate_algorithm<br>
predicted = algorithm(train_set, test_set, *args)<br>
File “journal.py”, line 173, in back_propagation<br>
train_network(network, train, l_rate, n_epoch, n_outputs)<br>
File “journal.py”, line 150, in train_network<br>
expected[row[-1]] = 1<br>
IndexError: list assignment index out of range</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-484198" data-commentid="484198" data-postid="3349" data-belowelement="comment-484198" data-respondelement="respond" data-replyto="Reply to Zahra" aria-label="Reply to Zahra">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-484218" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-484218" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">May 6, 2019 at 2:33 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-484218" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I cannot debug your dataset.</p>
<p>Perhaps start with Keras for deep learning instead:<br>
<a href="https://machinelearningmastery.com/start-here/#deeplearning" rel="nofollow ugc">https://machinelearningmastery.com/start-here/#deeplearning</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-484218" data-commentid="484218" data-postid="3349" data-belowelement="comment-484218" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-432202" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-432202" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/44ddc273bbba48e477fc8e9e2a82f73a.jpeg" srcset="https://secure.gravatar.com/avatar/44ddc273bbba48e477fc8e9e2a82f73a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jack</span>
	                <span class="date">March 15, 2018 at 12:11 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-432202" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Can I use this model for regression problem? For example us this model for boston house-prices dataset?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-432202" data-commentid="432202" data-postid="3349" data-belowelement="comment-432202" data-respondelement="respond" data-replyto="Reply to Jack" aria-label="Reply to Jack">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-432222" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-432222" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 15, 2018 at 2:50 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-432222" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sure, some changes would be required, such as the activation in the output layer would need to be linear.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-432222" data-commentid="432222" data-postid="3349" data-belowelement="comment-432222" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-432230" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-432230" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/755e6112e94ffdd57a7c60bd3a487f13.png" srcset="https://secure.gravatar.com/avatar/755e6112e94ffdd57a7c60bd3a487f13?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Nabil</span>
	                <span class="date">March 15, 2018 at 3:49 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-432230" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Are you using MSE?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-432230" data-commentid="432230" data-postid="3349" data-belowelement="comment-432230" data-respondelement="respond" data-replyto="Reply to Nabil" aria-label="Reply to Nabil">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-432288" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-432288" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 16, 2018 at 6:09 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-432288" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>As mentioned in the post, we are reporting accuracy for the classification problem.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-432288" data-commentid="432288" data-postid="3349" data-belowelement="comment-432288" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-432619" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-432619" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/48a04ab0dabb1c812bbaa5d89d889f2d.png" srcset="https://secure.gravatar.com/avatar/48a04ab0dabb1c812bbaa5d89d889f2d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Olu</span>
	                <span class="date">March 19, 2018 at 11:23 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-432619" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>In the train section,</p>
<p></p>
		<div id="urvanov-syntax-highlighter-6060ca9c6ed4e336985795" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18.9915px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">def train_network(network, train, l_rate, n_epoch, n_outputs):
    for epoch in range(n_epoch):
        for row in train:
            outputs = forward_propagate(network, row)
            expected = [0 for i in range(n_outputs)]
            expected[row[-1]] = 1
            backward_propagate_error(network, expected)
            update_weights(network, row, l_rate)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c6ed4e336985795-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c6ed4e336985795-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c6ed4e336985795-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c6ed4e336985795-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c6ed4e336985795-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c6ed4e336985795-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c6ed4e336985795-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c6ed4e336985795-8">8</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c6ed4e336985795-1"><span class="crayon-e">def </span><span class="crayon-e">train_network</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">l_rate</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_epoch</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_outputs</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c6ed4e336985795-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">epoch </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_epoch</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c6ed4e336985795-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c6ed4e336985795-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">outputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">forward_propagate</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c6ed4e336985795-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">expected</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_outputs</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c6ed4e336985795-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">expected</span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c6ed4e336985795-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">backward_propagate_error</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">expected</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c6ed4e336985795-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">update_weights</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">l_rate</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p></p>
<p>Can you please explain how this expected[row[-1]] = 1 knows where to insert the 1 in the arrays of zero created.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-432619" data-commentid="432619" data-postid="3349" data-belowelement="comment-432619" data-respondelement="respond" data-replyto="Reply to Olu" aria-label="Reply to Olu">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-432666" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-432666" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 20, 2018 at 6:23 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-432666" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Good question.</p>
<p>expected is all zeros. row[-1] is the index of the class value. therefore we set the index of the class value in expected to 1.</p>
<p>Perhaps it is worth reading up on array indexing:<br>
<a href="https://machinelearningmastery.com/index-slice-reshape-numpy-arrays-machine-learning-python/" rel="nofollow ugc">https://machinelearningmastery.com/index-slice-reshape-numpy-arrays-machine-learning-python/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-432666" data-commentid="432666" data-postid="3349" data-belowelement="comment-432666" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-454958" class="comment even depth-3 parent">

	      	<div id="li-comment-454958" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/2f4916070de31c492fb264d8910c4cb3.png" srcset="https://secure.gravatar.com/avatar/2f4916070de31c492fb264d8910c4cb3?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">kmillen</span>
	                <span class="date">November 16, 2018 at 11:27 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-454958" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Jason,<br>
This is an amazing piece of code that has been very beneficial.</p>
<p>Doesn’t that mean that only expected[0] and expected[1] will ever be set to 1 for this test data?</p>
<p>Thank you,</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-454958" data-commentid="454958" data-postid="3349" data-belowelement="comment-454958" data-respondelement="respond" data-replyto="Reply to kmillen" aria-label="Reply to kmillen">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-454973" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4 parent">

	      	<div id="li-comment-454973" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">November 16, 2018 at 1:58 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-454973" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I don’t understand your question?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-454973" data-commentid="454973" data-postid="3349" data-belowelement="comment-454973" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-455042" class="comment even depth-5">

	      	<div id="li-comment-455042" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/2f4916070de31c492fb264d8910c4cb3.png" srcset="https://secure.gravatar.com/avatar/2f4916070de31c492fb264d8910c4cb3?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">kmillen</span>
	                <span class="date">November 17, 2018 at 1:44 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-455042" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>If I understand Python (which I may not), row[-1] represents the last item in the row. Since the last value in each of the 10 rows is only either 0 or 1, expected[row[-1]] = 1 will only ever set expected[0] or expected[1] to the value of 1. Or, what am I missing?</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-455079" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-455079" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">November 17, 2018 at 5:50 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-455079" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Are you referring to this: expected[row[-1]] = 1</p>
<p>If so:</p>
<p>“expected” is all zeros, e.g. [0, 0]<br>
“row” is an example, e.g. […] where the value at -1 is either 0 or 1</p>
<p>Therefore row[-1] is an index of either 0 or 1 and we are marking the value in expected at that index as 1.</p>
<p>We have created a one hot vector.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-455048" class="comment even depth-4">

	      	<div id="li-comment-455048" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/2f4916070de31c492fb264d8910c4cb3.png" srcset="https://secure.gravatar.com/avatar/2f4916070de31c492fb264d8910c4cb3?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">kmillen</span>
	                <span class="date">November 17, 2018 at 2:54 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-455048" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Disregard my previous question; I found the answer in a previous reply. Thank you again for this example.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-455048" data-commentid="455048" data-postid="3349" data-belowelement="comment-455048" data-respondelement="respond" data-replyto="Reply to kmillen" aria-label="Reply to kmillen">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-432741" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-432741" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/0ae4b21a9cd4b9e4654236d18cf8df39.png" srcset="https://secure.gravatar.com/avatar/0ae4b21a9cd4b9e4654236d18cf8df39?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">kelvin</span>
	                <span class="date">March 21, 2018 at 2:14 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-432741" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, I would like to use softmax as the activation function for output layer. However, I do not know how to write the code for the derivative of softmax. Can you show me the code how to change the sigmoid function from your code to softmax?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-432741" data-commentid="432741" data-postid="3349" data-belowelement="comment-432741" data-respondelement="respond" data-replyto="Reply to kelvin" aria-label="Reply to kelvin">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-432742" class="comment even depth-2 parent">

	      	<div id="li-comment-432742" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/0ae4b21a9cd4b9e4654236d18cf8df39.png" srcset="https://secure.gravatar.com/avatar/0ae4b21a9cd4b9e4654236d18cf8df39?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">kelvin</span>
	                <span class="date">March 21, 2018 at 2:20 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-432742" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I do try few ways to change the sigmoid to softmax, however, all of them are not working. Can you show me how to create a softmax layer?</p>
<p>for transfer():<br>
first case:<br>
def transfer(input_value):<br>
        exp_scores = np.exp(input_value)<br>
        return exp_scores / np.sum(exp_scores, axis=1, keepdims=True)</p>
<p>second case:<br>
def transfer(input_value):<br>
        input_value -= np.max(input_value)<br>
        return np.exp(input_value) / np.sum(np.exp(input_value))</p>
<p>third case:<br>
def transfer(input_value):<br>
        input_value -= np.max(input_value)<br>
        result = (np.exp(input_value).T / np.sum(np.exp(input_value))).T<br>
        return result</p>
<p>for transfer_derivative():<br>
first case:<br>
def transfer_derivative(output):<br>
       s = output.reshape(-1, 1)<br>
        return np.diagflat(s) – np.dot(s, s.T)</p>
<p>second case:<br>
def transfer_derivative(output):<br>
        jacobian_m = np.diag(output)<br>
        for i in range(len(jacobian_m)):<br>
            for j in range(len(jacobian_m)):<br>
                if i == j:<br>
                    jacobian_m[i][j] = output[i] * (1 – output[i])<br>
                else:<br>
                    jacobian_m[i][j] = -output[i] * output[j]<br>
        return jacobian_m</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-432742" data-commentid="432742" data-postid="3349" data-belowelement="comment-432742" data-respondelement="respond" data-replyto="Reply to kelvin" aria-label="Reply to kelvin">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-432771" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-3">

	      	<div id="li-comment-432771" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 21, 2018 at 6:39 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-432771" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Here you go:<br>
<a href="https://en.wikipedia.org/wiki/Softmax_function#Artificial_neural_networks" rel="nofollow ugc">https://en.wikipedia.org/wiki/Softmax_function#Artificial_neural_networks</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-432771" data-commentid="432771" data-postid="3349" data-belowelement="comment-432771" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-432770" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-432770" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 21, 2018 at 6:38 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-432770" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps use Keras instead?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-432770" data-commentid="432770" data-postid="3349" data-belowelement="comment-432770" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-433545" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-433545" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/1f44ac7a59dd09f3eb83e639a0b5ded8.png" srcset="https://secure.gravatar.com/avatar/1f44ac7a59dd09f3eb83e639a0b5ded8?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Suede</span>
	                <span class="date">March 29, 2018 at 6:40 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-433545" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>hey Jason, this is very helpful. I have run the code but i keep on getting this error, can you please help me out? the error is:</p>
<p>NameError                                 Traceback (most recent call last)<br>
 in ()<br>
    186         str_column_to_float(dataset, i)<br>
    187 # convert class column to integers<br>
–&gt; 188 str_columnto_int(dataset, len(dataset[0])-1)<br>
    189 # normalize input variables<br>
    190 minmax = dataset_minmax(dataset)</p>
<p>NameError: name ‘str_columnto_int’ is not defined</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-433545" data-commentid="433545" data-postid="3349" data-belowelement="comment-433545" data-respondelement="respond" data-replyto="Reply to Suede" aria-label="Reply to Suede">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-433550" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-433550" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 29, 2018 at 6:42 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-433550" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The code was written for Python 2.7, confirm that you are using this version of Python?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-433550" data-commentid="433550" data-postid="3349" data-belowelement="comment-433550" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-435047" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-435047" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/4bb4b72187cad374aebefc17d252f5a2.jpeg" srcset="https://secure.gravatar.com/avatar/4bb4b72187cad374aebefc17d252f5a2?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://fahriguresci.com/" rel="external nofollow ugc" class="url">Fahri Güreşçi</a></span>
	                <span class="date">April 15, 2018 at 7:03 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-435047" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The csv file is not working. Edited csv file &gt; bit.ly/2GYX2dF<br>
you can use python 2 or 3<br>
results:<br>
python2 &gt; Mean Accuracy: 95.238%<br>
python3 &gt; Mean Accuracy: 93.333%</p>
<p>Why different?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-435047" data-commentid="435047" data-postid="3349" data-belowelement="comment-435047" data-respondelement="respond" data-replyto="Reply to Fahri Güreşçi" aria-label="Reply to Fahri Güreşçi">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-435097" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-435097" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 16, 2018 at 6:00 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-435097" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Wh is the CSV file not working? The link appears to work fine.</p>
<p>Good question re the difference, no idea. Perhaps small differences in the API? The code was written for Py2, so it may require changes for py3.</p>
<p>Also, see this post on the stochastic nature of ml algorithms:<br>
<a href="https://machinelearningmastery.com/randomness-in-machine-learning/" rel="nofollow ugc">https://machinelearningmastery.com/randomness-in-machine-learning/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-435097" data-commentid="435097" data-postid="3349" data-belowelement="comment-435097" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-435339" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-435339" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/22ba6318aedec7368b6fb6c0a3f84d5e.png" srcset="https://secure.gravatar.com/avatar/22ba6318aedec7368b6fb6c0a3f84d5e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Fahad</span>
	                <span class="date">April 18, 2018 at 8:58 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-435339" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have altered the code to work with MNIST (digit numbers) , the problem I have faced that forward_propagate function returns [1 ,1 ,1 ,1 ,1 ,1 ,1 ,1 ,1 ,1 ]  for each instance !</p>
<p>Any help</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-435339" data-commentid="435339" data-postid="3349" data-belowelement="comment-435339" data-respondelement="respond" data-replyto="Reply to Fahad" aria-label="Reply to Fahad">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-435390" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-435390" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 19, 2018 at 6:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-435390" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Well done.</p>
<p>The model will require tuning for the problem.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-435390" data-commentid="435390" data-postid="3349" data-belowelement="comment-435390" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-435408" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-435408" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/22ba6318aedec7368b6fb6c0a3f84d5e.png" srcset="https://secure.gravatar.com/avatar/22ba6318aedec7368b6fb6c0a3f84d5e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Fahad</span>
	                <span class="date">April 19, 2018 at 7:09 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-435408" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Could you explain more in some details please.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-435408" data-commentid="435408" data-postid="3349" data-belowelement="comment-435408" data-respondelement="respond" data-replyto="Reply to Fahad" aria-label="Reply to Fahad">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-435428" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-435428" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 19, 2018 at 2:45 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-435428" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>What details exactly?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-435428" data-commentid="435428" data-postid="3349" data-belowelement="comment-435428" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-435446" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-435446" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/22ba6318aedec7368b6fb6c0a3f84d5e.png" srcset="https://secure.gravatar.com/avatar/22ba6318aedec7368b6fb6c0a3f84d5e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Fahad</span>
	                <span class="date">April 19, 2018 at 8:17 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-435446" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>As I mentioned that forward_propagation function returns [1,1,1,1,1,1,1,1,1,1], what is the possible alter to come over this problem</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-435446" data-commentid="435446" data-postid="3349" data-belowelement="comment-435446" data-respondelement="respond" data-replyto="Reply to Fahad" aria-label="Reply to Fahad">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-435477" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-435477" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 20, 2018 at 5:48 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-435477" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps tune the model to your specific problem. I have some suggestions here:<br>
<a href="https://machinelearningmastery.com/improve-deep-learning-performance/" rel="nofollow ugc">http://machinelearningmastery.com/improve-deep-learning-performance/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-435477" data-commentid="435477" data-postid="3349" data-belowelement="comment-435477" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-435665" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-435665" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/22ba6318aedec7368b6fb6c0a3f84d5e.png" srcset="https://secure.gravatar.com/avatar/22ba6318aedec7368b6fb6c0a3f84d5e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Fahad</span>
	                <span class="date">April 23, 2018 at 5:34 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-435665" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I altered the code to work with XOR problem and it was working perfectly. Then, I altered the code to work with digit numbers MNIST, but as I told you there was a problem with the the forward_propagation function that it returned all outputs to be [1,1,1,…] instead of a probabilities for each output.<br>
I think it is not an optimization problem, there is something wrong with the forward_propagate function.</p>
<p>Here is the code after alteration [it is working but with a fixed error during all training epochs</p>
<p>from random import seed<br>
from random import randrange<br>
from random import random<br>
from csv import reader<br>
from math import exp<br>
global network<br>
global gl_errors</p>
<p># Load a CSV file<br>
def load_csv(filename):<br>
	dataset = list()<br>
	with open(filename, ‘r’) as file:<br>
		csv_reader = reader(file)<br>
		for row in csv_reader:<br>
			if not row:<br>
				continue<br>
			dataset.append(row)<br>
	return dataset</p>
<p># Convert string column to float<br>
def str_column_to_float(dataset, column):<br>
	for row in dataset:<br>
		row[column] = float(row[column].strip())</p>
<p>def str_column_to_intX(dataset, column):<br>
	for row in dataset:<br>
		row[column] = int(row[column].strip())</p>
<p># Convert string column to integer<br>
def str_column_to_int(dataset, column):<br>
	class_values = [row[column] for row in dataset]<br>
	unique = set(class_values)<br>
	lookup = dict()<br>
	for i, value in enumerate(unique):<br>
		lookup[value] = i<br>
	for row in dataset:<br>
		row[column] = lookup[row[column]]<br>
	return lookup</p>
<p># Find the min and max values for each column<br>
def dataset_minmax(dataset):<br>
	minmax = list()<br>
	stats = [[min(column), max(column)] for column in zip(*dataset)]<br>
	return stats</p>
<p># Rescale dataset columns to the range 0-1<br>
def normalize_dataset(dataset):<br>
    for row in dataset:<br>
        for i in range(1,len(row)):<br>
#            row[i] = (row[i] – minmax[i][0]) / (minmax[i][1] – minmax[i][0])<br>
            if row[i]&gt;10:<br>
                row[i]=1<br>
            else:<br>
                row[i]=0</p>
<p># Split a dataset into k folds<br>
def cross_validation_split(dataset, n_folds):<br>
	dataset_split = list()<br>
	dataset_copy = list(dataset)<br>
	fold_size = int(len(dataset) / n_folds)<br>
	for i in range(n_folds):<br>
		fold = list()<br>
		while len(fold) epoch=%d, lrate=%.3f, error=%.3f’ % (epoch, l_rate, sum_error))</p>
<p># Calculate neuron activation for an input<br>
def activate(weights, inputs):</p>
<p>	activation = weights[-1]<br>
	for i in range(len(weights)-1):<br>
		activation += weights[i] * inputs[i]<br>
	return activation</p>
<p># Transfer neuron activation<br>
def transfer(activation):<br>
	return 1.0 / (1.0 + exp(-activation))</p>
<p># Forward propagate input to a network output<br>
def forward_propagate(network, row):<br>
    inputs = row[1:]<br>
    i=0</p>
<p>    for layer in network:<br>
        new_inputs = []<br>
        i+=1<br>
        for neuron in layer:<br>
            activation = activate(neuron[‘weights’], inputs)<br>
            neuron[‘output’] = transfer(activation)<br>
            new_inputs.append(neuron[‘output’])<br>
        inputs = new_inputs</p>
<p>    return inputs</p>
<p># Calculate the derivative of an neuron output<br>
def transfer_derivative(output):<br>
	return output * (1.0 – output)</p>
<p># Backpropagate error and store in neurons<br>
def backward_propagate_error(network, expected):<br>
#    err =0<br>
    for i in reversed(range(len(network))):<br>
        layer = network[i]<br>
        errors = list()<br>
        if i != len(network)-1:<br>
            for j in range(len(layer)):<br>
                error = 0.0<br>
                for neuron in network[i + 1]:<br>
                    error += (neuron[‘weights’][j] * neuron[‘delta’])<br>
                errors.append(error)<br>
        else:<br>
            for j in range(len(layer)):<br>
                neuron = layer[j]<br>
                errors.append(expected[j] – neuron[‘output’])</p>
<p>        for j in range(len(layer)):<br>
            neuron = layer[j]<br>
            neuron[‘delta’] = errors[j] * transfer_derivative(neuron[‘output’])</p>
<p># Update network weights with error<br>
def update_weights(network, row, l_rate):</p>
<p>	for i in range(len(network)):<br>
		inputs = row[1:]<br>
		if i != 0:<br>
			inputs = [neuron[‘output’] for neuron in network[i – 1]]<br>
		for neuron in network[i]:<br>
			for j in range(len(inputs)):<br>
				neuron[‘weights’][j] += l_rate * neuron[‘delta’] * inputs[j]<br>
			neuron[‘weights’][-1] += l_rate * neuron[‘delta’]</p>
<p># Initialize a network<br>
def initialize_network(n_inputs, n_hidden, n_outputs):<br>
    global network<br>
    network = list()<br>
    hidden_layer1 = [{‘weights’:[random() for i in range(n_inputs + 1)]} for i in range(n_hidden)]<br>
    network.append(hidden_layer1)</p>
<p>    hidden_layer2 = [{‘weights’:[random() for i in range(n_hidden + 1)]} for i in range(100)]<br>
    network.append(hidden_layer2)</p>
<p>    hidden_layer3 = [{‘weights’:[random() for i in range(100 + 1)]} for i in range(50)]<br>
    network.append(hidden_layer3)</p>
<p>    output_layer = [{‘weights’:[random() for i in range(50 + 1)]} for i in range(n_outputs)]<br>
    network.append(output_layer)<br>
    return network</p>
<p># Make a prediction with a network<br>
def predict(network, row):<br>
    outputs = forward_propagate(network, row)<br>
    return outputs.index(max(outputs)) </p>
<p># Test Backprop on Seeds dataset<br>
seed(1)<br>
# load and prepare data<br>
filename = ‘dataset/train2.csv’<br>
dataset = load_csv(filename)</p>
<p>for i in range(1,len(dataset[0])):<br>
	str_column_to_float(dataset, i)</p>
<p># convert class column to integers<br>
str_column_to_int(dataset, 0)</p>
<p>normalize_dataset(dataset)</p>
<p># evaluate algorithm<br>
n_folds = 5<br>
l_rate = 0.5<br>
n_epoch = 100<br>
n_hidden = 500</p>
<p>scores = evaluate_algorithm(dataset, back_propagation, n_folds, l_rate, n_epoch, n_hidden)<br>
print(‘Scores: %s’ % scores)<br>
print(‘Mean Accuracy: %.3f%%’ % (sum(scores)/float(len(scores))))</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-435665" data-commentid="435665" data-postid="3349" data-belowelement="comment-435665" data-respondelement="respond" data-replyto="Reply to Fahad" aria-label="Reply to Fahad">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-435681" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-435681" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 23, 2018 at 6:26 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-435681" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I don’t have the capacity to debug the modified code for you.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-435681" data-commentid="435681" data-postid="3349" data-belowelement="comment-435681" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-435926" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-435926" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/299f14931ecf1fd2e009e0fae8b52074.png" srcset="https://secure.gravatar.com/avatar/299f14931ecf1fd2e009e0fae8b52074?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Rahmad ars</span>
	                <span class="date">April 26, 2018 at 3:23 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-435926" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sir, can you help me?<br>
this is my question..</p>
<p><a href="https://stackoverflow.com/questions/50027886/need-help-for-check-my-backprop-ann-using-python" rel="nofollow ugc">https://stackoverflow.com/questions/50027886/need-help-for-check-my-backprop-ann-using-python</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-435926" data-commentid="435926" data-postid="3349" data-belowelement="comment-435926" data-respondelement="respond" data-replyto="Reply to Rahmad ars" aria-label="Reply to Rahmad ars">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-435970" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-435970" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 26, 2018 at 6:37 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-435970" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps you can summarize your question in a sentence or two?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-435970" data-commentid="435970" data-postid="3349" data-belowelement="comment-435970" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-435975" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-435975" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/299f14931ecf1fd2e009e0fae8b52074.png" srcset="https://secure.gravatar.com/avatar/299f14931ecf1fd2e009e0fae8b52074?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Rahmad ars</span>
	                <span class="date">April 26, 2018 at 7:19 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-435975" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>your original code sir, only have 1 hidden layer with 2 neurons. then, I modify it, so the ANN have 3 hidden layers, each consist of (128, 64, 32). and i have my own dataset, so i change it (the dataset and input neurons). when i run this code, everything looks fine but the error value is not changing…</p>
<p>here’s the screen: <a href="https://i.stack.imgur.com/NQbNd.png" rel="nofollow ugc">https://i.stack.imgur.com/NQbNd.png</a></p>
<p>modified code: <a href="https://stackoverflow.com/questions/50027886/need-help-for-check-my-backprop-ann-using-python" rel="nofollow ugc">https://stackoverflow.com/questions/50027886/need-help-for-check-my-backprop-ann-using-python</a></p>
<p>thanks sir</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-435975" data-commentid="435975" data-postid="3349" data-belowelement="comment-435975" data-respondelement="respond" data-replyto="Reply to Rahmad ars" aria-label="Reply to Rahmad ars">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-435997" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-435997" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 26, 2018 at 2:59 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-435997" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>If you are struggling with the code, I would recommend not coding the algorithm from scratch.</p>
<p>Instead, I would recommend using a library like Keras. Here is a worked example:<br>
<a href="https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/" rel="nofollow ugc">https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-435997" data-commentid="435997" data-postid="3349" data-belowelement="comment-435997" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-436195" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-436195" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/22ba6318aedec7368b6fb6c0a3f84d5e.png" srcset="https://secure.gravatar.com/avatar/22ba6318aedec7368b6fb6c0a3f84d5e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Fahad</span>
	                <span class="date">April 28, 2018 at 9:20 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-436195" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have the same problem of Rahmad</p>
<p>The same problem occurs when you change the original code from 5 neurons in the hidden layer to 31 neuron ( the error value does not change). </p>
<p>I know 31 hidden neuron is not a right number of neurons for seed data set. But I would like to know what is the wrong when you increase the number of neurons.</p>
<p>Logically, it should be fine and the error value decreases. But when you change the number of neurons to 30 it is still working , when change it to 31 neurons it does not decrease !</p>
<p>I think if this problem is fixed, then the problem of Rahmad will be fixed too.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-436195" data-commentid="436195" data-postid="3349" data-belowelement="comment-436195" data-respondelement="respond" data-replyto="Reply to Fahad" aria-label="Reply to Fahad">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-436225" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-436225" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 29, 2018 at 6:26 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-436225" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps the model requires tuning to your specific problem (e.g. layers, nodes, activation function, etc.)</p>
<p>It might be better to use a library like Keras for your project:<br>
<a href="https://machinelearningmastery.com/start-here/#deeplearning" rel="nofollow ugc">https://machinelearningmastery.com/start-here/#deeplearning</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-436225" data-commentid="436225" data-postid="3349" data-belowelement="comment-436225" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-436476" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-436476" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/ce7b36067c2dd43538c4799c1103be1b.png" srcset="https://secure.gravatar.com/avatar/ce7b36067c2dd43538c4799c1103be1b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Rocha</span>
	                <span class="date">May 2, 2018 at 9:58 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-436476" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi dude, I’m stuck in this error, could you help me?</p>
<p># Forward propagate input to a network output<br>
def forward_propagate(network, row):<br>
	inputs = row<br>
	for layer in network:<br>
		new_inputs = []<br>
		for neuron in layer:<br>
—&gt;&gt;&gt;		activation = activate(neuron[‘weights’], inputs)<br>
			neuron[‘output’] = transfer(activation)<br>
			new_inputs.append(neuron[‘output’])<br>
		inputs = new_inputs<br>
	return inputs</p>
<p>That line is giving me this: TypeError: list indices must be integers or slices, not str</p>
<p>Should be the python version? I’m using python 3…</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-436476" data-commentid="436476" data-postid="3349" data-belowelement="comment-436476" data-respondelement="respond" data-replyto="Reply to Rocha" aria-label="Reply to Rocha">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-436513" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-436513" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">May 3, 2018 at 6:33 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-436513" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This code was written for Python 2.7 sorry.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-436513" data-commentid="436513" data-postid="3349" data-belowelement="comment-436513" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-436927" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-436927" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/f27effc28daddcc0264d3b26be036d5c.png" srcset="https://secure.gravatar.com/avatar/f27effc28daddcc0264d3b26be036d5c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Kamrun Nahar Nisha</span>
	                <span class="date">May 8, 2018 at 4:00 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-436927" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>hello.please help me.<br>
I want to use breast cancer dataset instead of seed dataset. </p>
<p>seed(1)<br>
# load and prepare data<br>
filename = ‘seeds_dataset.csv’<br>
dataset = load_csv(filename)<br>
for i in range(len(dataset[0])-1):<br>
	str_column_to_float(dataset, i)<br>
# convert class column to integers<br>
str_column_to_int(dataset, len(dataset[0])-1)<br>
# normalize input variables<br>
minmax = dataset_minmax(dataset)<br>
normalize_dataset(dataset, minmax)<br>
# evaluate algorithm<br>
n_folds = 5<br>
l_rate = 0.3<br>
n_epoch = 500<br>
n_hidden = 5<br>
scores = evaluate_algorithm(dataset, back_propagation, n_folds, l_rate, n_epoch, n_hidden)<br>
print(‘Scores: %s’ % scores)<br>
print(‘Mean Accuracy: %.3f%%’ % (sum(scores)/float(len(scores))))</p>
<p>In this part of your code I also want to print the error and it will be like</p>
<p>epoch=0, lrate=0.500, error=6.350<br>
&gt;epoch=1, lrate=0.500, error=5.531<br>
&gt;epoch=2, lrate=0.500, error=5.221<br>
&gt;epoch=3, lrate=0.500, error=4.951<br>
&gt;epoch=4, lrate=0.500, error=4.519<br>
&gt;epoch=5, lrate=0.500, error=4.173<br>
&gt;epoch=6, lrate=0.500, error=3.835<br>
&gt;epoch=7, lrate=0.500, error=3.506<br>
&gt;epoch=8, lrate=0.500, error=3.192<br>
&gt;epoch=9, lrate=0.500, error=2.898<br>
&gt;epoch=10, lrate=0.500, error=2.626<br>
&gt;epoch=11, lrate=0.500, error=2.377<br>
&gt;epoch=12, lrate=0.500, error=2.153<br>
&gt;epoch=13, lrate=0.500, error=1.953<br>
&gt;epoch=14, lrate=0.500, error=1.774<br>
&gt;epoch=15, lrate=0.500, error=1.614<br>
&gt;epoch=16, lrate=0.500, error=1.472<br>
&gt;epoch=17, lrate=0.500, error=1.346<br>
&gt;epoch=18, lrate=0.500, error=1.233<br>
&gt;epoch=19, lrate=0.500, error=1.132<br>
[{‘output’: 0.029980305604426185, ‘weights’: [-1.4688375095432327, 1.850887325439514, 1.0858178629550297], ‘delta’: -0.0059546604162323625}, {‘output’: 0.9456229000211323, ‘weights’: [0.37711098142462157, -0.0625909894552989, 0.2765123702642716], ‘delta’: 0.0026279652850863837}]<br>
[{‘output’: 0.23648794202357587, ‘weights’: [2.515394649397849, -0.3391927502445985, -0.9671565426390275], ‘delta’: -0.04270059278364587}, {‘output’: 0.7790535202438367, ‘weights’: [-2.5584149848484263, 1.0036422106209202, 0.42383086467582715], ‘delta’: 0.03803132596437354}]</p>
<p>please tell me the code . Using breast cancer dataset not wheat seed dataset. I am not so good in coding that’s why I need your help immediately.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-436927" data-commentid="436927" data-postid="3349" data-belowelement="comment-436927" data-respondelement="respond" data-replyto="Reply to Kamrun Nahar Nisha" aria-label="Reply to Kamrun Nahar Nisha">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-436976" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-436976" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">May 9, 2018 at 6:09 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-436976" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I’m eager to help, but I do not have the capacity to outline the changes or write the code for you.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-436976" data-commentid="436976" data-postid="3349" data-belowelement="comment-436976" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-437162" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-437162" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/7d22a6579d5a4cb864b3af62ddf0f521.png" srcset="https://secure.gravatar.com/avatar/7d22a6579d5a4cb864b3af62ddf0f521?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Akefar</span>
	                <span class="date">May 11, 2018 at 4:41 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-437162" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>hi Jason,<br>
I tried your code in my data set ,shape of my data is (576,16) .the problem is </p>
<p>IndexError: list assignment index out of range</p>
<p>is there any need to change your code for (576,16) data shape .<br>
Thanks</p>
<p>—————————————————————————<br>
IndexError                                Traceback (most recent call last)<br>
 in ()<br>
    195 n_epoch = 500<br>
    196 n_hidden = 1<br>
–&gt; 197 scores = evaluate_algorithm(dataset, back_propagation, n_folds, l_rate, n_epoch, n_hidden)<br>
    198 print(‘Scores: %s’ % scores)<br>
    199 print(‘Mean Accuracy: %.3f%%’ % (sum(scores)/float(len(scores))))</p>
<p> in evaluate_algorithm(dataset, algorithm, n_folds, *args)<br>
     79                         test_set.append(row_copy)<br>
     80                         row_copy[-1] = None<br>
—&gt; 81                 predicted = algorithm(train_set, test_set, *args)<br>
     82                 actual = [row[-1] for row in fold]<br>
     83                 accuracy = accuracy_metric(actual, predicted)</p>
<p> in back_propagation(train, test, l_rate, n_epoch, n_hidden)<br>
    171         n_outputs = len(set([row[-1] for row in train]))<br>
    172         network = initialize_network(n_inputs, n_hidden, n_outputs)<br>
–&gt; 173         train_network(network, train, l_rate, n_epoch, n_outputs)<br>
    174         predictions = list()<br>
    175         for row in test:</p>
<p> in train_network(network, train, l_rate, n_epoch, n_outputs)<br>
    148                         outputs = forward_propagate(network, row)<br>
    149                         expected = [0 for i in range(n_outputs)]<br>
–&gt; 150                         expected[row[-1]] = 1<br>
    151                         backward_propagate_error(network, expected)<br>
    152                         update_weights(network, row, l_rate)</p>
<p>IndexError: list assignment index out of range</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-437162" data-commentid="437162" data-postid="3349" data-belowelement="comment-437162" data-respondelement="respond" data-replyto="Reply to Akefar" aria-label="Reply to Akefar">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-437186" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-437186" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">May 11, 2018 at 6:39 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-437186" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You may need to change your data to match the model or the model to match the data.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-437186" data-commentid="437186" data-postid="3349" data-belowelement="comment-437186" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-437427" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-437427" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/6fd8251ab680d739a19a1d104d9ccdc4.png" srcset="https://secure.gravatar.com/avatar/6fd8251ab680d739a19a1d104d9ccdc4?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Pradeep</span>
	                <span class="date">May 14, 2018 at 3:31 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-437427" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, I tried your code on the same sample dataset, i am getting the following type error in the function activate. I am doing it in python3.6. hope to hear from you soon</p>
<p>Traceback (most recent call last):<br>
  File “neural_network.py”, line 94, in<br>
    train_network(network, dataset, 0.5, 20, n_outputs)<br>
  File “neural_network.py”, line 76, in train_network<br>
    outputs = forward_propagate(network, row)<br>
  File “neural_network.py”, line 31, in forward_propagate<br>
    activation = activate(neuron[‘weights’], inputs)<br>
  File “neural_network.py”, line 18, in activate<br>
    activation += weights[i] * inputs[i]<br>
TypeError: can’t multiply sequence by non-int of type ‘float’</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-437427" data-commentid="437427" data-postid="3349" data-belowelement="comment-437427" data-respondelement="respond" data-replyto="Reply to Pradeep" aria-label="Reply to Pradeep">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-437458" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-437458" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">May 14, 2018 at 6:39 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-437458" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The code requires Python 2.7.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-437458" data-commentid="437458" data-postid="3349" data-belowelement="comment-437458" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-437787" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-437787" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/e881f540a747c2fc238dd9ac0c66b157.png" srcset="https://secure.gravatar.com/avatar/e881f540a747c2fc238dd9ac0c66b157?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Deepak D</span>
	                <span class="date">May 17, 2018 at 6:49 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-437787" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason Brownlee,</p>
<p>I tried your code and experienced the some error applying the Backpropagation algorithm to the wheat seeds dataset. I am using python 2.7.</p>
<p>Error type:</p>
<p>File “C:\Python27\programs\backpropagation.py”, line 186,<br>
in  str_column_to_float(dataset, i)</p>
<p>File “C:\Python27\programs\backpropagation.py”, line 22,<br>
in str_column_to_float     row[column] = float(row[column].strip())<br>
ValueError: could not convert string to float:</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-437787" data-commentid="437787" data-postid="3349" data-belowelement="comment-437787" data-respondelement="respond" data-replyto="Reply to Deepak D" aria-label="Reply to Deepak D">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-437829" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-437829" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">May 18, 2018 at 6:22 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-437829" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I am sorry to hear that, I have some suggestions here:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-437829" data-commentid="437829" data-postid="3349" data-belowelement="comment-437829" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-437901" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-437901" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/c6313461e27ed009989687ab27507dff.jpeg" srcset="https://secure.gravatar.com/avatar/c6313461e27ed009989687ab27507dff?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Dhanya Hegde</span>
	                <span class="date">May 19, 2018 at 1:53 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-437901" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hey Jason! Great work. Really helpful. I didn’t understand one part of your code. On what basis does predict function return the predicted value as 0 or 1, after taking the maximum of the two output neuron values?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-437901" data-commentid="437901" data-postid="3349" data-belowelement="comment-437901" data-respondelement="respond" data-replyto="Reply to Dhanya Hegde" aria-label="Reply to Dhanya Hegde">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-437930" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-437930" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">May 19, 2018 at 7:44 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-437930" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The summation of the activation is passed through a sigmoid transfer function.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-437930" data-commentid="437930" data-postid="3349" data-belowelement="comment-437930" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-438072" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-438072" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/c6313461e27ed009989687ab27507dff.jpeg" srcset="https://secure.gravatar.com/avatar/c6313461e27ed009989687ab27507dff?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://./" rel="external nofollow ugc" class="url">Dhanya Hegde</a></span>
	                <span class="date">May 21, 2018 at 3:37 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-438072" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I didn’t understand this part of the code</p>
<p>outputs.index(max(outputs)</p>
<p>Is one hot encoding used or binary classification?<br>
If so, how is the actual mapping done?<br>
And when is the iteration process stopped?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-438072" data-commentid="438072" data-postid="3349" data-belowelement="comment-438072" data-respondelement="respond" data-replyto="Reply to Dhanya Hegde" aria-label="Reply to Dhanya Hegde">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-438103" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-438103" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">May 21, 2018 at 6:35 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-438103" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>As stated in the text above the code, it returns an integer for the class with the largest probability.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-438103" data-commentid="438103" data-postid="3349" data-belowelement="comment-438103" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-438755" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-438755" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/c5964b1e36a53faf0c3ee1d72d509acd.png" srcset="https://secure.gravatar.com/avatar/c5964b1e36a53faf0c3ee1d72d509acd?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ionut</span>
	                <span class="date">May 27, 2018 at 12:05 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-438755" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi,</p>
<p>I’m a beginner in neural networks and I don’t understand the dataset from the section “4.2. Train Network”. Can anyone explain me what x1, x2 and y means?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-438755" data-commentid="438755" data-postid="3349" data-belowelement="comment-438755" data-respondelement="respond" data-replyto="Reply to Ionut" aria-label="Reply to Ionut">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-438786" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-438786" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">May 27, 2018 at 6:45 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-438786" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Input 1, input 2 and output.</p>
<p>Perhaps start here:<br>
<a href="https://machinelearningmastery.com/start-here/#algorithms" rel="nofollow ugc">https://machinelearningmastery.com/start-here/#algorithms</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-438786" data-commentid="438786" data-postid="3349" data-belowelement="comment-438786" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-438884" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-438884" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/5374c07f0b56e1d42053a0b0a803f224.png" srcset="https://secure.gravatar.com/avatar/5374c07f0b56e1d42053a0b0a803f224?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Rishik Mani</span>
	                <span class="date">May 28, 2018 at 7:26 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-438884" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, thank you for the highly informative post. But could you please clarify me upon this petty little issue.</p>
<p>In section 4.2 Train network, you considered n_inputs = len(dataset[0]) – 1. Why did you put a -1 here, while the number of the inputs should exactly be of the length of the dataset.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-438884" data-commentid="438884" data-postid="3349" data-belowelement="comment-438884" data-respondelement="respond" data-replyto="Reply to Rishik Mani" aria-label="Reply to Rishik Mani">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-438914" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-438914" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">May 28, 2018 at 2:32 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-438914" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>To exclude the output variable from the number of inputs.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-438914" data-commentid="438914" data-postid="3349" data-belowelement="comment-438914" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-439536" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-439536" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/03a747778ade225b77e92439146b7886.png" srcset="https://secure.gravatar.com/avatar/03a747778ade225b77e92439146b7886?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Samih Eisa</span>
	                <span class="date">June 2, 2018 at 9:13 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-439536" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you, jason.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-439536" data-commentid="439536" data-postid="3349" data-belowelement="comment-439536" data-respondelement="respond" data-replyto="Reply to Samih Eisa" aria-label="Reply to Samih Eisa">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-439591" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-439591" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">June 3, 2018 at 6:22 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-439591" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You’re welcome.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-439591" data-commentid="439591" data-postid="3349" data-belowelement="comment-439591" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-439801" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-439801" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/5c7013883e95ef081e12404c5436a3e6.png" srcset="https://secure.gravatar.com/avatar/5c7013883e95ef081e12404c5436a3e6?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://github.com/gknam" rel="external nofollow ugc" class="url">Kie Woo Nam</a></span>
	                <span class="date">June 5, 2018 at 3:01 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-439801" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p></p>
		<div id="urvanov-syntax-highlighter-6060ca9c6e901886830537" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18.9915px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># Update network weights with error
def update_weights(network, row, l_rate):
	for i in range(len(network)):
		inputs = row[:-1]
		if i != 0:
			inputs = [neuron['output'] for neuron in network[i - 1]]
		for neuron in network[i]:
			for j in range(len(inputs)):
				neuron['weights'][j] += l_rate * neuron['delta'] * inputs[j]
			neuron['weights'][-1] += l_rate * neuron['delta']</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c6e901886830537-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c6e901886830537-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c6e901886830537-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c6e901886830537-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c6e901886830537-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c6e901886830537-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c6e901886830537-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c6e901886830537-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c6e901886830537-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c6e901886830537-10">10</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c6e901886830537-1"><span class="crayon-p"># Update network weights with error</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c6e901886830537-2"><span class="crayon-e">def </span><span class="crayon-e">update_weights</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">l_rate</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c6e901886830537-3"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c6e901886830537-4"><span class="crayon-h">		</span><span class="crayon-v">inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c6e901886830537-5"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c6e901886830537-6"><span class="crayon-h">			</span><span class="crayon-v">inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">neuron </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c6e901886830537-7"><span class="crayon-h">		</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">neuron </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c6e901886830537-8"><span class="crayon-h">			</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">inputs</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c6e901886830537-9"><span class="crayon-h">				</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'weights'</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-e ">l_rate *</span><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'delta'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c6e901886830537-10"><span class="crayon-h">			</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'weights'</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-e ">l_rate *</span><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'delta'</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p></p>
<p>Hi,</p>
<p>I guess I’m likely mistaken, so please but when i != 0, isn’t the last line updating the last weight for the second time?</p>
<p>So, shouldn’t it be “inputs = [neuron[‘output’] for neuron in network[i – 1]][:-1]” (add “[:-1]]” at the end)?</p>
<p>If I’m wrong, I’ll read the code again more carefully, so please let me know.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-439801" data-commentid="439801" data-postid="3349" data-belowelement="comment-439801" data-respondelement="respond" data-replyto="Reply to Kie Woo Nam" aria-label="Reply to Kie Woo Nam">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-439837" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-439837" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">June 5, 2018 at 6:46 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-439837" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>No. There are more weights than inputs and the -1 index of the weights is the bias.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-439837" data-commentid="439837" data-postid="3349" data-belowelement="comment-439837" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-439891" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-439891" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/5c7013883e95ef081e12404c5436a3e6.png" srcset="https://secure.gravatar.com/avatar/5c7013883e95ef081e12404c5436a3e6?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://github.com/gknam" rel="external nofollow ugc" class="url">Kie Woo Nam</a></span>
	                <span class="date">June 5, 2018 at 7:06 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-439891" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Ah, right. Now I see it from “output_layer = [{‘weights’:[random() for i in range(n_hidden + 1)]} for i in range(n_outputs)]”.</p>
<p>Thank you for your quick reply.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-439891" data-commentid="439891" data-postid="3349" data-belowelement="comment-439891" data-respondelement="respond" data-replyto="Reply to Kie Woo Nam" aria-label="Reply to Kie Woo Nam">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-439939" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-439939" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">June 6, 2018 at 6:39 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-439939" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>No problem.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-439939" data-commentid="439939" data-postid="3349" data-belowelement="comment-439939" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-443058" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-443058" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/119a6951e13df5661987462b66d36b2a.png" srcset="https://secure.gravatar.com/avatar/119a6951e13df5661987462b66d36b2a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Thomas Specht</span>
	                <span class="date">July 10, 2018 at 4:46 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-443058" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Great tutorial to get into ML coding. I have one question:</p>
<p>What library would you recommend for projects and why? I want to use NN for regression problems.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-443058" data-commentid="443058" data-postid="3349" data-belowelement="comment-443058" data-respondelement="respond" data-replyto="Reply to Thomas Specht" aria-label="Reply to Thomas Specht">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-443091" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-443091" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">July 10, 2018 at 6:53 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-443091" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I recommend Keras because it is computationally efficient, fast for development and fun:<br>
<a href="https://machinelearningmastery.com/start-here/#deeplearning" rel="nofollow ugc">https://machinelearningmastery.com/start-here/#deeplearning</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-443091" data-commentid="443091" data-postid="3349" data-belowelement="comment-443091" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-445938" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-445938" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a105e85f2291c370973e906cc67ef051.png" srcset="https://secure.gravatar.com/avatar/a105e85f2291c370973e906cc67ef051?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Hugo B.</span>
	                <span class="date">August 13, 2018 at 1:29 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-445938" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason! Thank you for this tutorial.<br>
I try to implement the batch learning, but I have some questions about it…</p>
<p>– Computing the errors:<br>
Do I have to accumulate the errors (‘delta’) in backward_propagate_error() during one epoch and performing an average according to the number of back-propagations performed?</p>
<p>– Updating the weights:<br>
In train_network(), I call update_weights() for each epoch, but I don’t know which row(s) of train (dataset) I have to used. Currently I use only one row: train[0].</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-445938" data-commentid="445938" data-postid="3349" data-belowelement="comment-445938" data-respondelement="respond" data-replyto="Reply to Hugo B." aria-label="Reply to Hugo B.">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-446016" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-446016" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/ab04b70a617a9a2df7606a532ff323f0.png" srcset="https://secure.gravatar.com/avatar/ab04b70a617a9a2df7606a532ff323f0?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">elizabeth</span>
	                <span class="date">August 14, 2018 at 2:40 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-446016" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Sir<br>
Thank you so much for this article.<br>
Can you please tell me how i can solve this error:</p>
<p>   File “mlp8.py”, line 186, in<br>
    str_column_to_float(dataset, i)<br>
  File “mlp8.py”, line 22, in str_column_to_float<br>
    row[column] = float(row[column].strip())<br>
ValueError: could not convert string to float:</p>
<p>thankyou</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-446016" data-commentid="446016" data-postid="3349" data-belowelement="comment-446016" data-respondelement="respond" data-replyto="Reply to elizabeth" aria-label="Reply to elizabeth">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-446048" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-446048" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">August 14, 2018 at 6:22 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-446048" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have some suggestions here:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-446048" data-commentid="446048" data-postid="3349" data-belowelement="comment-446048" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-447148" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-447148" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/8d54987121a77d3f5755bed8357efb0a.png" srcset="https://secure.gravatar.com/avatar/8d54987121a77d3f5755bed8357efb0a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">STEPHEN OLADEJI</span>
	                <span class="date">August 28, 2018 at 10:35 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-447148" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dear Prof,</p>
<p>Thanks for this tutorial,<br>
Sir, I’ve gone through a lot of your project online and they are very superb. God bless you, sir.<br>
Sir. my question is as followings.<br>
1. I noticed that one WEKA 3.6, Artificial Immune System was removed because this was in version 1.8, Is it because there is no research prospect in the algorithm?<br>
2. I want to write python version for AIRS, CSCA, Genetic Algorithm can you help proofread  it sir so see if what I write is correct</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-447148" data-commentid="447148" data-postid="3349" data-belowelement="comment-447148" data-respondelement="respond" data-replyto="Reply to STEPHEN OLADEJI" aria-label="Reply to STEPHEN OLADEJI">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-447185" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-447185" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">August 29, 2018 at 8:11 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-447185" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have an implementation here that you can use:<br>
<a href="http://wekaclassalgos.sourceforge.net/" rel="nofollow ugc">http://wekaclassalgos.sourceforge.net/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-447185" data-commentid="447185" data-postid="3349" data-belowelement="comment-447185" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-448350" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-448350" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/4ced9b8066651b3cb5874e14a971eba6.png" srcset="https://secure.gravatar.com/avatar/4ced9b8066651b3cb5874e14a971eba6?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Tamara</span>
	                <span class="date">September 11, 2018 at 5:36 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-448350" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you so much for this tutorial.<br>
How to see the results of work a trained network in Python?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-448350" data-commentid="448350" data-postid="3349" data-belowelement="comment-448350" data-respondelement="respond" data-replyto="Reply to Tamara" aria-label="Reply to Tamara">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-448368" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-448368" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">September 11, 2018 at 6:34 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-448368" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>What do you mean exactly?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-448368" data-commentid="448368" data-postid="3349" data-belowelement="comment-448368" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-449612" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-449612" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/f5e9b95ca84c1b7932a5b9f1d928a27e.png" srcset="https://secure.gravatar.com/avatar/f5e9b95ca84c1b7932a5b9f1d928a27e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">ritu</span>
	                <span class="date">September 23, 2018 at 9:49 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-449612" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>How should I modify to code to always run for one output neuron in the output layer?<br>
eg. if the output class consist of only 2 output classes ‘1’ and ‘2’ , as per the above code 2 neurons will be created within the output layer, but what if I wanted a neural network to just have one neuron in the output layer.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-449612" data-commentid="449612" data-postid="3349" data-belowelement="comment-449612" data-respondelement="respond" data-replyto="Reply to ritu" aria-label="Reply to ritu">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-449654" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-449654" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">September 24, 2018 at 6:09 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-449654" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>If you are having trouble with this tutorial, I would encourage you to use Keras to develop neural network models.</p>
<p>You can get started here:<br>
<a href="https://machinelearningmastery.com/start-here/#python" rel="nofollow ugc">https://machinelearningmastery.com/start-here/#python</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-449654" data-commentid="449654" data-postid="3349" data-belowelement="comment-449654" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-449919" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-449919" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/2641a0a39da1a5a369448a6848d4c6bb.png" srcset="https://secure.gravatar.com/avatar/2641a0a39da1a5a369448a6848d4c6bb?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Parva</span>
	                <span class="date">September 27, 2018 at 9:04 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-449919" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Why is there just one output coming from layer 1 though it contains 2 neurons. Shouldn’t there be 2 outputs one from each neuron?</p>
<p> [{‘output’: 0.7105668883115941, ‘weights’: [0.13436424411240122, 0.8474337369372327, 0.763774618976614], ‘delta’: -0.0005348048046610517}]<br>
[{‘output’: 0.6213859615555266, ‘weights’: [0.2550690257394217, 0.49543508709194095], ‘delta’: -0.14619064683582808}, {‘output’: 0.6573693455986976, ‘weights’: [0.4494910647887381, 0.651592972722763], ‘delta’: 0.0771723774346327}]</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-449919" data-commentid="449919" data-postid="3349" data-belowelement="comment-449919" data-respondelement="respond" data-replyto="Reply to Parva" aria-label="Reply to Parva">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-449941" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-449941" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">September 27, 2018 at 2:47 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-449941" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Which step exactly are you having trouble with?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-449941" data-commentid="449941" data-postid="3349" data-belowelement="comment-449941" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-449974" class="comment even depth-3 parent">

	      	<div id="li-comment-449974" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/361f92a100abccd2f1866faa6c809ab4.png" srcset="https://secure.gravatar.com/avatar/361f92a100abccd2f1866faa6c809ab4?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Brian</span>
	                <span class="date">September 28, 2018 at 1:17 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-449974" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you for this example. It has helped me get past the block I had with the mathematical based descriptions and differential calculus related to back propagation.<br>
As I have been focusing on the back propagation portion of this example I have come up with an alternative version of  the ‘backward_propagate_error’ function that I think is a much more succinct and logical way to write this function.</p>
<p>Please find below</p>
<p></p>
		<div id="urvanov-syntax-highlighter-6060ca9c6e759010002222" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18.9915px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># Backpropagate error and store in neurons
def backward_propagate_error(network, expected):
	for i in reversed(range(len(network))):
		layer = network[i]
		for j in range(len(layer)):
			fromNeuron = layer[j]
			error = 0.0
			if i != len(network)-1:                           #This identifies all but the last (output) layer
				for toNeuron in network[i + 1]:
					error += (toNeuron['weights'][j] * toNeuron['delta'])
			else:                                             #This is the last (output) layer
				error = expected[j] - fromNeuron['output']
			fromNeuron['error'] = error
			fromNeuron['delta'] = error * transfer_derivative(fromNeuron['output'])</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c6e759010002222-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c6e759010002222-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c6e759010002222-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c6e759010002222-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c6e759010002222-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c6e759010002222-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c6e759010002222-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c6e759010002222-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c6e759010002222-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c6e759010002222-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c6e759010002222-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c6e759010002222-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c6e759010002222-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c6e759010002222-14">14</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c6e759010002222-1"><span class="crayon-p"># Backpropagate error and store in neurons</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c6e759010002222-2"><span class="crayon-e">def </span><span class="crayon-e">backward_propagate_error</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">expected</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c6e759010002222-3"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">reversed</span><span class="crayon-sy">(</span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c6e759010002222-4"><span class="crayon-h">		</span><span class="crayon-v">layer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c6e759010002222-5"><span class="crayon-h">		</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">layer</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c6e759010002222-6"><span class="crayon-h">			</span><span class="crayon-v">fromNeuron</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">layer</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c6e759010002222-7"><span class="crayon-h">			</span><span class="crayon-v">error</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.0</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c6e759010002222-8"><span class="crayon-h">			</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-o">:</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-p">#This identifies all but the last (output) layer</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c6e759010002222-9"><span class="crayon-h">				</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">toNeuron </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c6e759010002222-10"><span class="crayon-h">					</span><span class="crayon-v">error</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">toNeuron</span><span class="crayon-sy">[</span><span class="crayon-s">'weights'</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">toNeuron</span><span class="crayon-sy">[</span><span class="crayon-s">'delta'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c6e759010002222-11"><span class="crayon-h">			</span><span class="crayon-st">else</span><span class="crayon-o">:</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-p">#This is the last (output) layer</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c6e759010002222-12"><span class="crayon-h">				</span><span class="crayon-v">error</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">expected</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">fromNeuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c6e759010002222-13"><span class="crayon-h">			</span><span class="crayon-v">fromNeuron</span><span class="crayon-sy">[</span><span class="crayon-s">'error'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">error</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c6e759010002222-14"><span class="crayon-e">			</span><span class="crayon-v">fromNeuron</span><span class="crayon-sy">[</span><span class="crayon-s">'delta'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e ">error *</span><span class="crayon-h"> </span><span class="crayon-e">transfer_derivative</span><span class="crayon-sy">(</span><span class="crayon-v">fromNeuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-449974" data-commentid="449974" data-postid="3349" data-belowelement="comment-449974" data-respondelement="respond" data-replyto="Reply to Brian" aria-label="Reply to Brian">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-450000" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-450000" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">September 28, 2018 at 6:16 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-450000" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Cool!</p>
<p>Sorry, I don’t have the capacity to review your code.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-450000" data-commentid="450000" data-postid="3349" data-belowelement="comment-450000" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-450626" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-450626" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/361f92a100abccd2f1866faa6c809ab4.png" srcset="https://secure.gravatar.com/avatar/361f92a100abccd2f1866faa6c809ab4?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Brian</span>
	                <span class="date">October 4, 2018 at 2:59 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-450626" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Should not the formula for the error be<br>
sum_error += sum([0.5*(expected[i]-outputs[i])**2 for i in range(len(expected))])<br>
as apposed to<br>
sum_error += sum([(expected[i]-outputs[i])**2 for i in range(len(expected))])<br>
To correctly back propagate with the derivative?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-450626" data-commentid="450626" data-postid="3349" data-belowelement="comment-450626" data-respondelement="respond" data-replyto="Reply to Brian" aria-label="Reply to Brian">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-450649" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-450649" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">October 4, 2018 at 6:20 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-450649" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Why is that Brian?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-450649" data-commentid="450649" data-postid="3349" data-belowelement="comment-450649" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-451146" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-451146" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a92f4c928e3c1aa433ae095f99a27568.png" srcset="https://secure.gravatar.com/avatar/a92f4c928e3c1aa433ae095f99a27568?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">KS</span>
	                <span class="date">October 10, 2018 at 2:15 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-451146" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Can you please tell me how to inplant tanh and ReLu?<br>
I tried to find examples on the internet, but I couldn’t find good examples.</p>
<p>I understand that these 2 codes need to be changed:</p>
<p># Transfer neuron activation<br>
def transfer(activation):<br>
	return 1.0 / (1.0 + exp(-activation))</p>
<p># Calculate the derivative of an neuron output<br>
def transfer_derivative(output):<br>
	return output * (1.0 – output)</p>
<p>1. What is the code when using tanh?<br>
2. What is the code when using ReLu?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-451146" data-commentid="451146" data-postid="3349" data-belowelement="comment-451146" data-respondelement="respond" data-replyto="Reply to KS" aria-label="Reply to KS">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-451181" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-451181" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">October 10, 2018 at 6:15 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-451181" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for the suggestion, sorry, I don’t have the capacity to make these changes for you.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-451181" data-commentid="451181" data-postid="3349" data-belowelement="comment-451181" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-529639" class="comment even depth-2 parent">

	      	<div id="li-comment-529639" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/ecb86436e868fc53fa343a2bf8fe9ce7.png" srcset="https://secure.gravatar.com/avatar/ecb86436e868fc53fa343a2bf8fe9ce7?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">audrey</span>
	                <span class="date">April 14, 2020 at 5:42 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-529639" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>did you find something about Relu?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-529639" data-commentid="529639" data-postid="3349" data-belowelement="comment-529639" data-respondelement="respond" data-replyto="Reply to audrey" aria-label="Reply to audrey">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-529676" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-3">

	      	<div id="li-comment-529676" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 14, 2020 at 6:31 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-529676" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>See thus tutorial:<br>
<a href="https://machinelearningmastery.com/rectified-linear-activation-function-for-deep-learning-neural-networks/" rel="nofollow ugc">https://machinelearningmastery.com/rectified-linear-activation-function-for-deep-learning-neural-networks/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-529676" data-commentid="529676" data-postid="3349" data-belowelement="comment-529676" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-451222" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-451222" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/ed0876828fe1921270d73720d1b32095.png" srcset="https://secure.gravatar.com/avatar/ed0876828fe1921270d73720d1b32095?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">moe</span>
	                <span class="date">October 10, 2018 at 7:08 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-451222" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you so much, 1 – 5 helped me to built my own generic network. Now i have a MLP network which i can easily adjust with a few parameter changes, wouldnt have been so easy with your example.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-451222" data-commentid="451222" data-postid="3349" data-belowelement="comment-451222" data-respondelement="respond" data-replyto="Reply to moe" aria-label="Reply to moe">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-451292" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-451292" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">October 11, 2018 at 7:51 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-451292" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Well done!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-451292" data-commentid="451292" data-postid="3349" data-belowelement="comment-451292" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-451271" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-451271" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/6e670f522ad802964e2e484f67051451.png" srcset="https://secure.gravatar.com/avatar/6e670f522ad802964e2e484f67051451?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Anwar</span>
	                <span class="date">October 11, 2018 at 3:35 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-451271" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I am running the same code that u have provided on python 3.6 and getting these errors please help me:-</p>
<p>—————————————————————————————————————————</p>
<p>IndexError                                Traceback (most recent call last)<br>
 in ()<br>
     16 n_epoch = 500<br>
     17 n_hidden = 5<br>
—&gt; 18 scores = evaluate_algorithm(dataset, back_propagation, n_folds, l_rate, n_epoch, n_hidden)<br>
     19 print(‘Scores: %s’ % scores)<br>
     20 print(‘Mean Accuracy: %.3f%%’ % (sum(scores)/float(len(scores))))</p>
<p> in evaluate_algorithm(dataset, algorithm, n_folds, *args)<br>
     12             test_set.append(row_copy)<br>
     13             row_copy[-1] = None<br>
—&gt; 14         predicted = algorithm(train_set, test_set, *args)<br>
     15         actual = [row[-1] for row in fold]<br>
     16         accuracy = accuracy_metric(actual, predicted)</p>
<p> in back_propagation(train, test, l_rate, n_epoch, n_hidden)<br>
      4     n_outputs = len(set([row[-1] for row in train]))<br>
      5     network = initialize_network(n_inputs, n_hidden, n_outputs)<br>
—-&gt; 6     train_network(network, train, l_rate, n_epoch, n_outputs)<br>
      7     predictions = list()<br>
      8     for row in test:</p>
<p> in train_network(network, train, l_rate, n_epoch, n_outputs)<br>
      5             outputs = forward_propagate(network, row)<br>
      6             expected = [0 for i in range(n_outputs)]<br>
—-&gt; 7             expected[row[-1]] = 1<br>
      8             backward_propagate_error(network, expected)<br>
      9             update_weights(network, row, l_rate)<br>
IndexError: list assignment index out of range</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-451271" data-commentid="451271" data-postid="3349" data-belowelement="comment-451271" data-respondelement="respond" data-replyto="Reply to Anwar" aria-label="Reply to Anwar">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-451307" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-451307" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">October 11, 2018 at 8:00 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-451307" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have some suggestions here:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-451307" data-commentid="451307" data-postid="3349" data-belowelement="comment-451307" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-451428" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-451428" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/f3c53b087faea28e5e53294b38ba0f47.png" srcset="https://secure.gravatar.com/avatar/f3c53b087faea28e5e53294b38ba0f47?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">KS</span>
	                <span class="date">October 12, 2018 at 11:33 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-451428" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>How to:<br>
“Regression. Change the network so that there is only one neuron in the output layer and that a real value is predicted.”</p>
<p>How to get 1 output layer?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-451428" data-commentid="451428" data-postid="3349" data-belowelement="comment-451428" data-respondelement="respond" data-replyto="Reply to KS" aria-label="Reply to KS">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-451512" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-451512" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">October 13, 2018 at 6:06 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-451512" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Coding algorithms from scratch is not for beginners.</p>
<p>I strongly encourage you to use Keras, for example:<br>
<a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/" rel="nofollow ugc">https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-451512" data-commentid="451512" data-postid="3349" data-belowelement="comment-451512" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-451754" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-451754" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/7dbaf4305bc8adde504dcf56e6a05050.png" srcset="https://secure.gravatar.com/avatar/7dbaf4305bc8adde504dcf56e6a05050?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jerry</span>
	                <span class="date">October 16, 2018 at 9:08 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-451754" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Ok, just following up. I still don’t get how the backprop is updating:</p>
<p></p>
		<div id="urvanov-syntax-highlighter-6060ca9c6e5ea352889444" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18.9915px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">        for row in train:
            outputs = forward_propagate(network, row, alpha)
            expected = [0 for i in range(n_outputs)]
            expected[row[-1]] = 1
            sum_error += sum([(expected[i]-outputs[i])**2 for i in range(len(expected))])
            backward_propagate_error(network, expected, alpha)
            update_weights(network, row, l_rate)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c6e5ea352889444-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c6e5ea352889444-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c6e5ea352889444-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c6e5ea352889444-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c6e5ea352889444-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c6e5ea352889444-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c6e5ea352889444-7">7</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c6e5ea352889444-1"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c6e5ea352889444-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">outputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">forward_propagate</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">alpha</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c6e5ea352889444-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">expected</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_outputs</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c6e5ea352889444-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">expected</span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c6e5ea352889444-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">sum_error</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-e">sum</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-v">expected</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-o">-</span><span class="crayon-v">outputs</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">expected</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c6e5ea352889444-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">backward_propagate_error</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">expected</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">alpha</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c6e5ea352889444-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">update_weights</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">l_rate</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p></p>
<p>1. No return statement or ‘global network’ for backward_propagate_error or update_network to actually incorporate the new weights. </p>
<p>My question, are you sure this uses back-propagation? How are the weights saved and updated for each epoch?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-451754" data-commentid="451754" data-postid="3349" data-belowelement="comment-451754" data-respondelement="respond" data-replyto="Reply to Jerry" aria-label="Reply to Jerry">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-451767" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-451767" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">October 16, 2018 at 2:34 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-451767" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The weights are passed in by reference and modified in place.</p>
<p>Perhaps using Keras would be a better fit Jerry:<br>
<a href="https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/" rel="nofollow ugc">https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-451767" data-commentid="451767" data-postid="3349" data-belowelement="comment-451767" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-454335" class="comment even depth-3 parent">

	      	<div id="li-comment-454335" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/7dbaf4305bc8adde504dcf56e6a05050.png" srcset="https://secure.gravatar.com/avatar/7dbaf4305bc8adde504dcf56e6a05050?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jerry</span>
	                <span class="date">November 10, 2018 at 11:53 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-454335" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You learn something new everyday! I was always under the impression that values were immutable when passing to a function in Python. </p>
<p><a href="https://stackoverflow.com/questions/986006/how-do-i-pass-a-variable-by-reference" rel="nofollow ugc">https://stackoverflow.com/questions/986006/how-do-i-pass-a-variable-by-reference</a></p>
<p>Thank you Jason! I’m really amazed on how active you are on this site. Just so you know, you and your work are referenced often in my MSDS program. </p>
<p>One area that I think would also be beneficial is some work on hidden node activations and their interpretations. The majority of our work is not so much on the output/accuracy of the NN, but more of visualizing weights, activations, and determining the features that are causing nodes to activate.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-454335" data-commentid="454335" data-postid="3349" data-belowelement="comment-454335" data-respondelement="respond" data-replyto="Reply to Jerry" aria-label="Reply to Jerry">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-454373" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-454373" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">November 11, 2018 at 6:08 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-454373" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks, happy to help.</p>
<p>Why do you want to view/understand the dynamics of nodes in hidden layers?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-454373" data-commentid="454373" data-postid="3349" data-belowelement="comment-454373" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-453276" class="comment even depth-2 parent">

	      	<div id="li-comment-453276" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/ed0876828fe1921270d73720d1b32095.png" srcset="https://secure.gravatar.com/avatar/ed0876828fe1921270d73720d1b32095?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">ben</span>
	                <span class="date">October 31, 2018 at 9:47 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-453276" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>i think this is not correct:<br>
sum_error += sum([(expected[i]-outputs[i])**2 for i in range(len(expected))])</p>
<p>shouldn´t this be:<br>
sum_error += sum([abs(0.5*(expected[i]-outputs[i])**2) for i in range(len(expected))])</p>
<p>see <a href="https://goo.gl/iqHJf6" rel="nofollow ugc">https://goo.gl/iqHJf6</a> page 233 (5.11).</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-453276" data-commentid="453276" data-postid="3349" data-belowelement="comment-453276" data-respondelement="respond" data-replyto="Reply to ben" aria-label="Reply to ben">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-453308" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-3">

	      	<div id="li-comment-453308" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">November 1, 2018 at 6:11 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-453308" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This implementation is based on the book “Neural Smithing”:<br>
<a href="https://www.amazon.com/Neural-Smithing-Supervised-Feedforward-Artificial/dp/0262527014/ref=as_li_ss_tl?ie=UTF8&amp;linkCode=sl1&amp;tag=inspiredalgor-20&amp;linkId=e3db0b57249093a94ebb073983bc8b4d&amp;language=en_US" rel="nofollow ugc">https://www.amazon.com/Neural-Smithing-Supervised-Feedforward-Artificial/dp/0262527014/ref=as_li_ss_tl?ie=UTF8&amp;linkCode=sl1&amp;tag=inspiredalgor-20&amp;linkId=e3db0b57249093a94ebb073983bc8b4d&amp;language=en_US</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-453308" data-commentid="453308" data-postid="3349" data-belowelement="comment-453308" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-452149" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-452149" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/8dac031bfc3405398650e56f521249a6.png" srcset="https://secure.gravatar.com/avatar/8dac031bfc3405398650e56f521249a6?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ayhan</span>
	                <span class="date">October 20, 2018 at 1:43 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-452149" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hey Jason, first thnx for the efforts. </p>
<p>Maybe one thing:<br>
wouldnt it be better (especially for beginners to that topic) to at least use<br>
something like numpy which would at least let all the matrix calculation look<br>
a bit more compact (and therefore possible to concentrate on the real topic .. which is<br>
backprop i would have guessed)?</p>
<p>Ok the title sais ‘implement from scratch’ but I would say at some point getting<br>
the point towards backprop is maybe more important than being able to say that<br>
it was implemented from scratch (using nothing but plain python). </p>
<p>Greets</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-452149" data-commentid="452149" data-postid="3349" data-belowelement="comment-452149" data-respondelement="respond" data-replyto="Reply to Ayhan" aria-label="Reply to Ayhan">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-452164" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-452164" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">October 20, 2018 at 5:57 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-452164" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for the feedback.</p>
<p>This example is not intended for writing operational code, for that I would recommend Keras:<br>
<a href="https://machinelearningmastery.com/start-here/#deeplearning" rel="nofollow ugc">https://machinelearningmastery.com/start-here/#deeplearning</a></p>
<p>This tutorial is to teach how to develop a net (training and evaluation) without any dependencies other than the standard lib.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-452164" data-commentid="452164" data-postid="3349" data-belowelement="comment-452164" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-453576" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-453576" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/5f4e5cfcb0dec0bfee4bdf796297eba5.png" srcset="https://secure.gravatar.com/avatar/5f4e5cfcb0dec0bfee4bdf796297eba5?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Vadim</span>
	                <span class="date">November 3, 2018 at 11:10 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-453576" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Just Brilliant stuff</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-453576" data-commentid="453576" data-postid="3349" data-belowelement="comment-453576" data-respondelement="respond" data-replyto="Reply to Vadim" aria-label="Reply to Vadim">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-453604" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-453604" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">November 4, 2018 at 6:27 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-453604" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-453604" data-commentid="453604" data-postid="3349" data-belowelement="comment-453604" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-454771" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-454771" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a93de98e99fcad50853f112a1f10398d.png" srcset="https://secure.gravatar.com/avatar/a93de98e99fcad50853f112a1f10398d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Himanshu</span>
	                <span class="date">November 14, 2018 at 10:38 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-454771" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason<br>
how i can use forward and backward propagation in real time data. I mean data in which we have multiple field. Fields contains Numerical values , floating values , String Values.<br>
For an example if i want to use this technique for Titanic data how can i use it.</p>
<p>How can i decide how many hidden layers should be there.<br>
How can i decide for learning rate.<br>
How can i decide for what should be the seed value.<br>
How can i decide for weights for such huge data.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-454771" data-commentid="454771" data-postid="3349" data-belowelement="comment-454771" data-respondelement="respond" data-replyto="Reply to Himanshu" aria-label="Reply to Himanshu">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-454801" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-454801" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">November 15, 2018 at 5:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-454801" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You must use careful experimentation to get answers to each of these questions.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-454801" data-commentid="454801" data-postid="3349" data-belowelement="comment-454801" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-454867" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-454867" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/b7595fa008656daf201ec2d404b6ee9d.png" srcset="https://secure.gravatar.com/avatar/b7595fa008656daf201ec2d404b6ee9d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Himanshu</span>
	                <span class="date">November 15, 2018 at 6:12 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-454867" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason<br>
I have few more questions on this.</p>
<p>First: why you assigned “activation = weights[-1]” , why not other weights or any random value.<br>
Second: why you are looping only for two values<br>
 for i in range(len(weights) – 1) though we have three values.<br>
Third: Why you have considered only two outputs here though we have four<br>
output for layer one =.9643898158763548<br>
output for layer two =.9185258960543243<br>
output for layer three = .8094918973879515<br>
output for layer two = .7734292563511262</p>
<p>why you considered only last two values why not first two or any other combination.</p>
<p>Four: here i guess some problem by mistake you have update wrong value<br>
expected[row[-1]] = 1<br>
after this line you have updated expected as [1,0] from [0,0]<br>
and why we in this i have other question why we are updating this value.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-454867" data-commentid="454867" data-postid="3349" data-belowelement="comment-454867" data-respondelement="respond" data-replyto="Reply to Himanshu" aria-label="Reply to Himanshu">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-454925" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-454925" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">November 16, 2018 at 6:12 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-454925" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Too many questions for one comment (I’m a simple human), one at a time and can you please reference specific examples/lines of code otherwise I can’t help.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-454925" data-commentid="454925" data-postid="3349" data-belowelement="comment-454925" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-455251" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-455251" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/b09e3a90a7eb03e595bc85bc56ed779d.png" srcset="https://secure.gravatar.com/avatar/b09e3a90a7eb03e595bc85bc56ed779d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Karim</span>
	                <span class="date">November 18, 2018 at 8:14 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-455251" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason — How can i add more hidden layers? Thankx</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-455251" data-commentid="455251" data-postid="3349" data-belowelement="comment-455251" data-respondelement="respond" data-replyto="Reply to Karim" aria-label="Reply to Karim">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-455426" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-455426" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">November 19, 2018 at 6:41 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-455426" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I recommend using Keras to develop your network:<br>
<a href="https://machinelearningmastery.com/start-here/#deeplearning" rel="nofollow ugc">https://machinelearningmastery.com/start-here/#deeplearning</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-455426" data-commentid="455426" data-postid="3349" data-belowelement="comment-455426" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-455842" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-455842" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/b7595fa008656daf201ec2d404b6ee9d.png" srcset="https://secure.gravatar.com/avatar/b7595fa008656daf201ec2d404b6ee9d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Himanshu</span>
	                <span class="date">November 22, 2018 at 5:24 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-455842" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>How to apply mathematical implementation of gradient descent and logistic regression,classification  in real time data.<br>
For example if i want use this in survivors of Titanic data how to start with.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-455842" data-commentid="455842" data-postid="3349" data-belowelement="comment-455842" data-respondelement="respond" data-replyto="Reply to Himanshu" aria-label="Reply to Himanshu">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-455884" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-455884" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">November 23, 2018 at 7:44 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-455884" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Here’s an example:<br>
<a href="https://machinelearningmastery.com/implement-logistic-regression-stochastic-gradient-descent-scratch-python/" rel="nofollow ugc">https://machinelearningmastery.com/implement-logistic-regression-stochastic-gradient-descent-scratch-python/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-455884" data-commentid="455884" data-postid="3349" data-belowelement="comment-455884" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-457560" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-457560" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/074558898f91bbddfc6289d40f7a07f8.png" srcset="https://secure.gravatar.com/avatar/074558898f91bbddfc6289d40f7a07f8?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">John Sald</span>
	                <span class="date">December 6, 2018 at 2:05 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-457560" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello, could you show me an example of using one of the extensions you mentioned, which can give us a gain in performance?</p>
<p>Such as using matrix operations (in the weights) and vectors (inputs, intermediate signals and outputs)</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-457560" data-commentid="457560" data-postid="3349" data-belowelement="comment-457560" data-respondelement="respond" data-replyto="Reply to John Sald" aria-label="Reply to John Sald">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-457691" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-457691" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">December 7, 2018 at 5:16 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-457691" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for the suggestion.</p>
<p>If you’re looking to go deeper into neural nets, I recommend using a library like Keras. You can start here:<br>
<a href="https://machinelearningmastery.com/start-here/#deeplearning" rel="nofollow ugc">https://machinelearningmastery.com/start-here/#deeplearning</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-457691" data-commentid="457691" data-postid="3349" data-belowelement="comment-457691" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-458835" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-458835" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/3285e63c2bc3f7ddb47e4d8e10694f03.png" srcset="https://secure.gravatar.com/avatar/3285e63c2bc3f7ddb47e4d8e10694f03?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Pipo</span>
	                <span class="date">December 17, 2018 at 7:25 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-458835" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>How could i change the loss to mse in this code? I can’t wrap my head around it. Thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-458835" data-commentid="458835" data-postid="3349" data-belowelement="comment-458835" data-respondelement="respond" data-replyto="Reply to Pipo" aria-label="Reply to Pipo">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-458865" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-458865" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">December 17, 2018 at 2:13 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-458865" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Calculate error between actual and predicted using a MSE function. That’s it.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-458865" data-commentid="458865" data-postid="3349" data-belowelement="comment-458865" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-498209" class="comment even depth-3 parent">

	      	<div id="li-comment-498209" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/dcde9f5a6d8a5c431a23a1740c7477a9.png" srcset="https://secure.gravatar.com/avatar/dcde9f5a6d8a5c431a23a1740c7477a9?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Brett</span>
	                <span class="date">August 24, 2019 at 4:07 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-498209" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I’m confused about why you chose MSE for a classification problem. I was trying to use this tutorial to discern the differences between a classification and function approximation implementation, and the use of MSE for classification really threw me off. I know that it technically works, but it’s probably good to mention that it’s not ideal. It would have been nice to get exposure to taking the derivative of a different loss function, so that someone who is new to back-propagation will start to grasp how different functions change the derivative, etc. Otherwise, the code is understandable and could be modified slightly to make a good tutorial for function approximation.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-498209" data-commentid="498209" data-postid="3349" data-belowelement="comment-498209" data-respondelement="respond" data-replyto="Reply to Brett" aria-label="Reply to Brett">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-498211" class="comment odd alt depth-4 parent">

	      	<div id="li-comment-498211" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/dcde9f5a6d8a5c431a23a1740c7477a9.png" srcset="https://secure.gravatar.com/avatar/dcde9f5a6d8a5c431a23a1740c7477a9?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Brett</span>
	                <span class="date">August 24, 2019 at 4:19 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-498211" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Just to clarify what I’m saying, and to answer Pipo’s question, this implementation is already using MSE. The derivative of MSE with respect to the output is: (output – expected). The fact that you’re multiplying this by the transfer derivative just means that you’re passing the MSE back through the activation of the output node. So if you want the code to work for function approximation, you simply don’t multiply by the transfer derivative. However, if you want classification to work better, you could use the derivative of a different loss function with respect to the output and predicted, and multiply that by your transfer derivative.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-498211" data-commentid="498211" data-postid="3349" data-belowelement="comment-498211" data-respondelement="respond" data-replyto="Reply to Brett" aria-label="Reply to Brett">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-498252" class="comment byuser comment-author-jasonb bypostauthor even depth-5">

	      	<div id="li-comment-498252" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">August 24, 2019 at 7:59 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-498252" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Agreed!</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-498250" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4 parent">

	      	<div id="li-comment-498250" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">August 24, 2019 at 7:58 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-498250" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, it was what we did in the 90s. Cross entropy would be preferred today, I agree.</p>
<p>I really need to do a series on coding neural nets from scratch to really dig into this. Thanks for the kick!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-498250" data-commentid="498250" data-postid="3349" data-belowelement="comment-498250" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-498260" class="comment even depth-5">

	      	<div id="li-comment-498260" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/dcde9f5a6d8a5c431a23a1740c7477a9.png" srcset="https://secure.gravatar.com/avatar/dcde9f5a6d8a5c431a23a1740c7477a9?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Brett</span>
	                <span class="date">August 24, 2019 at 9:26 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-498260" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for the reply. I just found this post on finding the derivative of cross entropy, and it turns out that you can do a really nice simplification of the math to basically get (output – expected) or (expected – output) for your implementation, when combining the cross entropy derivative and sigmoid derivative. So I’m pretty sure that if you simply stop multiplying by the transfer derivative to get your output error, you should see a big increase in performance of the algorithm. Worth a try at least. Here is the link, with the conclusion I mentioned at the very end:</p>
<p><a href="https://peterroelants.github.io/posts/cross-entropy-logistic/" rel="nofollow ugc">https://peterroelants.github.io/posts/cross-entropy-logistic/</a></p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-498402" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-498402" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">August 25, 2019 at 6:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-498402" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for sharing.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-459421" class="comment even thread-even depth-1">

	      	<div id="li-comment-459421" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/475527709087bc7cdda804dd06fea675.png" srcset="https://secure.gravatar.com/avatar/475527709087bc7cdda804dd06fea675?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">muhammad</span>
	                <span class="date">December 21, 2018 at 8:48 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-459421" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>hi, thanks for this code.<br>
I’m trying to understand why are u adding on the update weights, shouldnt be<br>
wi←wi−η∂E/∂wi like this?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-459421" data-commentid="459421" data-postid="3349" data-belowelement="comment-459421" data-respondelement="respond" data-replyto="Reply to muhammad" aria-label="Reply to muhammad">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-464254" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-464254" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/8c17121627059cc66fdcad3242b9af16.png" srcset="https://secure.gravatar.com/avatar/8c17121627059cc66fdcad3242b9af16?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sangeeth</span>
	                <span class="date">January 20, 2019 at 4:40 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-464254" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi,</p>
<p> This website provides a good introduction for almost all topics in machine learning. Thanks for your work. </p>
<p>In backpropagation, the error at each neuron is the product of<br>
1. Change in error w.r.t y_out<br>
2. Change in y_out w.r.t y<br>
3. Change in y w.r.t weight.</p>
<p>Could you please tell how you just multiplied 1 and 2 in backward_propagate_error (from the last layer) and then used 3 in update_weights (from the first layer). Should we not do all steps in backward_propagate_error and then use it to update_weights?.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-464254" data-commentid="464254" data-postid="3349" data-belowelement="comment-464254" data-respondelement="respond" data-replyto="Reply to Sangeeth" aria-label="Reply to Sangeeth">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-464272" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-464272" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">January 20, 2019 at 5:41 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-464272" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I show exactly how in the above tutorial.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-464272" data-commentid="464272" data-postid="3349" data-belowelement="comment-464272" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-464274" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-464274" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/8c17121627059cc66fdcad3242b9af16.png" srcset="https://secure.gravatar.com/avatar/8c17121627059cc66fdcad3242b9af16?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">sangeeth</span>
	                <span class="date">January 20, 2019 at 5:44 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-464274" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I just realized what I said is same as what you did.</p>
<p>About the error, should we not use 2*error (derivative of MSE)?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-464274" data-commentid="464274" data-postid="3349" data-belowelement="comment-464274" data-respondelement="respond" data-replyto="Reply to sangeeth" aria-label="Reply to sangeeth">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-464376" class="comment byuser comment-author-jasonb bypostauthor even depth-4 parent">

	      	<div id="li-comment-464376" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">January 21, 2019 at 5:26 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-464376" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>No, we calculate the derivative of the error against the non linear activation function, not the derivative of the loss function itself.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-464376" data-commentid="464376" data-postid="3349" data-belowelement="comment-464376" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-464424" class="comment odd alt depth-5">

	      	<div id="li-comment-464424" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/8c17121627059cc66fdcad3242b9af16.png" srcset="https://secure.gravatar.com/avatar/8c17121627059cc66fdcad3242b9af16?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">sangeeth</span>
	                <span class="date">January 21, 2019 at 12:11 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-464424" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Ok. I got it. Thanks,</p>
<p>I think this is online learning using SGD. Would you have an implementation for offline learning using mini Batch Gradient descent?</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-464498" class="comment byuser comment-author-jasonb bypostauthor even depth-5">

	      	<div id="li-comment-464498" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">January 22, 2019 at 6:16 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-464498" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Correct, you can modify the above example to use batch or mini-batch gradient descent.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-464478" class="comment odd alt depth-5">

	      	<div id="li-comment-464478" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/8c17121627059cc66fdcad3242b9af16.png" srcset="https://secure.gravatar.com/avatar/8c17121627059cc66fdcad3242b9af16?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">sangeeth</span>
	                <span class="date">January 22, 2019 at 1:14 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-464478" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Is the sum_error variable same as loss in model.fit output?..I get different loss values when testing the same datasets on model.fit and your model. Could you tell me why this is?</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-464513" class="comment byuser comment-author-jasonb bypostauthor even depth-5">

	      	<div id="li-comment-464513" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">January 22, 2019 at 6:25 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-464513" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, see this post:<br>
<a href="https://machinelearningmastery.com/randomness-in-machine-learning/" rel="nofollow ugc">https://machinelearningmastery.com/randomness-in-machine-learning/</a></p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-498213" class="comment odd alt depth-4">

	      	<div id="li-comment-498213" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/dcde9f5a6d8a5c431a23a1740c7477a9.png" srcset="https://secure.gravatar.com/avatar/dcde9f5a6d8a5c431a23a1740c7477a9?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Brett</span>
	                <span class="date">August 24, 2019 at 4:25 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-498213" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The loss function used in this tutorial is: (1/2)(out – expect)^2. The derivative of which with respect to the output is: (out – expect) * 1, or simply (out – expected). This is then multiplied by the transfer derivative, because the error is being passed backward via the chain rule. You always have to take the derivative with respect to the loss function itself first. I hope this clears up any confusion.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-498213" data-commentid="498213" data-postid="3349" data-belowelement="comment-498213" data-respondelement="respond" data-replyto="Reply to Brett" aria-label="Reply to Brett">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-464529" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-464529" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/72cf5bf5b7ecc4830eec6413ce019dff.png" srcset="https://secure.gravatar.com/avatar/72cf5bf5b7ecc4830eec6413ce019dff?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Gary</span>
	                <span class="date">January 22, 2019 at 8:54 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-464529" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason.</p>
<p>In the “full” seeds example you call user defined function evaluate_algorithm(). However, the “heavy lifting” inside it is performed by the function algorithm(). That function looks like it’s a part of some standard Python library, but I can’t find it in any reference. Also you don’t comment at all at its use. </p>
<p>What’s the deal here?</p>
<p>Thank you,</p>
<p>Gary</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-464529" data-commentid="464529" data-postid="3349" data-belowelement="comment-464529" data-respondelement="respond" data-replyto="Reply to Gary" aria-label="Reply to Gary">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-464545" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-464545" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">January 22, 2019 at 11:43 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-464545" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The “algorithm” is a reference to a function that is passed in as an argument.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-464545" data-commentid="464545" data-postid="3349" data-belowelement="comment-464545" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-464556" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-464556" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/72cf5bf5b7ecc4830eec6413ce019dff.png" srcset="https://secure.gravatar.com/avatar/72cf5bf5b7ecc4830eec6413ce019dff?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Gary</span>
	                <span class="date">January 22, 2019 at 1:24 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-464556" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, thank you, I already realized that.</p>
<p>Regards,</p>
<p>Gary</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-464556" data-commentid="464556" data-postid="3349" data-belowelement="comment-464556" data-respondelement="respond" data-replyto="Reply to Gary" aria-label="Reply to Gary">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-465278" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-465278" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/8c17121627059cc66fdcad3242b9af16.png" srcset="https://secure.gravatar.com/avatar/8c17121627059cc66fdcad3242b9af16?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">sangeeth</span>
	                <span class="date">January 28, 2019 at 8:39 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-465278" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi,</p>
<p>For online machine learning, should we perform epochs?. Should not we update the model based only on the present time input and then predict the next time step. If we do epochs that means the model is getting updated for the whole data set up to the present time. Am I correct?. Thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-465278" data-commentid="465278" data-postid="3349" data-belowelement="comment-465278" data-respondelement="respond" data-replyto="Reply to sangeeth" aria-label="Reply to sangeeth">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-465289" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-465289" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">January 28, 2019 at 11:44 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-465289" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It depends on the problem and the data. Yes, if often makes sense to update the model with new data and with a little of the old data.</p>
<p>Note, online gradient descent does not have to be used for online learning.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-465289" data-commentid="465289" data-postid="3349" data-belowelement="comment-465289" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-467953" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-467953" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/2f4916070de31c492fb264d8910c4cb3.png" srcset="https://secure.gravatar.com/avatar/2f4916070de31c492fb264d8910c4cb3?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">kmillen</span>
	                <span class="date">February 12, 2019 at 10:49 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-467953" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Good afternoon Jason. I have thoroughly enjoyed this solution both in Python and my conversion to C#. I guess for all the learning I’ve gleaned, one thing still seems to be a mystery to me. What exactly are the five scores telling me? Do they annotate how well the data fits a curve for each fold?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-467953" data-commentid="467953" data-postid="3349" data-belowelement="comment-467953" data-respondelement="respond" data-replyto="Reply to kmillen" aria-label="Reply to kmillen">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-467967" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-467967" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">February 12, 2019 at 1:59 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-467967" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Correct. </p>
<p>The mean of the scores is our estimate of the model’s performance when making predictions on unseen data.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-467967" data-commentid="467967" data-postid="3349" data-belowelement="comment-467967" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-470677" class="comment odd alt depth-3">

	      	<div id="li-comment-470677" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/2f4916070de31c492fb264d8910c4cb3.png" srcset="https://secure.gravatar.com/avatar/2f4916070de31c492fb264d8910c4cb3?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">kmillen</span>
	                <span class="date">February 26, 2019 at 8:10 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-470677" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-470677" data-commentid="470677" data-postid="3349" data-belowelement="comment-470677" data-respondelement="respond" data-replyto="Reply to kmillen" aria-label="Reply to kmillen">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-469383" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-469383" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/631978b15a9f6be38bcf5825d5c267f8.png" srcset="https://secure.gravatar.com/avatar/631978b15a9f6be38bcf5825d5c267f8?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">MathewP</span>
	                <span class="date">February 20, 2019 at 3:25 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-469383" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I think there is a mistake update_weights function.<br>
inputs = row[:-1]<br>
If we have, say 2 inputs and 1 neuron in hidden layer then only one weight is going to be updated, which is clearly wrong. Correct me if I am wrong. The code works fine just taking row as inputs.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-469383" data-commentid="469383" data-postid="3349" data-belowelement="comment-469383" data-respondelement="respond" data-replyto="Reply to MathewP" aria-label="Reply to MathewP">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-469418" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-469418" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">February 20, 2019 at 8:11 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-469418" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I don’t follow the possible issue, can you please elaborate?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-469418" data-commentid="469418" data-postid="3349" data-belowelement="comment-469418" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-506506" class="comment even depth-3 parent">

	      	<div id="li-comment-506506" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/54ac0ce62560d92fc53d761891259d4a.png" srcset="https://secure.gravatar.com/avatar/54ac0ce62560d92fc53d761891259d4a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Romel Rudon</span>
	                <span class="date">October 20, 2019 at 11:25 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-506506" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The issue is that the ‘row’ list should represent the outputs from the preceding layer (counting in the direction from input layer to output layer). having row[:-1] seems to exclude the very last output from the preceding layer, which doesn’t seem to be warranted in this case.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-506506" data-commentid="506506" data-postid="3349" data-belowelement="comment-506506" data-respondelement="respond" data-replyto="Reply to Romel Rudon" aria-label="Reply to Romel Rudon">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-506530" class="comment odd alt depth-4 parent">

	      	<div id="li-comment-506530" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/54ac0ce62560d92fc53d761891259d4a.png" srcset="https://secure.gravatar.com/avatar/54ac0ce62560d92fc53d761891259d4a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Romel Rudon</span>
	                <span class="date">October 21, 2019 at 2:05 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-506530" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I see now why a few people (including myself) were thrown off by this line. The last element of the row list ( i.e. row[-1]) is not an actual part of the input data, but the label or the ‘correct answer’ of the input data, which is why it’s left out. </p>
<p>Cheers.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-506530" data-commentid="506530" data-postid="3349" data-belowelement="comment-506530" data-respondelement="respond" data-replyto="Reply to Romel Rudon" aria-label="Reply to Romel Rudon">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-506577" class="comment byuser comment-author-jasonb bypostauthor even depth-5">

	      	<div id="li-comment-506577" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">October 21, 2019 at 6:19 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-506577" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-469794" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-469794" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/dd37870b011abdf6c3b2be93009ea41b.png" srcset="https://secure.gravatar.com/avatar/dd37870b011abdf6c3b2be93009ea41b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Venkat</span>
	                <span class="date">February 22, 2019 at 4:53 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-469794" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason Brownlee, back propagation implementation really excellent ,because of   without using any  predefined library just use functions  list, set, and dictionary. I need a suggestion how to write a code for implement activation function like a sigmoidal at hidden layer neurons  and a tangent at output neurons.  could u help me.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-469794" data-commentid="469794" data-postid="3349" data-belowelement="comment-469794" data-respondelement="respond" data-replyto="Reply to Venkat" aria-label="Reply to Venkat">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-469830" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-469830" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">February 22, 2019 at 6:25 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-469830" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, you can use the above as a starting point.</p>
<p>More on tanh here:<br>
<a href="https://en.wikipedia.org/wiki/Hyperbolic_function" rel="nofollow ugc">https://en.wikipedia.org/wiki/Hyperbolic_function</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-469830" data-commentid="469830" data-postid="3349" data-belowelement="comment-469830" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-469875" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-469875" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/dd37870b011abdf6c3b2be93009ea41b.png" srcset="https://secure.gravatar.com/avatar/dd37870b011abdf6c3b2be93009ea41b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Venkat</span>
	                <span class="date">February 22, 2019 at 4:49 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-469875" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason Brownlee,   yes , iam not asking how to write code for implementation of tanh, sigmoidial . My  request is how to modified code in forward_propagate function to implement  suppose x is a activation at hidden layer and y is another activation function at output layer. </p>
<p></p>
		<div id="urvanov-syntax-highlighter-6060ca9c6e1dc433163583" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18.9915px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">def forward_propagate(network, row):
   inputs =row  
   for layer in network:
      new_inputs = []
      for neuron in layer:
        activation = activate(neuron['weights'], inputs)
        neuron['output'] = transfer(activation)
        new_inputs.append(neuron['output'])
      inputs = new_inputs    
   return inputs</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c6e1dc433163583-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c6e1dc433163583-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c6e1dc433163583-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c6e1dc433163583-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c6e1dc433163583-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c6e1dc433163583-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c6e1dc433163583-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c6e1dc433163583-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c6e1dc433163583-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c6e1dc433163583-10">10</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c6e1dc433163583-1"><span class="crayon-e">def </span><span class="crayon-e">forward_propagate</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c6e1dc433163583-2"><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-v">inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-e">row&nbsp;&nbsp;</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c6e1dc433163583-3"><span class="crayon-e">&nbsp;&nbsp; </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">layer </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c6e1dc433163583-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">new_inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c6e1dc433163583-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">neuron </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">layer</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c6e1dc433163583-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">activate</span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'weights'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c6e1dc433163583-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">transfer</span><span class="crayon-sy">(</span><span class="crayon-v">activation</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c6e1dc433163583-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">new_inputs</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c6e1dc433163583-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">new_inputs&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c6e1dc433163583-10"><span class="crayon-e">&nbsp;&nbsp; </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p></p>
<p>in the above code u r calling  transfer  function for the  hidden neurons and also output neurons . I request u to give suggestion to call different activation functions  for hidden  and output neurons.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-469875" data-commentid="469875" data-postid="3349" data-belowelement="comment-469875" data-respondelement="respond" data-replyto="Reply to Venkat" aria-label="Reply to Venkat">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-469954" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-469954" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">February 23, 2019 at 6:26 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-469954" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Change the code in the activation function itself.</p>
<p>Does that help?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-469954" data-commentid="469954" data-postid="3349" data-belowelement="comment-469954" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-470270" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-470270" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/29381f242aa4f8e02b34220f27b3e0cd.png" srcset="https://secure.gravatar.com/avatar/29381f242aa4f8e02b34220f27b3e0cd?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://danh-was-here.netlify.com/" rel="external nofollow ugc" class="url">Danh Nguyen</a></span>
	                <span class="date">February 24, 2019 at 12:09 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-470270" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Example is great! The totally clean CSV wheat seed dataset is here: <a href="https://raw.githubusercontent.com/NguyenDa18/MachineLearning_HW3/master/wheat-seeds.csv" rel="nofollow ugc">https://raw.githubusercontent.com/NguyenDa18/MachineLearning_HW3/master/wheat-seeds.csv</a></p>
<p>I tried Jason’s link<br>
<a href="https://raw.githubusercontent.com/jbrownlee/Datasets/master/wheat-seeds.csv" rel="nofollow ugc">https://raw.githubusercontent.com/jbrownlee/Datasets/master/wheat-seeds.csv</a><br>
and the UCI Repo link and the CSVs still had double commas and so we got the str_column_to_float error</p>
<p>Anyway, posting this here so others won’t run into the same problem I did! Thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-470270" data-commentid="470270" data-postid="3349" data-belowelement="comment-470270" data-respondelement="respond" data-replyto="Reply to Danh Nguyen" aria-label="Reply to Danh Nguyen">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-470428" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-470428" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">February 25, 2019 at 6:37 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-470428" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for sharing.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-470428" data-commentid="470428" data-postid="3349" data-belowelement="comment-470428" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-470846" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-470846" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/7d18fadb717ef0f3fc3b5a9df8fb72c7.png" srcset="https://secure.gravatar.com/avatar/7d18fadb717ef0f3fc3b5a9df8fb72c7?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">vartika sharma</span>
	                <span class="date">February 27, 2019 at 3:49 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-470846" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hey Jason,<br>
While I am ruuning the following code, I am getting this error<br>
&gt;&gt;&gt; scores=evaluate_algorithm(dataset,back_propagation,n_folds,l_rate,n_epoch,n_hidden)<br>
Traceback (most recent call last):<br>
  File “”, line 1, in<br>
  File “”, line 13, in evaluate_algorithm<br>
  File “”, line 5, in back_propagation<br>
  File “”, line 6, in train_network<br>
TypeError: list indices must be integers, not str</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-470846" data-commentid="470846" data-postid="3349" data-belowelement="comment-470846" data-respondelement="respond" data-replyto="Reply to vartika sharma" aria-label="Reply to vartika sharma">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-470896" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-470896" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">February 27, 2019 at 7:34 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-470896" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps try saving code to a file and run from the command line, here’s how:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/how-do-i-run-a-script-from-the-command-line" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/how-do-i-run-a-script-from-the-command-line</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-470896" data-commentid="470896" data-postid="3349" data-belowelement="comment-470896" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-472429" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-472429" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/73a7f828d2dc22981877b11d0f2a5171.png" srcset="https://secure.gravatar.com/avatar/73a7f828d2dc22981877b11d0f2a5171?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Andy</span>
	                <span class="date">March 5, 2019 at 12:51 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-472429" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason,</p>
<p>I would like to ask, can you make the data split between training data and test data, instead of using k folds variation, I would like to get some insight in this, thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-472429" data-commentid="472429" data-postid="3349" data-belowelement="comment-472429" data-respondelement="respond" data-replyto="Reply to Andy" aria-label="Reply to Andy">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-472454" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-472454" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 5, 2019 at 2:22 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-472454" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, I show how here:<br>
<a href="https://machinelearningmastery.com/implement-resampling-methods-scratch-python/" rel="nofollow ugc">https://machinelearningmastery.com/implement-resampling-methods-scratch-python/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-472454" data-commentid="472454" data-postid="3349" data-belowelement="comment-472454" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-472518" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-472518" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/73a7f828d2dc22981877b11d0f2a5171.png" srcset="https://secure.gravatar.com/avatar/73a7f828d2dc22981877b11d0f2a5171?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Andy</span>
	                <span class="date">March 5, 2019 at 6:33 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-472518" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason, it’s me again.</p>
<p>I would like to ask another question, how do you predict using this trained network ?<br>
Lets say I have 100 data, and I split the training and test by 70:30 ratio. I’ve trained the network using 70 data, how do I predict the rest (30 data) ?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-472518" data-commentid="472518" data-postid="3349" data-belowelement="comment-472518" data-respondelement="respond" data-replyto="Reply to Andy" aria-label="Reply to Andy">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-472690" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-472690" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 6, 2019 at 7:46 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-472690" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can fit one final model on all data, then use it to make predictions (see the predict section).</p>
<p>Remember, this is an example for learning only. If you want a model for your data in practice, I recommend using a robust neural network library like Keras:<br>
<a href="https://machinelearningmastery.com/start-here/#deeplearning" rel="nofollow ugc">https://machinelearningmastery.com/start-here/#deeplearning</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-472690" data-commentid="472690" data-postid="3349" data-belowelement="comment-472690" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-473477" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-473477" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/3cc07db88ec0cb5351d0834b9450652c.png" srcset="https://secure.gravatar.com/avatar/3cc07db88ec0cb5351d0834b9450652c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Dini M</span>
	                <span class="date">March 11, 2019 at 12:21 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-473477" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p># Convert string column to integer<br>
def str_column_to_int(dataset, column):<br>
	class_values = [row[column] for row in dataset]<br>
	unique = set(class_values)<br>
	lookup = dict()<br>
	for i, value in enumerate(unique):<br>
		lookup[value] = i<br>
	for row in dataset:<br>
		row[column] = lookup[row[column]]<br>
	return lookup</p>
<p>I got the error “class_values = [row[column] for row in dataset]”<br>
IndexError: list index out of range</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-473477" data-commentid="473477" data-postid="3349" data-belowelement="comment-473477" data-respondelement="respond" data-replyto="Reply to Dini M" aria-label="Reply to Dini M">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-473520" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-473520" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 11, 2019 at 6:52 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-473520" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry to hear that, I have some suggestions here:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-473520" data-commentid="473520" data-postid="3349" data-belowelement="comment-473520" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-473478" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-473478" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/3cc07db88ec0cb5351d0834b9450652c.png" srcset="https://secure.gravatar.com/avatar/3cc07db88ec0cb5351d0834b9450652c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Dini M</span>
	                <span class="date">March 11, 2019 at 12:28 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-473478" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I trying your code example and seeds_dataset.csv</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-473478" data-commentid="473478" data-postid="3349" data-belowelement="comment-473478" data-respondelement="respond" data-replyto="Reply to Dini M" aria-label="Reply to Dini M">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-474402" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-474402" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/8b637020ebcfbb9301f5552b84c87be5.png" srcset="https://secure.gravatar.com/avatar/8b637020ebcfbb9301f5552b84c87be5?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">giuseppe</span>
	                <span class="date">March 15, 2019 at 7:08 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-474402" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi thanks for the code is amazing,<br>
I’ve included it in a class for a project, I’ve modified it so I can decide how many neurons put in each layer because, but I have a question: during the train process using for example 4 neurons in the first layer and 3 in the second one I get nice result, around 85% / 92 %. At this point I save all the weights of the neurons and I call another function that just load the weight that I’ve saved(skipping in this way the traning process) and using all the dataset(the same I’ve used for train the network) as test set it gives me a really bad score, most of the time is around 30%. I’m using the “IrisDataTrain” and what I’ve noticed is that the networks fails to recognise one of the 3 classes. Do you have any suggestion about what could be? Thanks 🙂</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-474402" data-commentid="474402" data-postid="3349" data-belowelement="comment-474402" data-respondelement="respond" data-replyto="Reply to giuseppe" aria-label="Reply to giuseppe">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-474457" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-474457" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 15, 2019 at 2:25 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-474457" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps the weights are not being loaded correctly?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-474457" data-commentid="474457" data-postid="3349" data-belowelement="comment-474457" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-476947" class="comment even depth-3 parent">

	      	<div id="li-comment-476947" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/8b637020ebcfbb9301f5552b84c87be5.png" srcset="https://secure.gravatar.com/avatar/8b637020ebcfbb9301f5552b84c87be5?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">giuseppe</span>
	                <span class="date">March 28, 2019 at 8:11 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-476947" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi sorry for the late replay, actually the problem of save and loading the nn is not that important so maybe i’ll try to solve it later. At the moment the problem is that i should reach the 99. % on the “IrisDataTrain” set. What i’ve noticed is that the accurancy can change a lot repeating the same training process with the same configuration. In order to get a better result I’ve tryied to repeat the same traning process different times with the same configuration, I’ve choosen the configuration that give me the best result in mean and variance. Now in order to improve the accurancy I’ve modified the code so that I can connect easily the output of a nn with the input of another one so that I can create a cascade of neural networks connected in different ways. At this point i’m stucked at 96% in mean. To improve the accurancy I’ve implemented the relu activation function (but i’m not sure it’s correctly implemented) and adam optimizer (but it doesn’t work at all).<br>
I’ll link the code on pastbin (I don’t know if there is any better way to do that) in particular what I’ve done is just insert everything in a class and modified:<br>
1. the initialization function so that I can chose the number of neurons in each layer<br>
2. the back_propagation_error function trying to add the relu and adam optimizer<br>
3. the update weights function trying to implement adam optimizer (it doesnt’ work at all)<br>
In the code I’m going to share I’ve just removed many parts just for a readability reason, after cleaning it I will send it to you if you want. Sorry for the long message and thanks for you help 🙂</p>
<p><a href="https://pastebin.com/RxxuVaCD" rel="nofollow ugc">https://pastebin.com/RxxuVaCD</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-476947" data-commentid="476947" data-postid="3349" data-belowelement="comment-476947" data-respondelement="respond" data-replyto="Reply to giuseppe" aria-label="Reply to giuseppe">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-477097" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-477097" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 29, 2019 at 8:31 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-477097" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Nice work!</p>
<p>It might be time to graduate to Keras where everything is implemented for you and you can just use it directly and focus on tuning the model.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-477097" data-commentid="477097" data-postid="3349" data-belowelement="comment-477097" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-475784" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-475784" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/7e8574ec9561b3a178ebe33128147ab7.png" srcset="https://secure.gravatar.com/avatar/7e8574ec9561b3a178ebe33128147ab7?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">MLnovice</span>
	                <span class="date">March 21, 2019 at 10:53 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-475784" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello sir,<br>
I am playing with your code and I am trying to figure out this error:</p>
<p>line 185, in<br>
    str_column_to_float(dataset, i)<br>
line 21, in str_column_to_float<br>
    row[column] = float(row[column].strip())<br>
ValueError: could not convert string to float: </p>
<p>Do you have any insides of why this is happening?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-475784" data-commentid="475784" data-postid="3349" data-belowelement="comment-475784" data-respondelement="respond" data-replyto="Reply to MLnovice" aria-label="Reply to MLnovice">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-475859" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-475859" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 22, 2019 at 8:28 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-475859" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry to hear that, I have some suggestions here:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-475859" data-commentid="475859" data-postid="3349" data-belowelement="comment-475859" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-476234" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-476234" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/04b092d2a54ce73560006a949675c8de.png" srcset="https://secure.gravatar.com/avatar/04b092d2a54ce73560006a949675c8de?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Matty</span>
	                <span class="date">March 25, 2019 at 9:55 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-476234" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you for the post Jason.</p>
<p>Reading this post, it seems to me that I can split the process of back propagation in large networks into multiple steps. Am I right? </p>
<p>I have a large network that my current GPU runs out of memory when I try to train it.   I was wondering if I can split my network into two sub-networks, and first calculate the updates for the deeper part(that has the ground truth outputs) and obtain the error that should be passed to the other sub-network.  Then, use the provided error to calculate the updates for the second sub-network as well.  Do you think it’s possible?  Do you have any suggestion (or source that can be helpful) for implementing this back propagation with existing tensorflow or pytorch builtin functions?</p>
<p>Thanks.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-476234" data-commentid="476234" data-postid="3349" data-belowelement="comment-476234" data-respondelement="respond" data-replyto="Reply to Matty" aria-label="Reply to Matty">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-476263" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-476263" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 25, 2019 at 2:17 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-476263" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, by node or by layer.</p>
<p>It might be possible, but also a massive pain.</p>
<p>It might be cheaper (in time/money) to rent an AWS EC2 instance with more GPU RAM for a few hours?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-476263" data-commentid="476263" data-postid="3349" data-belowelement="comment-476263" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-476414" class="comment even depth-3 parent">

	      	<div id="li-comment-476414" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/04b092d2a54ce73560006a949675c8de.png" srcset="https://secure.gravatar.com/avatar/04b092d2a54ce73560006a949675c8de?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Matty</span>
	                <span class="date">March 26, 2019 at 1:03 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-476414" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks, Jason.    I think I found an easy way to split the back-propagation in tensorflow. </p>
<p>We can define two separate optimizations with different trainable variable lists. Something similar to:</p>
<p>        self.optim_last_layers = tf.train.AdamOptimizer(lr, beta1=beta1) \<br>
            .minimize(loss, var_list=vars_of_last_layers) </p>
<p>        self.optim_first_layers = tf.train.AdamOptimizer(lr, beta1=beta1) \<br>
            .minimize(loss, var_list=vars_of_first_layers) </p>
<p>And in each iteration, we can call the optimizations separately.   </p>
<p>I did a small sanity check with a two-layer network, and it seems both the two-step optimization and the one-step optimization with all the trainable parameters results in the same updates.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-476414" data-commentid="476414" data-postid="3349" data-belowelement="comment-476414" data-respondelement="respond" data-replyto="Reply to Matty" aria-label="Reply to Matty">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-476427" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-476427" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 26, 2019 at 2:20 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-476427" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Glad to hear it.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-476427" data-commentid="476427" data-postid="3349" data-belowelement="comment-476427" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-476723" class="comment even thread-even depth-1">

	      	<div id="li-comment-476723" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/d8f31f65247021ee6b991e36cc56e37d.png" srcset="https://secure.gravatar.com/avatar/d8f31f65247021ee6b991e36cc56e37d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Novia Puspitasari</span>
	                <span class="date">March 28, 2019 at 12:17 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-476723" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>thankyou so much jason, for your post about it<br>
i have some problem in “‘float’ object has no attribute ‘append'”</p>
<p>Traceback (most recent call last):<br>
  File “backprop.py”, line 200, in<br>
    scores = evaluate_algorithm(dataset, back_propagation, n_folds, l_rate, n_epoch, n_hidden)<br>
  File “backprop.py”, line 80, in evaluate_algorithm<br>
    predicted = algorithm(train_set, test_set, *args)<br>
  File “backprop.py”, line 172, in back_propagation<br>
    train_network(network, train, l_rate, n_epoch, n_outputs)<br>
  File “backprop.py”, line 150, in train_network<br>
    backward_propagate_error(network, expected)<br>
  File “backprop.py”, line 123, in backward_propagate_error<br>
    error.append(error)<br>
AttributeError: ‘float’ object has no attribute ‘append’</p>
<p>do you have a solve for that ? thankyou</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-476723" data-commentid="476723" data-postid="3349" data-belowelement="comment-476723" data-respondelement="respond" data-replyto="Reply to Novia Puspitasari" aria-label="Reply to Novia Puspitasari">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-477009" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-477009" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/b12b3cb42d6d49082ae2b17584799b8a.png" srcset="https://secure.gravatar.com/avatar/b12b3cb42d6d49082ae2b17584799b8a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Kevin</span>
	                <span class="date">March 29, 2019 at 1:21 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-477009" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi there Jason, I would like to ask if I wanted to generate random weights and bias with range -1 to 1, how to do it ? Since I already import random or from uniform import random, and it said AttributeError: ‘builtin_function_or_method’. Thank you very much !</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-477009" data-commentid="477009" data-postid="3349" data-belowelement="comment-477009" data-respondelement="respond" data-replyto="Reply to Kevin" aria-label="Reply to Kevin">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-477109" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-477109" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 29, 2019 at 8:38 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-477109" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Good question, this post shows how:<br>
<a href="https://machinelearningmastery.com/how-to-generate-random-numbers-in-python/" rel="nofollow ugc">https://machinelearningmastery.com/how-to-generate-random-numbers-in-python/</a></p>
<p>You then scale them to any range you want: </p>
<p>result = min + value * range</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-477109" data-commentid="477109" data-postid="3349" data-belowelement="comment-477109" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-477201" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-477201" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/b12b3cb42d6d49082ae2b17584799b8a.png" srcset="https://secure.gravatar.com/avatar/b12b3cb42d6d49082ae2b17584799b8a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Kevin</span>
	                <span class="date">March 29, 2019 at 4:20 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-477201" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for your reply ! Awesome guide, I really grateful for it. Once again, thanks a lot Jason.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-477201" data-commentid="477201" data-postid="3349" data-belowelement="comment-477201" data-respondelement="respond" data-replyto="Reply to Kevin" aria-label="Reply to Kevin">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-477323" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-477323" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 30, 2019 at 6:22 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-477323" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You’re welcome.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-477323" data-commentid="477323" data-postid="3349" data-belowelement="comment-477323" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-477382" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-477382" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/6ee9f81ba6f9aef254a4b8007c578645.png" srcset="https://secure.gravatar.com/avatar/6ee9f81ba6f9aef254a4b8007c578645?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">wancong zhang</span>
	                <span class="date">March 30, 2019 at 12:45 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-477382" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, very cool tutorial.</p>
<p>I notice that your neural network only has 3 layers.</p>
<p>If I change your “initialize network” method to initialize multiple hidden layers with arbitrary width, will your program still work? In other words does your algorithm generalize to deeper networks?</p>
<p>Thanks.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-477382" data-commentid="477382" data-postid="3349" data-belowelement="comment-477382" data-respondelement="respond" data-replyto="Reply to wancong zhang" aria-label="Reply to wancong zhang">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-477547" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-477547" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 31, 2019 at 9:26 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-477547" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>No idea – it is for educational purposes only, try it and see.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-477547" data-commentid="477547" data-postid="3349" data-belowelement="comment-477547" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-481210" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-481210" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/2840a31bc7e7fc82b8e317c0b66dcdf2.png" srcset="https://secure.gravatar.com/avatar/2840a31bc7e7fc82b8e317c0b66dcdf2?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://none/" rel="external nofollow ugc" class="url">manoj</a></span>
	                <span class="date">April 19, 2019 at 7:38 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-481210" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason!</p>
<p>Its really a helpful post, that you very much. </p>
<p>I wanted to see the plots of training error and testing error. (like how they finally converged by epochs by epochs). What would be the easiest way to plot those training and testing graphs</p>
<p>regards<br>
Manoj Goli</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-481210" data-commentid="481210" data-postid="3349" data-belowelement="comment-481210" data-respondelement="respond" data-replyto="Reply to manoj" aria-label="Reply to manoj">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-481254" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-481254" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 19, 2019 at 3:03 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-481254" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I’d recommend using a library like Keras which provides the history directly and ready to plot:<br>
<a href="https://machinelearningmastery.com/display-deep-learning-model-training-history-in-keras/" rel="nofollow ugc">https://machinelearningmastery.com/display-deep-learning-model-training-history-in-keras/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-481254" data-commentid="481254" data-postid="3349" data-belowelement="comment-481254" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-481476" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-481476" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/f91142d9c5ab004b6a0c49f6ef8f2d32.png" srcset="https://secure.gravatar.com/avatar/f91142d9c5ab004b6a0c49f6ef8f2d32?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Danial</span>
	                <span class="date">April 20, 2019 at 5:46 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-481476" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi jason.<br>
My question is how I can see my CNN code is using BP framework?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-481476" data-commentid="481476" data-postid="3349" data-belowelement="comment-481476" data-respondelement="respond" data-replyto="Reply to Danial" aria-label="Reply to Danial">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-481564" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-481564" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 21, 2019 at 8:20 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-481564" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can save the model weights to a file.</p>
<p>Is that what you mean?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-481564" data-commentid="481564" data-postid="3349" data-belowelement="comment-481564" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-481626" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-481626" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/f91142d9c5ab004b6a0c49f6ef8f2d32.png" srcset="https://secure.gravatar.com/avatar/f91142d9c5ab004b6a0c49f6ef8f2d32?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Danial</span>
	                <span class="date">April 21, 2019 at 1:27 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-481626" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes. How I can see model weights? How cnn use BP framework if it is not shown in code?<br>
for i in range(len(test)):<br>
    # Forecast the data<br>
    test_X, test_y = test[i, 0:-1], test[i, -1]<br>
    X_ = test_X.reshape(1, 28, 28, 1)<br>
    predict = model.predict(X_, batch_size=1)<br>
    predict = predict[0, 0]</p>
<p>    # Replacing value in test scaled with the predicted value.<br>
    test_prediction = [predict] + test_prediction<br>
    if len(test_prediction) &gt; sequence_length+1:<br>
        test_prediction = test_prediction[:-1]<br>
    if i+1  sequence_length+1:<br>
            test[i+1] = test_prediction<br>
        else:<br>
            test[i+1] = np.concatenate((test_prediction, test[i+1, i+1:]), axis=0)</p>
<p>    # Inverse transform<br>
    predict = inverse_transform(scaler, test_X, predict)<br>
    # Inverse the features<br>
    predict = inverse_features(data_set, predict, len(test)+1-i) – maxVal<br>
    if predict &lt; 0:<br>
        predict = 0<br>
    # Round the value<br>
    predict = np.round(predict, 2)<br>
    # store forecast<br>
    expected = data_set[len(train) + i + 1]<br>
    predict_data.append(predict )<br>
    real_data.append(expected )<br>
    if expected != 0:<br>
        prediction.append(predict)<br>
        real.append(expected)</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-481626" data-commentid="481626" data-postid="3349" data-belowelement="comment-481626" data-respondelement="respond" data-replyto="Reply to Danial" aria-label="Reply to Danial">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-481796" class="comment byuser comment-author-jasonb bypostauthor even depth-4 parent">

	      	<div id="li-comment-481796" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 22, 2019 at 6:15 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-481796" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can get the model weights from a Keras model by calling the get_weights() function on a give layer.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-481796" data-commentid="481796" data-postid="3349" data-belowelement="comment-481796" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-481813" class="comment odd alt depth-5">

	      	<div id="li-comment-481813" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/f91142d9c5ab004b6a0c49f6ef8f2d32.png" srcset="https://secure.gravatar.com/avatar/f91142d9c5ab004b6a0c49f6ef8f2d32?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Danial</span>
	                <span class="date">April 22, 2019 at 6:38 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-481813" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Is it right that  above code is using BP framework.? It’s part of CNN code that I sent</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-481858" class="comment even depth-5">

	      	<div id="li-comment-481858" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/f91142d9c5ab004b6a0c49f6ef8f2d32.png" srcset="https://secure.gravatar.com/avatar/f91142d9c5ab004b6a0c49f6ef8f2d32?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Danial</span>
	                <span class="date">April 22, 2019 at 11:23 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-481858" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>How keras uses BP framework.? If you have link kindly share it.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-481889" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-481889" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 22, 2019 at 2:26 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-481889" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can get started with Keras here:<br>
<a href="https://machinelearningmastery.com/start-here/#deeplearning" rel="nofollow ugc">https://machinelearningmastery.com/start-here/#deeplearning</a></p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-482358" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-482358" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/7c1559b6f93529e68930c5751f371c26.jpeg" srcset="https://secure.gravatar.com/avatar/7c1559b6f93529e68930c5751f371c26?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Idris Shareef</span>
	                <span class="date">April 24, 2019 at 4:16 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-482358" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason , You’re the best teacher.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-482358" data-commentid="482358" data-postid="3349" data-belowelement="comment-482358" data-respondelement="respond" data-replyto="Reply to Idris Shareef" aria-label="Reply to Idris Shareef">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-482456" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-482456" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 25, 2019 at 8:08 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-482456" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-482456" data-commentid="482456" data-postid="3349" data-belowelement="comment-482456" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-483373" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-483373" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/795e07b9799c4349c18489e744d76c86.png" srcset="https://secure.gravatar.com/avatar/795e07b9799c4349c18489e744d76c86?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Abarni</span>
	                <span class="date">April 30, 2019 at 12:39 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-483373" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Nice Post !</p>
<p>Here is another very nice tutorial with step by step Mathematical explanation and full coding.</p>
<p><a href="http://www.adeveloperdiary.com/data-science/machine-learning/understand-and-implement-the-" rel="nofollow ugc">http://www.adeveloperdiary.com/data-science/machine-learning/understand-and-implement-the-</a><br>
backpropagation-algorithm-from-scratch-in-python/</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-483373" data-commentid="483373" data-postid="3349" data-belowelement="comment-483373" data-respondelement="respond" data-replyto="Reply to Abarni" aria-label="Reply to Abarni">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-483390" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-483390" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 30, 2019 at 2:27 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-483390" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for sharing.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-483390" data-commentid="483390" data-postid="3349" data-belowelement="comment-483390" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-484227" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-484227" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/b6f21963e4c0624a84c599adb50397e9.jpeg" srcset="https://secure.gravatar.com/avatar/b6f21963e4c0624a84c599adb50397e9?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Zahra</span>
	                <span class="date">May 6, 2019 at 4:28 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-484227" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello, I’m so confuse.<br>
I try to run this code in command prompt. But, I use my dataset (not Wheat Seeds dataset).</p>
<p>And why this happened? What’s wrong? What should I do? What should I change?<br>
Please, help me!</p>
<p>Traceback (most recent call last):<br>
File “journal.py”, line 197, in<br>
scores = evaluate_algorithm(dataset, back_propagation, n_folds, l_rate, n_epoch, n_hidden)<br>
File “journal.py”, line 81, in evaluate_algorithm<br>
predicted = algorithm(train_set, test_set, *args)<br>
File “journal.py”, line 173, in back_propagation<br>
train_network(network, train, l_rate, n_epoch, n_outputs)<br>
File “journal.py”, line 150, in train_network<br>
expected[row[-1]] = 1<br>
IndexError: list assignment index out of range</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-484227" data-commentid="484227" data-postid="3349" data-belowelement="comment-484227" data-respondelement="respond" data-replyto="Reply to Zahra" aria-label="Reply to Zahra">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-484279" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-484279" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">May 7, 2019 at 6:12 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-484279" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I cannot know, I can give you some advice on debugging your problem here:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/can-you-read-review-or-debug-my-code" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/can-you-read-review-or-debug-my-code</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-484279" data-commentid="484279" data-postid="3349" data-belowelement="comment-484279" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-484500" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-484500" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/b6f21963e4c0624a84c599adb50397e9.jpeg" srcset="https://secure.gravatar.com/avatar/b6f21963e4c0624a84c599adb50397e9?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Zahra</span>
	                <span class="date">May 9, 2019 at 1:11 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-484500" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello, How to import my dataset using that codes? </p>
<p>For example (in this codes), how to use my dataset (use excel file) in this codes.. How to import my dataset in this codes? Can you teach me more detail, please..</p>
<p># Test training backprop algorithm<br>
seed(1)<br>
dataset = [[2.7810836,2.550537003,0],<br>
	[1.465489372,2.362125076,0],<br>
	[3.396561688,4.400293529,0],<br>
	[1.38807019,1.850220317,0],<br>
	[3.06407232,3.005305973,0],<br>
	[7.627531214,2.759262235,1],<br>
	[5.332441248,2.088626775,1],<br>
	[6.922596716,1.77106367,1],<br>
	[8.675418651,-0.242068655,1],<br>
	[7.673756466,3.508563011,1]]<br>
n_inputs = len(dataset[0]) – 1<br>
n_outputs = len(set([row[-1] for row in dataset]))<br>
network = initialize_network(n_inputs, 2, n_outputs)<br>
train_network(network, dataset, 0.5, 20, n_outputs)<br>
for layer in network:<br>
	print(layer)</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-484500" data-commentid="484500" data-postid="3349" data-belowelement="comment-484500" data-respondelement="respond" data-replyto="Reply to Zahra" aria-label="Reply to Zahra">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-484540" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-484540" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">May 9, 2019 at 6:46 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-484540" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps you should start with Keras, it is much easier for beginners:<br>
<a href="https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/" rel="nofollow ugc">https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-484540" data-commentid="484540" data-postid="3349" data-belowelement="comment-484540" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-493696" class="comment even depth-3 parent">

	      	<div id="li-comment-493696" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/d72b3408ace6def4cb9a255a9784d285.png" srcset="https://secure.gravatar.com/avatar/d72b3408ace6def4cb9a255a9784d285?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Aziz Ahmad</span>
	                <span class="date">July 22, 2019 at 4:42 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-493696" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sir! I really apprecitae your work.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-493696" data-commentid="493696" data-postid="3349" data-belowelement="comment-493696" data-respondelement="respond" data-replyto="Reply to Aziz Ahmad" aria-label="Reply to Aziz Ahmad">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-493722" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-493722" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">July 22, 2019 at 8:28 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-493722" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-493722" data-commentid="493722" data-postid="3349" data-belowelement="comment-493722" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-484641" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-484641" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/4e216bb7e5ed6bfd6ddd28ee5f0d75c4.png" srcset="https://secure.gravatar.com/avatar/4e216bb7e5ed6bfd6ddd28ee5f0d75c4?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Nirmala</span>
	                <span class="date">May 10, 2019 at 5:37 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-484641" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I got an error called-&gt;</p>
<p>                                IndexError: list assignment index out of range.</p>
<p>but I m using python 3 itself.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-484641" data-commentid="484641" data-postid="3349" data-belowelement="comment-484641" data-respondelement="respond" data-replyto="Reply to Nirmala" aria-label="Reply to Nirmala">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-484672" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-484672" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">May 10, 2019 at 8:20 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-484672" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry to hear that, I have some suggestions here:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-484672" data-commentid="484672" data-postid="3349" data-belowelement="comment-484672" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-484917" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-484917" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/b532e1d4a703e0a96b8dc1256d5bbf40.png" srcset="https://secure.gravatar.com/avatar/b532e1d4a703e0a96b8dc1256d5bbf40?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ido Berenbaum</span>
	                <span class="date">May 11, 2019 at 9:39 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-484917" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
thanks for the great tutorial, I learned a lot from it.<br>
There is one thing I didn’t really understand though,<br>
when you update the weights you add to the weight the calculated change that is needed.<br>
but’from what I read in other sites like wikipedia, the change to the weight needs to be multiplied by -1 and then added to ensure it<br>
changes the weight in the opposite direction of the gradient and so getting it closer to the local minimum.<br>
like muhammad said in December 21, 2018:<br>
“hi, thanks for this code.<br>
I’m trying to understand why are u adding on the update weights, shouldnt be<br>
wi←wi−η∂E/∂wi like this?”</p>
<p>and I tried to change line 141 to: neuron[‘weights’][j] -= l_rate * neuron[‘delta’] * inputs[j]<br>
basically doing -= and not += but it just made the sum error of the network to increase after each epoch.</p>
<p>so, I will be grateful if you could explain to me why are you adding and not subtracting.</p>
<p>thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-484917" data-commentid="484917" data-postid="3349" data-belowelement="comment-484917" data-respondelement="respond" data-replyto="Reply to Ido Berenbaum" aria-label="Reply to Ido Berenbaum">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-484973" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-484973" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">May 12, 2019 at 6:43 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-484973" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>There are many ways to implement the algorithm description.</p>
<p>This implementation is based on the description in “neural smithing”:<br>
<a href="https://amzn.to/2pW6hjI" rel="nofollow ugc">https://amzn.to/2pW6hjI</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-484973" data-commentid="484973" data-postid="3349" data-belowelement="comment-484973" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-493036" class="comment even depth-2 parent">

	      	<div id="li-comment-493036" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/524d63b1cfb7f83361755f83bf347fae.png" srcset="https://secure.gravatar.com/avatar/524d63b1cfb7f83361755f83bf347fae?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">cocoa</span>
	                <span class="date">July 16, 2019 at 8:37 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-493036" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Jason seem to use mean square error as loss. partial derivative of loss should be (output-expected). In his “backward” function, he did (expected-output). That’s why he came up with “+=” not “-=”</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-493036" data-commentid="493036" data-postid="3349" data-belowelement="comment-493036" data-respondelement="respond" data-replyto="Reply to cocoa" aria-label="Reply to cocoa">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-493053" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-3">

	      	<div id="li-comment-493053" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">July 16, 2019 at 2:19 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-493053" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Nice explanation.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-493053" data-commentid="493053" data-postid="3349" data-belowelement="comment-493053" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-485613" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-485613" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/4e216bb7e5ed6bfd6ddd28ee5f0d75c4.png" srcset="https://secure.gravatar.com/avatar/4e216bb7e5ed6bfd6ddd28ee5f0d75c4?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Nirmala</span>
	                <span class="date">May 16, 2019 at 4:23 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-485613" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>In training code and testing code I want to link the onther dataset .txt file but it will not work.please can u send a code for that..</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-485613" data-commentid="485613" data-postid="3349" data-belowelement="comment-485613" data-respondelement="respond" data-replyto="Reply to Nirmala" aria-label="Reply to Nirmala">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-485675" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-485675" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">May 17, 2019 at 5:49 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-485675" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I don’t have the capacity to develop custom code for you.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-485675" data-commentid="485675" data-postid="3349" data-belowelement="comment-485675" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-486255" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-486255" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a77719cd793357e197afaac54bf0ac71.png" srcset="https://secure.gravatar.com/avatar/a77719cd793357e197afaac54bf0ac71?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Arthur</span>
	                <span class="date">May 22, 2019 at 4:03 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-486255" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, first of all thank you very much for this post, I’m learning ML at the moment, and writing a neural network with backpropagation in C# to help the process.</p>
<p>When using the wheat seeds dataset, and the same network layout as you suggest, I get very similar results to yours in terms of accuracy.</p>
<p>When I scale the network however to have 2 (or more) hidden layers of 5 neurons, I sometimes get exploding gradients (and NaN output results because of it). Is this something you’d expect given the dataset? ie, doesn’t this dataset allow for much more than 1 hidden layer for some reason. (Some context: I normalize the data just like you do, and I use the same dataset as you do, the reason I test with more than 1 layer, is just out of curiosity, and to see whether the accuracy improved – it doesnt)</p>
<p>I’m trying to understand why it happens with this particular data, or whether my implementation fails somehow. Note that I do get good results most of the time, but with a certain weight initialization the exploding gradients can happen.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-486255" data-commentid="486255" data-postid="3349" data-belowelement="comment-486255" data-respondelement="respond" data-replyto="Reply to Arthur" aria-label="Reply to Arthur">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-486328" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-486328" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">May 23, 2019 at 5:54 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-486328" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps try scaling the data prior to modeling, see this post:<br>
<a href="https://machinelearningmastery.com/how-to-improve-neural-network-stability-and-modeling-performance-with-data-scaling/" rel="nofollow ugc">https://machinelearningmastery.com/how-to-improve-neural-network-stability-and-modeling-performance-with-data-scaling/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-486328" data-commentid="486328" data-postid="3349" data-belowelement="comment-486328" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-486790" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-486790" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/b6f21963e4c0624a84c599adb50397e9.jpeg" srcset="https://secure.gravatar.com/avatar/b6f21963e4c0624a84c599adb50397e9?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Zahra Nabila</span>
	                <span class="date">May 27, 2019 at 4:00 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-486790" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello, I have problem. Why output must be integers, not float (decimal)? Specially in Train.. How to change output data type to float?</p>
<p>TypeError                                 Traceback (most recent call last)</p>
<p> in train_network(network, train, l_rate, n_epoch, n_outputs)<br>
     93                         outputs = forward_propagate(network, row)<br>
     94                         expected = [0 for i in range(n_outputs)]<br>
—&gt; 95                         expected[row[-1]] = 1<br>
     96                         sum_error += sum([(expected[i]-outputs[i])**2 for i in range(len(expected))])<br>
     97                         backward_propagate_error(network, expected)</p>
<p>TypeError: list indices must be integers or slices, not numpy.float64</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-486790" data-commentid="486790" data-postid="3349" data-belowelement="comment-486790" data-respondelement="respond" data-replyto="Reply to Zahra Nabila" aria-label="Reply to Zahra Nabila">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-486849" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-486849" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">May 28, 2019 at 8:08 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-486849" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The example is classification, you can change it to regression if you wish.</p>
<p>Perhaps this tutorial will be more helpful:<br>
<a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/" rel="nofollow ugc">https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-486849" data-commentid="486849" data-postid="3349" data-belowelement="comment-486849" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-486885" class="comment even depth-3 parent">

	      	<div id="li-comment-486885" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/b6f21963e4c0624a84c599adb50397e9.jpeg" srcset="https://secure.gravatar.com/avatar/b6f21963e4c0624a84c599adb50397e9?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Zahra</span>
	                <span class="date">May 28, 2019 at 1:09 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-486885" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I want to ask, how to display execution time (running rime) in Train code?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-486885" data-commentid="486885" data-postid="3349" data-belowelement="comment-486885" data-respondelement="respond" data-replyto="Reply to Zahra" aria-label="Reply to Zahra">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-486891" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-486891" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">May 28, 2019 at 2:44 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-486891" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I don’t have an example of calculating clock time for code examples.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-486891" data-commentid="486891" data-postid="3349" data-belowelement="comment-486891" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-487711" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-487711" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/016c2f3bcf484efb477cc76aabb2b3bb.png" srcset="https://secure.gravatar.com/avatar/016c2f3bcf484efb477cc76aabb2b3bb?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jeny</span>
	                <span class="date">June 3, 2019 at 10:06 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-487711" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>”’<br>
Calculate the output of a recurrent neural network with tanh activation<br>
and a linear layer on top<br>
Params:<br>
x: input matrix [n_timesteps * n_samples * 2]<br>
w: non-recurrent weights<br>
r: recurrent weights<br>
b: biases<br>
wo: output-layer weights<br>
bo: output-layer biases<br>
Returns:<br>
h: matrix of activations (n_timesteps, n_samples, n_hiddens)<br>
o: final predictions<br>
”’</p>
<p>def forward_path(x, w, r, b, wo, bo):<br>
h = np.empty([t_max, n, w.shape[0]], dtype=np.float32) # storage for the hidden activations<br>
for t in range(t_max):<br>
   z = np.dot(x[t], w.T) + b<br>
   if t &gt; 0:<br>
        z += np.dot(h[t-1], r.T)<br>
   h[t] = np.tanh(z)<br>
o = np.dot(h[-1], wo.T) + bo<br>
return h, o</p>
<p>def backward_path(x, h, w, b, r, wo, bo, o, y):<br>
n, t_max, _ = x.shape<br>
dw = np.zeros_like(w)<br>
db = np.zeros_like(b)<br>
dr = np.zeros_like(r)<br>
dwo = 0<br>
dbo = 0</p>
<p>return dw, dr, db, dwo, dbo</p>
<p>def loss(w, r, b, wo, bo, x, y):<br>
        _, o = forward_path(x, w, r, b, wo, bo)<br>
       err = 0.5*np.sum(np.square(o-y))<br>
       return err</p>
<p>Can you help me implement the backpropagation? Please.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-487711" data-commentid="487711" data-postid="3349" data-belowelement="comment-487711" data-respondelement="respond" data-replyto="Reply to Jeny" aria-label="Reply to Jeny">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-487728" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-487728" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">June 3, 2019 at 2:34 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-487728" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I don’t have the capacity to debug your code, perhaps try posting to stackoverflow?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-487728" data-commentid="487728" data-postid="3349" data-belowelement="comment-487728" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-488476" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-488476" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/b6f21963e4c0624a84c599adb50397e9.jpeg" srcset="https://secure.gravatar.com/avatar/b6f21963e4c0624a84c599adb50397e9?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Zahra Nabila Izdihar</span>
	                <span class="date">June 10, 2019 at 11:53 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-488476" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello…<br>
How to display “predicted” value in your code?</p>
<p>Because I need to display the predicted or forecast value..</p>
<p>Thank you</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-488476" data-commentid="488476" data-postid="3349" data-belowelement="comment-488476" data-respondelement="respond" data-replyto="Reply to Zahra Nabila Izdihar" aria-label="Reply to Zahra Nabila Izdihar">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-488516" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-488516" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">June 11, 2019 at 7:54 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-488516" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The forward_propagate() function makes a prediction.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-488516" data-commentid="488516" data-postid="3349" data-belowelement="comment-488516" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-488715" class="comment even depth-3 parent">

	      	<div id="li-comment-488715" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/b6f21963e4c0624a84c599adb50397e9.jpeg" srcset="https://secure.gravatar.com/avatar/b6f21963e4c0624a84c599adb50397e9?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Zahra Nabila Izdihar</span>
	                <span class="date">June 13, 2019 at 2:36 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-488715" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I got it. So, “output” (in ForwardPropagation code)= prediction result?</p>
<p> But, I don’t understand How to determine the weights in forward propagation? What is the formula?</p>
<p>Thank you</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-488715" data-commentid="488715" data-postid="3349" data-belowelement="comment-488715" data-respondelement="respond" data-replyto="Reply to Zahra Nabila Izdihar" aria-label="Reply to Zahra Nabila Izdihar">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-488741" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4 parent">

	      	<div id="li-comment-488741" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">June 13, 2019 at 6:21 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-488741" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>What do you mean exactly?</p>
<p>The weights are learned during training.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-488741" data-commentid="488741" data-postid="3349" data-belowelement="comment-488741" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-489059" class="comment even depth-5">

	      	<div id="li-comment-489059" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/1aa422125b70004755cde210b53f1110.jpeg" srcset="https://secure.gravatar.com/avatar/1aa422125b70004755cde210b53f1110?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Zahra</span>
	                <span class="date">June 16, 2019 at 4:51 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-489059" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Did you mean that “output” (in forward propagatation) is predicted result?</p>
<p># test forward propagation<br>
network = [[{‘weights’: [0.13436424411240122, 0.8474337369372327, 0.763774618976614]}],<br>
		[{‘weights’: [0.2550690257394217, 0.49543508709194095]}, {‘weights’: [0.4494910647887381, 0.651592972722763]}]]<br>
row = [1, 0, None]<br>
output = forward_propagate(network, row)<br>
print(output)</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-489078" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-489078" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">June 16, 2019 at 7:16 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-489078" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes.</p>
<p>Perhaps this is too advanced. I recommend starting with Keras instead:<br>
<a href="https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/" rel="nofollow ugc">https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/</a></p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-491304" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-491304" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/866c2651fb44c9b5f2b3448f1488ab92.png" srcset="https://secure.gravatar.com/avatar/866c2651fb44c9b5f2b3448f1488ab92?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Leo</span>
	                <span class="date">July 2, 2019 at 11:25 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-491304" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It is crazy that nobody complain the readability of your codes. Thanks anyway</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-491304" data-commentid="491304" data-postid="3349" data-belowelement="comment-491304" data-respondelement="respond" data-replyto="Reply to Leo" aria-label="Reply to Leo">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-491360" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-491360" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">July 3, 2019 at 8:34 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-491360" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry that you think that the code is not readable. I thought it was very readable.</p>
<p>What do you believe the problem is exactly?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-491360" data-commentid="491360" data-postid="3349" data-belowelement="comment-491360" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-492782" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-492782" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/e35d22c4acb0657088f18912e84b6f68.png" srcset="https://secure.gravatar.com/avatar/e35d22c4acb0657088f18912e84b6f68?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Femi</span>
	                <span class="date">July 14, 2019 at 12:17 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-492782" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Good day Dr. I am new to machine learning but have interest in it. My question is this, can i use the Python 2.7 in miniconda to implement your samples?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-492782" data-commentid="492782" data-postid="3349" data-belowelement="comment-492782" data-respondelement="respond" data-replyto="Reply to Femi" aria-label="Reply to Femi">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-492826" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-492826" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">July 14, 2019 at 8:15 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-492826" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-492826" data-commentid="492826" data-postid="3349" data-belowelement="comment-492826" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-493477" class="comment even thread-even depth-1">

	      	<div id="li-comment-493477" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/266ac380288343098bda656a692970d6.png" srcset="https://secure.gravatar.com/avatar/266ac380288343098bda656a692970d6?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ravi</span>
	                <span class="date">July 19, 2019 at 9:52 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-493477" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Dr. Jason</p>
<p>I have developed and trained a neural network (3 layers: 1 input, 1 hidden and 1 output) for following situation</p>
<p>(The code was written step by step, as i do not want to use a tool without understanding the computations) </p>
<p>Data set (40 input patterns): </p>
<p>Input: 40 samples 5 elements<br>
Output: 40 samples 1 element<br>
number of neurons (Input = 5; hidden = 5; output = 1)</p>
<p>Using the delta rule with backpropagation algorithm, i was able to achieve error =  9.39E-06 for 1000 iterations</p>
<p>My final “input to hidden layer” weight matrix size is 200 x 5 (as i have 40 samples x 5 input neurons and 5 hidden neurons)</p>
<p>             “hidden to output layer” weight matrix size is 200 x 1 (as i have 40 samples x 5 hidden neurons and 1 output neuron)</p>
<p>Now my question is for a given test sample having 5 elements (input is 1 sample 5 elements), </p>
<p>i need to run feed-forward computation to get a single element output.</p>
<p>For running this which weights i need to select in “input to hidden layer” and “hidden to output layer” from the trained set??</p>
<p>I have 200 x 5 and 200 x 1 weight matrices; but i require only 5 x 5 and 5 x 1 weight matrices for testing.</p>
<p>Kindly let me know if i am missing something here?</p>
<p>Thanks in advance</p>
<p>Ravi</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-493477" data-commentid="493477" data-postid="3349" data-belowelement="comment-493477" data-respondelement="respond" data-replyto="Reply to Ravi" aria-label="Reply to Ravi">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-494218" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-494218" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/f731d0f94abb9798e361853a57aaff13.png" srcset="https://secure.gravatar.com/avatar/f731d0f94abb9798e361853a57aaff13?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Chrissie Li</span>
	                <span class="date">July 25, 2019 at 9:06 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-494218" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>hi, how can i download the code? copy the tip’s script?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-494218" data-commentid="494218" data-postid="3349" data-belowelement="comment-494218" data-respondelement="respond" data-replyto="Reply to Chrissie Li" aria-label="Reply to Chrissie Li">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-494265" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-494265" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">July 26, 2019 at 8:22 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-494265" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I show you how right here:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/how-do-i-copy-code-from-a-tutorial" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/how-do-i-copy-code-from-a-tutorial</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-494265" data-commentid="494265" data-postid="3349" data-belowelement="comment-494265" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-494219" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-494219" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/e35d22c4acb0657088f18912e84b6f68.png" srcset="https://secure.gravatar.com/avatar/e35d22c4acb0657088f18912e84b6f68?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Femi</span>
	                <span class="date">July 25, 2019 at 9:39 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-494219" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Prof Sir, pls i have been finding it difficult to implement your samples when i can not prepare environment that accept all the command. Pls help</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-494219" data-commentid="494219" data-postid="3349" data-belowelement="comment-494219" data-respondelement="respond" data-replyto="Reply to Femi" aria-label="Reply to Femi">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-494266" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-494266" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">July 26, 2019 at 8:23 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-494266" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This tutorial will show you how to setup your environment:<br>
<a href="https://machinelearningmastery.com/setup-python-environment-machine-learning-deep-learning-anaconda/" rel="nofollow ugc">https://machinelearningmastery.com/setup-python-environment-machine-learning-deep-learning-anaconda/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-494266" data-commentid="494266" data-postid="3349" data-belowelement="comment-494266" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-494827" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-494827" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/e35d22c4acb0657088f18912e84b6f68.png" srcset="https://secure.gravatar.com/avatar/e35d22c4acb0657088f18912e84b6f68?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Femi</span>
	                <span class="date">July 31, 2019 at 12:39 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-494827" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sir, I guessed you use scipy environment. am i right?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-494827" data-commentid="494827" data-postid="3349" data-belowelement="comment-494827" data-respondelement="respond" data-replyto="Reply to Femi" aria-label="Reply to Femi">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-494868" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-494868" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">July 31, 2019 at 6:53 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-494868" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>For this tutorial, a simple Python environment is enough.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-494868" data-commentid="494868" data-postid="3349" data-belowelement="comment-494868" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-495423" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-495423" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/23dc6269af9741702a7c72bf50e7ea9d.png" srcset="https://secure.gravatar.com/avatar/23dc6269af9741702a7c72bf50e7ea9d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Majed</span>
	                <span class="date">August 4, 2019 at 8:10 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-495423" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I wrote a neural network that consists of three layers as follows:[ 4 input neurones – 5 hidden neurones – 3 output neurones]. first, I standerdized the data using the z-score. The accuracy of my model exceeded 67. Note: I didn’t use the regularisation terms yet.<br>
here is my implementation of both feedforward and back prop .. </p>
<p></p>
		<div id="urvanov-syntax-highlighter-6060ca9c6da8e392952163" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18.9915px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">    while iteration &lt; number_of_iterations:
        z2 = np.dot(x, w1)
        a2 = sigmoid(z2)
        z3 = np.dot(a2, w2)
        a3 = sigmoid(z3)  # this represents the output of the network
        error = loss_function(a3, label_matrix)
        delta_3 = np.multiply(-(label_matrix-a3), sigmoid_prime(z3))
        dJW2 = np.dot(a2.transpose(), delta_3)
        delta_2 = np.dot(delta_3, w2.transpose()) * sigmoid_prime(z2)
        dJW1 = x.transpose() @ delta_2
        w2 = w2 - (learning_rate * dJW2)
        w1 = w1 - (learning_rate * dJW1)
        iteration = iteration + 1  # update the counter :')
    return w1, w2</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c6da8e392952163-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c6da8e392952163-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c6da8e392952163-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c6da8e392952163-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c6da8e392952163-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c6da8e392952163-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c6da8e392952163-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c6da8e392952163-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c6da8e392952163-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c6da8e392952163-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c6da8e392952163-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c6da8e392952163-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c6da8e392952163-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c6da8e392952163-14">14</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c6da8e392952163-1"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-v">iteration</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">number_of_iterations</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c6da8e392952163-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">z2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">dot</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">w1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c6da8e392952163-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">a2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">sigmoid</span><span class="crayon-sy">(</span><span class="crayon-v">z2</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c6da8e392952163-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">z3</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">dot</span><span class="crayon-sy">(</span><span class="crayon-v">a2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">w2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c6da8e392952163-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">a3</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">sigmoid</span><span class="crayon-sy">(</span><span class="crayon-v">z3</span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-p"># this represents the output of the network</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c6da8e392952163-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">error</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">loss_function</span><span class="crayon-sy">(</span><span class="crayon-v">a3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label_matrix</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c6da8e392952163-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">delta_3</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">multiply</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-sy">(</span><span class="crayon-v">label_matrix</span><span class="crayon-o">-</span><span class="crayon-v">a3</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">sigmoid_prime</span><span class="crayon-sy">(</span><span class="crayon-v">z3</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c6da8e392952163-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">dJW2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">dot</span><span class="crayon-sy">(</span><span class="crayon-v">a2</span><span class="crayon-sy">.</span><span class="crayon-e">transpose</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">delta_3</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c6da8e392952163-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">delta_2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">dot</span><span class="crayon-sy">(</span><span class="crayon-v">delta_3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">w2</span><span class="crayon-sy">.</span><span class="crayon-e">transpose</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-e">sigmoid_prime</span><span class="crayon-sy">(</span><span class="crayon-v">z2</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c6da8e392952163-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">dJW1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">.</span><span class="crayon-e">transpose</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">@</span><span class="crayon-h"> </span><span class="crayon-e">delta_2</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c6da8e392952163-11"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">w2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">w2</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e ">learning_rate *</span><span class="crayon-h"> </span><span class="crayon-v">dJW2</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c6da8e392952163-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">w1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">w1</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e ">learning_rate *</span><span class="crayon-h"> </span><span class="crayon-v">dJW1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c6da8e392952163-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">iteration</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">iteration</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-p"># update the counter :')</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c6da8e392952163-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">w1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">w2</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p></p>
<p>Thanks …</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-495423" data-commentid="495423" data-postid="3349" data-belowelement="comment-495423" data-respondelement="respond" data-replyto="Reply to Majed" aria-label="Reply to Majed">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-495424" class="comment even depth-2">

	      	<div id="li-comment-495424" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/23dc6269af9741702a7c72bf50e7ea9d.png" srcset="https://secure.gravatar.com/avatar/23dc6269af9741702a7c72bf50e7ea9d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Majed</span>
	                <span class="date">August 4, 2019 at 8:11 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-495424" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The data set that I worked on is the Iris data set</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-495424" data-commentid="495424" data-postid="3349" data-belowelement="comment-495424" data-respondelement="respond" data-replyto="Reply to Majed" aria-label="Reply to Majed">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-495505" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-495505" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">August 5, 2019 at 6:43 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-495505" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Well done!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-495505" data-commentid="495505" data-postid="3349" data-belowelement="comment-495505" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-495742" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-495742" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/e35d22c4acb0657088f18912e84b6f68.png" srcset="https://secure.gravatar.com/avatar/e35d22c4acb0657088f18912e84b6f68?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ekundayo</span>
	                <span class="date">August 6, 2019 at 9:40 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-495742" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Ca I still get an help this one time? Pls sir, my project is to use 14 features extractions for plant leave classification. I need to recognize one leaf out of 36 leaves all with 14 features. Sir can  I use your code to achieve this?<br>
Thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-495742" data-commentid="495742" data-postid="3349" data-belowelement="comment-495742" data-respondelement="respond" data-replyto="Reply to Ekundayo" aria-label="Reply to Ekundayo">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-495795" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-495795" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">August 7, 2019 at 7:52 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-495795" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I would recommend this tutorial, e.g. transfer learning:<br>
<a href="https://machinelearningmastery.com/how-to-use-transfer-learning-when-developing-convolutional-neural-network-models/" rel="nofollow ugc">https://machinelearningmastery.com/how-to-use-transfer-learning-when-developing-convolutional-neural-network-models/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-495795" data-commentid="495795" data-postid="3349" data-belowelement="comment-495795" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-496710" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-496710" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/860510f408423e3067931de95b91a69c.png" srcset="https://secure.gravatar.com/avatar/860510f408423e3067931de95b91a69c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Mohammed</span>
	                <span class="date">August 14, 2019 at 12:20 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-496710" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Dr. Jason</p>
<p>Thank you for this post, it is really very helpful.</p>
<p>I have one question about backpropagation in unsupervised model, e.g. extract features.<br>
Is it possible to apply this code for it, and only replaces loss function of unsupervised model by the loss function of supervised?</p>
<p>Regards</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-496710" data-commentid="496710" data-postid="3349" data-belowelement="comment-496710" data-respondelement="respond" data-replyto="Reply to Mohammed" aria-label="Reply to Mohammed">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-496724" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-496724" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">August 14, 2019 at 2:10 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-496724" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Backpropagation is for supervised learning, not unsupervised learning.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-496724" data-commentid="496724" data-postid="3349" data-belowelement="comment-496724" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-496856" class="comment even depth-3 parent">

	      	<div id="li-comment-496856" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/860510f408423e3067931de95b91a69c.png" srcset="https://secure.gravatar.com/avatar/860510f408423e3067931de95b91a69c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Mohammed</span>
	                <span class="date">August 15, 2019 at 5:08 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-496856" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Oh! many thanks,So, can help me what is the way for learning parameters in unsupervised approach.<br>
if i need to extract the features from data as low dimension nested of data with large dimension.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-496856" data-commentid="496856" data-postid="3349" data-belowelement="comment-496856" data-respondelement="respond" data-replyto="Reply to Mohammed" aria-label="Reply to Mohammed">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-496924" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-496924" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">August 16, 2019 at 7:47 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-496924" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>There are specialized techniques for unsupervised learning neural nets, perhaps start with the SOM:<br>
<a href="http://cleveralgorithms.com/nature-inspired/neural/som.html" rel="nofollow ugc">http://cleveralgorithms.com/nature-inspired/neural/som.html</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-496924" data-commentid="496924" data-postid="3349" data-belowelement="comment-496924" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-496857" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-496857" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/860510f408423e3067931de95b91a69c.png" srcset="https://secure.gravatar.com/avatar/860510f408423e3067931de95b91a69c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Mohammed</span>
	                <span class="date">August 15, 2019 at 5:10 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-496857" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>such as Unsupervised feature learning with Sparse Filtering!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-496857" data-commentid="496857" data-postid="3349" data-belowelement="comment-496857" data-respondelement="respond" data-replyto="Reply to Mohammed" aria-label="Reply to Mohammed">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-496925" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-496925" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">August 16, 2019 at 7:48 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-496925" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I don’t have a tutorial on that topic, perhaps in the future.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-496925" data-commentid="496925" data-postid="3349" data-belowelement="comment-496925" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-496966" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-496966" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/860510f408423e3067931de95b91a69c.png" srcset="https://secure.gravatar.com/avatar/860510f408423e3067931de95b91a69c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Mohammed</span>
	                <span class="date">August 16, 2019 at 11:20 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-496966" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you so much Dr. Jason.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-496966" data-commentid="496966" data-postid="3349" data-belowelement="comment-496966" data-respondelement="respond" data-replyto="Reply to Mohammed" aria-label="Reply to Mohammed">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-496986" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-496986" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">August 16, 2019 at 2:10 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-496986" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You’re welcome.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-496986" data-commentid="496986" data-postid="3349" data-belowelement="comment-496986" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-497496" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-497496" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/8869ecdadb916e09a93414802340ca1f.png" srcset="https://secure.gravatar.com/avatar/8869ecdadb916e09a93414802340ca1f?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Cherinet Mores</span>
	                <span class="date">August 20, 2019 at 4:44 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-497496" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Jason Brownlee<br>
Thank you for your continues help<br>
Here I have one questions,<br>
In case, if i want to solve the regression problem (Meaning, if I have 3 real value outputs from the input parameters) which part of the code should be modified and How? </p>
<p>Thank you very much</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-497496" data-commentid="497496" data-postid="3349" data-belowelement="comment-497496" data-respondelement="respond" data-replyto="Reply to Cherinet Mores" aria-label="Reply to Cherinet Mores">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-497551" class="comment odd alt depth-2 parent">

	      	<div id="li-comment-497551" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/fbd799366fa43d79b93260649d5991d5.png" srcset="https://secure.gravatar.com/avatar/fbd799366fa43d79b93260649d5991d5?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://www.slimstock.be/" rel="external nofollow ugc" class="url">Steven Pauly</a></span>
	                <span class="date">August 20, 2019 at 9:59 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-497551" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Cherinet, I’ve changed the n_outputs to 1 and the function train_network, I’ve changed the below. I’ve increased the n_epoch to a lot higher, because else it will give you the average. Be sure to normalize your input &amp; output values, though.</p>
<p></p>
		<div id="urvanov-syntax-highlighter-6060ca9c6d8ff823839698" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18.9915px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">def train_network(network, train, l_rate, n_epoch, n_outputs):
	for epoch in range(n_epoch):
		sum_error = 0
		for row in train:
			outputs = forward_propagate(network, row)
			expected = [row[-1] for i in range(n_outputs)]
			sum_error = sum([(expected[i]-outputs[i])**2 for i in range(len(expected))])
			backward_propagate_error(network, expected)
			update_weights(network, row, l_rate)
		print('&gt;epoch=%d, lrate=%.3f, error=%.3f' % (epoch, l_rate, sum_error))</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c6d8ff823839698-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c6d8ff823839698-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c6d8ff823839698-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c6d8ff823839698-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c6d8ff823839698-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c6d8ff823839698-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c6d8ff823839698-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c6d8ff823839698-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c6d8ff823839698-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c6d8ff823839698-10">10</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c6d8ff823839698-1"><span class="crayon-e">def </span><span class="crayon-e">train_network</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">l_rate</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_epoch</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_outputs</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c6d8ff823839698-2"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">epoch </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_epoch</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c6d8ff823839698-3"><span class="crayon-h">		</span><span class="crayon-v">sum_error</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c6d8ff823839698-4"><span class="crayon-h">		</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c6d8ff823839698-5"><span class="crayon-h">			</span><span class="crayon-v">outputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">forward_propagate</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c6d8ff823839698-6"><span class="crayon-h">			</span><span class="crayon-v">expected</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_outputs</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c6d8ff823839698-7"><span class="crayon-h">			</span><span class="crayon-v">sum_error</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">sum</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-v">expected</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-o">-</span><span class="crayon-v">outputs</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">expected</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c6d8ff823839698-8"><span class="crayon-h">			</span><span class="crayon-e">backward_propagate_error</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">expected</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c6d8ff823839698-9"><span class="crayon-h">			</span><span class="crayon-e">update_weights</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">l_rate</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c6d8ff823839698-10"><span class="crayon-h">		</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'&gt;epoch=%d, lrate=%.3f, error=%.3f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">epoch</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">l_rate</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">sum_error</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-497551" data-commentid="497551" data-postid="3349" data-belowelement="comment-497551" data-respondelement="respond" data-replyto="Reply to Steven Pauly" aria-label="Reply to Steven Pauly">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-497623" class="comment byuser comment-author-jasonb bypostauthor even depth-3">

	      	<div id="li-comment-497623" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">August 21, 2019 at 6:42 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-497623" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for sharing.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-497623" data-commentid="497623" data-postid="3349" data-belowelement="comment-497623" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-497648" class="comment odd alt depth-3">

	      	<div id="li-comment-497648" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/8869ecdadb916e09a93414802340ca1f.png" srcset="https://secure.gravatar.com/avatar/8869ecdadb916e09a93414802340ca1f?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Cherinet Mores</span>
	                <span class="date">August 21, 2019 at 8:06 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-497648" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dear Steven Pauly thank you very much for your help.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-497648" data-commentid="497648" data-postid="3349" data-belowelement="comment-497648" data-respondelement="respond" data-replyto="Reply to Cherinet Mores" aria-label="Reply to Cherinet Mores">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-501841" class="comment even depth-3">

	      	<div id="li-comment-501841" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/6ebbf8e6a82fb4ed81dbb412de199c74.png" srcset="https://secure.gravatar.com/avatar/6ebbf8e6a82fb4ed81dbb412de199c74?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Charles</span>
	                <span class="date">September 17, 2019 at 1:01 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-501841" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, </p>
<p>By normalizing input and output, do you mean modifying the forward_propogate method like this?</p>
<p></p>
		<div id="urvanov-syntax-highlighter-6060ca9c6d7a9055436174" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18.9915px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># Forward propagate input to a network output
def forward_propagate_regression(network, row):
    inputs = row
    new_inputs = []
    # gets the 1st layer, applies sigmoid activation
    hiddenlayer = network[0]
    for neuron in hiddenlayer:
        activation = activate(neuron['weights'], inputs)
        neuron['output'] = transfer(activation)
        new_inputs.append(neuron['output'])
    inputs = new_inputs
    # gets the last layer, applies linear activation
    outputlayer = network[-1]
    for neuron in outputlayer:
        activation = activate(neuron['weights'], inputs)
        neuron['output'] = activation
        new_inputs.append(neuron['output'])
    inputs = new_inputs
    return inputs</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c6d7a9055436174-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c6d7a9055436174-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c6d7a9055436174-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c6d7a9055436174-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c6d7a9055436174-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c6d7a9055436174-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c6d7a9055436174-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c6d7a9055436174-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c6d7a9055436174-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c6d7a9055436174-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c6d7a9055436174-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c6d7a9055436174-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c6d7a9055436174-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c6d7a9055436174-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c6d7a9055436174-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c6d7a9055436174-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c6d7a9055436174-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6060ca9c6d7a9055436174-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6060ca9c6d7a9055436174-19">19</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c6d7a9055436174-1"><span class="crayon-p"># Forward propagate input to a network output</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c6d7a9055436174-2"><span class="crayon-e">def </span><span class="crayon-e">forward_propagate_regression</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c6d7a9055436174-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">row</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c6d7a9055436174-4"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">new_inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c6d7a9055436174-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-p"># gets the 1st layer, applies sigmoid activation</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c6d7a9055436174-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">hiddenlayer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c6d7a9055436174-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">neuron </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">hiddenlayer</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c6d7a9055436174-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">activate</span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'weights'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c6d7a9055436174-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">transfer</span><span class="crayon-sy">(</span><span class="crayon-v">activation</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c6d7a9055436174-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">new_inputs</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c6d7a9055436174-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">new</span><span class="crayon-sy">_</span>inputs</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c6d7a9055436174-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-p"># gets the last layer, applies linear activation</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c6d7a9055436174-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">outputlayer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c6d7a9055436174-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">neuron </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">outputlayer</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c6d7a9055436174-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">activate</span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'weights'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c6d7a9055436174-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">activation</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c6d7a9055436174-17"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">new_inputs</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6060ca9c6d7a9055436174-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">new_inputs</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6060ca9c6d7a9055436174-19"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-501841" data-commentid="501841" data-postid="3349" data-belowelement="comment-501841" data-respondelement="respond" data-replyto="Reply to Charles" aria-label="Reply to Charles">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-497611" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-497611" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">August 21, 2019 at 6:36 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-497611" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Change the output to be a linear activation and the loss function to mse.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-497611" data-commentid="497611" data-postid="3349" data-belowelement="comment-497611" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-497550" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-497550" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/fbd799366fa43d79b93260649d5991d5.png" srcset="https://secure.gravatar.com/avatar/fbd799366fa43d79b93260649d5991d5?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://www.slimstock.be/" rel="external nofollow ugc" class="url">Steven Pauly</a></span>
	                <span class="date">August 20, 2019 at 9:56 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-497550" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Well Done, Jason! Great stuff!!!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-497550" data-commentid="497550" data-postid="3349" data-belowelement="comment-497550" data-respondelement="respond" data-replyto="Reply to Steven Pauly" aria-label="Reply to Steven Pauly">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-497622" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-497622" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">August 21, 2019 at 6:41 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-497622" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks, I’m glad it helped.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-497622" data-commentid="497622" data-postid="3349" data-belowelement="comment-497622" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-502840" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-502840" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/9a79b5b90a280d4f5fba8351b6d1334a.png" srcset="https://secure.gravatar.com/avatar/9a79b5b90a280d4f5fba8351b6d1334a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">George Shannon</span>
	                <span class="date">September 25, 2019 at 12:09 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-502840" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dear Dr. Brownlee:</p>
<p>Do you have an example of doing the same thing but with backprop using momentum?</p>
<p>George</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-502840" data-commentid="502840" data-postid="3349" data-belowelement="comment-502840" data-respondelement="respond" data-replyto="Reply to George Shannon" aria-label="Reply to George Shannon">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-502880" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-502880" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">September 25, 2019 at 5:59 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-502880" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can easily update the example to add momentum.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-502880" data-commentid="502880" data-postid="3349" data-belowelement="comment-502880" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-581816" class="comment even depth-3 parent">

	      	<div id="li-comment-581816" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/3a3dbb7d2e677ca4b32ed7e429cfbe95.png" srcset="https://secure.gravatar.com/avatar/3a3dbb7d2e677ca4b32ed7e429cfbe95?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">shahrul</span>
	                <span class="date">December 8, 2020 at 7:29 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-581816" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>can you show me how to add momentum in this tutorial, I quite confuse how to apply the momentum calculation.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-581816" data-commentid="581816" data-postid="3349" data-belowelement="comment-581816" data-respondelement="respond" data-replyto="Reply to shahrul" aria-label="Reply to shahrul">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-581968" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-581968" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">December 9, 2020 at 6:13 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-581968" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This is a common question that I answer here:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/can-you-change-the-code-in-the-tutorial-to-___" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/can-you-change-the-code-in-the-tutorial-to-___</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-581968" data-commentid="581968" data-postid="3349" data-belowelement="comment-581968" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-504271" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-504271" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/108c0074e685e6765dbeb0e130f34be4.png" srcset="https://secure.gravatar.com/avatar/108c0074e685e6765dbeb0e130f34be4?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Harini</span>
	                <span class="date">October 6, 2019 at 3:45 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-504271" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dear Sir,</p>
<p>This tutorial is really helpful for a beginner like me. I couldn’t understand where the input and output nodes are mentioned in the code. How to change number of nodes for input and output layer. Kindly help me with it.</p>
<p>Regards</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-504271" data-commentid="504271" data-postid="3349" data-belowelement="comment-504271" data-respondelement="respond" data-replyto="Reply to Harini" aria-label="Reply to Harini">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-504336" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-504336" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">October 6, 2019 at 8:17 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-504336" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps start with this even simpler example:<br>
<a href="https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/" rel="nofollow ugc">https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-504336" data-commentid="504336" data-postid="3349" data-belowelement="comment-504336" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-506555" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-506555" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/c5e8ae78e24da1f52dbb9029073c4be6.jpeg" srcset="https://secure.gravatar.com/avatar/c5e8ae78e24da1f52dbb9029073c4be6?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Víctor</span>
	                <span class="date">October 21, 2019 at 5:06 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-506555" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason, </p>
<p>Thanks for this great tutorial. How can the trained model be saved with this example? I mean with pickle or joblib in a .sav file like in other scikit classifiers. Thanks.</p>
<p>Regards</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-506555" data-commentid="506555" data-postid="3349" data-belowelement="comment-506555" data-respondelement="respond" data-replyto="Reply to Víctor" aria-label="Reply to Víctor">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-506585" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-506585" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">October 21, 2019 at 6:25 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-506585" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I recommend using sklearn for real projects, this code is for learning purposes only.</p>
<p>That being said, you can save the “network” prepared in the backpropagation function.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-506585" data-commentid="506585" data-postid="3349" data-belowelement="comment-506585" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-508070" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-508070" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/dd1dd66a96a9c74ca140b7265816a667.png" srcset="https://secure.gravatar.com/avatar/dd1dd66a96a9c74ca140b7265816a667?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">chamodi</span>
	                <span class="date">October 31, 2019 at 5:53 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-508070" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you very much sir..your articles are always very clear,greatly supporting in coding.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-508070" data-commentid="508070" data-postid="3349" data-belowelement="comment-508070" data-respondelement="respond" data-replyto="Reply to chamodi" aria-label="Reply to chamodi">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-508169" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-508169" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">November 1, 2019 at 5:26 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-508169" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-508169" data-commentid="508169" data-postid="3349" data-belowelement="comment-508169" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-509375" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-509375" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/1ca5490c4057fb4cbc6e7fd2adbdbea8.png" srcset="https://secure.gravatar.com/avatar/1ca5490c4057fb4cbc6e7fd2adbdbea8?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jaya</span>
	                <span class="date">November 9, 2019 at 3:10 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-509375" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for great tutorial. How can we determine the number of neuron we used in each of hidden layer?. Thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-509375" data-commentid="509375" data-postid="3349" data-belowelement="comment-509375" data-respondelement="respond" data-replyto="Reply to Jaya" aria-label="Reply to Jaya">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-509540" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-509540" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">November 10, 2019 at 8:16 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-509540" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This is a common question that I answer here:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/how-many-layers-and-nodes-do-i-need-in-my-neural-network" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/how-many-layers-and-nodes-do-i-need-in-my-neural-network</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-509540" data-commentid="509540" data-postid="3349" data-belowelement="comment-509540" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-510282" class="comment even depth-3 parent">

	      	<div id="li-comment-510282" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/1ca5490c4057fb4cbc6e7fd2adbdbea8.png" srcset="https://secure.gravatar.com/avatar/1ca5490c4057fb4cbc6e7fd2adbdbea8?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jaya</span>
	                <span class="date">November 13, 2019 at 12:20 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-510282" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for the answer, i mean in your code is there variable that we can set to determine the sum of neuron in each hidden layer.<br>
And one question more, is there case that epoch looping will stop when the error values is small or epoch looping is always looping until finish to max epoch?<br>
sorry for my bad english and im a newbie in neural network<br>
thanks you so much</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-510282" data-commentid="510282" data-postid="3349" data-belowelement="comment-510282" data-respondelement="respond" data-replyto="Reply to Jaya" aria-label="Reply to Jaya">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-510366" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-510366" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">November 13, 2019 at 5:45 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-510366" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>No, in this example we run for a fixed number of epochs.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-510366" data-commentid="510366" data-postid="3349" data-belowelement="comment-510366" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-512525" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-512525" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/e581ff55cdf66c0aebd6bf71719f9838.png" srcset="https://secure.gravatar.com/avatar/e581ff55cdf66c0aebd6bf71719f9838?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jean</span>
	                <span class="date">November 27, 2019 at 2:08 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-512525" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason,<br>
Thanks for great content.<br>
Nevertheless, I think it would much better if you could also write down the mathematical equation behind the code(s). It would be much easier to understand how all “those scary math” are implemented.<br>
Anyway very good job!</p>
<p>Regards,<br>
Jean</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-512525" data-commentid="512525" data-postid="3349" data-belowelement="comment-512525" data-respondelement="respond" data-replyto="Reply to Jean" aria-label="Reply to Jean">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-512567" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-512567" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">November 27, 2019 at 6:09 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-512567" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for the suggestion.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-512567" data-commentid="512567" data-postid="3349" data-belowelement="comment-512567" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-514018" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-514018" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/59b72106f85f352d32044e3726facd37.png" srcset="https://secure.gravatar.com/avatar/59b72106f85f352d32044e3726facd37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Tobias</span>
	                <span class="date">December 7, 2019 at 7:27 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-514018" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It does not work for xor but it works for the first data you used. Why?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-514018" data-commentid="514018" data-postid="3349" data-belowelement="comment-514018" data-respondelement="respond" data-replyto="Reply to Tobias" aria-label="Reply to Tobias">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-514135" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-514135" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">December 8, 2019 at 6:00 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-514135" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The network was designed for a specific dataset.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-514135" data-commentid="514135" data-postid="3349" data-belowelement="comment-514135" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-514024" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-514024" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/59b72106f85f352d32044e3726facd37.png" srcset="https://secure.gravatar.com/avatar/59b72106f85f352d32044e3726facd37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Tobias</span>
	                <span class="date">December 7, 2019 at 7:54 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-514024" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>this is what it is outputting</p>
<p>Expected=1, Got=0<br>
Expected=1, Got=0<br>
Expected=0, Got=0<br>
Expected=0, Got=0</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-514024" data-commentid="514024" data-postid="3349" data-belowelement="comment-514024" data-respondelement="respond" data-replyto="Reply to Tobias" aria-label="Reply to Tobias">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-514138" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-514138" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">December 8, 2019 at 6:02 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-514138" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps try tuning the architecture and training of the model to your specific dataset.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-514138" data-commentid="514138" data-postid="3349" data-belowelement="comment-514138" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-514104" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-514104" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/9d0afd79f064e4d55e3d87fb7f9f5e86.png" srcset="https://secure.gravatar.com/avatar/9d0afd79f064e4d55e3d87fb7f9f5e86?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Samara Silva Santos</span>
	                <span class="date">December 8, 2019 at 1:13 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-514104" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hii, I would like to know what do you mean when you say that  “Using the Zero Rule algorithm that predicts the most common class value, the baseline accuracy for the problem is 28.095%.”</p>
<p>If I use this algoritm for another use case, the accuracity is just 28%?</p>
<p>Please, look what I have:<br>
I need to modify this approach to use Quasi-newton method to calculate the error, instead of gradient method. The gradient method, what you have used, use partial derivative to calculate if the error is growing on. I see that you implemented derivative this way:</p>
<p>def transfer_derivative(output):<br>
	return output * (1.0 – output)</p>
<p>And what I know is that derivate is calculated this way:</p>
<p>( f(x + h) – f( x) ) /h</p>
<p>this both way are equivalent?</p>
<p>I already have quasi-newton method implemented but it is now really difficult to me make this modification. </p>
<p>Please, let me know if you could help me. I really appreciate your help.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-514104" data-commentid="514104" data-postid="3349" data-belowelement="comment-514104" data-respondelement="respond" data-replyto="Reply to Samara Silva Santos" aria-label="Reply to Samara Silva Santos">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-514155" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-514155" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">December 8, 2019 at 6:14 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-514155" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I mean predicting the majority class. It is a naive classifier sometimes called the zero rule.</p>
<p>Sorry, I don’t have the capacity to help you adapt the example to use a different optimization algorithm.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-514155" data-commentid="514155" data-postid="3349" data-belowelement="comment-514155" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-514295" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-514295" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/b5f9cece1d603ce3bb1ab8cfe152ca58.png" srcset="https://secure.gravatar.com/avatar/b5f9cece1d603ce3bb1ab8cfe152ca58?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jeff Myzek</span>
	                <span class="date">December 9, 2019 at 9:49 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-514295" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hey Jason,<br>
   I am trying to use your code to run back propagation on MNIST with the following parameters but i am having trouble: 784 input units, a hidden layer of 100, and a Softmax group of 10 units as the output layer, cross-entropy loss objective function. I want to compute the weight update based on the entire training set, using the error backpropagation algorithm. learning rate that’s small enough for all practical purposes, but not so small that the network doesn’t learn. And I want to stop when the weight update becomes zero.  Optimally i would want to see the weight vector and loss at each step. would you be able to assist me?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-514295" data-commentid="514295" data-postid="3349" data-belowelement="comment-514295" data-respondelement="respond" data-replyto="Reply to Jeff Myzek" aria-label="Reply to Jeff Myzek">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-514314" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-514314" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">December 9, 2019 at 1:43 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-514314" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I would recommend using mini-batches to approximate the error gradient.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-514314" data-commentid="514314" data-postid="3349" data-belowelement="comment-514314" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-514593" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-514593" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/ba96e6b5fecaeb07ca32ea932df8804b.jpeg" srcset="https://secure.gravatar.com/avatar/ba96e6b5fecaeb07ca32ea932df8804b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sabarish</span>
	                <span class="date">December 11, 2019 at 6:20 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-514593" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Back Propagate Error:</p>
<p>We are using the sigmoid transfer function, the derivative of which can be calculated as follows:</p>
<p>derivative = output * (1.0 – output)</p>
<p>What does it mean? I am not clear. Could you please help me understand?<br>
Sigmoid function =1/1+e**-x<br>
How come derivative of it be  output * (1.0 – output)??</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-514593" data-commentid="514593" data-postid="3349" data-belowelement="comment-514593" data-respondelement="respond" data-replyto="Reply to Sabarish" aria-label="Reply to Sabarish">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-514652" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-514652" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">December 12, 2019 at 6:15 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-514652" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The gradient or slope at a point on the function.<br>
<a href="https://en.wikipedia.org/wiki/Logistic_function" rel="nofollow ugc">https://en.wikipedia.org/wiki/Logistic_function</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-514652" data-commentid="514652" data-postid="3349" data-belowelement="comment-514652" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-515516" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-515516" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/66e29834bc5e1e0b41859a9a3d886874.png" srcset="https://secure.gravatar.com/avatar/66e29834bc5e1e0b41859a9a3d886874?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sylvan</span>
	                <span class="date">December 17, 2019 at 7:25 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-515516" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello here!</p>
<p>I am very new with Python in Data Science and Artificial Intelligence. Can anyone here help me with this AI assignment below due by December  19 2019, please? I am seriously stuck. Here is the question:</p>
<p>&lt;&gt; End of the question.<br>
———————————————————————</p>
<p>Below is the indicator simple code:</p>
<p>#Indicators.py</p>
<p># Import Built-Ins<br>
import logging</p>
<p># Import Third-Party<br>
import pandas as pd<br>
import numpy as np</p>
<p># Import Homebrew</p>
<p># Init Logging Facilities<br>
log = logging.getLogger(__name__)</p>
<p>#<br>
from alpha_vantage.timeseries import TimeSeries<br>
import matplotlib.pyplot as plt</p>
<p># Add get_price() def from get_price_alphavantagepy code<br>
def get_prices():<br>
	apikey = “BW4V00IXHSAE829D”</p>
<p>	ts = TimeSeries(key=apikey, output_format=’pandas’)<br>
	data, meta_data = ts.get_intraday(symbol=’MSFT’,interval=’1min’, outputsize=’full’)<br>
	data[‘4. close’]</p>
<p># End add get_price() def from get_price_alphavantagepy code</p>
<p>	#plt.title(‘Intraday Times Series for the MSFT stock (1 min)’)<br>
	#plt.show()<br>
	return data[‘4. close’] #return price</p>
<p>#if __name__ == “__main__”:<br>
#	get_prices()</p>
<p>def rsi(price, n=14): #rsi(prices, n=14):<br>
        deltas = np.diff(prices)<br>
        seed = deltas[:n+1]<br>
        up = seed[seed&gt;=0].sum()/n<br>
        down = -seed[seed0:<br>
                        upval = delta<br>
                        downval = 0.<br>
                else:<br>
                        upval = 0.<br>
                        downval = -delta<br>
                up = (up*(n-1) + upval)/n<br>
                down = (down*(n-1) + downval)/n</p>
<p>                rs = up/down<br>
                rsi[i] = 100. – 100./(1.+rs)<br>
        return rsi<br>
prices = get_prices()<br>
print(“\n”)<br>
print(rsi(prices))<br>
print(“\n”)</p>
<p>——————————–</p>
<p>Very thank you in advance.</p>
<p>*Sylvan</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-515516" data-commentid="515516" data-postid="3349" data-belowelement="comment-515516" data-respondelement="respond" data-replyto="Reply to Sylvan" aria-label="Reply to Sylvan">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-515518" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-515518" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">December 17, 2019 at 7:34 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-515518" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps try posting your code and question to stackoverflow?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-515518" data-commentid="515518" data-postid="3349" data-belowelement="comment-515518" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-516043" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-516043" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/e94e7545fe246e8bbb1e00967e453bf9.png" srcset="https://secure.gravatar.com/avatar/e94e7545fe246e8bbb1e00967e453bf9?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">bismeet</span>
	                <span class="date">December 22, 2019 at 5:12 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-516043" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>row = [1, 0, None]<br>
Cant understand the use of None here.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-516043" data-commentid="516043" data-postid="3349" data-belowelement="comment-516043" data-respondelement="respond" data-replyto="Reply to bismeet" aria-label="Reply to bismeet">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-516073" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-516073" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">December 23, 2019 at 6:44 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-516073" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The final value in the row is the class label. Here we set None, as in no class label.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-516073" data-commentid="516073" data-postid="3349" data-belowelement="comment-516073" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-516182" class="comment even depth-3 parent">

	      	<div id="li-comment-516182" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/e94e7545fe246e8bbb1e00967e453bf9.png" srcset="https://secure.gravatar.com/avatar/e94e7545fe246e8bbb1e00967e453bf9?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">bismeet</span>
	                <span class="date">December 24, 2019 at 12:40 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-516182" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I still don’t understand , how can an input have no class label?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-516182" data-commentid="516182" data-postid="3349" data-belowelement="comment-516182" data-respondelement="respond" data-replyto="Reply to bismeet" aria-label="Reply to bismeet">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-516196" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-516196" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">December 24, 2019 at 4:58 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-516196" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>In the case where we want to make a prediction.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-516196" data-commentid="516196" data-postid="3349" data-belowelement="comment-516196" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-516053" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-516053" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/e94e7545fe246e8bbb1e00967e453bf9.png" srcset="https://secure.gravatar.com/avatar/e94e7545fe246e8bbb1e00967e453bf9?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">bismeet</span>
	                <span class="date">December 22, 2019 at 9:40 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-516053" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Why are there two formulas for error?</p>
<p>error = (expected – output) * transfer_derivative(output)</p>
<p>error = (weight_k * error_j) * transfer_derivative(output)</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-516053" data-commentid="516053" data-postid="3349" data-belowelement="comment-516053" data-respondelement="respond" data-replyto="Reply to bismeet" aria-label="Reply to bismeet">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-516077" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-516077" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">December 23, 2019 at 6:49 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-516077" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>They are the same, but one for the output of the model and one for credit assignment for each weight.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-516077" data-commentid="516077" data-postid="3349" data-belowelement="comment-516077" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-516227" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-516227" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/93313dc184cbaa2b9401d0b135fe15ec.png" srcset="https://secure.gravatar.com/avatar/93313dc184cbaa2b9401d0b135fe15ec?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Vaishu</span>
	                <span class="date">December 24, 2019 at 9:23 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-516227" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Why can’t we use same backpropagation algorithm code for wheatseed_dataset as the one used in previous case?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-516227" data-commentid="516227" data-postid="3349" data-belowelement="comment-516227" data-respondelement="respond" data-replyto="Reply to Vaishu" aria-label="Reply to Vaishu">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-516270" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-516270" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">December 25, 2019 at 10:36 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-516270" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can. We do.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-516270" data-commentid="516270" data-postid="3349" data-belowelement="comment-516270" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-518421" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-518421" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/da088388565bf440f8126d436c4bdb94.png" srcset="https://secure.gravatar.com/avatar/da088388565bf440f8126d436c4bdb94?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ansist</span>
	                <span class="date">January 19, 2020 at 1:49 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-518421" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, I am a little new to the implementing neural networks and the underlying mathematics. I wanted to know why the target variable (y-variable) is usually binary in nature ([0 or 1]). Why can’t I have, say for example returns (usually between [-1,1] continuous)? </p>
<p>Secondly, is it always advised to transform your X and Y variables before feeding them into the neural network?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-518421" data-commentid="518421" data-postid="3349" data-belowelement="comment-518421" data-respondelement="respond" data-replyto="Reply to Ansist" aria-label="Reply to Ansist">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-518447" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-518447" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">January 19, 2020 at 7:17 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-518447" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can, it is common to use 0 and 1 with a sigmoid activation function in the output layer.</p>
<p>It is good practice to scale data:<br>
<a href="https://machinelearningmastery.com/how-to-improve-neural-network-stability-and-modeling-performance-with-data-scaling/" rel="nofollow ugc">https://machinelearningmastery.com/how-to-improve-neural-network-stability-and-modeling-performance-with-data-scaling/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-518447" data-commentid="518447" data-postid="3349" data-belowelement="comment-518447" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-518843" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-518843" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/6d319ce921264add5d45ccd578e24af8.png" srcset="https://secure.gravatar.com/avatar/6d319ce921264add5d45ccd578e24af8?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://www.itam.mx/" rel="external nofollow ugc" class="url">rafael gamboa</a></span>
	                <span class="date">January 23, 2020 at 10:54 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-518843" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>it function perfectly!!!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-518843" data-commentid="518843" data-postid="3349" data-belowelement="comment-518843" data-respondelement="respond" data-replyto="Reply to rafael gamboa" aria-label="Reply to rafael gamboa">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-518862" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-518862" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">January 23, 2020 at 12:56 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-518862" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks, I’m, happy to hear that.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-518862" data-commentid="518862" data-postid="3349" data-belowelement="comment-518862" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-519589" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-519589" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/0dad874678a4d156f5b6e971e8a9f05f.png" srcset="https://secure.gravatar.com/avatar/0dad874678a4d156f5b6e971e8a9f05f?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://dbrama.blogspot.com/" rel="external nofollow ugc" class="url">Bram</a></span>
	                <span class="date">January 28, 2020 at 6:00 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-519589" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>hi jason,<br>
I just finished the tutorial, this tutorial is very helpfull for me as the beginner in python and neural network. i have some question for the k-fold validation</p>
<p>in the tutorial above I see if every fold process need to initialize a new network. Does the neural network work like that? i think the network will only be initialized once and the network will be used in the next fold? not initialize a new one. what if i use it in a real case ?<br>
I might be wrong, please correct me.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-519589" data-commentid="519589" data-postid="3349" data-belowelement="comment-519589" data-respondelement="respond" data-replyto="Reply to Bram" aria-label="Reply to Bram">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-519646" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-519646" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">January 29, 2020 at 6:31 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-519646" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, k-fold cross-validation means fitting and evaluating k different models and averaging their performance.</p>
<p>You can learn more here:<br>
<a href="https://machinelearningmastery.com/k-fold-cross-validation/" rel="nofollow ugc">https://machinelearningmastery.com/k-fold-cross-validation/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-519646" data-commentid="519646" data-postid="3349" data-belowelement="comment-519646" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-522222" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-522222" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/7c46bc712de4fbd78883db39eda315e7.png" srcset="https://secure.gravatar.com/avatar/7c46bc712de4fbd78883db39eda315e7?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">ssrinath</span>
	                <span class="date">February 19, 2020 at 3:22 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-522222" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>hello jason brownlee</p>
<p>I am a CSE student and can you help us in predicting weather using neural network backpropagation</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-522222" data-commentid="522222" data-postid="3349" data-belowelement="comment-522222" data-respondelement="respond" data-replyto="Reply to ssrinath" aria-label="Reply to ssrinath">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-522272" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-522272" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">February 19, 2020 at 8:07 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-522272" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps start here:<br>
<a href="https://machinelearningmastery.com/start-here/#deep_learning_time_series" rel="nofollow ugc">https://machinelearningmastery.com/start-here/#deep_learning_time_series</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-522272" data-commentid="522272" data-postid="3349" data-belowelement="comment-522272" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-522419" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-522419" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/9dc776fed8aa55e070bb20fe792a9d62.png" srcset="https://secure.gravatar.com/avatar/9dc776fed8aa55e070bb20fe792a9d62?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Salvador</span>
	                <span class="date">February 20, 2020 at 9:43 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-522419" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason,<br>
I receive this error in spyder :<br>
IndexError: list assignment index out of range.<br>
Do you know where is the error?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-522419" data-commentid="522419" data-postid="3349" data-belowelement="comment-522419" data-respondelement="respond" data-replyto="Reply to Salvador" aria-label="Reply to Salvador">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-522432" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-522432" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">February 20, 2020 at 11:28 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-522432" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This will help:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-522432" data-commentid="522432" data-postid="3349" data-belowelement="comment-522432" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-522771" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-522771" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/0d9ac4181022fb49406f6c64960ec3dc.png" srcset="https://secure.gravatar.com/avatar/0d9ac4181022fb49406f6c64960ec3dc?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Melkamu</span>
	                <span class="date">February 22, 2020 at 1:04 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-522771" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hey Jason! Thank you so much for your best tutorial</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-522771" data-commentid="522771" data-postid="3349" data-belowelement="comment-522771" data-respondelement="respond" data-replyto="Reply to Melkamu" aria-label="Reply to Melkamu">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-522847" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-522847" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">February 23, 2020 at 7:22 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-522847" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You’re welcome.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-522847" data-commentid="522847" data-postid="3349" data-belowelement="comment-522847" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-522773" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-522773" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/0d9ac4181022fb49406f6c64960ec3dc.png" srcset="https://secure.gravatar.com/avatar/0d9ac4181022fb49406f6c64960ec3dc?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Melkamu</span>
	                <span class="date">February 22, 2020 at 1:15 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-522773" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason i am new for Python and i seriously follow your tutorial because i wanna to design my own prediction model using neural network with back propagation algorithm. but when i try to write this code on Jupiter   notebook on python 3.6 “list index out of  range ” error message displayed. Could you correct me ? the code i tried and error is from random import seed<br>
from random import random<br>
from math import exp</p>
<p># Initialize a network<br>
def initialize_network(n_inputs, n_hidden, n_outputs):<br>
	network = list()<br>
	hidden_layer = [{‘weights’:[random() for i in range(n_inputs + 1)]} for i in range(n_hidden)]<br>
	network.append(hidden_layer)<br>
	output_layer = [{‘weights’:[random() for i in range(n_hidden + 1)]} for i in range(n_outputs)]<br>
	network.append(output_layer)<br>
	return network</p>
<p>seed(1)<br>
network = initialize_network(5, 6, 1)<br>
for layer in network:<br>
	print(layer)<br>
 #Calculate neuron activation for an input<br>
def activate(weights, inputs):<br>
	activation = weights[-1]<br>
	for i in range(len(weights)-1):<br>
		activation += weights[i] * inputs[i]<br>
	return activation</p>
<p># Transfer neuron activation<br>
def transfer(activation):<br>
	return 1.0 / (1.0 + exp(-activation))</p>
<p># Forward propagate input to a network output<br>
def forward_propagate(network, row):<br>
	inputs = row<br>
	for layer in network:<br>
		new_inputs = []<br>
		for neuron in layer:<br>
			activation = activate(neuron[‘weights’], inputs)<br>
			neuron[‘output’] = transfer(activation)<br>
			new_inputs.append(neuron[‘output’])<br>
		inputs = new_inputs<br>
	return inputs</p>
<p># test forward propagation<br>
network = [[{‘weights’: [0.13436424411240122,<br>
    0.8474337369372327,<br>
    0.763774618976614,<br>
    0.2550690257394217,<br>
    0.49543508709194095,<br>
    0.4494910647887381],<br>
   ‘output’: 0.7853169772903308}],<br>
 [{‘weights’: [0.651592972722763,<br>
    0.7887233511355132,<br>
    0.0938595867742349,<br>
    0.02834747652200631,<br>
    0.8357651039198697,<br>
    0.43276706790505337]}],<br>
 [{‘weights’: [0.762280082457942,<br>
    0.0021060533511106927,<br>
    0.4453871940548014,<br>
    0.7215400323407826,<br>
    0.22876222127045265,<br>
    0.9452706955539223]}],<br>
 [{‘weights’: [0.9014274576114836,<br>
    0.030589983033553536,<br>
    0.0254458609934608,<br>
    0.5414124727934966,<br>
    0.9391491627785106,<br>
    0.38120423768821243]}],<br>
 [{‘weights’: [0.21659939713061338,<br>
    0.4221165755827173,<br>
    0.029040787574867943,<br>
    0.22169166627303505,<br>
    0.43788759365057206,<br>
    0.49581224138185065]}],<br>
 [{‘weights’: [0.23308445025757263,<br>
    0.2308665415409843,<br>
    0.2187810373376886,<br>
    0.4596034657377336,<br>
    0.28978161459048557,<br>
    0.021489705265908876]}],<br>
 [{‘weights’: [0.8375779756625729,<br>
    0.5564543226524334,<br>
    0.6422943629324456,<br>
    0.1859062658947177,<br>
    0.9925434121760651,<br>
    0.8599465287952899,<br>
    0.12088995980580641]}]]<br>
row = [0, 1, 0, 0, 0]<br>
output = forward_propagate(network, row)<br>
print(output)<br>
and the error is<br>
IndexError                                Traceback (most recent call last)<br>
 in<br>
     85     0.12088995980580641]}]]<br>
     86 row = [0, 1, 0, 0, 0]<br>
—&gt; 87 output = forward_propagate(network, row)<br>
     88 print(output)</p>
<p> in forward_propagate(network, row)<br>
     33                 new_inputs = []<br>
     34                 for neuron in layer:<br>
—&gt; 35                         activation = activate(neuron[‘weights’], inputs)<br>
     36                         neuron[‘output’] = transfer(activation)<br>
     37                         new_inputs.append(neuron[‘output’])</p>
<p> in activate(weights, inputs)<br>
     20         activation = weights[-1]<br>
     21         for i in range(len(weights)-1):<br>
—&gt; 22                 activation += weights[i] * inputs[i]<br>
     23         return activation<br>
     24 </p>
<p>IndexError: list index out of range</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-522773" data-commentid="522773" data-postid="3349" data-belowelement="comment-522773" data-respondelement="respond" data-replyto="Reply to Melkamu" aria-label="Reply to Melkamu">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-522849" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-522849" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">February 23, 2020 at 7:22 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-522849" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps don’t use a notebook. See this:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-522849" data-commentid="522849" data-postid="3349" data-belowelement="comment-522849" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-523695" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-523695" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/7a4ab4b3cf030abe33e1768aa09c5793.png" srcset="https://secure.gravatar.com/avatar/7a4ab4b3cf030abe33e1768aa09c5793?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Pavitra</span>
	                <span class="date">February 29, 2020 at 12:12 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-523695" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason,<br>
I’am new to machine learning and I want to build a model using back propagation. And I am using this code for my project. This code works perfectly. But I want the prediction when I input the value so can you please tell me how can I get the prediction ?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-523695" data-commentid="523695" data-postid="3349" data-belowelement="comment-523695" data-respondelement="respond" data-replyto="Reply to Pavitra" aria-label="Reply to Pavitra">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-523760" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-523760" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">February 29, 2020 at 7:15 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-523760" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, you can change the example to just train the network then call the predict function on new data.</p>
<p>If this is challenging for you, perhaps use a library instead, like keras:<br>
<a href="https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/" rel="nofollow ugc">https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-523760" data-commentid="523760" data-postid="3349" data-belowelement="comment-523760" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-523802" class="comment even depth-3 parent">

	      	<div id="li-comment-523802" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/7a4ab4b3cf030abe33e1768aa09c5793.png" srcset="https://secure.gravatar.com/avatar/7a4ab4b3cf030abe33e1768aa09c5793?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Pavitra</span>
	                <span class="date">February 29, 2020 at 11:12 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-523802" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you so much sir.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-523802" data-commentid="523802" data-postid="3349" data-belowelement="comment-523802" data-respondelement="respond" data-replyto="Reply to Pavitra" aria-label="Reply to Pavitra">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-523902" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-523902" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 1, 2020 at 5:19 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-523902" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You’re welcome.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-523902" data-commentid="523902" data-postid="3349" data-belowelement="comment-523902" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-523816" class="comment even depth-3 parent">

	      	<div id="li-comment-523816" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/7a4ab4b3cf030abe33e1768aa09c5793.png" srcset="https://secure.gravatar.com/avatar/7a4ab4b3cf030abe33e1768aa09c5793?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Pavitra</span>
	                <span class="date">February 29, 2020 at 2:50 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-523816" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Could you please tell me how to use the predict function.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-523816" data-commentid="523816" data-postid="3349" data-belowelement="comment-523816" data-respondelement="respond" data-replyto="Reply to Pavitra" aria-label="Reply to Pavitra">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-523905" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-523905" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 1, 2020 at 5:21 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-523905" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can adapt the example in the tutorial directly. Sorry, I cannot prepare a custom code example for you.</p>
<p>If it is challenging for you (which it sounds like it is), I recommend using a library instead:<br>
<a href="https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/" rel="nofollow ugc">https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-523905" data-commentid="523905" data-postid="3349" data-belowelement="comment-523905" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-524123" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-524123" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/45f289c49381fcd6cb09b41e0060f2b3.png" srcset="https://secure.gravatar.com/avatar/45f289c49381fcd6cb09b41e0060f2b3?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Lucas</span>
	                <span class="date">March 3, 2020 at 2:20 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-524123" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason,</p>
<p>i’ve noticed that (in chapter 4) you use the labels (0,1) as a bias constant for the bias weight multiplication in the activation function. Shouldn’t you theoratically set the all labels temporarily to 1, otherwise samples with label 0 will have no bias?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-524123" data-commentid="524123" data-postid="3349" data-belowelement="comment-524123" data-respondelement="respond" data-replyto="Reply to Lucas" aria-label="Reply to Lucas">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-524154" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-524154" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 3, 2020 at 6:01 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-524154" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>No.</p>
<p>Why do you think this?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-524154" data-commentid="524154" data-postid="3349" data-belowelement="comment-524154" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-524398" class="comment even depth-3 parent">

	      	<div id="li-comment-524398" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/45f289c49381fcd6cb09b41e0060f2b3.png" srcset="https://secure.gravatar.com/avatar/45f289c49381fcd6cb09b41e0060f2b3?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Lucas</span>
	                <span class="date">March 5, 2020 at 1:55 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-524398" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Oh nvm sorry, i missed that you add the bias explicitly “activation = weights[-1]”. </p>
<p>Most of the books I’ve read add a temporary “1” to the inputs, so that the dot product doesn’t exclude the bias. So i falsly asumed you wanted to set the labels temporarly to one  “activation = activate(neuron[‘weights’], inputs)”  because the inputs include the labels (i already thought this would be a weird way to do it).</p>
<p>Btw thanks for the excellent tutorial.</p>
<p>I also tried to implement a multi-layer nn which uses np.arrays for efficent matrix multiplication. But somehow my weights get really small really fast. Is this a general problem with nn’s or is it probably a problem with my activation function?<br>
I use reLu for the hidden layers and sigmoid for the output layer.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-524398" data-commentid="524398" data-postid="3349" data-belowelement="comment-524398" data-respondelement="respond" data-replyto="Reply to Lucas" aria-label="Reply to Lucas">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-524428" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-524428" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 5, 2020 at 6:39 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-524428" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>NN can be hard to debug, it could be a hyperparameter or it could be a bug in your implementation. </p>
<p>Moving to a standard lib is highly recommended at some point.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-524428" data-commentid="524428" data-postid="3349" data-belowelement="comment-524428" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-524135" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-524135" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/722758a4d50f30bb88e052ca73a1bd16.png" srcset="https://secure.gravatar.com/avatar/722758a4d50f30bb88e052ca73a1bd16?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Heritiera fomes</span>
	                <span class="date">March 3, 2020 at 5:50 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-524135" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason,</p>
<p>I have to implement a placement problem, where I need to place some students in different classes, where every classes have some capacity. In that case how can I relate ANN with these?<br>
If I want to add some constraints in the ANN, how can I add these constraint? for example when a test case (student) is going to be predict in which class it is assigned. My porblem needs to check the capacity of the class, then all the students must be assigned to a class.<br>
It would be great help if I hear from you.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-524135" data-commentid="524135" data-postid="3349" data-belowelement="comment-524135" data-respondelement="respond" data-replyto="Reply to Heritiera fomes" aria-label="Reply to Heritiera fomes">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-524159" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-524159" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 3, 2020 at 6:05 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-524159" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>o, sounds like an constraint satisfaction / optimization problem. Look at operations research / dynamic programming.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-524159" data-commentid="524159" data-postid="3349" data-belowelement="comment-524159" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-524265" class="comment even depth-3 parent">

	      	<div id="li-comment-524265" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/722758a4d50f30bb88e052ca73a1bd16.png" srcset="https://secure.gravatar.com/avatar/722758a4d50f30bb88e052ca73a1bd16?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Heritiera fomes</span>
	                <span class="date">March 4, 2020 at 1:44 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-524265" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for your reply.</p>
<p>If i want to add some constraints during prediction how should I do this?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-524265" data-commentid="524265" data-postid="3349" data-belowelement="comment-524265" data-respondelement="respond" data-replyto="Reply to Heritiera fomes" aria-label="Reply to Heritiera fomes">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-524309" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-524309" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 4, 2020 at 5:57 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-524309" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Use the Keras API:<br>
<a href="https://machinelearningmastery.com/how-to-reduce-overfitting-in-deep-neural-networks-with-weight-constraints-in-keras/" rel="nofollow ugc">https://machinelearningmastery.com/how-to-reduce-overfitting-in-deep-neural-networks-with-weight-constraints-in-keras/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-524309" data-commentid="524309" data-postid="3349" data-belowelement="comment-524309" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-524371" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-524371" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/8920f6fcd7f037db3fe8a4c70aafe3f2.jpeg" srcset="https://secure.gravatar.com/avatar/8920f6fcd7f037db3fe8a4c70aafe3f2?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">A Kranthi Kiran</span>
	                <span class="date">March 4, 2020 at 9:06 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-524371" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>can I know how to build a front end for this model using flask? or<br>
is there any other best way to build a front end rather than flask?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-524371" data-commentid="524371" data-postid="3349" data-belowelement="comment-524371" data-respondelement="respond" data-replyto="Reply to A Kranthi Kiran" aria-label="Reply to A Kranthi Kiran">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-524418" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-524418" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 5, 2020 at 6:34 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-524418" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I don’t have an example, sorry.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-524418" data-commentid="524418" data-postid="3349" data-belowelement="comment-524418" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-548194" class="comment even depth-2">

	      	<div id="li-comment-548194" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/e05f38b67e9505bc800bf5e10c8226fd.jpeg" srcset="https://secure.gravatar.com/avatar/e05f38b67e9505bc800bf5e10c8226fd?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Eunike Kamase Elisabeth</span>
	                <span class="date">August 8, 2020 at 5:28 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-548194" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>hello, have you already know how to build the front end for backpropagation with flask?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-548194" data-commentid="548194" data-postid="3349" data-belowelement="comment-548194" data-respondelement="respond" data-replyto="Reply to Eunike Kamase Elisabeth" aria-label="Reply to Eunike Kamase Elisabeth">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-524628" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-524628" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/6afd5911893477ea94757f3761f9a608.png" srcset="https://secure.gravatar.com/avatar/6afd5911893477ea94757f3761f9a608?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Prabhu Prasad Dev</span>
	                <span class="date">March 6, 2020 at 11:42 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-524628" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Is there any code or how to implement Spiking Neural Network(SNN).. I am very much interested to know about SNN bcoz it is the 3rd generation of neural network..Can u plz help me of details about SNN???</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-524628" data-commentid="524628" data-postid="3349" data-belowelement="comment-524628" data-respondelement="respond" data-replyto="Reply to Prabhu Prasad Dev" aria-label="Reply to Prabhu Prasad Dev">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-524672" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-524672" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 7, 2020 at 7:17 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-524672" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I don’t have an example, sorry.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-524672" data-commentid="524672" data-postid="3349" data-belowelement="comment-524672" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-524866" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-524866" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/c6e678c51c804d840cf42debe2e62e75.png" srcset="https://secure.gravatar.com/avatar/c6e678c51c804d840cf42debe2e62e75?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Namitha Dsouza</span>
	                <span class="date">March 8, 2020 at 4:43 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-524866" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I am new to this field. I am sorry if you do not get my question. </p>
<p># Train a network for a fixed number of epochs<br>
def train_network(network, train, l_rate, n_epoch, n_outputs):<br>
	for epoch in range(n_epoch):<br>
		for row in train:<br>
			outputs = forward_propagate(network, row)<br>
			expected = [0 for i in range(n_outputs)]<br>
			expected[row[-1]] = 1<br>
			backward_propagate_error(network, expected)<br>
			update_weights(network, row, l_rate)</p>
<p>What is the use of these two lines? Is it only for binary classification or any classification with 3 or more classes can use this? Because this works perfectly for binary classification. But for other classifications, it gives an error. </p>
<p>expected = [0 for i in range(n_outputs)]<br>
			expected[row[-1]] = 1</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-524866" data-commentid="524866" data-postid="3349" data-belowelement="comment-524866" data-respondelement="respond" data-replyto="Reply to Namitha Dsouza" aria-label="Reply to Namitha Dsouza">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-524917" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-524917" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 9, 2020 at 7:15 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-524917" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>We are one hot encoding the target class.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-524917" data-commentid="524917" data-postid="3349" data-belowelement="comment-524917" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-525468" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-525468" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/4236c4e6834dbc55d5daf8c8b58ab5bf.png" srcset="https://secure.gravatar.com/avatar/4236c4e6834dbc55d5daf8c8b58ab5bf?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Carlos Meza</span>
	                <span class="date">March 13, 2020 at 1:47 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-525468" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello!! Im new on this. If I want to add 9 input variables instead of 7. What do I need to change in the code in order to make it work. Amazing publication!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-525468" data-commentid="525468" data-postid="3349" data-belowelement="comment-525468" data-respondelement="respond" data-replyto="Reply to Carlos Meza" aria-label="Reply to Carlos Meza">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-525473" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-525473" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 13, 2020 at 1:50 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-525473" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps start with this much simler tutorial:<br>
<a href="https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/" rel="nofollow ugc">https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-525473" data-commentid="525473" data-postid="3349" data-belowelement="comment-525473" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-525476" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-525476" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/4236c4e6834dbc55d5daf8c8b58ab5bf.png" srcset="https://secure.gravatar.com/avatar/4236c4e6834dbc55d5daf8c8b58ab5bf?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Carlos Meza</span>
	                <span class="date">March 13, 2020 at 2:14 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-525476" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello, thanks for your reply. I looked into it, you use [:,0:8] to define de input variables. However in this code is different, thats why I’m confused. Any other clue?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-525476" data-commentid="525476" data-postid="3349" data-belowelement="comment-525476" data-respondelement="respond" data-replyto="Reply to Carlos Meza" aria-label="Reply to Carlos Meza">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-525535" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-525535" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 14, 2020 at 8:04 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-525535" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Ah, if you are new to list/array slicing, this will help:<br>
<a href="https://machinelearningmastery.com/index-slice-reshape-numpy-arrays-machine-learning-python/" rel="nofollow ugc">https://machinelearningmastery.com/index-slice-reshape-numpy-arrays-machine-learning-python/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-525535" data-commentid="525535" data-postid="3349" data-belowelement="comment-525535" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-525716" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-525716" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/14270b3e1258b3a1370e9032b2a869d6.png" srcset="https://secure.gravatar.com/avatar/14270b3e1258b3a1370e9032b2a869d6?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Alex Ramirez</span>
	                <span class="date">March 16, 2020 at 11:15 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-525716" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello! How to calculate the recall/precision/F1Score from this excersise?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-525716" data-commentid="525716" data-postid="3349" data-belowelement="comment-525716" data-respondelement="respond" data-replyto="Reply to Alex Ramirez" aria-label="Reply to Alex Ramirez">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-525724" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-525724" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 16, 2020 at 1:31 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-525724" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You could use the sklearn library to calculate the required metrics:<br>
<a href="https://scikit-learn.org/stable/modules/classes.html#sklearn-metrics-metrics" rel="nofollow ugc">https://scikit-learn.org/stable/modules/classes.html#sklearn-metrics-metrics</a></p>
<p>I don’t have the capacity to implement this for you. If it is too advanced, I strongly recommend using Keras instead:<br>
<a href="https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/" rel="nofollow ugc">https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-525724" data-commentid="525724" data-postid="3349" data-belowelement="comment-525724" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-527523" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-527523" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/292e86ee61e445347db2a002290121f3.png" srcset="https://secure.gravatar.com/avatar/292e86ee61e445347db2a002290121f3?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sumanta Das</span>
	                <span class="date">March 30, 2020 at 3:01 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-527523" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>How to modify the code to work with GPUs, without using fancy libraries?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-527523" data-commentid="527523" data-postid="3349" data-belowelement="comment-527523" data-respondelement="respond" data-replyto="Reply to Sumanta Das" aria-label="Reply to Sumanta Das">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-527551" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-527551" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 30, 2020 at 5:37 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-527551" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Not sure you can. Fancy libraries (keras on tensorflow) let you use the GPU.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-527551" data-commentid="527551" data-postid="3349" data-belowelement="comment-527551" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-527652" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-527652" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/0d3e186fd69d9f5b548f68068cf21ce6.png" srcset="https://secure.gravatar.com/avatar/0d3e186fd69d9f5b548f68068cf21ce6?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Abhishek</span>
	                <span class="date">March 30, 2020 at 10:13 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-527652" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Trying to execute, but I’m facing this Error. I’m running the Code on Spyder (Python 3.7)</p>
<p>Traceback (most recent call last):</p>
<p>  File “”, line 1, in<br>
    runfile(‘C:/Users/duppa/Desktop/Wheat Seed Code New.py’, wdir=’C:/Users/duppa/Desktop’)</p>
<p>  File “C:\Users\duppa\Anaconda3\lib\site-packages\spyder_kernels\customize\spydercustomize.py”, line 786, in runfile<br>
    execfile(filename, namespace)</p>
<p>  File “C:\Users\duppa\Anaconda3\lib\site-packages\spyder_kernels\customize\spydercustomize.py”, line 110, in execfile<br>
    exec(compile(f.read(), filename, ‘exec’), namespace)</p>
<p>  File “C:/Users/duppa/Desktop/Wheat Seed Code New.py”, line 204, in<br>
    scores = evaluate_algorithm(dataset, back_propagation, n_folds, l_rate, n_epoch, n_hidden)</p>
<p>  File “C:/Users/duppa/Desktop/Wheat Seed Code New.py”, line 82, in evaluate_algorithm<br>
    train_set = sum(train_set, [])</p>
<p>  File “C:\Users\duppa\Anaconda3\lib\site-packages\numpy\core\fromnumeric.py”, line 2076, in sum<br>
    initial=initial)</p>
<p>  File “C:\Users\duppa\Anaconda3\lib\site-packages\numpy\core\fromnumeric.py”, line 86, in _wrapreduction<br>
    return ufunc.reduce(obj, axis, dtype, out, **passkwargs)</p>
<p>TypeError: ‘list’ object cannot be interpreted as an integer</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-527652" data-commentid="527652" data-postid="3349" data-belowelement="comment-527652" data-respondelement="respond" data-replyto="Reply to Abhishek" aria-label="Reply to Abhishek">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-527700" class="comment even depth-2 parent">

	      	<div id="li-comment-527700" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/0d3e186fd69d9f5b548f68068cf21ce6.png" srcset="https://secure.gravatar.com/avatar/0d3e186fd69d9f5b548f68068cf21ce6?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Abhishek</span>
	                <span class="date">March 31, 2020 at 6:02 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-527700" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Earlier, I tried running the code on Spyder (Python 3.7) and faced the Error of (TypeError: ‘list’ object cannot be interpreted as an integer). But when I executed the same code on Jupyter notebook I haven’t faced any Error. Output was successful</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-527700" data-commentid="527700" data-postid="3349" data-belowelement="comment-527700" data-respondelement="respond" data-replyto="Reply to Abhishek" aria-label="Reply to Abhishek">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-527759" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-3">

	      	<div id="li-comment-527759" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 31, 2020 at 8:19 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-527759" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Happy to hear that.</p>
<p>I recommend not using an IDE or notebook in general:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/why-dont-use-or-recommend-notebooks" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/why-dont-use-or-recommend-notebooks</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-527759" data-commentid="527759" data-postid="3349" data-belowelement="comment-527759" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-527740" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-527740" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 31, 2020 at 8:09 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-527740" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I’m sorry to hear that, this will help:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-527740" data-commentid="527740" data-postid="3349" data-belowelement="comment-527740" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-528787" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-528787" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a711085226b51ae24eb023e87181d32f.png" srcset="https://secure.gravatar.com/avatar/a711085226b51ae24eb023e87181d32f?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Robin</span>
	                <span class="date">April 8, 2020 at 1:04 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-528787" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Just wanted to extend my thanks for your tutorial. Two months ago I wanted to learn Python and was in the middle of learning more about AI and ML and used your tutorial to help me implement my first neural network. A lot of literature and texts use a more mathematical and lower level approach to neural networks using matrices, etc which isn’t intuitive to me but your tutorial just clicked as it was easy to conceptualize and was a more simple approach.</p>
<p>One of the ways I cement my own knowledge is writing about things I’m working on or worked on, and to really commit neural networks to memory, I wrote a tutorial myself for a neural network using learning rate and momentum parameters.</p>
<p><a href="https://github.com/stratzilla/neural-network-tutorial/blob/master/neural-network-tutorial.ipynb" rel="nofollow ugc">https://github.com/stratzilla/neural-network-tutorial/blob/master/neural-network-tutorial.ipynb</a></p>
<p>I would love to put your web page in an acknowledgements section if you were okay with that as I don’t think I would have figured out neural networks if it weren’t for your site.</p>
<p>Regards,<br>
Robin</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-528787" data-commentid="528787" data-postid="3349" data-belowelement="comment-528787" data-respondelement="respond" data-replyto="Reply to Robin" aria-label="Reply to Robin">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-528827" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-528827" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 8, 2020 at 7:55 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-528827" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Robin, well done on your progress!</p>
<p>Yes, please link back.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-528827" data-commentid="528827" data-postid="3349" data-belowelement="comment-528827" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-529462" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-529462" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/9c3262ce8728336ffb40b27c2e2a2b42.png" srcset="https://secure.gravatar.com/avatar/9c3262ce8728336ffb40b27c2e2a2b42?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">tom</span>
	                <span class="date">April 12, 2020 at 2:39 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-529462" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hey Jason, amazing tutorial on how to implement a 3 layer neural network with 200 lines of code. </p>
<p>I have one question though, for the back propagation part, why is that error of (layer j, neutron i) = summation of (weight_k * error_j) * transfer_derivative(output)? Can you explain a little bit on mathematics? I know the error is derivatives of cost function, but how do you know the connection between error of current layer and error of next layer?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-529462" data-commentid="529462" data-postid="3349" data-belowelement="comment-529462" data-respondelement="respond" data-replyto="Reply to tom" aria-label="Reply to tom">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-529522" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-529522" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 13, 2020 at 6:11 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-529522" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks.</p>
<p>Sorry, I don’t dive into the theory, I recommend a good textbook like the 2016 “deep learning” or 1999 “neuralsmithing”.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-529522" data-commentid="529522" data-postid="3349" data-belowelement="comment-529522" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-529494" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-529494" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/9cc7d2440d4829c066ab33333e5b2bdc.jpeg" srcset="https://secure.gravatar.com/avatar/9cc7d2440d4829c066ab33333e5b2bdc?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Quang Huy Chu</span>
	                <span class="date">April 12, 2020 at 11:51 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-529494" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, first of all, thank you for posting this, it helps me very much in my Master’s research. But at my research, 4 output is required and at try to put my dataset, which is 48 samples of 16 inputs node and 4 output.<br>
My question is:<br>
As my research, with my small size dataset, choosing k = dataset size (48) is needed, apply k = 48, l_rate = 0.3, n_hidden = 42. But according to the result, the prediction is always repeated [0,0,0,0,0,0] ; [2,2,2,2,2,2] ; [0,0,0,0,0,0] ; [3,3,3,3,3,3], with different k also give the same prediction result (0,2,0,3). Can you figure it out why my NN give that strange result ?</p>
<p>Thank you very much.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-529494" data-commentid="529494" data-postid="3349" data-belowelement="comment-529494" data-respondelement="respond" data-replyto="Reply to Quang Huy Chu" aria-label="Reply to Quang Huy Chu">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-529495" class="comment even depth-2 parent">

	      	<div id="li-comment-529495" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/9cc7d2440d4829c066ab33333e5b2bdc.jpeg" srcset="https://secure.gravatar.com/avatar/9cc7d2440d4829c066ab33333e5b2bdc?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Quang Huy Chu</span>
	                <span class="date">April 12, 2020 at 11:58 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-529495" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>For example, here is my result:<br>
\NN_BP_1.py<br>
Predicted:  [0, 0, 0, 0, 0, 0]<br>
Actual:  [0, 1, 0, 3, 0, 2]<br>
Predicted:  [2, 2, 2, 2, 2, 2]<br>
Actual:  [2, 1, 2, 3, 0, 1]<br>
Predicted:  [0, 0, 0, 0, 0, 0]<br>
Actual:  [0, 2, 1, 0, 1, 3]<br>
Predicted:  [3, 3, 3, 3, 3, 3]<br>
Actual:  [1, 1, 3, 2, 0, 3]<br>
Predicted:  [0, 0, 0, 0, 0, 0]<br>
Actual:  [0, 0, 0, 1, 1, 0]<br>
Predicted:  [2, 2, 2, 2, 2, 2]<br>
Actual:  [2, 3, 1, 2, 0, 2]<br>
Predicted:  [2, 2, 2, 2, 2, 2]<br>
Actual:  [3, 2, 2, 1, 3, 3]<br>
Predicted:  [1, 1, 1, 1, 1, 1]<br>
Actual:  [3, 3, 1, 2, 3, 2]<br>
scores: [50.0, 33.33333333333333, 33.33333333333333, 33.33333333333333, 66.66666666666666, 50.0, 33.33333333333333, 16.666666666666664]<br>
Mean Accuracy: 39.583%</p>
<p>Can you figure it out why I have this problem or the problem is my dataset is not good?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-529495" data-commentid="529495" data-postid="3349" data-belowelement="comment-529495" data-respondelement="respond" data-replyto="Reply to Quang Huy Chu" aria-label="Reply to Quang Huy Chu">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-529532" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-3">

	      	<div id="li-comment-529532" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 13, 2020 at 6:18 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-529532" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps try alternate model configurations?<br>
Perhaps try alternate training configurations?<br>
Perhaps try scaling the data?<br>
Perhaps try monitoring loss during training.</p>
<p>See these tutorials for debugging neural nets:<br>
<a href="https://machinelearningmastery.com/start-here/#better" rel="nofollow ugc">https://machinelearningmastery.com/start-here/#better</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-529532" data-commentid="529532" data-postid="3349" data-belowelement="comment-529532" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-529531" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-529531" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 13, 2020 at 6:17 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-529531" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You’re welcome.</p>
<p>Perhaps use the Keras API instead, it will be much easier for you:<br>
<a href="https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/" rel="nofollow ugc">https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-529531" data-commentid="529531" data-postid="3349" data-belowelement="comment-529531" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-529554" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-529554" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/9cc7d2440d4829c066ab33333e5b2bdc.jpeg" srcset="https://secure.gravatar.com/avatar/9cc7d2440d4829c066ab33333e5b2bdc?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Quang Huy Chu</span>
	                <span class="date">April 13, 2020 at 11:17 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-529554" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, thanks for the reply, after using your model and test with other datasets I found on the internet, your model works properly. Maybe it is my dataset is the problem.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-529554" data-commentid="529554" data-postid="3349" data-belowelement="comment-529554" data-respondelement="respond" data-replyto="Reply to Quang Huy Chu" aria-label="Reply to Quang Huy Chu">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-529566" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-529566" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 13, 2020 at 1:50 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-529566" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-529566" data-commentid="529566" data-postid="3349" data-belowelement="comment-529566" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-529635" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-529635" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/3e7d024e4bf61cc15101cdca148e3cc3.png" srcset="https://secure.gravatar.com/avatar/3e7d024e4bf61cc15101cdca148e3cc3?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Bia</span>
	                <span class="date">April 14, 2020 at 5:14 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-529635" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason!</p>
<p>First, Thank you for this good tutorial, it really helps a lot.<br>
My question is that in your code you just use one hidden layer but how to add more hidden layers in same above code. Kindly guide me as I am a beginner. Thank you:)</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-529635" data-commentid="529635" data-postid="3349" data-belowelement="comment-529635" data-respondelement="respond" data-replyto="Reply to Bia" aria-label="Reply to Bia">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-529672" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-529672" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 14, 2020 at 6:29 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-529672" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You’re welcome.</p>
<p>If you are a beginner, I recommend starting here:<br>
<a href="https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/" rel="nofollow ugc">https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-529672" data-commentid="529672" data-postid="3349" data-belowelement="comment-529672" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-529640" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-529640" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/ecb86436e868fc53fa343a2bf8fe9ce7.png" srcset="https://secure.gravatar.com/avatar/ecb86436e868fc53fa343a2bf8fe9ce7?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">audrey</span>
	                <span class="date">April 14, 2020 at 5:48 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-529640" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>did you find something about Relu? i need this too thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-529640" data-commentid="529640" data-postid="3349" data-belowelement="comment-529640" data-respondelement="respond" data-replyto="Reply to audrey" aria-label="Reply to audrey">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-529675" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-529675" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 14, 2020 at 6:31 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-529675" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>See thus tutorial:<br>
<a href="https://machinelearningmastery.com/rectified-linear-activation-function-for-deep-learning-neural-networks/" rel="nofollow ugc">https://machinelearningmastery.com/rectified-linear-activation-function-for-deep-learning-neural-networks/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-529675" data-commentid="529675" data-postid="3349" data-belowelement="comment-529675" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-529896" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-529896" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/c6203ad4c6369de1cc4486bceca916cb.png" srcset="https://secure.gravatar.com/avatar/c6203ad4c6369de1cc4486bceca916cb?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Alex</span>
	                <span class="date">April 16, 2020 at 4:56 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-529896" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>If the transfer derivative is = output * (1.0 – output), when calculating errors in a hidden layer, which has a bias = 1, doesn’t that mean the transfer derivative is always 1 * (1-1) = 0 for the bias node? Therefore the error of the bias node is always 0 because error = (weight_k * error_j) * transfer_derivative(output)?</p>
<p>If that’s true, then the weights from the bias node never update because you multiply by the error.</p>
<p>I assume I’m missing something. How do the weights from a bias node get updated (i.e. how is the error of the bias ever not 0)?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-529896" data-commentid="529896" data-postid="3349" data-belowelement="comment-529896" data-respondelement="respond" data-replyto="Reply to Alex" aria-label="Reply to Alex">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-529924" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-529924" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 16, 2020 at 6:09 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-529924" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The implementation is based on the description in this book if you’d like to know more:<br>
<a href="https://amzn.to/3en9SPL" rel="nofollow ugc">https://amzn.to/3en9SPL</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-529924" data-commentid="529924" data-postid="3349" data-belowelement="comment-529924" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-529927" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-529927" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/c6203ad4c6369de1cc4486bceca916cb.png" srcset="https://secure.gravatar.com/avatar/c6203ad4c6369de1cc4486bceca916cb?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Alex</span>
	                <span class="date">April 16, 2020 at 7:18 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-529927" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I guess I’m not so much interested in why at the moment, but that in your implementation, which as far as I can tell is correct (it matches logically identically with a C/C++ I came up with), there is no way to update the weights coming off the bias.</p>
<p>This line [ neuron[‘delta’] = errors[j] * transfer_derivative(neuron[‘output’]) ] seems as if it will always result in neuron[‘delta’] == 0 for the bias. I noticed it my C++ implementation and when I went looking for answers, came across your post, and it looks like yours would result in 0 also.</p>
<p>So I’m more interested in if you found that to be the case. If so, it can escape detection because the network will still learn, just not as well or as fast, so with toy data this will not be noticed.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-529927" data-commentid="529927" data-postid="3349" data-belowelement="comment-529927" data-respondelement="respond" data-replyto="Reply to Alex" aria-label="Reply to Alex">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-529954" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-529954" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 16, 2020 at 1:20 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-529954" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Interesting, thanks for sharing.</p>
<p>I have not observed this issue, have you confirmed that indeed bias weights in the above implementation are unchanged after initialization?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-529954" data-commentid="529954" data-postid="3349" data-belowelement="comment-529954" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-537886" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-537886" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/c6203ad4c6369de1cc4486bceca916cb.png" srcset="https://secure.gravatar.com/avatar/c6203ad4c6369de1cc4486bceca916cb?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Alex</span>
	                <span class="date">June 4, 2020 at 3:47 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-537886" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry for the long delay in answering, I got distracted, but remembered to come back to this. I did look at the weights and you are correct, they do update. However, there is still something missing (admittedly, most likely in my understanding). You create a bias node by adding 1 weight vector per layer (weights from bias to next level neurons), but I do not see anywhere where the bias node activation it is explicitly set to 1. It seems that the activation of the bias node is treated like all other nodes, and is free to change value (I printed them during training and they are never 1.0). So the weights are also updating because bias does not equal 1.</p>
<p>If the bias activation is forced to stay at 1 (which seems correct for the algorithm), the weights from the bias cannot update because in the transfer derivative: 1 * (1-1) = 0. I did try that as well, and it shows the weights do not update. If I’m correct, this seems like a very subtle flaw, which would be undetectable in any simple learning problem because the network will learn and predict with or without a bias (I tried that too, and it does work either way).</p>
<p>With that said, I’m still not convinced I’m correct. I might still be missing something, but after several hours in the code, I can’t find any way the bias activation holds to 1.0. When it isn’t 1.0, the bias weights will update because the transfer derivative is non-zero, but that violates the role of the bias node. When the bias activation is forced to 1.0 which is the correct value for the bias, the weights do not update because 1 * (1-1) = 0. So I’m still confused, but still open to the possibility I’m just not understanding something about the code.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-537886" data-commentid="537886" data-postid="3349" data-belowelement="comment-537886" data-respondelement="respond" data-replyto="Reply to Alex" aria-label="Reply to Alex">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-537930" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-537930" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">June 4, 2020 at 6:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-537930" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>To understand the bias consider the forward and backward pass.</p>
<p>For the forward pass, see the activate() function and notice that the bias activation (stored as the last element of the list) is added to the activation first. The same as 1*bias_weight.</p>
<p>For the backward pass, the update_weights() function update the bias weight first, then the other weights.</p>
<p>Perhaps re-read the text and code of the tutorial. This is all discussed.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-537930" data-commentid="537930" data-postid="3349" data-belowelement="comment-537930" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-530043" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-530043" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/96c1ea9e27021f96fd0a407000b7e2a1.png" srcset="https://secure.gravatar.com/avatar/96c1ea9e27021f96fd0a407000b7e2a1?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Maria Campero</span>
	                <span class="date">April 17, 2020 at 2:15 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-530043" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
First of all thank you very much for this post it is really helpful,<br>
At the moment I’m writing a code for neural network with backpropagation in Phyton. I have 8 inputs and 7 outputs with one hidden layer(1neuron). I scaled the dataset then tryed to used your code but I have error of alignment. Can you please give me some advice to fix that issue</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-530043" data-commentid="530043" data-postid="3349" data-belowelement="comment-530043" data-respondelement="respond" data-replyto="Reply to Maria Campero" aria-label="Reply to Maria Campero">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-530082" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-530082" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 17, 2020 at 6:24 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-530082" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This is an advanced tutorial and it sounds like you are having trouble. </p>
<p>I recommend using the Keras API instead, it’s much simpler:<br>
<a href="https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/" rel="nofollow ugc">https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-530082" data-commentid="530082" data-postid="3349" data-belowelement="comment-530082" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-531547" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-531547" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/4e4aa1b42614f77d99ecc59e04e35839.png" srcset="https://secure.gravatar.com/avatar/4e4aa1b42614f77d99ecc59e04e35839?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">sameer sakkhari</span>
	                <span class="date">April 25, 2020 at 1:16 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-531547" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have a dataset isolet in the form of csv file. I want to implement a Neural Network with backpropagation in python using tensorflow . How do I start ? How do I load my data?</p>
<p>You said to save the dataset in csv format in current working directory. But it is not able to recognize isolet</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-531547" data-commentid="531547" data-postid="3349" data-belowelement="comment-531547" data-respondelement="respond" data-replyto="Reply to sameer sakkhari" aria-label="Reply to sameer sakkhari">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-531591" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-531591" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 25, 2020 at 7:00 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-531591" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This will show you how to load your data:<br>
<a href="https://machinelearningmastery.com/load-machine-learning-data-python/" rel="nofollow ugc">http://machinelearningmastery.com/load-machine-learning-data-python/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-531591" data-commentid="531591" data-postid="3349" data-belowelement="comment-531591" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-531694" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-531694" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/4f8998f6bd32e0839a2c19267e6a6212.png" srcset="https://secure.gravatar.com/avatar/4f8998f6bd32e0839a2c19267e6a6212?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">João Guilherme Cotta</span>
	                <span class="date">April 26, 2020 at 2:37 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-531694" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason,</p>
<p>Thanks for this tutorial, it is very helpful.</p>
<p>I would like to modify this code to use MLP with BP to predict the velocity of a car based on different inputs, such as velocity, acceleration, pedal position, etc. I am having some difficulty adapting the ‘expected’ part of the code, since in your example you are using only zeroes and ones, and my study case would have different values of velocity given by the dataset.</p>
<p>Do you have any advice regarding this?</p>
<p>Thanks in advance.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-531694" data-commentid="531694" data-postid="3349" data-belowelement="comment-531694" data-respondelement="respond" data-replyto="Reply to João Guilherme Cotta" aria-label="Reply to João Guilherme Cotta">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-531728" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-531728" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 26, 2020 at 6:16 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-531728" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, as a beginner, I strongly recommend using Keras instead:<br>
<a href="https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/" rel="nofollow ugc">https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-531728" data-commentid="531728" data-postid="3349" data-belowelement="comment-531728" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-531778" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-531778" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/57ba4347161e7c48dfe40bf7a95e0c91.png" srcset="https://secure.gravatar.com/avatar/57ba4347161e7c48dfe40bf7a95e0c91?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sid</span>
	                <span class="date">April 26, 2020 at 1:30 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-531778" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, I used the updated dataset provided and copied the code exactly(copy/paste) to test. However, when I run the code I get the error “TypeError: ‘list’ object cannot be interpreted as an integer”. Do you know why this may be happening?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-531778" data-commentid="531778" data-postid="3349" data-belowelement="comment-531778" data-respondelement="respond" data-replyto="Reply to Sid" aria-label="Reply to Sid">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-531892" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-531892" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 27, 2020 at 5:26 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-531892" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry to hear that you are having trouble, perhaps this will help:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-531892" data-commentid="531892" data-postid="3349" data-belowelement="comment-531892" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-532741" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-532741" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/20b4c320eb55eb1816a76b6e782c39bf.png" srcset="https://secure.gravatar.com/avatar/20b4c320eb55eb1816a76b6e782c39bf?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Q.H.Chu</span>
	                <span class="date">May 1, 2020 at 12:24 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-532741" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, According to the post, Your Network is using only 1 Hidden layer (Maybe its called Shallow Feed forward NN) , is that hidden layer represent Logistic Regression step? And is there a way to add more hidden-layer, many hidden-layer will improve the accurate of netowk</p>
<p>And one more question, How can I choose a fit parameter (epoch, learning rate or hidden layer neurons number) for this network ? does it depends on output and input neurons?</p>
<p>Once again, thank you very much for posting this helpful post and looking for see your reply</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-532741" data-commentid="532741" data-postid="3349" data-belowelement="comment-532741" data-respondelement="respond" data-replyto="Reply to Q.H.Chu" aria-label="Reply to Q.H.Chu">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-532753" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-532753" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">May 1, 2020 at 2:04 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-532753" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, one hidden layer. No not logistic regression.</p>
<p>Tune the parameters of your model to your data.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-532753" data-commentid="532753" data-postid="3349" data-belowelement="comment-532753" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-533620" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-533620" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/2082d7f1dc0fa68fed94be80e05f1b8a.png" srcset="https://secure.gravatar.com/avatar/2082d7f1dc0fa68fed94be80e05f1b8a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ahmed Gad</span>
	                <span class="date">May 7, 2020 at 9:25 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-533620" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi,</p>
<p>Please help with adapting the code to include Upper and Lower weights for each neuron without biases ==&gt; Rough Neural Network.</p>
<p>Thanks!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-533620" data-commentid="533620" data-postid="3349" data-belowelement="comment-533620" data-respondelement="respond" data-replyto="Reply to Ahmed Gad" aria-label="Reply to Ahmed Gad">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-533638" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-533638" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">May 7, 2020 at 11:51 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-533638" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This is a common question that I answer here:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/can-you-change-the-code-in-the-tutorial-to-___" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/can-you-change-the-code-in-the-tutorial-to-___</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-533638" data-commentid="533638" data-postid="3349" data-belowelement="comment-533638" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-533623" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-533623" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/2082d7f1dc0fa68fed94be80e05f1b8a.png" srcset="https://secure.gravatar.com/avatar/2082d7f1dc0fa68fed94be80e05f1b8a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ahmed Gad</span>
	                <span class="date">May 7, 2020 at 9:49 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-533623" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The RNN structure replaces the traditional neuron by two neurons (lower neuron, upper neuron ) to represent lower and upper approximations of each attribute in the CTG data set, Its structure formed from 4 layers input, 2 hidden and output layers. The hidden layers have rough neurons which overlap and exchange information between each other, While the input and output layers consists of traditional neurons as in the figure(1):</p>
<p>This image illustrates the idea more: <a href="https://imgur.com/AZ0FTbY" rel="nofollow ugc">https://imgur.com/AZ0FTbY</a>.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-533623" data-commentid="533623" data-postid="3349" data-belowelement="comment-533623" data-respondelement="respond" data-replyto="Reply to Ahmed Gad" aria-label="Reply to Ahmed Gad">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-533639" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-533639" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">May 7, 2020 at 11:51 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-533639" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for sharing.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-533639" data-commentid="533639" data-postid="3349" data-belowelement="comment-533639" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-533836" class="comment odd alt depth-3">

	      	<div id="li-comment-533836" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/2082d7f1dc0fa68fed94be80e05f1b8a.png" srcset="https://secure.gravatar.com/avatar/2082d7f1dc0fa68fed94be80e05f1b8a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ahmed Gad</span>
	                <span class="date">May 8, 2020 at 10:44 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-533836" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Please i need help where and how to customize the code!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-533836" data-commentid="533836" data-postid="3349" data-belowelement="comment-533836" data-respondelement="respond" data-replyto="Reply to Ahmed Gad" aria-label="Reply to Ahmed Gad">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-534149" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-534149" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/0767e25827df66fc70a870d08d5f1024.png" srcset="https://secure.gravatar.com/avatar/0767e25827df66fc70a870d08d5f1024?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">John Pillar</span>
	                <span class="date">May 10, 2020 at 4:43 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-534149" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>HI Jason – thanks very much for a wonderfully clear and understandable description.  I really appreciate your ‘gentle’ approach.  I’ve re-coded your python into C – I find it’s the best way for me to really learn what’s going on.  </p>
<p>Please – I have a couple of question – to apply softmax to the output – it’s easy enough to map the outputs using softmax so that they are ‘probabilities’ that sum to one, but – what changes do I need to make to the transfer function derivative in the backpropagation code.  I’ve read several descriptions that say that backpropagation of the output layer errors after softmax follows exactly the same as sigmoid – so I’m confused.  I think it should be different, but I may be missing something.</p>
<p>Also – cross-entropy loss is commonly described as a natural ‘partner’ to softmax, but actually, in practice, is the ‘error’ still (expected_value) – (predicted value) , just like you have in your code?</p>
<p>Thanks very much if you have time to consider my question – much appreciated.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-534149" data-commentid="534149" data-postid="3349" data-belowelement="comment-534149" data-respondelement="respond" data-replyto="Reply to John Pillar" aria-label="Reply to John Pillar">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-534201" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-534201" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">May 11, 2020 at 5:56 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-534201" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You’re welcome.</p>
<p>Yes, softmax error would be the same, except calculated for each output node.</p>
<p>Yes, you can see an implementation of cross entropy here:<br>
<a href="https://machinelearningmastery.com/cross-entropy-for-machine-learning/" rel="nofollow ugc">https://machinelearningmastery.com/cross-entropy-for-machine-learning/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-534201" data-commentid="534201" data-postid="3349" data-belowelement="comment-534201" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-535186" class="comment even depth-3 parent">

	      	<div id="li-comment-535186" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/0767e25827df66fc70a870d08d5f1024.png" srcset="https://secure.gravatar.com/avatar/0767e25827df66fc70a870d08d5f1024?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">John</span>
	                <span class="date">May 18, 2020 at 6:36 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-535186" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Jason – appreciate your help.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-535186" data-commentid="535186" data-postid="3349" data-belowelement="comment-535186" data-respondelement="respond" data-replyto="Reply to John" aria-label="Reply to John">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-535187" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-535187" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">May 18, 2020 at 6:37 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-535187" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You’re welcome.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-535187" data-commentid="535187" data-postid="3349" data-belowelement="comment-535187" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-537103" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-537103" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/075f2758ac4af33044a67f659da7297b.png" srcset="https://secure.gravatar.com/avatar/075f2758ac4af33044a67f659da7297b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sandeep Kumar Dash</span>
	                <span class="date">May 29, 2020 at 9:41 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-537103" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi. Thanks for the great tutorial. How can I save the network diagram in file?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-537103" data-commentid="537103" data-postid="3349" data-belowelement="comment-537103" data-respondelement="respond" data-replyto="Reply to Sandeep Kumar Dash" aria-label="Reply to Sandeep Kumar Dash">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-537159" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-537159" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">May 30, 2020 at 5:59 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-537159" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>THanks.</p>
<p>Perhaps use Keras and see this tutorial:<br>
<a href="https://machinelearningmastery.com/visualize-deep-learning-neural-network-model-keras/" rel="nofollow ugc">https://machinelearningmastery.com/visualize-deep-learning-neural-network-model-keras/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-537159" data-commentid="537159" data-postid="3349" data-belowelement="comment-537159" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-537220" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-537220" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/43cc96eceaedb4761417c8f45695795c.png" srcset="https://secure.gravatar.com/avatar/43cc96eceaedb4761417c8f45695795c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Andirian Ahmad</span>
	                <span class="date">May 30, 2020 at 5:19 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-537220" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello sir, sorry for disturbance, may i ask, can we use other datasets instead of seeds dataset for this BPNN algorithm?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-537220" data-commentid="537220" data-postid="3349" data-belowelement="comment-537220" data-respondelement="respond" data-replyto="Reply to Andirian Ahmad" aria-label="Reply to Andirian Ahmad">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-537325" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-537325" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">May 31, 2020 at 6:20 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-537325" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sure!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-537325" data-commentid="537325" data-postid="3349" data-belowelement="comment-537325" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-538800" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-538800" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/fe3b7d1733cb919a2799559abc779e61.png" srcset="https://secure.gravatar.com/avatar/fe3b7d1733cb919a2799559abc779e61?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Anon</span>
	                <span class="date">June 9, 2020 at 6:59 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-538800" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason. Thank you so much for this tutorial. I would just like to know if this would work with the iris dataset?b</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-538800" data-commentid="538800" data-postid="3349" data-belowelement="comment-538800" data-respondelement="respond" data-replyto="Reply to Anon" aria-label="Reply to Anon">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-538878" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-538878" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">June 10, 2020 at 6:10 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-538878" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sure.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-538878" data-commentid="538878" data-postid="3349" data-belowelement="comment-538878" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-539031" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-539031" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/fe3b7d1733cb919a2799559abc779e61.png" srcset="https://secure.gravatar.com/avatar/fe3b7d1733cb919a2799559abc779e61?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Zach</span>
	                <span class="date">June 11, 2020 at 5:13 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-539031" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Do you perhaps have a Java or C# version of this code? I’m trying to understand it in OOP principles and have done up to the end of prediction, but the last portion just confuses me</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-539031" data-commentid="539031" data-postid="3349" data-belowelement="comment-539031" data-respondelement="respond" data-replyto="Reply to Zach" aria-label="Reply to Zach">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-539065" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-539065" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">June 11, 2020 at 6:06 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-539065" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry I do not.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-539065" data-commentid="539065" data-postid="3349" data-belowelement="comment-539065" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-539136" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-539136" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/d8138dd8fad6c702a448b3361bdfe268.png" srcset="https://secure.gravatar.com/avatar/d8138dd8fad6c702a448b3361bdfe268?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Muhammad Basit Umair</span>
	                <span class="date">June 11, 2020 at 11:04 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-539136" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sir kindly guide me about difference between  “multilayer feed-forward network” and deep neural network (DNN).<br>
 Or can we say that, a multilayer feed-forward network is a deep neural network?</p>
<p>Thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-539136" data-commentid="539136" data-postid="3349" data-belowelement="comment-539136" data-respondelement="respond" data-replyto="Reply to Muhammad Basit Umair" aria-label="Reply to Muhammad Basit Umair">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-539173" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-539173" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">June 12, 2020 at 6:10 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-539173" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>MLP can be made deep by adding many layers, so can a CNN, LSTM or any type of network.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-539173" data-commentid="539173" data-postid="3349" data-belowelement="comment-539173" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-541717" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-541717" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/0327c3567346e42a5b9cf4b311b955d0.png" srcset="https://secure.gravatar.com/avatar/0327c3567346e42a5b9cf4b311b955d0?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Nasimul</span>
	                <span class="date">June 28, 2020 at 8:05 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-541717" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I am getting this error, please help</p>
<p>  File “F:/khaise/neuralnet.py”, line 80, in activate<br>
    activation += weights[i] * inputs[i]</p>
<p>TypeError: can’t multiply sequence by non-int of type ‘float’</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-541717" data-commentid="541717" data-postid="3349" data-belowelement="comment-541717" data-respondelement="respond" data-replyto="Reply to Nasimul" aria-label="Reply to Nasimul">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-541804" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-541804" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">June 29, 2020 at 6:31 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-541804" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I’m sorry to hear that, this may help:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-541804" data-commentid="541804" data-postid="3349" data-belowelement="comment-541804" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-543043" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-543043" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/22b80f08804ae6af6cb7f7d394420b58.png" srcset="https://secure.gravatar.com/avatar/22b80f08804ae6af6cb7f7d394420b58?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">navid</span>
	                <span class="date">July 7, 2020 at 2:20 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-543043" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello , i have question. this code only support 1 hidden layer?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-543043" data-commentid="543043" data-postid="3349" data-belowelement="comment-543043" data-respondelement="respond" data-replyto="Reply to navid" aria-label="Reply to navid">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-543078" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-543078" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">July 7, 2020 at 6:43 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-543078" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can extend it to add more layers.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-543078" data-commentid="543078" data-postid="3349" data-belowelement="comment-543078" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-545766" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-545766" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a43ee20dea07602a599a7129863b3074.png" srcset="https://secure.gravatar.com/avatar/a43ee20dea07602a599a7129863b3074?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">DavidHE</span>
	                <span class="date">July 24, 2020 at 1:00 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-545766" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I’m trying to implement this tutorial in a language different than python, If during the training of the net the value of the varibale sum_error gets stuck or even goes up a little and down again, that means an error in the implementation?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-545766" data-commentid="545766" data-postid="3349" data-belowelement="comment-545766" data-respondelement="respond" data-replyto="Reply to DavidHE" aria-label="Reply to DavidHE">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-545771" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-545771" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">July 24, 2020 at 1:38 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-545771" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps run the same code with the same initial weights and compare the output of each step?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-545771" data-commentid="545771" data-postid="3349" data-belowelement="comment-545771" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-547887" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-547887" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/c76eb7bf9132d0fb9e8bfa2df3e48286.png" srcset="https://secure.gravatar.com/avatar/c76eb7bf9132d0fb9e8bfa2df3e48286?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Shyam</span>
	                <span class="date">August 6, 2020 at 3:52 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-547887" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, </p>
<p>How can I get a loss vs epoch graph for this code?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-547887" data-commentid="547887" data-postid="3349" data-belowelement="comment-547887" data-respondelement="respond" data-replyto="Reply to Shyam" aria-label="Reply to Shyam">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-547952" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-547952" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">August 7, 2020 at 6:22 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-547952" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, you will have to implement it yourself though and use a train/test split instead of k-fold cross-validation.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-547952" data-commentid="547952" data-postid="3349" data-belowelement="comment-547952" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-548179" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-548179" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/fceafe4970cb74d01f5965ac0e49a4be.png" srcset="https://secure.gravatar.com/avatar/fceafe4970cb74d01f5965ac0e49a4be?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/" rel="external nofollow ugc" class="url">arun</a></span>
	                <span class="date">August 8, 2020 at 4:01 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-548179" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hai In Initialize Network function  hidden_layer variable store three random weight ,but we are given one hidden layer is used one weight for feed forward another one weight backward remaining one which propose used ??. similarly output_layer got three weight i did not under can you explain</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-548179" data-commentid="548179" data-postid="3349" data-belowelement="comment-548179" data-respondelement="respond" data-replyto="Reply to arun" aria-label="Reply to arun">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-548278" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-548278" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">August 9, 2020 at 5:33 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-548278" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I don’t follow. Can you please rephrase or elaborate on your question?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-548278" data-commentid="548278" data-postid="3349" data-belowelement="comment-548278" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-548210" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-548210" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/fceafe4970cb74d01f5965ac0e49a4be.png" srcset="https://secure.gravatar.com/avatar/fceafe4970cb74d01f5965ac0e49a4be?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/" rel="external nofollow ugc" class="url">arun</a></span>
	                <span class="date">August 8, 2020 at 8:09 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-548210" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi i need predicted = algorithm(train_set, test_set, *args) behind this line operation ?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-548210" data-commentid="548210" data-postid="3349" data-belowelement="comment-548210" data-respondelement="respond" data-replyto="Reply to arun" aria-label="Reply to arun">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-548287" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-548287" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">August 9, 2020 at 5:40 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-548287" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, what do you mean exactly?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-548287" data-commentid="548287" data-postid="3349" data-belowelement="comment-548287" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-549125" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-549125" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a9c8ef3e35ebec41a6878b6d0b56eaee.png" srcset="https://secure.gravatar.com/avatar/a9c8ef3e35ebec41a6878b6d0b56eaee?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Nate</span>
	                <span class="date">August 14, 2020 at 9:38 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-549125" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>do you know how to extract the “deltas” for each input and synaptic weight?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-549125" data-commentid="549125" data-postid="3349" data-belowelement="comment-549125" data-respondelement="respond" data-replyto="Reply to Nate" aria-label="Reply to Nate">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-549150" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-549150" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">August 14, 2020 at 1:18 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-549150" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, the element added to each weight would be the deltas as you describe them.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-549150" data-commentid="549150" data-postid="3349" data-belowelement="comment-549150" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-549275" class="comment even depth-3 parent">

	      	<div id="li-comment-549275" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a9c8ef3e35ebec41a6878b6d0b56eaee.png" srcset="https://secure.gravatar.com/avatar/a9c8ef3e35ebec41a6878b6d0b56eaee?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Nate</span>
	                <span class="date">August 15, 2020 at 12:54 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-549275" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>But how would you extract them in the code? I want to print the weight before and after the delta was added. What part of the code would you modify?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-549275" data-commentid="549275" data-postid="3349" data-belowelement="comment-549275" data-respondelement="respond" data-replyto="Reply to Nate" aria-label="Reply to Nate">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-549336" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-549336" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">August 15, 2020 at 6:32 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-549336" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You could retrieve them from the part of the code that updates the model weights, in the backward_propagate_error function I guess.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-549336" data-commentid="549336" data-postid="3349" data-belowelement="comment-549336" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-559749" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-559749" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/169846da0c41ad8a6b96f7ae6fa559e8.png" srcset="https://secure.gravatar.com/avatar/169846da0c41ad8a6b96f7ae6fa559e8?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Niloo</span>
	                <span class="date">September 5, 2020 at 9:22 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-559749" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi<br>
I am interested in machine learning. I read your code at this website and now I am willing to add some features so I have a question. How can we add more layer to this neural network or in the other words how can we make the number of hidden layers flexible? Could you please explain me or send me a link to learn more?<br>
Thanks for your attention.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-559749" data-commentid="559749" data-postid="3349" data-belowelement="comment-559749" data-respondelement="respond" data-replyto="Reply to Niloo" aria-label="Reply to Niloo">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-559898" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-559898" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">September 6, 2020 at 6:04 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-559898" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps it would be easier for you to start with the Keras API here:<br>
<a href="https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/" rel="nofollow ugc">https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-559898" data-commentid="559898" data-postid="3349" data-belowelement="comment-559898" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-564682" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-564682" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/9a3842a752daed77639ee9c504a9872f.jpeg" srcset="https://secure.gravatar.com/avatar/9a3842a752daed77639ee9c504a9872f?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Harsha</span>
	                <span class="date">September 25, 2020 at 8:04 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-564682" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Oh Legend!!</p>
<p>You are extremely awesome – I can’t thank you enough.</p>
<p>As an aspiring ML engineer this is what all I needed. You will be remembered forever as the mentor who taught me ANN from scratch</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-564682" data-commentid="564682" data-postid="3349" data-belowelement="comment-564682" data-respondelement="respond" data-replyto="Reply to Harsha" aria-label="Reply to Harsha">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-564684" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-564684" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">September 25, 2020 at 9:29 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-564684" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-564684" data-commentid="564684" data-postid="3349" data-belowelement="comment-564684" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-567425" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-567425" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/4b351f3b9a8d971c22655446972e721c.png" srcset="https://secure.gravatar.com/avatar/4b351f3b9a8d971c22655446972e721c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jon</span>
	                <span class="date">October 15, 2020 at 3:31 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-567425" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I tried to convert this example to use ReLU by changing the transfer function to be:</p>
<p>def transfer(activation):<br>
	return 0.0 if activation &lt;= 0.0 else activation</p>
<p>and the transfer_derivative to be:</p>
<p>def transfer_derivative(output):<br>
	return 0.0 if output &lt;= 0.0 else 1.0</p>
<p>This seem to break the training system however and the error is never reduced.</p>
<p>Any thoughts?</p>
<p>Thanks for a great article anyway.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-567425" data-commentid="567425" data-postid="3349" data-belowelement="comment-567425" data-respondelement="respond" data-replyto="Reply to Jon" aria-label="Reply to Jon">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-567466" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-567466" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">October 15, 2020 at 6:16 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-567466" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps try cross entropy loss.<br>
Perhaps try changing the model architecture.<br>
Perhaps try changing the learning hyperparameters.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-567466" data-commentid="567466" data-postid="3349" data-belowelement="comment-567466" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-567928" class="comment even depth-3">

	      	<div id="li-comment-567928" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/4b351f3b9a8d971c22655446972e721c.png" srcset="https://secure.gravatar.com/avatar/4b351f3b9a8d971c22655446972e721c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jon</span>
	                <span class="date">October 16, 2020 at 5:31 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-567928" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Ok thanks Jason, sounds interesting, I’ll certainly take a look.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-567928" data-commentid="567928" data-postid="3349" data-belowelement="comment-567928" data-respondelement="respond" data-replyto="Reply to Jon" aria-label="Reply to Jon">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-568104" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-568104" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/12130a47c86256cb3fbb9d795f9efdf0.png" srcset="https://secure.gravatar.com/avatar/12130a47c86256cb3fbb9d795f9efdf0?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Dinesh Kumar</span>
	                <span class="date">October 17, 2020 at 10:32 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-568104" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thanks for your help to understand the Back-props concepts with python. could you please help me how we will implement based computational graph</p>
<p>ex: <a href="https://i.imgur.com/0xUaxy6.png" rel="nofollow ugc">https://i.imgur.com/0xUaxy6.png</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-568104" data-commentid="568104" data-postid="3349" data-belowelement="comment-568104" data-respondelement="respond" data-replyto="Reply to Dinesh Kumar" aria-label="Reply to Dinesh Kumar">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-568157" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-568157" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">October 17, 2020 at 1:43 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-568157" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I recommend using the Keras framework:<br>
<a href="https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/" rel="nofollow ugc">https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-568157" data-commentid="568157" data-postid="3349" data-belowelement="comment-568157" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-572022" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-572022" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/38fad5c19b9f971dbd2b25b324bda3f8.png" srcset="https://secure.gravatar.com/avatar/38fad5c19b9f971dbd2b25b324bda3f8?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://acehl.org/" rel="external nofollow ugc" class="url">JG</a></span>
	                <span class="date">October 31, 2020 at 10:19 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-572022" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>I decided to follow this “old” tutorial, by the possibility of understand at low level the main AI’s functions such as network model definition (through a list of weights per neuron and layers on dictionary), how to activate manually the inputs and output of a  neuron), network forward input propagation, but specially for me the core of the AI nets: the back error propagation), etc.</p>
<p>Finally I decided to jump into high level Api Keras model, to wrapper of these detailed functions into a more integrated ones such as Model/Sequential, with their methods of .fit, .evaluate, .predict, and tools such as to_categorical, etc.Besides sklearn libraries for normalization, kfold, onehotencoding, etc.</p>
<p> Of course I got better accuracies (97.5% as mean kfold) because I could used “relu”, activations functions, and output her layers types, etc…  </p>
<p>So one more time, thanks for this tutorial to have the chance to understand better the motor that it is running below tensorflow and specially under Keras High level structures…</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-572022" data-commentid="572022" data-postid="3349" data-belowelement="comment-572022" data-respondelement="respond" data-replyto="Reply to JG" aria-label="Reply to JG">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-572085" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-572085" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">November 1, 2020 at 7:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-572085" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Nice work!</p>
<p>The tutorial really should be updated to use cross entropy and relu, e.g. modern ideas. I wrote this implementation like we used to in the 90s.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-572085" data-commentid="572085" data-postid="3349" data-belowelement="comment-572085" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-572025" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-572025" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/38fad5c19b9f971dbd2b25b324bda3f8.png" srcset="https://secure.gravatar.com/avatar/38fad5c19b9f971dbd2b25b324bda3f8?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://acehl.org/" rel="external nofollow ugc" class="url">JG</a></span>
	                <span class="date">October 31, 2020 at 10:52 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-572025" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>More particularly the “backpropagation” ML concept, I rather prefer to cal it more intuitively and personal as  “distribution of output error between all the weights / biases of neurons of all layers of the model” . </p>
<p>So “error’s distribution” between all errors contributors (model’s weights/biases) it is for me a better name and key idea  than standard one of  “backpropagation”…</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-572025" data-commentid="572025" data-postid="3349" data-belowelement="comment-572025" data-respondelement="respond" data-replyto="Reply to JG" aria-label="Reply to JG">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-572086" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-572086" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">November 1, 2020 at 7:31 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-572086" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Agreed. That is the key learning from this tutorial!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-572086" data-commentid="572086" data-postid="3349" data-belowelement="comment-572086" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-573471" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-573471" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/f81e406fa54320c4bc498b5766d016eb.png" srcset="https://secure.gravatar.com/avatar/f81e406fa54320c4bc498b5766d016eb?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Lia Jusmai Theresia</span>
	                <span class="date">November 7, 2020 at 5:19 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-573471" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello, can you help me create a rainfall prediction code using the neural network in python?<br>
I do not understand. I have monthly data spanning 10 years. The total data that I got was 120 data. How about the input, hidden, output layer? How do you get neron? and what parameters will be used? Thank you in advance</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-573471" data-commentid="573471" data-postid="3349" data-belowelement="comment-573471" data-respondelement="respond" data-replyto="Reply to Lia Jusmai Theresia" aria-label="Reply to Lia Jusmai Theresia">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-573582" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-573582" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">November 8, 2020 at 6:38 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-573582" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I recommend starting with the tutorials here:<br>
<a href="https://machinelearningmastery.com/start-here/#deep_learning_time_series" rel="nofollow ugc">https://machinelearningmastery.com/start-here/#deep_learning_time_series</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-573582" data-commentid="573582" data-postid="3349" data-belowelement="comment-573582" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-573495" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-573495" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/b23a958b219b29a2f870be3d6049afc4.png" srcset="https://secure.gravatar.com/avatar/b23a958b219b29a2f870be3d6049afc4?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/" rel="external nofollow ugc" class="url">Arnav</a></span>
	                <span class="date">November 7, 2020 at 6:32 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-573495" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Can you fix my code please?<br>
<a href="https://colab.research.google.com/drive/1Skfq3A1u7Mwdo72YBRWOm4x0SCp8mIFn?usp=sharing" rel="nofollow ugc">https://colab.research.google.com/drive/1Skfq3A1u7Mwdo72YBRWOm4x0SCp8mIFn?usp=sharing</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-573495" data-commentid="573495" data-postid="3349" data-belowelement="comment-573495" data-respondelement="respond" data-replyto="Reply to Arnav" aria-label="Reply to Arnav">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-573584" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-573584" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">November 8, 2020 at 6:39 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-573584" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This is a common question that I answer here:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/can-you-read-review-or-debug-my-code" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/can-you-read-review-or-debug-my-code</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-573584" data-commentid="573584" data-postid="3349" data-belowelement="comment-573584" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-573856" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-573856" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/3b3bf57bd2962d57c4a1619643c59622.png" srcset="https://secure.gravatar.com/avatar/3b3bf57bd2962d57c4a1619643c59622?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Pedro H</span>
	                <span class="date">November 9, 2020 at 5:31 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-573856" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, is this code rigged for the 2:1:2 layout?</p>
<p>If yes can you point me some good articles to better understand the back forward prop?</p>
<p>Anyway, great work! It REALY helped me!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-573856" data-commentid="573856" data-postid="3349" data-belowelement="comment-573856" data-respondelement="respond" data-replyto="Reply to Pedro H" aria-label="Reply to Pedro H">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-573871" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-573871" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">November 9, 2020 at 6:16 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-573871" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Not really.</p>
<p>You can adapt the architecture of the model directly.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-573871" data-commentid="573871" data-postid="3349" data-belowelement="comment-573871" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-573901" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-573901" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/c0a400fd2fad9441094f671d733ad263.png" srcset="https://secure.gravatar.com/avatar/c0a400fd2fad9441094f671d733ad263?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://www.linkedin.com/in/chrimaho/" rel="external nofollow ugc" class="url">Chris Mahoney</a></span>
	                <span class="date">November 9, 2020 at 9:05 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-573901" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>I LOVED this article. It helped me immensely in learning about the intricacies of Neural Networks and Deep Learning in recently months. Thank you so much!</p>
<p>I note here that you do a node-by-node method of implementation. But there is also another method using matrix multiplication and linear algebra.</p>
<p>I’ve taken these concepts and processes, and written up a similar article. Except, I’ve used R and the matrix method. I’d love to know your thoughts on it:<br>
<a href="https://towardsdatascience.com/vanilla-neural-networks-in-r-43b028f415?sk=f47b3d6f9f539e907d272966fa88bcb8" rel="nofollow ugc">https://towardsdatascience.com/vanilla-neural-networks-in-r-43b028f415?sk=f47b3d6f9f539e907d272966fa88bcb8</a></p>
<p>Thank you again for your assistance. It has helped me greatly!</p>
<p>Cheers,<br>
Chris M</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-573901" data-commentid="573901" data-postid="3349" data-belowelement="comment-573901" data-respondelement="respond" data-replyto="Reply to Chris Mahoney" aria-label="Reply to Chris Mahoney">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-573954" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-573954" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">November 9, 2020 at 1:15 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-573954" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks.</p>
<p>Well done.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-573954" data-commentid="573954" data-postid="3349" data-belowelement="comment-573954" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-577402" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-577402" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/27443509ba2f11c0e94bda52cfb3ee30.png" srcset="https://secure.gravatar.com/avatar/27443509ba2f11c0e94bda52cfb3ee30?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Joey Hung</span>
	                <span class="date">November 22, 2020 at 3:26 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-577402" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thanks for your code.<br>
However, when I was running it, it has below problem and I don’t know how to fix it. Could you help to fix it?</p>
<p>Traceback (most recent call last):<br>
  File “MDSHW3-2.py”, line 187, in<br>
    scores = evaluate_algorithm(df, back_propagation, n_folds, l_rate, n_epoch, n_hidden)<br>
  File “MDSHW3-2.py”, line 59, in evaluate_algorithm<br>
    train_set.remove(fold)<br>
ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-577402" data-commentid="577402" data-postid="3349" data-belowelement="comment-577402" data-respondelement="respond" data-replyto="Reply to Joey Hung" aria-label="Reply to Joey Hung">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-577460" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-577460" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">November 22, 2020 at 6:57 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-577460" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry to hear that, these tips may help:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-577460" data-commentid="577460" data-postid="3349" data-belowelement="comment-577460" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-579861" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-579861" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/8869ecdadb916e09a93414802340ca1f.png" srcset="https://secure.gravatar.com/avatar/8869ecdadb916e09a93414802340ca1f?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Chiso Buso</span>
	                <span class="date">December 1, 2020 at 7:13 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-579861" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you very much, I would be glad if I can get python code for ANN-Using BP for a regression problem. Like the inputs of 10 parameters and outputs of the continuous value of 5 parameters. </p>
<p>Look forward to hearing from you.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-579861" data-commentid="579861" data-postid="3349" data-belowelement="comment-579861" data-respondelement="respond" data-replyto="Reply to Chiso Buso" aria-label="Reply to Chiso Buso">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-579863" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-579863" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">December 1, 2020 at 8:06 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-579863" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The above example can be adapted for your regression problem directly.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-579863" data-commentid="579863" data-postid="3349" data-belowelement="comment-579863" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-580871" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-580871" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/845f7f735bce9c1555dc56e89c1acb50.png" srcset="https://secure.gravatar.com/avatar/845f7f735bce9c1555dc56e89c1acb50?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Lokman Hakim</span>
	                <span class="date">December 5, 2020 at 2:49 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-580871" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Can i know why we pass ‘None’ in the code “row = [1,0, None]” which is in the forward propagation phase.<br>
Is it because it is related to bias?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-580871" data-commentid="580871" data-postid="3349" data-belowelement="comment-580871" data-respondelement="respond" data-replyto="Reply to Lokman Hakim" aria-label="Reply to Lokman Hakim">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-580953" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-580953" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">December 5, 2020 at 8:09 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-580953" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>We mark the label as None.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-580953" data-commentid="580953" data-postid="3349" data-belowelement="comment-580953" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-587058" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-587058" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/fac000f1d38694ea2344fed595d52aad.png" srcset="https://secure.gravatar.com/avatar/fac000f1d38694ea2344fed595d52aad?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://sinabirecik.wordpress.com/" rel="external nofollow ugc" class="url">Sina Birecik</a></span>
	                <span class="date">December 21, 2020 at 9:17 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-587058" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason,<br>
At first, many thanks for the tutorial, it has cleared a lot of things about DL in my mind.<br>
I would like to make a contribution. It includes the code that allows your network to get deeper. People here can upgrade your code to multi hidden layers, each neuron number in each hidden layer can be adjusted. Just follow the instructions:<br>
1) Copy the code in the link below and overwrite the whole “initialize_network” method.<br>
<a href="https://pastebin.pl/view/fc96c453" rel="nofollow ugc">https://pastebin.pl/view/fc96c453</a><br>
2) Replace any “n_hidden” term with “hidden_list”.<br>
3) At the end of the code, you can adjust hidden layers like the example below:<br>
    Example:<br>
        hidden_list = [5, 3, 7]<br>
    means there are 3 hidden layers, each hidden layer has 5, 3 and 7 neurons, respectively.</p>
<p>Best regards.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-587058" data-commentid="587058" data-postid="3349" data-belowelement="comment-587058" data-respondelement="respond" data-replyto="Reply to Sina Birecik" aria-label="Reply to Sina Birecik">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-587147" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-587147" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">December 21, 2020 at 1:53 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-587147" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You’re welcome.</p>
<p>Thanks for sharing!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-587147" data-commentid="587147" data-postid="3349" data-belowelement="comment-587147" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-587510" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-587510" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a9d8b164d715d8a40f15524c9c2f23ff.png" srcset="https://secure.gravatar.com/avatar/a9d8b164d715d8a40f15524c9c2f23ff?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Frank</span>
	                <span class="date">December 22, 2020 at 12:01 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-587510" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello, I have a simple question, your data have 3 classes like 1-2-3 , for example if we have different number of classes and if they are string like YES NO , do we need to convert them to 0-1 or it  does not matter . I checked the code for find the answer but i could not be able to find it. Please answer me .</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-587510" data-commentid="587510" data-postid="3349" data-belowelement="comment-587510" data-respondelement="respond" data-replyto="Reply to Frank" aria-label="Reply to Frank">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-587552" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-587552" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">December 22, 2020 at 1:36 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-587552" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, class labels should be integer encoded then one hot encoded prior to modeling for neural networks.</p>
<p>Perhaps start here:<br>
<a href="https://machinelearningmastery.com/one-hot-encoding-for-categorical-data/" rel="nofollow ugc">https://machinelearningmastery.com/one-hot-encoding-for-categorical-data/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-587552" data-commentid="587552" data-postid="3349" data-belowelement="comment-587552" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-587808" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-587808" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/1b693079cc293b61659cc75336a560ad.png" srcset="https://secure.gravatar.com/avatar/1b693079cc293b61659cc75336a560ad?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://xn--odt-joa/" rel="external nofollow ugc" class="url">GreakBoy</a></span>
	                <span class="date">December 23, 2020 at 5:28 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-587808" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hı, ıt was a really good article , thank you for doing such a good work.<br>
I have a question , in your csv data your all coloumns are integer and your classes are at the last coloum, numbers but what if<br>
we have data csv like that and one class is Mercedes and the other is Porsche in this situation do we need to implement any extra code in your example code to convert, ı tried it still works but i am not sure about answer.</p>
<p>5001700134,2053150024,961776886,88349551,15594,793434083,Mercedes<br>
4363829956,1773486023,8596657562,874662638,12190,763556063,Porsche</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-587808" data-commentid="587808" data-postid="3349" data-belowelement="comment-587808" data-respondelement="respond" data-replyto="Reply to GreakBoy" aria-label="Reply to GreakBoy">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-587820" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-587820" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">December 23, 2020 at 5:37 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-587820" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks.</p>
<p>Perhaps scale the values prior to model and integer encode labels.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-587820" data-commentid="587820" data-postid="3349" data-belowelement="comment-587820" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-594015" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-594015" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/86fa0e4a9d801c97d6fa87089cd81f63.png" srcset="https://secure.gravatar.com/avatar/86fa0e4a9d801c97d6fa87089cd81f63?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Gloria</span>
	                <span class="date">January 22, 2021 at 8:38 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-594015" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for this useful article!<br>
I want to change Sigmoid function into ReLU, so I modified the following 2 functions: (1) transfer(activation) and (2) transfer_derivative(output) as follows:</p>
<p>(1) return 1.0 / (1.0 + exp(-activation)) =&gt; return max(activation,0)<br>
(2) return output * (1.0 – output) =&gt; return 1 if output&gt;0 else 0</p>
<p>However, the network isn’t learning (accuracy ~33.3% for each fold, even when I train more epoches). Did I get something wrong? Thanks in advance!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-594015" data-commentid="594015" data-postid="3349" data-belowelement="comment-594015" data-respondelement="respond" data-replyto="Reply to Gloria" aria-label="Reply to Gloria">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-594072" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-594072" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">January 23, 2021 at 7:03 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-594072" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You’re welcome.</p>
<p>Nice work!</p>
<p>Perhaps check you didn’t change the activation function in the output layer!<br>
Perhaps change the loss to cross entropy?<br>
Perhaps change the architecture?<br>
Perhaps change the learning hyperparameters?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-594072" data-commentid="594072" data-postid="3349" data-belowelement="comment-594072" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-594350" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-594350" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/86fa0e4a9d801c97d6fa87089cd81f63.png" srcset="https://secure.gravatar.com/avatar/86fa0e4a9d801c97d6fa87089cd81f63?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Gloria</span>
	                <span class="date">January 25, 2021 at 7:18 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-594350" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, thanks for the reply!<br>
I’ve checked the activations and weights, and found that it is the problem of ‘dying ReLU’. Some units (in this case the 3 output unit) always output 0 and cannot recover with further training.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-594350" data-commentid="594350" data-postid="3349" data-belowelement="comment-594350" data-respondelement="respond" data-replyto="Reply to Gloria" aria-label="Reply to Gloria">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-594465" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-594465" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">January 26, 2021 at 5:50 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-594465" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Try an alternate weight initialization, like “he”.</p>
<p>Try scaling inputs to the range 0-1.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-594465" data-commentid="594465" data-postid="3349" data-belowelement="comment-594465" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-597108" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-597108" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/702308c3ebbbed70972592b9e05e33c4.png" srcset="https://secure.gravatar.com/avatar/702308c3ebbbed70972592b9e05e33c4?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Unnikrishnan</span>
	                <span class="date">February 11, 2021 at 1:28 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-597108" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Jason. Nice article.<br>
Concepts of Backpropagation became clear now.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-597108" data-commentid="597108" data-postid="3349" data-belowelement="comment-597108" data-respondelement="respond" data-replyto="Reply to Unnikrishnan" aria-label="Reply to Unnikrishnan">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-597186" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-597186" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">February 12, 2021 at 5:43 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-597186" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you, I’m happy it helps!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-597186" data-commentid="597186" data-postid="3349" data-belowelement="comment-597186" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-597421" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-597421" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/2a0ccc8467a164fe62fc2570c86a63dd.png" srcset="https://secure.gravatar.com/avatar/2a0ccc8467a164fe62fc2570c86a63dd?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">AbdulAhad</span>
	                <span class="date">February 14, 2021 at 1:00 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-597421" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for the great article. Still helping who want to know exactly what and how it happens from coding presepective.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-597421" data-commentid="597421" data-postid="3349" data-belowelement="comment-597421" data-respondelement="respond" data-replyto="Reply to AbdulAhad" aria-label="Reply to AbdulAhad">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-597443" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-597443" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">February 14, 2021 at 5:11 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-597443" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You’re welcome!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-597443" data-commentid="597443" data-postid="3349" data-belowelement="comment-597443" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-597509" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-597509" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/217c01cb78ddaee51df75b5cb4b54226.png" srcset="https://secure.gravatar.com/avatar/217c01cb78ddaee51df75b5cb4b54226?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">David</span>
	                <span class="date">February 15, 2021 at 6:45 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-597509" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thanks a bunch for this. Please, can this code work in Python 3.x?</p>
<p>Thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-597509" data-commentid="597509" data-postid="3349" data-belowelement="comment-597509" data-respondelement="respond" data-replyto="Reply to David" aria-label="Reply to David">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-597523" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-597523" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">February 15, 2021 at 8:11 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-597523" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You’re welcome David!</p>
<p>Yes, the code works with Python 3.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-597523" data-commentid="597523" data-postid="3349" data-belowelement="comment-597523" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-600675" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-600675" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/05f51b2aba8796ebb59b7d8f20c2ea83.png" srcset="https://secure.gravatar.com/avatar/05f51b2aba8796ebb59b7d8f20c2ea83?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Lukasz</span>
	                <span class="date">March 12, 2021 at 9:25 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-600675" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, </p>
<p>Thank you for great article! I run the code on my own dataset where I was predicting three label classes. The algorithm gave me a great results with the accuracy of the prediction above 97%. Right now I am trying to use the trained network to predict the results of the new dataset, where I would not provide any labels to calculate the accuracy. Do you have any recommendation for me? Thank you!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-600675" data-commentid="600675" data-postid="3349" data-belowelement="comment-600675" data-respondelement="respond" data-replyto="Reply to Lukasz" aria-label="Reply to Lukasz">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-600730" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-600730" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 13, 2021 at 5:31 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-600730" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can remove the evaluation of the model, fit the model on all available data and call predict on new data.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-600730" data-commentid="600730" data-postid="3349" data-belowelement="comment-600730" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-600975" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-600975" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/4ad7329b87863cb56d8f2abd10dede99.png" srcset="https://secure.gravatar.com/avatar/4ad7329b87863cb56d8f2abd10dede99?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/" rel="external nofollow ugc" class="url">Gordon</a></span>
	                <span class="date">March 16, 2021 at 2:38 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-600975" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, why do we copy the row and set row[-1] to None?<br>
This is in the function evaluate_algorithm:</p>
<p>for row in fold:<br>
	row_copy = list(row)<br>
	test_set.append(row_copy)<br>
	row_copy[-1] = None</p>
<p>it seems like you could just do</p>
<p>for row in fold:<br>
       test_set.append(row)</p>
<p>Thanks for your help!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-600975" data-commentid="600975" data-postid="3349" data-belowelement="comment-600975" data-respondelement="respond" data-replyto="Reply to Gordon" aria-label="Reply to Gordon">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-600999" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-600999" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 16, 2021 at 4:51 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-600999" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>So that the expected output value is not available to the model.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-600999" data-commentid="600999" data-postid="3349" data-belowelement="comment-600999" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-602099" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-602099" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/255bd18be368089a1bd62ed9a465f54d.png" srcset="https://secure.gravatar.com/avatar/255bd18be368089a1bd62ed9a465f54d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">mlhan</span>
	                <span class="date">March 27, 2021 at 2:58 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-602099" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Do u have any idea if I want the user enters the input.how can I do it 🙁</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-602099" data-commentid="602099" data-postid="3349" data-belowelement="comment-602099" data-respondelement="respond" data-replyto="Reply to mlhan" aria-label="Reply to mlhan">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
			</ol>
		 	</div>	<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#respond" style="display:none;">Click here to cancel reply.</a></small></h3><form action="https://machinelearningmastery.com/wp-comments-post.php?wpe-comment-post=mlmastery" method="post" id="commentform" class="comment-form"><p class="comment-form-comment"><label class="hide" for="comment">Comment</label> <textarea tabindex="4" id="comment" name="comment" cols="50" rows="10" maxlength="65525" required="required"></textarea></p><p class="comment-form-author"><input id="author" name="author" type="text" class="txt" tabindex="1" value="" size="30" aria-required="true"><label for="author">Name <span class="required">(required)</span></label> </p>
<p class="comment-form-email"><input id="email" name="email" type="text" class="txt" tabindex="2" value="" size="30" aria-required="true"><label for="email">Email (will not be published) <span class="required">(required)</span></label> </p>
<p class="comment-form-url"><input id="url" name="url" type="text" class="txt" tabindex="3" value="" size="30"><label for="url">Website</label></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit Comment"> <input type="hidden" name="comment_post_ID" value="3349" id="comment_post_ID">
<input type="hidden" name="comment_parent" id="comment_parent" value="0">
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="64a4b9b380"></p><textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100" style="display: none !important;"></textarea><input type="hidden" id="ak_js" name="ak_js" value="1616956285899"></form>	</div><!-- #respond -->
	     
            </section><!-- /#main -->
                
            <aside id="sidebar">
<div id="woo_blogauthorinfo-2" class="widget widget_woo_blogauthorinfo"><span class="left"><img alt="" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=176&amp;d=mm&amp;r=g 2x" class="avatar avatar-88 photo" height="88" width="88" loading="lazy"></span>
<p><strong>Welcome!</strong><br>
I'm <em>Jason Brownlee</em> PhD <br>
and I <strong>help developers</strong> get results with <strong>machine learning</strong>.<br>
<a href="https://machinelearningmastery.com/about">Read more</a></p>
<div class="fix"></div>
</div><div id="custom_html-89_clone" class="widget_text widget widget_custom_html q2w3-widget-clone-primary" style="top: 10px; width: 306.307px; height: 68.1818px; visibility: hidden;"></div><div id="custom_html-89" class="widget_text widget widget_custom_html" style="top: 10px; width: 306.307px; position: fixed;"><div class="textwidget custom-html-widget"><h4>Never miss a tutorial:</h4>
<br>
<div style="text-align: left;">
<a href="https://www.linkedin.com/company/machine-learning-mastery/"><img width="30" height="30" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/small_icon_blue_linkedin3.webp" alt="LinkedIn"></a>
&nbsp;&nbsp;&nbsp;
<a href="https://twitter.com/TeachTheMachine"><img width="30" height="30" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/small_icon_blue_twitter3.webp" alt="Twitter"></a>
&nbsp;&nbsp;&nbsp;
<a href="https://www.facebook.com/MachineLearningMastery/"><img width="30" height="30" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/small_icon_blue_facebook3.webp" alt="Facebook"></a>
&nbsp;&nbsp;&nbsp;
<a href="https://machinelearningmastery.com/newsletter/"><img width="30" height="30" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/small_icon_blue_email3.webp" alt="Email Newsletter"></a>
&nbsp;&nbsp;&nbsp;
<a href="https://machinelearningmastery.com/rss-feed/"><img width="30" height="30" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/small_icon_blue_rss3.webp" alt="RSS Feed"></a>
</div></div></div><div id="custom_html-52_clone" class="widget_text widget widget_custom_html q2w3-widget-clone-primary" style="top: 108.182px; width: 306.307px; height: 408.182px; visibility: hidden;"></div><div id="custom_html-52" class="widget_text widget widget_custom_html" style="top: 108.182px; width: 306.307px; position: fixed;"><div class="textwidget custom-html-widget"><h4>Picked for you:</h4>
<br>
<div class="display-posts-listing image-left"><div class="listing-item"><a class="image" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/"><img width="150" height="150" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/How-to-Implement-the-Backpropagation-Algorithm-From-Scratch-(1).jpg" class="attachment-thumbnail size-thumbnail wp-post-image" alt="How to Implement the Backpropagation Algorithm From Scratch In Python" loading="lazy"></a> <a class="title" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/" rel="nofollow">How to Code a Neural Network with Backpropagation In Python (from scratch)</a></div><div class="listing-item"><a class="image" href="https://machinelearningmastery.com/tutorial-to-implement-k-nearest-neighbors-in-python-from-scratch/"><img width="150" height="150" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/k-Nearest-Neighbors-algorithm-150x150.webp" class="attachment-thumbnail size-thumbnail wp-post-image" alt="k-Nearest Neighbors algorithm" loading="lazy"></a> <a class="title" href="https://machinelearningmastery.com/tutorial-to-implement-k-nearest-neighbors-in-python-from-scratch/" rel="nofollow">Develop k-Nearest Neighbors in Python From Scratch</a></div><div class="listing-item"><a class="image" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/"><img width="150" height="150" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/How-To-Implement-The-Decision-Tree-Algorithm-From-Scratch-In-Pytho.jpg" class="attachment-thumbnail size-thumbnail wp-post-image" alt="How To Implement The Decision Tree Algorithm From Scratch In Python" loading="lazy"></a> <a class="title" href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/" rel="nofollow">How To Implement The Decision Tree Algorithm From Scratch In Python</a></div><div class="listing-item"><a class="image" href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/"><img width="150" height="150" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/naive-bayes-classifier-150x150.jpg" class="attachment-thumbnail size-thumbnail wp-post-image" alt="naive bayes classifier" loading="lazy"></a> <a class="title" href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/" rel="nofollow">Naive Bayes Classifier From Scratch in Python</a></div><div class="listing-item"><a class="image" href="https://machinelearningmastery.com/implement-perceptron-algorithm-scratch-python/"><img width="150" height="150" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/How-To-Implement-The-Perceptron-Algorithm-From-Scratch-In-Python-1.jpg" class="attachment-thumbnail size-thumbnail wp-post-image" alt="How To Implement The Perceptron Algorithm From Scratch In Python" loading="lazy"></a> <a class="title" href="https://machinelearningmastery.com/implement-perceptron-algorithm-scratch-python/" rel="nofollow">How To Implement The Perceptron Algorithm From Scratch In Python</a></div></div></div></div><div id="custom_html-24_clone" class="widget_text widget widget_custom_html q2w3-widget-clone-primary" style="top: 546.364px; width: 306.307px; height: 138.153px; visibility: hidden;"></div><div id="custom_html-24" class="widget_text widget widget_custom_html" style="top: 546.364px; width: 306.307px; position: fixed;"><div class="textwidget custom-html-widget"><div style="text-align: center;">
	<p></p><h4>Loving the Tutorials?</h4><p></p>

<p>The <a href="https://machinelearningmastery.com/machine-learning-algorithms-from-scratch/" rel="nofollow">Code Algorithms from Scratch </a> EBook is<br> where you'll find the <strong><i>Really Good</i></strong> stuff.</p>

<a href="https://machinelearningmastery.com/machine-learning-algorithms-from-scratch/" class="woo-sc-button  red"><span class="woo-">&gt;&gt; See What's Inside</span></a>

</div></div></div></aside><!-- /#sidebar -->

		</div><!-- /#main-sidebar-container -->         

		
    </div><!-- /#content -->
	
	<footer id="footer" class="col-full">

		
		<div id="copyright" class="col-left">
			<p>© 2021 Machine Learning Mastery Pty. Ltd. All Rights Reserved.<br>
<a href="https://www.linkedin.com/company/machine-learning-mastery/">LinkedIn</a> |
<a href="https://twitter.com/TeachTheMachine">Twitter</a> |
<a href="https://www.facebook.com/MachineLearningMastery/">Facebook</a> |
<a href="https://machinelearningmastery.com/newsletter/">Newsletter</a> |
<a href="https://machinelearningmastery.com/rss-feed/">RSS</a></p>		</div>

		<div id="credit" class="col-right">
			<p><a href="https://machinelearningmastery.com/privacy/">Privacy</a> | 
<a href="https://machinelearningmastery.com/disclaimer/">Disclaimer</a> | 
<a href="https://machinelearningmastery.com/terms-of-service/">Terms</a> | 
<a href="https://machinelearningmastery.com/contact/">Contact</a> |
<a href="https://machinelearningmastery.com/sitemap/">Sitemap</a> |
<a href="https://machinelearningmastery.com/site-search/">Search</a></p>		</div>

	</footer>

	
	</div><!-- /#inner-wrapper -->

</div><!-- /#wrapper -->

<div class="fix"></div><!--/.fix-->

<!-- Drip -->
<script data-cfasync="false" type="text/javascript">
  var _dcq = _dcq || [];
  var _dcs = _dcs || {};
  _dcs.account = '9556588';

  (function() {
    var dc = document.createElement('script');
    dc.type = 'text/javascript'; dc.async = true;
    dc.src = '//tag.getdrip.com/9556588.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(dc, s);
  })();
</script>
<!-- end Drip -->
<script type="text/javascript" id="rocket-browser-checker-js-after">
"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}var RocketBrowserCompatibilityChecker=function(){function RocketBrowserCompatibilityChecker(options){_classCallCheck(this,RocketBrowserCompatibilityChecker),this.passiveSupported=!1,this._checkPassiveOption(this),this.options=!!this.passiveSupported&&options}return _createClass(RocketBrowserCompatibilityChecker,[{key:"_checkPassiveOption",value:function(self){try{var options={get passive(){return!(self.passiveSupported=!0)}};window.addEventListener("test",null,options),window.removeEventListener("test",null,options)}catch(err){self.passiveSupported=!1}}},{key:"initRequestIdleCallback",value:function(){!1 in window&&(window.requestIdleCallback=function(cb){var start=Date.now();return setTimeout(function(){cb({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(Date.now()-start))}})},1)}),!1 in window&&(window.cancelIdleCallback=function(id){return clearTimeout(id)})}},{key:"isDataSaverModeOn",value:function(){return"connection"in navigator&&!0===navigator.connection.saveData}},{key:"supportsLinkPrefetch",value:function(){var elem=document.createElement("link");return elem.relList&&elem.relList.supports&&elem.relList.supports("prefetch")&&window.IntersectionObserver&&"isIntersecting"in IntersectionObserverEntry.prototype}},{key:"isSlowConnection",value:function(){return"connection"in navigator&&"effectiveType"in navigator.connection&&("2g"===navigator.connection.effectiveType||"slow-2g"===navigator.connection.effectiveType)}}]),RocketBrowserCompatibilityChecker}();
</script>
<script type="text/javascript" id="rocket-delay-js-js-after">
(function() {
"use strict";var e=function(){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}}();function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var t=function(){function r(e,t){n(this,r),this.attrName="data-rocketlazyloadscript",this.browser=t,this.options=this.browser.options,this.triggerEvents=e,this.userEventListener=this.triggerListener.bind(this)}return e(r,[{key:"init",value:function(){this._addEventListener(this)}},{key:"reset",value:function(){this._removeEventListener(this)}},{key:"_addEventListener",value:function(t){this.triggerEvents.forEach(function(e){return window.addEventListener(e,t.userEventListener,t.options)})}},{key:"_removeEventListener",value:function(t){this.triggerEvents.forEach(function(e){return window.removeEventListener(e,t.userEventListener,t.options)})}},{key:"_loadScriptSrc",value:function(){var r=this,e=document.querySelectorAll("script["+this.attrName+"]");0!==e.length&&Array.prototype.slice.call(e).forEach(function(e){var t=e.getAttribute(r.attrName);e.setAttribute("src",t),e.removeAttribute(r.attrName)}),this.reset()}},{key:"triggerListener",value:function(){this._loadScriptSrc(),this._removeEventListener(this)}}],[{key:"run",value:function(){RocketBrowserCompatibilityChecker&&new r(["keydown","mouseover","touchmove","touchstart","wheel"],new RocketBrowserCompatibilityChecker({passive:!0})).init()}}]),r}();t.run();
}());
</script>
<script type="text/javascript" id="rocket-preload-links-js-extra">
/* <![CDATA[ */
var RocketPreloadLinksConfig = {"excludeUris":"\/(.+\/)?feed\/?.+\/?|\/(?:.+\/)?embed\/|\/(index\\.php\/)?wp\\-json(\/.*|$)|\/wp-admin\/|\/logout\/|\/wp-login.php","usesTrailingSlash":"1","imageExt":"jpg|jpeg|gif|png|tiff|bmp|webp|avif","fileExt":"jpg|jpeg|gif|png|tiff|bmp|webp|avif|php|pdf|html|htm","siteUrl":"https:\/\/machinelearningmastery.com","onHoverDelay":"100","rateThrottle":"3"};
/* ]]> */
</script>
<script type="text/javascript" id="rocket-preload-links-js-after">
(function() {
"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}();function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var t=function(){function n(e,t){i(this,n),this.browser=e,this.config=t,this.options=this.browser.options,this.prefetched=new Set,this.eventTime=null,this.threshold=1111,this.numOnHover=0}return e(n,[{key:"init",value:function(){!this.browser.supportsLinkPrefetch()||this.browser.isDataSaverModeOn()||this.browser.isSlowConnection()||(this.regex={excludeUris:RegExp(this.config.excludeUris,"i"),images:RegExp(".("+this.config.imageExt+")$","i"),fileExt:RegExp(".("+this.config.fileExt+")$","i")},this._initListeners(this))}},{key:"_initListeners",value:function(e){-1<this.config.onHoverDelay&&document.addEventListener("mouseover",e.listener.bind(e),e.listenerOptions),document.addEventListener("mousedown",e.listener.bind(e),e.listenerOptions),document.addEventListener("touchstart",e.listener.bind(e),e.listenerOptions)}},{key:"listener",value:function(e){var t=e.target.closest("a"),n=this._prepareUrl(t);if(null!==n)switch(e.type){case"mousedown":case"touchstart":this._addPrefetchLink(n);break;case"mouseover":this._earlyPrefetch(t,n,"mouseout")}}},{key:"_earlyPrefetch",value:function(t,e,n){var i=this,r=setTimeout(function(){if(r=null,0===i.numOnHover)setTimeout(function(){return i.numOnHover=0},1e3);else if(i.numOnHover>i.config.rateThrottle)return;i.numOnHover++,i._addPrefetchLink(e)},this.config.onHoverDelay);t.addEventListener(n,function e(){t.removeEventListener(n,e,{passive:!0}),null!==r&&(clearTimeout(r),r=null)},{passive:!0})}},{key:"_addPrefetchLink",value:function(i){return this.prefetched.add(i.href),new Promise(function(e,t){var n=document.createElement("link");n.rel="prefetch",n.href=i.href,n.onload=e,n.onerror=t,document.head.appendChild(n)}).catch(function(){})}},{key:"_prepareUrl",value:function(e){if(null===e||"object"!==(void 0===e?"undefined":r(e))||!1 in e||-1===["http:","https:"].indexOf(e.protocol))return null;var t=e.href.substring(0,this.config.siteUrl.length),n=this._getPathname(e.href,t),i={original:e.href,protocol:e.protocol,origin:t,pathname:n,href:t+n};return this._isLinkOk(i)?i:null}},{key:"_getPathname",value:function(e,t){var n=t?e.substring(this.config.siteUrl.length):e;return n.startsWith("/")||(n="/"+n),this._shouldAddTrailingSlash(n)?n+"/":n}},{key:"_shouldAddTrailingSlash",value:function(e){return this.config.usesTrailingSlash&&!e.endsWith("/")&&!this.regex.fileExt.test(e)}},{key:"_isLinkOk",value:function(e){return null!==e&&"object"===(void 0===e?"undefined":r(e))&&(!this.prefetched.has(e.href)&&e.origin===this.config.siteUrl&&-1===e.href.indexOf("?")&&-1===e.href.indexOf("#")&&!this.regex.excludeUris.test(e.href)&&!this.regex.images.test(e.href))}}],[{key:"run",value:function(){"undefined"!=typeof RocketPreloadLinksConfig&&new n(new RocketBrowserCompatibilityChecker({capture:!0,passive:!0}),RocketPreloadLinksConfig).init()}}]),n}();t.run();
}());
</script>



<script type="text/javascript">window.lazyLoadOptions={elements_selector:"iframe[data-lazy-src]",data_src:"lazy-src",data_srcset:"lazy-srcset",data_sizes:"lazy-sizes",class_loading:"lazyloading",class_loaded:"lazyloaded",threshold:300,callback_loaded:function(element){if(element.tagName==="IFRAME"&&element.dataset.rocketLazyload=="fitvidscompatible"){if(element.classList.contains("lazyloaded")){if(typeof window.jQuery!="undefined"){if(jQuery.fn.fitVids){jQuery(element).parent().fitVids()}}}}}};window.addEventListener('LazyLoad::Initialized',function(e){var lazyLoadInstance=e.detail.instance;if(window.MutationObserver){var observer=new MutationObserver(function(mutations){var image_count=0;var iframe_count=0;var rocketlazy_count=0;mutations.forEach(function(mutation){for(i=0;i<mutation.addedNodes.length;i++){if(typeof mutation.addedNodes[i].getElementsByTagName!=='function'){continue}
if(typeof mutation.addedNodes[i].getElementsByClassName!=='function'){continue}
images=mutation.addedNodes[i].getElementsByTagName('img');is_image=mutation.addedNodes[i].tagName=="IMG";iframes=mutation.addedNodes[i].getElementsByTagName('iframe');is_iframe=mutation.addedNodes[i].tagName=="IFRAME";rocket_lazy=mutation.addedNodes[i].getElementsByClassName('rocket-lazyload');image_count+=images.length;iframe_count+=iframes.length;rocketlazy_count+=rocket_lazy.length;if(is_image){image_count+=1}
if(is_iframe){iframe_count+=1}}});if(image_count>0||iframe_count>0||rocketlazy_count>0){lazyLoadInstance.update()}});var b=document.getElementsByTagName("body")[0];var config={childList:!0,subtree:!0};observer.observe(b,config)}},!1)</script><script async="" data-no-minify="1" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/lazyload.min.js.download" type="text/javascript"></script><script src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/3ed81729718a91c994504fa83c9d4d63.js.download" data-minify="1" defer="" type="text/javascript"></script>

<!-- This website is like a Rocket, isn't it? Performance optimized by WP Rocket. Learn more: https://wp-rocket.me --><div class="drip-tab-container">
  <div id="drip-2211" class="drip-tab bottom right side-image image-right classic">
    <div id="drip-header-2211" class="drip-header">
      <a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#" id="drip-toggle-2211" class="drip-toggle">
        <h2 id="drip-teaser-2211">Start Machine Learning</h2>
        <span id="drip-tab-up-2211" class="drip-arrow up">
          <svg width="12px" height="8px" viewBox="1362 659 12 8" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
            <polygon id="right_angle" stroke="none" fill="#FFFFFF" fill-rule="evenodd" transform="translate(1368.000000, 662.703125) rotate(-90.000000) translate(-1368.000000, -662.703125) " points="1364.29688 667.296875 1368.89062 662.703125 1364.29688 658.109375 1365.70312 656.703125 1371.70312 662.703125 1365.70312 668.703125"></polygon>
          </svg>
        </span>
        <span id="drip-tab-down-2211" class="drip-arrow down" style="display: none"></span>
      </a>
    </div>

    <div id="drip-content-2211" class="drip-content drip-clearfix" style="height: auto; bottom: -495px;">
      <div id="drip-form-panel-2211" class="drip-panel" style="display: block;">
        <a id="drip-close-2211" class="drip-close">×</a>
        <h3 id="drip-content-header-2211">Start Machine Learning</h3>
        <div id="drip-scroll-2211" class="drip-scroll">
          <div class="drip-clearfix">
              <img src="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/" class="drip-image">
            <div class="drip-description">You can master applied Machine Learning&nbsp;<br>
<strong>without math or fancy degrees</strong>.<br>
Find out how in this <em>free</em>&nbsp;and <em>practical</em>&nbsp;course.</div>
          </div>
          <form id="drip-form-2211">
            <div style="display: none">
              <input type="hidden" name="form_id" value="2211">
              
            </div>
            <dl class="no-labels">
                  <dt class="label-for-type-email">
    Email Address
      <span title="Required"> *</span>
  </dt>
  <dd>
    <input type="email" name="fields[email]" value="" placeholder="Email Address" class="drip-text-field" id="drip-email-field-2211" tabindex="0">
<div id="drip-errors-for-email-2211" class="drip-errors"></div>

  </dd>

                  <dt class="label-for-type-eu_consent">
    
  </dt>
  <dd>
      <div class="classic--checkbox hidden" data-container="eu-checkbox">
    <input type="hidden" name="fields[eu_consent]" id="drip-field-eu_consent-2211-denied" value="denied" disabled="disabled">
    <input type="checkbox" name="fields[eu_consent]" id="drip-field-eu_consent-2211" value="granted" disabled="disabled">
    <label for="drip-field-eu_consent-2211">I consent to receive information about services and special offers by email. For more information, see the <a href="https://machinelearningmastery.com/privacy/">Privacy Policy</a>.</label>
  </div>

  </dd>

                <input type="hidden" name="fields[eu_consent_message]" value="I consent to receive information about services and special offers by email. For more information, see the Privacy Policy (https://machinelearningmastery.com/privacy/)." tabindex="-1">

              <div style="display: none;" aria-hidden="true">
  <dt for="website">Website</dt>
  <dd>
    <input type="text" id="website" name="website" placeholder="Website" class="drip-text-field" tabindex="-1" autocomplete="false" value="">
  </dd>
</div>

            </dl>
            <div class="form-controls">
              <input type="submit" name="submit" value="Start My Email Course" id="drip-submit-2211" class="drip-submit-button">
            </div>
            <div id="drip-errors-for-base-2211" class="drip-errors dfwid-error"></div>

          </form>
        </div>
      </div>

      <div id="drip-success-panel-2211" class="drip-success drip-panel drip-clearfix drip-form-success-message" style="display: none">
        <a id="drip-hide-2211" class="drip-close">×</a>
        <h3>Thank you for signing up!</h3>
        <p class="drip-description">Please check your email and click the link provided to confirm your subscription.</p>
      </div>
    </div>
  </div>
</div><iframe scrolling="no" frameborder="0" allowtransparency="true" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/widget_iframe.0edc1ef9f8b82d9b79c6115bda79f63f.html" title="Twitter settings iframe" style="display: none;"></iframe><iframe id="rufous-sandbox" scrolling="no" frameborder="0" allowtransparency="true" allowfullscreen="true" style="position: absolute; visibility: hidden; display: none; width: 0px; height: 0px; padding: 0px; border: none;" title="Twitter analytics iframe" src="./How to Code a Neural Network with Backpropagation In Python (from scratch)_files/saved_resource.html"></iframe></body></html>